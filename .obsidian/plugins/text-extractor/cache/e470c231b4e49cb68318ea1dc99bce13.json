{"path":".obsidian/plugins/text-extractor/cache/e470c231b4e49cb68318ea1dc99bce13.json","text":"MATEMATYKA OLIMPIJSKA ⋆GeometriaCzêœæ 1 p q p q pq . p p 2 p p pp pp qqpp qq pp qq .. pp pp 22 pp pp pppp Algebra i Teoria Liczb Adam Neugebauer STYCZEŃ 2018 OPRACOWANIE GRAFICZNE Autor W y d a n i e XV (rozszerzone) Przedmowa Mathematik ist die K¨onigin der Wissennschaften und die Zahlentheorie die K¨onigin der Mathematik. (Carl Friedrich Gauss) Przedstawiamy kolejne wydanie pierwszego, z powstających czterech, skryptu z MATEMA- TYKI OLIMPIJSKIEJ. Skrypt ten – ż ó ł t y – przedstawia podstawowe pojęcia i metody elementarnej Algebry i Teorii Liczb. Kolejnymi są lub będą: skrypt z i e l o n y – Geometria (cytowany jako GEO ), skrypt c z e r w o n y – Kombinatoryka (cytowany jako KOM ) i skrypt n i e b i e s k i – Równania i Nierówności (cytowany jako RIN ). Zamiarem pomysłodawców jest, by mogły one służyć nauczycielom i uczniom zajmującym się Olimpiadą Matematyczną. Byłoby też dobrze, gdyby matematykę elementarną, w objętości zakreślonej przez te skrypty, znali studenci kierunków nauczycielskich uniwersytetów. Przy wyborze przedstawionego materiału kierujemy się, oprócz pierwotnego wymogu ”ele- mentarności”, względami ”stosowalności” w matematyce olimpijskiej: większość omawianych tematów inspirowana była przez zadania olimpijskie (krajowe i międzynarodowe). Szczegółowy spis treści i indeks dają dostatecznie dobre wyobrażenie, na ile należy przy tym rozszerzyć i pogłębić wykładane w szkołach średnich treści teorioliczbowe i algebraiczne. Skrypt jest w zasadzie samowystarczalny: zaczyna się od liczb naturalnych. Dążąc do krzywych eliptycznych, po drodze mówi o jednoznaczności rozkładu na czynniki nieroz- kładalne w pierścieniu liczb całkowitych i pierścieniu wielomianów, kongruencjach, ułamkach łańcuchowych, formach kwadratowych, ciągach rekurencyjnych, pierście- niach kwadratowych, i o równaniach diofantycznych, w szczególności o równaniu in- dyjskim. Centralnym rozdziałem skryptu jest rozdział 5: badanie reszt z dzielenia liczb cał- kowitych przez ustaloną liczbę m – moduł – dostarcza mocnego narzędzia teorioliczbowego – arytmetyki modulo m – z którym powinni oswajać się już gimnazjaliści. W krótkiej bibliograﬁi, którą uzupełnić należy o rozmaite zbiory zadań z Olimpiad Mate- matycznych, pokazujemy kilka źródeł dających możliwość rozszerzenia i pogłębienia wiedzy algebraicznej i teorioliczbowej. W indeksie zamieszczamy również terminy zaledwie wspomniane w tekście. Powinno to rozbudzać ciekawość Czytelników i zachęcać do samodzielnych poszukiwań w literaturze. Znaczek □ oznacza koniec dowodu twierdzenia lub wskazuje, że dowód opuszczamy. Zna- czek ♦ oznacza koniec rozwiązania zadania lub koniec przykładu. Czasami zamiast wtedy i iv tylko wtedy, gdy piszemy ”iﬀ” (ang. if and only if ). Używamy też skrótu ”b.s.o.” zamiast bez straty ogólności. Skrypt należy zacząć czytać od Elementarza (rozdział 2) następnie przejść do Arytmetyki Modularnej (rozdział 5), stopniowo, gdy pojawia się potrzeba, zapoznając się z materiałem rozdziałów 1, 3 i 4. Kolejność czytania dalszych rozdziałów jest w zasadzie dowolna. Rozdziały 2, 3 i 4 (w planie: wszystkie) kończą się zestawami zadań treningowych i wska- zówkami/rozwiązaniami. Proponowana kolejność działań: (0) dobrze zrozum matematyczną treść zadania i wykonaj e k s p e r y m e n t y rachunkowe, (1) szukaj rozwiązania (nie rezygnuj przed upływem jednej godziny!), (2) czytaj (z ołówkiem w ręce) pokazaną wskazówkę/rozwiązanie uzupełniając wszystkie szczegóły, i porównaj z rozwiązaniem własnym (jeżeli takowe masz), (3) spróbuj znaleźć uogólnienie, (4) zreferuj kolegom. Autor wraz z konsultantem skryptu (którym jest pani Beata Bogdańska – współautor pozostałych części serii ”Matematyka Olimpijska”) ma nadzieję, że skrypt okaże się przy- datny w trudnej pracy nad ”otwieraniem” tego co w głowach młodzieży, dzięki zbiorowemu i (zapewne niezamierzenie) solidarnemu wysiłkowi dorosłych, zostało ”zamknięte”, mianowicie c i e k a w o ś c i ś w i a t a. Matematyka, jako królowa nauk, jest z pewnością jednym z lepszych (może najlepszym) ”otwieraczem” młodych umysłów, a w jej ramach teoria liczb, jako królowa matematyki, wyróżnia się szczególną ”ostrością”. APEL Szanowni Czytelnicy! Nasze skrypty z Matematyki Olimpijskiej są ciągle w trakcie tworzenia. Mimo naszych wy- siłków z pewnością pozostało w nich jeszcze sporo do poprawienia. W związku z tym zwracamy się do Was z apelem o: (1) krytyczne czytanie, (2) informowanie o zauważonych błędach i innych niedostatkach zarówno merytorycznych jak i dydaktycznych (adres: koloroweskrypty @ gmail.com). Bylibyśmy bardzo wdzięczni za wzięcie sobie do serca tego apelu. Nasze reakcje na Wasze uwagi zamieszczamy na stronie sites.google.com/site/koloroweskrypty. Tabliczka chronologiczna Euklides z Aleksandrii (ok. 365 p.n.e. - ok. 300 p.n.e.) Eratostenes z Cyreny (275 p.n.e. - 194 p.n.e.) Diofantos z Aleksandrii (III - IV wiek n.e.) Brahmagupta (598 - 660) Bhaskara (1114 - 1185) Leonardo Pisano Bigollo zw. Fibonacci (ok. 1170 - ok. 1240) Niccol`o Fontana zw. Tartaglia (ok. 1499 - 1557) Fran¸cois Vi`ete (1540 - 1603) Claude Gaspard Bachet de M´eziriac (1581 - 1638) Pierre de Fermat (1601 - 1665) Isaac Newton (1643 - 1727) Jakob Bernoulli (1654 - 1705) Leonhard Euler (1707 - 1783) ´Etienne B´ezout (1730 - 1783) Joseph-Louis Lagrange (1736 - 1813) Adrien Marie Legendre (1752 - 1833) Sophie Germain (1776 - 1831) Carl Friedrich Gauss (1777 - 1855) August Ferdinand M¨obius (1790 - 1868) Peter Gustav Lejeune-Dirichlet (1805 - 1859) Joseph Liouville (1809 - 1882) ´Evariste Galois (1811 - 1832) James Joseph Sylvester (1814 - 1897) Pafnucy Czebyszew (1821 - 1894) Gotthold Eisenstein (1823 - 1852) Leopold Kronecker (1823 - 1891) Richard Dedekind (1831 - 1916) Fran¸cois ´Edouard Lucas (1842 - 1891) Georg Frobenius (1849 - 1917) Adolf Hurwitz (1859 - 1919) Kurt Hensel (1861 - 1941) David Hilbert (1862 - 1943) Hermann Minkowski (1864 - 1909) Jacques Hadamard (1865 - 1963) Charles de la Vall´ee Poussin (1866 - 1962) Srinivasa Ramanujan (1887 - 1920) Liczby pierwsze 3 ⩽ p ⩽ 2011 i ich pierwiastki pierwotne p g g′ p g p g p g p g p g p g p g 3 2 −1 173 2 397 5 641 3 887 5 1163 5 1451 2 1721 3 5 2 −2 179 2 401 3 643 11 907 2 1171 2 1453 2 1723 3 7 3 −2 181 2 409 21 647 5 911 17 1181 7 1459 5 1733 2 11 2 −3 191 19 419 2 653 2 919 7 1187 2 1471 6 1741 2 13 2 −2 193 5 421 2 659 2 929 3 1193 3 1481 3 1747 2 17 3 −3 197 2 431 7 661 2 937 5 1201 11 1483 2 1753 7 19 2 −4 199 3 433 5 673 5 941 2 1213 2 1487 5 1759 6 23 5 −2 211 2 439 15 677 2 947 2 1217 3 1489 14 1777 5 29 2 −2 223 3 443 2 683 5 953 3 1223 5 1493 2 1783 10 31 3 −7 227 2 449 3 691 3 967 5 1229 2 1499 2 1787 2 37 2 −2 229 6 457 13 701 2 971 6 1231 3 1511 11 1789 6 41 6 −6 233 3 461 2 709 2 977 3 1237 2 1523 2 1801 11 43 3 −9 239 7 463 3 719 11 983 5 1249 7 1531 2 1811 6 47 5 −2 241 7 467 2 727 5 991 6 1259 2 1543 5 1823 5 53 2 −2 251 6 479 13 733 6 997 7 1277 2 1549 2 1831 3 59 2 −3 257 3 487 3 739 3 1009 11 1279 3 1553 3 1847 5 61 2 −2 263 5 491 2 743 5 1013 3 1283 2 1559 19 1861 2 67 2 −4 269 2 499 7 751 3 1019 2 1289 6 1567 3 1867 2 71 7 −2 271 6 503 5 757 2 1021 10 1291 2 1571 2 1871 14 73 5 −5 277 5 509 2 761 6 1031 14 1297 10 1579 3 1873 10 79 3 −2 281 3 521 3 769 11 1033 5 1301 2 1583 5 1877 2 83 2 −3 283 3 523 2 773 2 1039 3 1303 6 1597 11 1879 6 89 3 −3 293 2 541 2 787 2 1049 3 1307 2 1601 3 1889 3 97 5 −5 307 5 547 2 797 2 1051 7 1319 13 1607 5 1901 2 101 2 −2 311 17 557 2 809 3 1061 2 1321 13 1609 7 1907 2 103 5 −2 313 10 563 2 811 3 1063 3 1327 3 1613 3 1913 3 107 2 −3 317 2 569 3 821 2 1069 6 1361 3 1619 2 1931 2 109 6 −6 331 3 571 3 823 3 1087 3 1367 5 1621 2 1933 5 113 3 −3 337 10 577 5 827 2 1091 2 1373 2 1627 3 1949 2 127 3 −9 347 2 587 2 829 2 1093 5 1381 2 1637 2 1951 3 131 2 −3 349 2 593 7 839 11 1097 3 1399 13 1657 11 1973 2 137 3 −3 353 3 599 7 853 2 1103 5 1409 3 1663 3 1979 2 139 2 −4 359 7 601 7 857 3 1109 2 1423 3 1667 2 1987 2 149 2 −2 367 6 607 3 859 2 1117 2 1427 2 1669 2 1993 5 151 6 −5 373 2 613 2 863 5 1123 2 1429 6 1693 2 1997 2 157 5 −5 379 2 617 3 877 2 1129 11 1433 3 1697 3 1999 3 163 2 −4 383 5 619 2 881 3 1151 17 1439 7 1699 3 2003 5 167 5 −2 389 2 631 3 883 2 1153 5 1447 3 1709 3 2011 3 Spis treści 1 Pojęcia podstawowe 1 1.1 Liczby naturalne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 1.1.1 Kilka zasad podstawowych . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 1.1.2 Zasada Indukcji Matematycznej . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 1.2 Działania algebraiczne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 1.3 Grupa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 1.4 Pierścień przemienny. Ciało . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 1.5 Liczby zespolone . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 2 Elementarz 18 2.1 Największy wspólny dzielnik w pierścieniu Z . . . . . . . . . . . . . . . . . . . . . . . 18 2.1.1 Podzielność i dzielenie z resztą w Z . . . . . . . . . . . . . . . . . . . . . . . . 18 2.1.2 Ideały w pierścieniu Z . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20 2.1.3 Największy wspólny dzielnik . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22 2.1.4 Zasadnicze Twierdzenie Arytmetyki . . . . . . . . . . . . . . . . . . . . . . . . 24 2.1.5 Najmniejsza wspólna wielokrotność . . . . . . . . . . . . . . . . . . . . . . . . . 25 2.1.6 Algorytm Euklidesa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26 2.2 Równanie ax + by = n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 2.2.1 Twierdzenie Brahmagupty-Bachet’a . . . . . . . . . . . . . . . . . . . . . . . . 28 2.2.2 Twierdzenie Sylvestera . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 2.3 Liczby pierwsze . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 2.3.1 Istnienie i jednoznaczność rozkładu na czynniki pierwsze . . . . . . . . . . . . . 31 2.3.2 Sito Eratostenesa. Twierdzenie Euklidesa . . . . . . . . . . . . . . . . . . . . . 32 2.3.3 Kilka pytań dotyczących liczb pierwszych . . . . . . . . . . . . . . . . . . . . . 34 2.4 Wykładniki p-adyczne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36 2.4.1 Deﬁnicje. Formuła Legendre’a . . . . . . . . . . . . . . . . . . . . . . . . . . . 36 2.4.2 Lemat o zwiększaniu wykładnika p-adycznego . . . . . . . . . . . . . . . . . . . 38 2.5 Trójki pitagorejskie . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42 2.5.1 Trik . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42 2.5.2 Trójki pitagorejskie . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43 2.6 Zadania dodatkowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44 2.6.1 Treści zadań . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44 2.6.2 Wskazówki i rozwiązania . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48 3 Wielomiany 64 3.1 Pierścień wielomianów . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64 3.2 Siedem idei podstawowych . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66 3.2.1 Pierwsza idea: twierdzenie B´ezout’a . . . . . . . . . . . . . . . . . . . . . . . . 66 3.2.2 Druga idea: algorytm dzielenia z resztą . . . . . . . . . . . . . . . . . . . . . . 68 viii SPIS TREŚCI 3.2.3 Trzecia idea: twierdzenie Lagrange’a i o jednoznaczności . . . . . . . . . . . . . 70 3.2.4 Czwarta idea: pierwiastki wymierne . . . . . . . . . . . . . . . . . . . . . . . . 72 3.2.5 Piąta idea: postać kanoniczna trójmianu kwadratowego . . . . . . . . . . . . . 73 3.2.6 Szósta idea: Wielomian jako funkcja rzeczywista . . . . . . . . . . . . . . . . . 75 3.2.7 Siódma idea: wzory Vi`ete’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77 3.3 Jednoznaczność rozkładu w pierścieniu wielomianów . . . . . . . . . . . . . . . . . . . 81 3.3.1 Podzielność w pierścieniu wielomianów . . . . . . . . . . . . . . . . . . . . . . . 82 3.3.2 Ideał. Największy wspólny dzielnik . . . . . . . . . . . . . . . . . . . . . . . . . 83 3.3.3 Zasadnicze twierdzenie arytmetyki wielomianów . . . . . . . . . . . . . . . . . 84 3.3.4 Wielomiany nierozkładalne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85 3.3.5 Jednoznaczność rozkładu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85 3.4 Dalsze twierdzenia o wielomianach . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86 3.4.1 Zawartość wielomianu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86 3.4.2 Wielomiany nierozkładalne w Q[X] . . . . . . . . . . . . . . . . . . . . . . . . 89 3.4.3 Zasadnicze Twierdzenie Algebry . . . . . . . . . . . . . . . . . . . . . . . . . . 92 3.4.4 Rozkłady w pierścieniu C[X] i R[X] . . . . . . . . . . . . . . . . . . . . . . . . 94 3.4.5 Pierwiastki wielomianu X n − 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . 95 3.4.6 Wielomiany cyklotomiczne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97 3.4.7 Rozwiązywanie równań stopnia 3 i 4 . . . . . . . . . . . . . . . . . . . . . . . 98 3.4.8 Wzory Vi`ete’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101 3.4.9 Wielomiany palindromiczne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104 3.4.10 Wielomian interpolacyjny Lagrange’a . . . . . . . . . . . . . . . . . . . . . . . 105 3.4.11 Funkcje wymierne. Ułamki proste . . . . . . . . . . . . . . . . . . . . . . . . . 106 3.4.12 Funkcje wymierne jako funkcje . . . . . . . . . . . . . . . . . . . . . . . . . . . 108 3.5 Wielomiany wielu zmiennych . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108 3.5.1 Deﬁnicje . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108 3.5.2 Tożsamość Sophie Germain . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110 3.5.3 Jeszcze dwie faktoryzacje . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111 3.6 Zadania dodatkowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112 3.6.1 Treści zadań . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112 3.6.2 Wskazówki/rozwiązania . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118 4 Funkcje arytmetyczne 143 4.1 Sumy potęg dzielników . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143 4.1.1 Funkcja τ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144 4.1.2 Funkcja σ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145 4.2 Funkcja ϕ Eulera . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146 4.3 Splot Dirichlet’a i odwracanie M¨obiusa . . . . . . . . . . . . . . . . . . . . . . . . . . . 147 4.3.1 Splot Dirichlet’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147 4.3.2 Twierdzenie M¨obiusa o odwracaniu . . . . . . . . . . . . . . . . . . . . . . . . . 148 4.4 Piętnaście zadań dodatkowych . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150 4.4.1 Treści zadań . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150 4.4.2 Rozwiązania wybranych ćwiczeń i zadań dodatkowych . . . . . . . . . . . . . . 151 5 Arytmetyka modularna 157 5.1 Wstęp do teorii kongruencji . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157 5.1.1 Deﬁnicja i cechy podzielności . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157 5.1.2 Motywacja: równania diofantyczne . . . . . . . . . . . . . . . . . . . . . . . . . 160 5.1.3 Twierdzenie Schura . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161 SPIS TREŚCI ix 5.1.4 Kongruencje liniowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 162 5.1.5 Odwracanie modulo m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163 5.2 Twierdzenie Eulera, Fermat’a i Wilsona . . . . . . . . . . . . . . . . . . . . . . . . . . 164 5.2.1 Zupełne i zredukowane układy reszt . . . . . . . . . . . . . . . . . . . . . . . . 164 5.2.2 Twierdzenie Eulera . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 165 5.2.3 Małe twierdzenie Fermat’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166 5.2.4 Twierdzenie Wilsona . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167 5.3 Układy kongruencji liniowych . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 168 5.3.1 Twierdzenie chińskie o resztach . . . . . . . . . . . . . . . . . . . . . . . . . . . 169 5.3.2 Zadanie o długiej igle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171 5.3.3 Uogólnione twierdzenie chińskie o resztach . . . . . . . . . . . . . . . . . . . . . 172 5.4 Pierścień klas reszt modulo m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175 5.4.1 Działania na warstwach modulo m . . . . . . . . . . . . . . . . . . . . . . . . . 176 5.4.2 Grupa (Z/m)∗ warstw odwracalnych . . . . . . . . . . . . . . . . . . . . . . . 177 5.4.3 Ciało Z/p . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178 5.4.4 Pierwiastki kongruencji wielomianowych . . . . . . . . . . . . . . . . . . . . . . 178 5.4.5 Kongruencje wielomianowe modulo p . . . . . . . . . . . . . . . . . . . . . . . 181 5.4.6 Ważne zastosowanie twierdzenia chińskiego . . . . . . . . . . . . . . . . . . . . 181 5.5 Rząd elementu grupy w teorii liczb . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 183 5.5.1 Podgrupy i twierdzenie Lagrange’a . . . . . . . . . . . . . . . . . . . . . . . . . 183 5.5.2 Podstawowe własności rzędu elementu . . . . . . . . . . . . . . . . . . . . . . . 184 5.5.3 Rząd elementu w grupie (Z/m, +) . . . . . . . . . . . . . . . . . . . . . . . . . 186 5.5.4 Rząd elementu w grupie ((Z/m)∗, ·) . . . . . . . . . . . . . . . . . . . . . . . . 186 5.5.5 O liczbach pierwszych w ciągach arytmetycznych . . . . . . . . . . . . . . . . . 189 5.5.6 Twierdzenie Zsigmondy’ego . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191 5.6 Pierwiastki pierwotne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195 5.6.1 Deﬁnicja i uwagi wstępne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195 5.6.2 Twierdzenie o istnieniu pierwiastków pierwotnych . . . . . . . . . . . . . . . . . 197 5.6.3 Jeszcze kilka przykładów . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 199 5.6.4 Indeks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 201 5.6.5 Dwa słowa o liczbach Carmichaela . . . . . . . . . . . . . . . . . . . . . . . . . 202 5.7 Reszty kwadratowe i prawo wzajemności . . . . . . . . . . . . . . . . . . . . . . . . . . 203 5.7.1 Reszty i niereszty kwadratowe modulo p . . . . . . . . . . . . . . . . . . . . . . 203 5.7.2 Symbol Legendre’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 204 5.7.3 Kryterium Eulera . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 204 5.7.4 Kryterium Gaussa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 206 5.7.5 Prawo wzajemności reszt kwadratowych . . . . . . . . . . . . . . . . . . . . . . 208 5.7.6 Prawo wzajemności a ciągi arytmetyczne . . . . . . . . . . . . . . . . . . . . . 211 5.7.7 Trójmian kwadratowy modulo p . . . . . . . . . . . . . . . . . . . . . . . . . . 213 5.7.8 Kilka zadań . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 214 5.7.9 Liczba lokalnie kwadratowa jest kwadratem (globalnym) . . . . . . . . . . . . . 217 5.8 Kongruencje modulo pn. Liczby p-adyczne . . . . . . . . . . . . . . . . . . . . . . . . 218 5.8.1 Reszty kwadratowe modulo pn . . . . . . . . . . . . . . . . . . . . . . . . . . . 219 5.8.2 Lemat Hensela . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 220 5.8.3 Jedno interesujące zadanie . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221 5.8.4 Dwa słowa o liczbach p-adycznych . . . . . . . . . . . . . . . . . . . . . . . . . 222 x SPIS TREŚCI 6 Dodatkowe wiadomości o wielomianach 224 6.1 Pochodna wielomianu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 224 6.1.1 Funkcja wielomianowa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 224 6.1.2 Deﬁnicja pochodnej . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225 6.1.3 Twierdzenia Rolle’a i Lagrange’a . . . . . . . . . . . . . . . . . . . . . . . . . . 225 6.1.4 Wzór Maclaurina i wzór Taylora . . . . . . . . . . . . . . . . . . . . . . . . . . 226 6.1.5 Pochodna a pierwiastki wielokrotne . . . . . . . . . . . . . . . . . . . . . . . . 227 6.2 Wielomiany symetryczne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 227 6.2.1 Deﬁnicja . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 228 6.2.2 Twierdzenie Newtona . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 229 6.2.3 Wyróżnik . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 230 6.2.4 Funkcje tworzące . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 230 6.3 Liczby algebraiczne i przestępne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 232 6.3.1 Wielomian minimalny liczby algebraicznej . . . . . . . . . . . . . . . . . . . . . 232 6.3.2 Uwalnianie się od niewymierności w mianowniku . . . . . . . . . . . . . . . . . 233 6.3.3 Pierścień liczb algebraicznych całkowitych . . . . . . . . . . . . . . . . . . . . . 234 6.3.4 Nierozkładalność wielomianów cyklotomicznych . . . . . . . . . . . . . . . . . . 236 6.3.5 Liczby przestępne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 238 6.3.6 Twierdzenie Liouville’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 238 6.4 O zerach wielomianów wielu zmiennych . . . . . . . . . . . . . . . . . . . . . . . . . . 240 6.4.1 Combinatorial Nullstellensatz . . . . . . . . . . . . . . . . . . . . . . . . . . . . 241 6.4.2 Kilka zastosowań . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 244 6.4.3 Twierdzenia Chevalley’a i Warninga . . . . . . . . . . . . . . . . . . . . . . . . 245 6.5 Wielomiany i liczby Bernoulli’ego . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 248 6.5.1 Sumowanie potęg . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 248 6.5.2 Wielomiany i liczby Bernoulli’ego . . . . . . . . . . . . . . . . . . . . . . . . . . 248 7 Aproksymacje diofantyczne 250 7.1 Twierdzenie Dirichlet’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 250 7.2 Ciągi Farey’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 251 7.3 Ułamki łańcuchowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 253 7.3.1 Kanoniczne rozwinięcia. Reguła Eulera . . . . . . . . . . . . . . . . . . . . . . 253 7.3.2 Nieskończone ułamki łańcuchowe . . . . . . . . . . . . . . . . . . . . . . . . . . 256 7.3.3 Złota liczba. Twierdzenie Hurwitza . . . . . . . . . . . . . . . . . . . . . . . . . 259 7.3.4 Grupa GL2(Z) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 261 7.3.5 Równoważność liczb . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 262 7.3.6 Niewymierności kwadratowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 263 7.3.7 Okresowe ułamki łańcuchowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . 265 7.3.8 Twierdzenia Lagrange’a i Galois’a . . . . . . . . . . . . . . . . . . . . . . . . . 267 8 Sumy kwadratów 270 8.1 Jedna ważna tożsamość . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 270 8.2 Sumy dwóch kwadratów . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 272 8.2.1 Twierdzenie Fermat’a-Eulera . . . . . . . . . . . . . . . . . . . . . . . . . . . . 272 8.2.2 Drugi dowód twierdzenia Fermat’a-Eulera . . . . . . . . . . . . . . . . . . . . . 274 8.2.3 Twierdzenie o przedstawieniu . . . . . . . . . . . . . . . . . . . . . . . . . . . . 275 8.2.4 Funkcja r(n) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 276 8.3 Nieco geometrii w teorii liczb . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 277 8.3.1 Kraty w płaszczyźnie . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 277 SPIS TREŚCI xi 8.3.2 Dyskretne podgrupy płaszczyzny . . . . . . . . . . . . . . . . . . . . . . . . . . 278 8.3.3 Twierdzenie Minkowskiego o ﬁgurze wypukłej . . . . . . . . . . . . . . . . . . . 280 8.3.4 Dwa zastosowania . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 281 8.3.5 Liczby naturalne postaci x2 + 2y2 i x2 + 3y2 . . . . . . . . . . . . . . . . . . . 283 8.3.6 Liczby pierwsze postaci x2 + 5y2 . . . . . . . . . . . . . . . . . . . . . . . . . . 285 8.4 Binarne formy kwadratowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 287 8.4.1 Wyróżnik formy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 288 8.4.2 Równoważność form . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 288 8.4.3 Lemat Lagrange’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 290 8.4.4 Redukcja form dodatnio-określonych . . . . . . . . . . . . . . . . . . . . . . . . 291 8.5 Sumy więcej niż dwóch kwadratów . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 293 8.5.1 Twierdzenie o sumach czterech kwadratów . . . . . . . . . . . . . . . . . . . . . 294 8.5.2 Uwagi o sumach trzech kwadratów . . . . . . . . . . . . . . . . . . . . . . . . . 296 8.6 Dodatek. Piąty dowód TFE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 297 9 Arytmetyka ciągów rekurencyjnych 301 9.1 Klasyczny ciąg Fibonacci’ego . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 301 9.1.1 Wzór Binet’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 302 9.1.2 Kilka tożsamości . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 302 9.1.3 Dwie interpretacje ciągu (fn) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 304 9.1.4 Ciąg (fn) jest NWD -ciągiem . . . . . . . . . . . . . . . . . . . . . . . . . . . . 304 9.2 Metoda Eulera i metoda funkcji tworzących . . . . . . . . . . . . . . . . . . . . . . . . 305 9.2.1 Metoda Eulera . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 305 9.2.2 Pierścień formalnych szeregów potęgowych . . . . . . . . . . . . . . . . . . . . 308 9.2.3 Metoda funkcji tworzących . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 309 9.3 Ciągi Lucas’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 309 9.3.1 Przestrzeń Rek(P, Q) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 310 9.3.2 Deﬁnicja ciągów Lucas’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 310 9.3.3 Kilka tożsamości . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 311 9.3.4 Podzielność wyrazów ciągów Lucas’a . . . . . . . . . . . . . . . . . . . . . . . . 312 9.4 Ilustracja geometryczna . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 313 9.4.1 Macierze odwzorowań liniowych . . . . . . . . . . . . . . . . . . . . . . . . . . . 313 9.4.2 Wyznacznik odwzorowania liniowego . . . . . . . . . . . . . . . . . . . . . . . . 315 9.4.3 Pola trójkątów . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 315 9.4.4 Ogólny wzór Cassini’ego . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 316 9.5 Ciągi rekurencyjne modulo p . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 317 9.5.1 Warstwy ”zespolone” modulo p . . . . . . . . . . . . . . . . . . . . . . . . . . . 317 9.5.2 Fp(ι) jest ciałem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 319 9.5.3 Dwa słowa o grupie multyplikatywnej Fp(ι)∗ . . . . . . . . . . . . . . . . . . . 320 9.5.4 Wzory Eulera-Binet’a modulo p . . . . . . . . . . . . . . . . . . . . . . . . . . 321 9.5.5 Okresowość ciągów rekurencyjnych modulo p . . . . . . . . . . . . . . . . . . . 322 10 Pierścienie kwadratowe 325 10.1 Pierścień liczb całkowitych Gaussa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 326 10.1.1 Deﬁnicja i podstawowe własności . . . . . . . . . . . . . . . . . . . . . . . . . . 326 10.1.2 Dzielenie z resztą i podzielność w Z[ i ] . . . . . . . . . . . . . . . . . . . . . . . 327 10.1.3 Algorytm Euklidesa w Z[ i ] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 330 10.1.4 Liczby pierwsze w Z[ i ] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 330 10.1.5 Twierdzenie o jednoznaczności rozkładu w Z[ i ] . . . . . . . . . . . . . . . . . . 332 xii SPIS TREŚCI 10.1.6 Rozkład liczb pierwszych wymiernych w Z[ i ] . . . . . . . . . . . . . . . . . . . 335 10.2 Pierścienie kwadratowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 336 10.2.1 Jedności w Z[τD] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 337 10.2.2 Dzielenie z resztą w Z[τD] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 337 10.2.3 Podzielność, NWD i ideały w Z[τD] . . . . . . . . . . . . . . . . . . . . . . . . 340 10.2.4 Dig’owość pierścieni kwadratowych . . . . . . . . . . . . . . . . . . . . . . . . . 342 10.2.5 Wnioski z dig’owości . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 342 10.2.6 Związek z formami kwadratowymi . . . . . . . . . . . . . . . . . . . . . . . . . 344 10.2.7 Jednoznaczność rozkładu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 347 10.2.8 Pierścienie Z[τ−2], Z[τ−3] i Z[τ−5] . . . . . . . . . . . . . . . . . . . . . . . . . 349 10.3 Teoria podzielności w dig’ach . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 354 10.3.1 Dziedziny całkowitości . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 354 10.3.2 Relacja podzielności. Relacja stowarzyszenia . . . . . . . . . . . . . . . . . . . 355 10.3.3 Ideał. Dziedzina ideałów głównych . . . . . . . . . . . . . . . . . . . . . . . . . 356 10.3.4 Największy wspólny dzielnik . . . . . . . . . . . . . . . . . . . . . . . . . . . . 357 10.3.5 Elementy nierozkładalne i pierwsze w R . . . . . . . . . . . . . . . . . . . . . . 357 10.3.6 Jednoznaczność rozkładu w dig’ach . . . . . . . . . . . . . . . . . . . . . . . . 358 10.4 Jedności rzeczywiste . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 360 10.4.1 Lemat o równaniu x2 − Dy2 = 1 . . . . . . . . . . . . . . . . . . . . . . . . . . 360 10.4.2 Jedności fundamentalne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 361 10.4.3 Pierścienie typu (−1) i (+1) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 364 11 Równania diofantyczne 365 11.1 Metody podstawowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 365 11.1.1 Wykorzystanie nierówności . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 365 11.1.2 Metoda zstępowania . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 366 11.1.3 Wykorzystanie kongruencji . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 367 11.1.4 Wykorzystanie jednoznaczności rozkładu . . . . . . . . . . . . . . . . . . . . . . 369 11.2 Wielkie Twierdzenie Fermat’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 371 11.2.1 Twierdzenia Fermat’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 372 11.2.2 Twierdzenie Sophie Germain . . . . . . . . . . . . . . . . . . . . . . . . . . . . 374 11.2.3 Metoda Eulera dowodu WTF(3) . . . . . . . . . . . . . . . . . . . . . . . . . . 375 11.2.4 Równanie x3 + y3 + z3 = w3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 377 11.3 Równanie Ramanujana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 378 11.4 Równanie indyjskie . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 383 11.4.1 Twierdzenie podstawowe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 383 11.4.2 Interpretacje . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 386 11.4.3 Równanie anty-indyjskie . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 388 11.4.4 Ogólne równanie indyjskie . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 389 11.4.5 Kilka zadań . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 390 11.5 Punkty wymierne na prostych i na stożkowych . . . . . . . . . . . . . . . . . . . . . . 391 11.6 Krzywe sześcienne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 398 11.6.1 Postać normalna. Przykłady . . . . . . . . . . . . . . . . . . . . . . . . . . . . 398 11.6.2 Krzywe eliptyczne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 402 11.6.3 Metoda siecznych-stycznych . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 403 11.6.4 Równania y2 = x3 + 1 i y2 = x3 − 1 . . . . . . . . . . . . . . . . . . . . . . . . 406 11.6.5 Dodawanie punktów krzywej eliptycznej . . . . . . . . . . . . . . . . . . . . . . 409 SPIS TREŚCI xiii 12 Kilka wiadomości dodatkowych 412 12.1 Część całkowita i ułamkowa liczby rzeczywistej . . . . . . . . . . . . . . . . . . . . . . 412 12.1.1 Podstawowe własności . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 412 12.1.2 Twierdzenie Beatty’ego . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414 12.1.3 Zadania z częścią ułamkową . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 415 12.2 Zapis pozycyjny liczb . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 417 12.2.1 Zapis pozycyjny liczb naturalnych . . . . . . . . . . . . . . . . . . . . . . . . . 417 12.2.2 Zapis pozycyjny liczb rzeczywistych . . . . . . . . . . . . . . . . . . . . . . . . 419 12.3 Ułamki egipskie . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421 12.3.1 Skończone sumy ułamków egipskich . . . . . . . . . . . . . . . . . . . . . . . . 421 12.3.2 Szeregi harmoniczne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 425 12.3.3 Liczby harmoniczne. Twierdzenie Wolstenholme’a . . . . . . . . . . . . . . . . 429 12.4 Współczynniki dwumienne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 431 12.4.1 Wielomiany Newtona . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 432 12.4.2 Twierdzenie Lucas’a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 432 12.4.3 Twierdzenie Wolstenholme’a-Glaishera . . . . . . . . . . . . . . . . . . . . . . . 434 12.5 Rozmieszczenie liczb pierwszych . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 436 12.5.1 Dwa twierdzenia Czebyszewa . . . . . . . . . . . . . . . . . . . . . . . . . . . . 436 12.5.2 Twierdzenie o liczbach pierwszych . . . . . . . . . . . . . . . . . . . . . . . . . 440 Literatura 441 Indeks 442 Rozdział 1 Pojęcia podstawowe Ich bin der Meinung [...] daß man zu einer strengen und v¨ollig befriedigenden Begr¨undung des Zahlbegriﬀs kommen kann, und zwar durch eine Methode, die ich die axiomatische nennen will. (David Hilbert) W rozdziale tym przypominamy podstawowe fakty dotyczące liczb naturalnych oraz po- znajemy deﬁnicje najważniejszych struktur algebraicznych takich jak grupa, pierścień i ciało. W końcu rozdziału poznajemy nowy rodzaj liczb: liczby zespolone. 1.1 Liczby naturalne Zakładamy, że Czytelnik jest dobrze zaznajomiony z pojęciem liczby całkowitej. Zbiór wszystkich liczb całkowitych {. . . , −3, −2, −1, 0, 1, 2, 3, . . . } oznaczamy przez Z. D o d a t n i e elementy tego zbioru nazywamy liczbami naturalnymi. Zbiór liczb naturalnych oznaczamy symbolem N. W niektórych podręcznikach zero uważa się za liczbę naturalną. Nam będzie wygodniej ”zaczynać” liczby naturalne od 1. 1.1.1 Kilka zasad podstawowych Najważniejszym faktem dotyczącym liczb naturalnych jest Zasada Minimum. Jest ona w istocie aksjomatem (czyli twierdzeniem przyjmowanym bez dowodu). ZASADA MINIMUM Każdy niepusty podzbiór zbioru liczb naturalnych zawiera (do- kładnie jedną) liczbę najmniejszą. Standardowe zastosowania Zasady Minimum w rozumowaniach teorioliczbowych zobaczymy w dowodach twierdzeń T2.14 i T2.16. Teraz pokażemy na prostym przykładzie, jak to działa. Wybieramy w tym celu d o w ó d n i e w y m i e r n o ś c i √n, gdzie n ∈ N n i e jest kwadratem: 2 1. Pojęcia podstawowe ZADANIE 1.1 Udowodnić, że jeżeli liczba naturalna n nie jest kwadratem żadnej liczby całkowitej, to nie jest też kwadratem żadnej liczby wymiernej. R o z w i ą z a n i e. Załóżmy, nie wprost, że i s t n i e j ą takie ułamki a b , że a, b ∈ N i że zachodzi równość √n = a b , czyli równość nb 2 = a2. Rozważmy więc (niepusty!) zbiór mianow- ników wszystkich takich ułamków a b . Niech b0 będzie n a j m n i e j s z ą liczbą w tym zbiorze. Wówczas nab0 ab0 = n = ka 2 kb 2 0 dla pewnego a ∈ N i d o w o l n e j liczby k ∈ N. Stąd n = nab0 − ka 2 ab0 − kb 2 0 = a b0 · nb0 − ka a − kb0 = √n · nb0 − ka a − kb0 (1.1) na mocy zasady odejmowania proporcji stronami i założenia √n = a/b0. Podnosząc równość (1.1) obustronnie do kwadratu i upraszczając przez n, dostajemy n = ( nb0 − ka a − kb0 )2 . Połóżmy w tej równości k wyznaczone (jednoznacznie) z nierówności k2 < n < (k + 1)2. Wówczas kb0 < a < kb0 + b0, skąd 0 < a − kb0 < b0 i widzimy, że dodatni mianownik a − kb0 ułamka nb0−ka a−kb0 jest m n i e j s z y niż b0. S p r z e c z n o ś ć. ♦ P r z y k ł a d. Dowodzimy: Liczba 1 jest n a j m n i e j s z ą liczbą naturalną. Rzeczywiście, jeżeli istnieją liczby naturalne mniejsze niż 1, to niech (Zasada Minimum!) n0 będzie naj- mniejszą liczbą naturalną mniejszą niż 1. Wówczas n2 0 < n0 < 1. Sprzeczność. Q.e.d. ♦ Czytelnik zechce z pewnością udowodnić prawdziwość kolejnej zasady: ZASADA SKWANTOWANIA Jeżeli liczby całkowite a, b spełniają warunek a > b, to a ⩾ b + 1. W szczególności: jeżeli c ∈ Z i c > 0, to c ⩾ 1. Przykładowe zastosowanie Zasady Skwantowania widzimy w rozwiązaniu takiego zadania: ZADANIE 1.2 Udowodnić, że jeżeli dla liczb naturalnych a, b, c, d, k, l zachodzi rów- ność bc − ad = 1 i nierówności a b < k l < c d , to k ⩾ a + c i l ⩾ b + d. R o z w i ą z a n i e. Nierówność a b < k l daje 0 < bk − al. Stąd, ponieważ mamy do czynienia z liczbą całkowitą, dostajemy 1 ⩽ bk − al. Mnożąc tę nierówność przez c znajdujemy c ⩽ c(bk − al) = bck − acl = (1 + ad)k − acl, skąd a(cl − dk) + c ⩽ k, czyli a + c ⩽ k (bo cl − dk > 0, więc cl − dk ⩾ 1). Podobnie, mnożąc nierówność cl − dk ⩾ 1 przez b, dostaniemy nierówność b + d ⩽ l. ♦ Często stosujemy również Zasadę Maksimum: ZASADA MAKSIMUM Każdy niepusty i ograniczony (od góry) zbiór liczb natural- nych zawiera dokładnie jeden element największy. 1.1. Liczby naturalne 3 ZADANIE 1.3 Udowodnić Zasadę Maksimum korzystając z Zasady Minimum. R o z w i ą z a n i e. Niech X będzie niepustym i ograniczonym podzbiorem zbioru liczb na- turalnych. To znaczy, że istnieje takie a ∈ N, że dla każdego x ∈ X mamy x ⩽ a. Niech Y = {y ∈ N : ∀x∈X y ⩾ x} będzie zbiorem wszystkich ograniczeń górnych zbioru X. Zbiór Y jest niepusty, bo a ∈ Y . Zawiera zatem element najmniejszy. Oznaczmy go m. Wówczas m ⩾ x dla każdego x ∈ X, bo m ∈ Y . Twierdzimy, że m należy do X i jest, wobec tego, najwięk- szym elementem zbioru X. Gdyby m /∈ X, to wszystkie nierówności m ⩾ x byłyby ostre i wtedy (na mocy Zasady Skwantowania) mielibyśmy m − 1 ⩾ x dla każdego x ∈ X. To jednakże jest niemożliwe, bo m jest najmniejszym elementem zbioru Y . ♦ Ćwiczenie 1.1 Udowodnić Zasadę Minimum korzystając z Zasady Maksimum. 1.1.2 Zasada Indukcji Matematycznej Zasada Indukcji Matematycznej jest (logicznie) równoważna Zasadzie Minimum, ale często bywa wygodniejsza w stosowaniu. ZASADA INDUKCJI MATEMATYCZNEJ Niech X ⊆ N będzie podzbiorem zbioru liczb naturalnych. Załóżmy, że spełnione są warunki: (B) 1 ∈ X , (I) k ∈ X ⇒ k + 1 ∈ X . Wówczas X = N. Podzbiór X zbioru liczb naturalnych nazwiemy podzbiorem induktywnym, gdy spełnia warunek (I). Zasada Indukcji Matematycznej mówi po prostu, że zawierający liczbę 1 podzbiór induktywny zbioru liczb naturalnych jest c a ł y m zbiorem liczb naturalnych N. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 krok indukcyjny Rys 1.1 X X65 P r z y k ł a d. Udowodnimy, że suma wszystkich liczb naturalnych niewiększych niż n wy- nosi n(n+1) 2 . Oznaczmy tę sumę przez Sn. Mamy udowodnić, że zbiór X = {k ∈ N : Sk = k(k + 1) 2 } jest całym zbiorem liczb naturalnych. W pierwszym kroku sprawdzamy, czy zbiór X speł- nia warunek (B) (zwany warunkiem bazowym). Tę część rozumowania nazywamy bazą 4 1. Pojęcia podstawowe rozumowania indukcyjnego. W aktualnym przypadku warunek bazowy jest spełniony (bowiem 1 = 1·2 2 ). Sprawdzenie zachodzenia warunku (I), czyli induktywności zbioru X, nazywa się krokiem indukcyjnym rozumowania indukcyjnego. Załóżmy więc, że liczba naturalna k należy do X. Wówczas, w aktualnym przypadku, Sk+1 = Sk + (k + 1) = k(k + 1) 2 + (k + 1) = (k + 1)(k + 2) 2 , więc k + 1 ∈ X. Dzięki ZIM (Zasadzie Indukcji Matematycznej) widzimy, że X = N. ♦ Podobnie dowodzimy tez poniższego ćwiczenia: Ćwiczenie 1.2 Udowodnić, że dla każdej liczby naturalnej n > 1: 1. 1 2 + 22 + 32 + . . . + n2 = n(n + 1)(2n + 1) 6 , 2. 1 2 + 32 + 52 + . . . + (2n − 1) 2 = n(4n2 − 1) 3 , 3. 1 · 3 · 5 · . . . · (2n − 1) 2 · 4 · 6 · . . . · 2n < 1 √3n + 1 , 4. √ 2 + √ 2 + . . . + √2 = 2 cos π 2n+1 (n pierwiastków), 5. 1 1 + x + 2 1 + x2 + 4 1 + x4 + . . . + 2 n 1 + x2n = 2 n+1 1 − x2n+1 − 1 1 − x dla |x| ̸= 1. Ćwiczenie 1.3 Udowodnić poniższe wersje ZIM: (1) Jeżeli podzbiór X ⊆ N spełnia warunki (B) 1 ∈ X , (IU) {1, . . . , k} ⊆ X ⇒ k + 1 ∈ X , to X jest c a ł y m zbiorem liczb naturalnych. (2) Jeżeli podzbiór X ⊆ N spełnia warunki (B1-2) 1, 2 ∈ X , (I2) k ∈ X ⇒ k + 2 ∈ X , to X jest c a ł y m zbiorem liczb naturalnych. ZADANIE 1.4 Udowodnić, że zbiór G = {0, 1, . . . , 1023} da się rozbić na sumę takich dwóch r o z ł ą c z n y c h r ó w n o l i c z n y c h podzbiorów A, B, że dla każdego k = 1, 2, . . . , 9 suma k-tych potęg liczb zbioru A równa jest sumie k-tych potęg liczb zbioru B. R o z w i ą z a n i e. Po pierwsze dobrze jest się domyślić, że jest to zadanie dające się rozwią- zać za pomocą indukcji. Mianowicie oznaczymy przez X zbiór takich liczb naturalnych n, dla których zbiór G(n) = {0, 1, . . . , 2 n+1 − 1} można przedstawić w postaci sumy takich dwóch równolicznych podzbiorów A(n) i B(n), że dla każdego k = 1, 2, . . . , n suma k-tych potęg 1.1. Liczby naturalne 5 liczb zbioru A(n) równa jest sumie k-tych potęg liczb zbioru B(n). Nasze zadanie polega na udowodnieniu, że 9 ∈ X. Wykażemy przez indukcję nierównie więcej: X = N. Korzystając z Zasady Indukcji zdeﬁniujemy zbiory A(n) i B(n) dla każdego n ∈ N. Niech A(1) = {0, 3} i B(1) = {1, 2} (to jest baza deﬁnicji indukcyjnej). Następnie deﬁniujemy A(n + 1) = A(n) ∪ [B(n) + 2n+1], B(n + 1) = B(n) ∪ [A(n) + 2n+1]. (1.2) [Używamy tu wygodnego skrótu X + a = {x + a : x ∈ X } dla dowolnego podzbioru X ⊆ N i dowolnej liczby a ∈ N.] To jest krok indukcyjny deﬁnicji indukcyjnej (= określenie obiektu ”następnego” za pomocą ”poprzedniego” lub ”poprzednich”). Mamy więc na przykład: A(2) = A(1) ∪ [B(1) + 4] = {0, 3} ∪ [{1, 2} + 4] = {0, 3} ∪ {5, 6} = {0, 3, 5, 6}, B(2) = B(1) ∪ [A(1) + 4] = {1, 2} ∪ [{0, 3} + 4] = {1, 2} ∪ {4, 7} = {1, 2, 4, 7}. Łatwo, przez indukcję(!), sprawdzić, że zbiory A(n), B(n) są r o z ł ą c z n e i r ó w n o l i c z n e. Czytelnik powinien bezwzględnie to zrobić. Pozostało nam sprawdzenie, że ∑ x∈A(n) xk = ∑ x∈B(n) xk dla wszystkich n ∈ N i wszyst- kich 1 ⩽ k ⩽ n. Robimy to, oczywiście, za pomocą indukcji matematycznej, której baza jest po prostu równością 0 + 3 = 1 + 2. Dla wykonania kroku indukcyjnego ustalmy liczby naturalne k ⩽ n + 1. Mamy wtedy ∑ x∈A(n+1) xk = ∑ x∈A(n) xk + ∑ x∈B(n) (x + 2n+1) k = ∑ x∈A(n) xk + ∑ x∈B(n) k∑ s=0 ( k s ) xk−s2 (n+1)s = ∑ x∈A(n) xk + k∑ s=0 (k s )2 (n+1)s ∑ x∈B(n) xk−s = ∑ x∈G(n) xk + k∑ s=1 ( k s ) 2 (n+1)s ∑ x∈B(n) xk−s. Pierwsza równość wynika z (1.2), druga z twierdzenia o dwumianie (por. (1.7)), trzecia z przemienności sumy, a czwarta z równości G(n) = A(n) ⊔ B(n) (suma rozłączna, zob. KOM ). Dokładnie tak samo dostaniemy ∑ x∈B(n+1) xk = ∑ x∈G(n) xk + k∑ s=1 ( k s ) 2 (n+1)s ∑ x∈A(n) xk−s. Założenie indukcyjne, czyli równości ∑ x∈A(n) xk−s = ∑ x∈B(n) xk−s dla wszystkich s = 1, . . . , k (przy czym w przypadku s = k równość ta oznacza, po prostu równość mocy |A(n)| = |B(n)|) daje więc równość ∑ x∈A(n+1) xk = ∑ x∈B(n+1) xk. W ten sposób zadanie jest rozwiązane. ♦ Rozwiązując poniższe zadanie również należy postawić tezę ogólną (dla dowolnego n) a następnie udowodnić ją za pomocą ZIM. ZADANIE HALMOSA. W pewnym miasteczku mieszka 345 zamężnych matematyczek. Każda z nich wie w każdej chwili czy mąż innej jest wierny czy nie, nic nie wie jednak o swoim mężu. Prawo tego miasteczka wymaga aby każdy, kto jest w stanie p r z e p r o w a d z i ć d o w ó d niewierności swojego partnera, zastrzelił go na specjalnym miejscu straceń tego samego dnia o zachodzie słońca. Każda matematyczka jest absolutnie inteligentna i absolutnie prawomyślna. 6 1. Pojęcia podstawowe Pewnego dnia pani burmistrz (jedyna niezamężna w miasteczku) ogłosiła, że w miasteczku s ą niewierni mężowie. Zakazała porozumiewania się paniom matematyczkom w rzeczonej sprawie, jednocześnie nakazując przeprowadzanie rozumowań dowodowych. W rzeczywistości w mia- steczku było 40 niewiernych mężów. Co się stanie w miasteczku po ogłoszeniu pani burmistrz? Czasami niezbędne jest stosowne wzmocnienie tezy, która staje się założeniem w kroku indukcyjnym: Ćwiczenie 1.4 Udowodnić za pomocą indukcji, że dla dowolnej liczby naturalnej n za- chodzi nierówność hn(2) := 1 + 1 22 + 1 32 + . . . + 1 n2 < 2. Wskazówka. Łatwiej dowodzić nierówności mocniejszej: hn(2) ⩽ 2 − 1 n . ZADANIE 1.5 Udowodnić, że Zasada Minimum jest równoważna Zasadzie Indukcji. R o z w i ą z a n i e. (1) Dowodzimy najpierw, że z ZIM wynika ZM. Postępujemy nie wprost. To znaczy, załóżmy, że zbiór Y ⊆ N jest podzbiorem n i e p u s t y m bez elementu najmniej- szego. Zdeﬁniujmy podzbiór X ⊆ N: X = {n ∈ N : {1, 2, . . . , n} ∩ Y = ∅}. Jasne, że 1 ∈ X (bo {1} ∩ Y = ∅, bowiem w przeciwnym przypadku liczba 1 byłaby elementem najmniejszym w Y ). Zatem X spełnia warunek bazowy ZIM. Sprawdzimy, że X jest podzbiorem induktywnym: Niech k ∈ X. Wówczas {1, . . . , k} ∩ Y = ∅, więc, gdyby {1, . . . , k, k + 1} ∩ Y ̸= ∅, to liczba k + 1 musiałaby należeć do Y i byłaby wtedy elementem najmniejszym w Y . Ponieważ założyliśmy, że w Y nie ma elementu najmniejszego, więc musi być {1, . . . , k, k + 1} ∩ Y = ∅, czyli k + 1 ∈ X. Zatem, na mocy ZIM, X = N. To oznacza, że Y = ∅. Uzyskana sprzeczność kończy rozumowanie. (2) Dowodzimy teraz, że z ZM wynika ZIM. Załóżmy, że X ⊆ N spełnia warunki (B) i (I) i że, nie wprost, X ̸= N. Wówczas Y = N ∖ X jest niepusty. Ma więc element najmniejszy n0. Wtedy n0 − 1 jest liczbą naturalną (!) należącą do X. Więc n0 = (n0 − 1) + 1 ∈ X, bo X jest induktywny. Sprzeczność. ♦ 1.2 Działania algebraiczne Podstawowym pojęciem w algebrze jest pojęcie działania (dwuargumentowego). Algebra jest działem matematyki badającym struktury algebraiczne, czyli zbiory z działaniami. Deﬁnicja 1.1 Niech A będzie dowolnym zbiorem. Funkcję f : A × A −→ A, która każdej uporządkowanej parze (α, β) elementów zbioru A przyporządkowuje element f (α, β) tego samego zbioru, nazywamy działaniem dwuargumentowym w zbiorze A. Na oznaczenie działania używamy jakiegoś specjalnego znaczka, na przykład +, ·, ×, ◦, ∗ (itp.), i zamiast +(α, β) (itp.) piszemy α + β (itp.). Element α ∗ β ∈ A nazywamy wynikiem działania ∗ na parze (α, β) ∈ A × A. 1.2. Działania algebraiczne 7 Deﬁnicja 1.2 Działanie ∗ : A × A −→ A nazywamy łącznym, gdy α ∗ (β ∗ γ) = (α ∗ β) ∗ γ (1.3) dla dowolnych α, β, γ ∈ A. Działanie ∗ nazywamy przemiennym, gdy α ∗ β = β ∗ α (1.4) dla dowolnych α, β ∈ A. P r z y k ł a d 1. Każdy zna działania dodawania i mnożenia w zbiorze Z liczb całkowi- tych. Działania te są łączne i przemienne. Również łączne i przemienne są działania dodawania i mnożenia w zbiorze Q liczb wymiernych oraz w zbiorze R liczb rzeczywistych. Działanie ▷ : Z × Z −→ Z dane wzorem a ▷ b = 2a + b nie jest ani łączne ani przemienne. Na przykład 1 ▷ 2 = 4 ̸= 5 = 2 ▷ 1. Oraz 1 ▷ (2 ▷ 3) = 2 + (2 ▷ 3) = 2 + (4 + 3) = 9, a (1 ▷ 2) ▷ 3 = (2 + 2) ▷ 3 = 8 + 3 = 11. Działania − : R × R −→ R i :: R>0 × R>0 −→ R>0 odejmowania liczb rzeczywistych i dzielenia dodatnich liczb rzeczywistych nie są ani przemienne ani łączne. Działanie △: R × R −→ R dane wzorem x △ y = x+y 2 jest przemienne ale nie jest łączne. ♦ U w a g a. Łączność działania jest w pewnym sensie bardziej podstawową jego własnością niż przemienność. Jeżeli dane działanie ∗ jest łączne, to można jednoznacznie zdeﬁniować wartość ”iloczynu” trzech czynników α ∗ β ∗ γ jako α ∗ (β ∗ γ) lub (α ∗ β) ∗ γ. Podobnie ma się rzecz z ”iloczynem” α1 ∗ α2 ∗ . . . ∗ αn, gdzie tylko porządek αi jest istotny. W szczególności, gdy wszystkie αi są równe α dostajemy n-tą ”potęgę” αn. Prawidłowo należy ją określić indukcyjnie (α1 = α i αn+1 = αn ∗ α) i zapisywać jakoś tak: α∗ n. Ćwiczenie 1.5 Niech X będzie dowolnym zbiorem niepustym i niech Bij(X) oznacza zbiór wszystkich bijekcji zbioru X na zbiór X. W zbiorze Bij(X) określamy działanie skła- dania: Jeżeli f, g ∈ Bij(X), to f ◦ g jest zdeﬁniowane przez (f ◦ g)(x) = f (g(x)) dla każdego x ∈ X. Udowodnić, że w ten sposób z d e f i n i o w a l i ś m y działanie i że jest ono ł ą c z n e, ale (gdy |X| > 2) n i e j e s t p r z e m i e n n e. Deﬁnicja 1.3 Jeżeli w pewnym zbiorze B zadane są dwa działania ∧ i ∨, to mówimy, że działanie ∨ jest rozdzielne względem działania ∧, gdy u ∨ (v ∧ w) = (u ∨ v) ∧ (u ∨ w) (1.5) dla dowolnych u, v, w ∈ B. P r z y k ł a d 2. Działanie mnożenia liczb jest rozdzielne względem działania dodawania liczb (to znaczy, że a · (b + c) = a · b + a · c dla dowolnych liczb a, b, c). Ćwiczenie 1.6 W zbiorze P(X) wszystkich podzbiorów danego zbioru X znane są dzia- łania ∩ przekroju czyli iloczynu teoriomnogościowego oraz ∪ sumy teoriomnogościo- wej. Uzasadnić, że każde z nich jest rozdzielne względem drugiego. 8 1. Pojęcia podstawowe Deﬁnicja 1.4 Element ε ∈ A nazywamy elementem neutralnym działania ∗ w zbiorze A, gdy dla dowolnego α ∈ A zachodzą równości: ε ∗ α = α ∗ ε = α. (1.6) P r z y k ł a d 3. Jasne, że liczba 0 jest elementem neutralnym dodawania liczb (naturalnych, całkowitych, wymiernych, rzeczywistych), liczba 1 jest elementem neutralnym mnożenia liczb. Zbiór pusty ∅ ∈ P(X) jest elementem neutralnym sumy teoriomnogościowej, zbiór ”pełny” X ∈ P(X) jest elementem neutralnym iloczynu teoriomnogościowego w P(X). ♦ Ćwiczenie 1.7 Udowodnić, że działanie ma c o n a j w y ż e j jeden element neutralny. 1.3 Grupa Wprowadzimy teraz bardzo ważne pojęcie grupy. Deﬁnicja 1.5 Zbiór Γ wraz z działaniem ∗ : Γ × Γ −→ Γ nazywamy grupą, gdy speł- nione są następujące prawa: (1) działanie ∗ jest łączne, tzn. α ∗ (β ∗ γ) = (α ∗ β) ∗ γ dla wszystkich α, β, γ ∈ Γ , (2) działanie ∗ ma element neutralny ε, tzn. α ∗ ε = ε ∗ α = α dla wszystkich α ∈ Γ , (3) dla każdego α ∈ Γ istnieje taki element ̃α ∈ Γ , że α ∗ ̃α = ̃α ∗ α = ε. Ćwiczenie 1.8 Jeżeli α ∈ Γ , to element ̃α, którego istnienie zapewnia punkt (3), nazywa się elementem odwrotnym do α lub odwrotnością α. Udowodnić, że dany element grupy ma dokładnie jedną odwrotność. Oznaczamy ją α−1. Ćwiczenie 1.9 Udowodnić, że odwrotność odwrotności danego elementu równa jest temu elementowi: (α−1) −1 = α. Ćwiczenie 1.10 Dowieść, że jeśli α, β są elementami grupy, to (α ∗ β)−1 = β−1 ∗ α−1. U w a g a. Gdy zadanym działaniem ∗ w grupie jest dodawanie oznaczane symbolem +, to mówimy, że ta grupa jest grupą typu addytywnego. W takim przypadku element neutralny ε nazywa się zerem i zazwyczaj oznacza symbolem 0, element odwrotny do α nazywa się elementem przeciwnym do α, i oznacza symbolem −α. Równości z aksjomatów D1.5(1), D1.5(2) i D1.5(3) w tym przypadku mają postać: (1) (α + β) + γ = α + (β + γ), (2) 0 + α = α + 0 = α, (3) α + (−α) = (−α) + α = 0. Deﬁnicja 1.6 Jeżeli (Γ, ∗) jest grupą i działanie ∗ jest przemienne, to grupę (Γ, ∗) na- zywamy grupą przemienną, czyli komutatywną lub grupą abelową. 1.4. Pierścień przemienny. Ciało 9 Ćwiczenie 1.11 Sprawdzić, że następujące zbiory ze wskazanymi działaniami są grupami abelowymi: (Z, +), (Q, +), (R, +), (Q \\ {0}, ·), (R \\ {0}, ·), ({+1, −1}, ·), (R>0, ·). P r z y k ł a d. Najważniejszy przykład grupy spotykamy w ćwiczeniu C1.5. Odwrotnością bijekcji f ∈ Bij(X) jest, oczywiście, bijekcja odwrona f −1. Elementem neutralnym zaś jest identyczność na X, oznaczana zazwyczaj IdX. Grupa (Bij(X), ◦) nazywa się grupą bijek- cji zbioru X. Grupa ta jest grupą abelową wyłącznie w przypadku, gdy |X| ⩽ 2. W przypadku gdy X jest zbiorem skończonym i zawiera n elementów, na przykład X = {1, 2, . . . , n}, zbiór Bij(X) oznaczamy symbolem Sn, jego elementy nazywamy permutacjami, a samą grupę (Sn, ◦) nazywamy n-tą grupą symetryczną. Ponieważ element σ ∈ Sn jest funkcją określoną na zbiorze [ n ] := {1, 2, . . . , n}, więc zadajemy ją wypisując w jednej linii elementy zbioru [ n ] a tuż pod nimi ich obrazy: σ = ( 1 2 3 . . . n σ(1) σ(2) σ(3) . . . σ(n) ) . Zbiór Sn ma n! (silnia) elementów. ♦ Ćwiczenie 1.12 Niech σ, τ ∈ S7 będą zadane przez σ = ( 1 2 3 4 5 6 7 3 6 7 1 2 4 5 ) , τ = (1 2 3 4 5 6 7 7 5 6 1 3 2 4 ) . Wyznaczyć następujące elementy grupy S7: σ ◦ τ, τ ◦ σ, σ4, τ −1, σ−3 := (σ−1)3. Ćwiczenie 1.13 Niech α będzie elementem grupy (Γ, ∗). Niech funkcja fα : Γ −→ Γ będzie zadana przez fα(ξ) = α ∗ ξ. Dowieść, że fα jest bijekcją zbioru Γ . Dowieść też, że fα ◦ fβ = fα∗β, oraz (fα)−1 = fα−1 dla dowolnych α, β ∈ Γ . 1.4 Pierścień przemienny. Ciało Pierścienie, jakie występują w dużych ilościach w elementarnej teorii liczb, należą do klasy pierścieni przemiennych z jedynką. Deﬁnicja 1.7 Zbiór R wraz z dwoma działaniami: + zwanym dodawaniem i · zwa- nym mnożeniem i dwoma wyróżnionymi elementami: 0 zwanym elementem zerowym lub zerem, i 1 zwanym jedynką, nazywa się pierścieniem przemiennym z jedynką, gdy (1) (R, +) jest grupą abelową z elementem neutralnym 0, (2) mnożenie · jest rozdzielne względem dodawania +, (3) mnożenie · jest łączne i przemienne, (4) jedynka 1 jest elementem neutralnym mnożenia. 10 1. Pojęcia podstawowe P r z y k ł a d 1. Znane nam przykłady pierścieni (przemiennych z jedynką): • pierścień liczb całkowitych (Z, +, ·, 0, 1), • pierścień liczb wymiernych (Q, +, ·, 0, 1), • pierścień liczb rzeczywistych (R, +, ·, 0, 1). ♦ ZADANIE 1.6 Udowodnić, że w każdym pierścieniu zachodzą równości (1) α · 0 = 0, (2) (−α) · (−β) = α · β. R o z w i ą z a n i e. (1) Mamy α · 0 + α · 0 = α · (0 + 0) = α · 0. Pierwsza z tych równości wynika z rozdzielności mnożenia względem dodawania, druga z faktu, że 0 jest elementem neutralnym dodawania. Dodajmy teraz −(α · 0) do lewej strony tej równości: −(α · 0) + [α · 0 + α · 0] = [−(α · 0) + α · 0] + α · 0 = 0 + α · 0 = α · 0. Dodając ten sam element −(α · 0) do prawej strony dostajemy 0. W ten sposób równość (1) jest udowodniona. Dla sprawdzenia równości (2), zauważmy, że: (−α) · β + α · β = (−α + α) · β = 0 · β = β · 0 = 0. Widzimy stąd, że (−α) · β jest elementem przeciwnym do α · β. Zatem (−α) · (−β) = −(α · (−β)) = −((−β) · α) = −(−(β · α)) = β · α = α · β. Takiego typu proste manipulacje z aksjomatami pierścienia w dalszym ciągu będziemy pozo- stawiali Czytelnikowi. ♦ U w a g a. Gdy α jest elementem pierścienia R i n jest liczbą całkowitą, to deﬁniujemy nα ∈ R następująco: 0α = 0, 1α = α, (n + 1)α = nα + α dla n ∈ N, oraz nα = −(−n)α, gdy n < 0. Ćwiczenie 1.14 Niech α, β będą dowolnymi elementami pierścienia. Udowodnić szcze- gółowo (przez indukcję), że dla m, n ∈ Z prawdziwe są równości: (1) n(mα) = (nm)α, (2) (n + m)α = nα + mα, (3) n(α + β) = nα + nβ, (4) (nα) · β = α · nβ = n(α · β). Ćwiczenie 1.15 Niech α będzie elementem pierścienia. Zdeﬁniować przez indukcję n-tą potęgę, αn dla wykładnika naturalnego n. Następnie udowodnić przez indukcję, że (αm) n = αmn dla dowolnych m, n ∈ N. Ćwiczenie 1.16 Udowodnić przez indukcję, że dla dowolnych elementów α, β pierścienia p r z e m i e n n e g o i dowolnej liczby n ∈ N zachodzą równości (piszemy ϕψ zamiast ϕ · ψ): (α + β)n = αn + (n 1 )αn−1β + . . . + ( n n − 1 )αβn−1 + βn, (1.7) αn − βn = (α − β)(αn−1 + αn−2β + . . . + αβn−2 + βn−1). (1.8) 1.5. Liczby zespolone 11 Deﬁnicja 1.8 Element η ∈ R danego pierścienia R nazywamy elementem odwracal- nym lub jednością, gdy istnieje taki element ξ ∈ R, że ηξ = 1. W takiej sytuacji element ξ nazywamy odwrotnością η i oznaczamy ξ = η−1. Zbiór wszystkich elementów odwracalnych pierścienia R oznaczamy symbolem R ∗. Ćwiczenie 1.17 Udowodnić, że jeżeli R jest pierścieniem przemiennym z jedynką, to zbiór R ∗ z działaniem · jest grupą abelową, zwaną grupą jedności pierścienia R. Ćwiczenie 1.18 Wyznaczyć grupy jedności pierścieni Z, Q, R. Deﬁnicja 1.9 Element α pierścienia R nazywamy dzielnikiem zera, gdy α ̸= 0 i ist- nieje taki r ó ż n y o d z e r a element β ∈ R, że αβ = 0. Pierścień nie zawierający żadnych dzielników zera nazywa się dziedziną całkowitości. W dziedzinach całkowitości (zwanych też pierścieniami bez dzielników zera) zachodzi więc prawo: αβ = 0 ⇒ α = 0 lub β = 0. Poznamy teraz deﬁnicję ciała: Deﬁnicja 1.10 Pierścień przemienny z jedynką nazywa się ciałem, gdy każdy jego różny od zera element jest odwracalny. Jeżeli α jest niezerowym elementem ciała, to jego odwrotność oznaczamy α−1 lub 1 α. Konsekwentnie piszemy również α β zamiast αβ−1. P r z y k ł a d. Z ćwiczenia C1.18 widzimy, że pierścienie Q i R są ciałami. ♦ Ćwiczenie 1.19 Udowodnić, że ciało jest dziedziną całkowitości. Ćwiczenie 1.20 Udowodnić, że s k o ń c z o n a dziedzina całkowitości jest ciałem. 1.5 Liczby zespolone Matematyka w żaden sposób n i e p o t r a f i obejść się bez liczb zespolonych. Również mate- matyka ”olimpijska” wyraźnie kuleje bez tych liczb. Należy więc przyswoić sobie podstawową wiedzę ich dotyczącą. I m w c z e ś n i e j t y m l e p i e j. Liczby rzeczywiste utożsamiamy z punktami prostej – osi liczbowej. Podobnie, liczby zespolone utożsamimy z p u n k t a m i p ł a s z c z y z n y. Deﬁnicja 1.11 Napis postaci a + bi, gdzie a, b ∈ R nazywamy liczbą zespoloną. Zbiór liczb zespolonych oznaczamy symbolem C. W zbiorze tym wykonujemy działania dodawania i mnożenia następująco: (a + bi) + (c + di) = (a + c) + (b + d)i, (1.9) (a + bi) · (c + di) = (ac − bd) + (ad + bc)i. (1.10) 12 1. Pojęcia podstawowe Dodawanie i mnożenie liczb zespolonych jest łatwe: mówi o tym reguła: rób to co w szkole pamiętając, że i2 = −1. Wygodnym jest utożsamiać liczbę zespoloną z = a + bi z punktem płaszczyzny o współ- rzędnych kartezjańskich (a, b). W takiej sytuacji odciętą a nazywamy częścią rzeczywistą liczby z i oznaczamy a = Re z, a rzędną b nazywamy częścią urojoną liczby z i oznaczamy b = Im z. Utożsamiamy też liczbę rzeczywistą a z liczbą zespoloną a + 0i. W ten sposób traktujemy zbiór R liczb rzeczywistych jako p o d z b i ó r zbioru liczb zespolonych C. Geometrycznie, R pokrywa się z osią odciętych, zwaną w tym kontekście osią rzeczywistą. Oś rzęd- nych nazywamy wtedy osią urojoną. Liczby zespo- lone leżące na osi urojonej nazywa się liczbami czy- sto urojonymi. Niech z = a + bi będzie liczbą zespoloną. Kła- dziemy: z = a − bi, |z| = √ a2 + b2. Liczbę z nazywamy liczbą sprzężoną do z; z geometrycznego punktu widzenia, z jest odbiciem punktu z w osi rzeczywistej. Liczba r z e c z y w i s t a |z| nazywa się modułem liczby z; oznacza ona od- ległość punktu (a, b) od początku układu współrzęd- nych. j a |z| Rys. 1.2 |z| = +biz a = biz a _ bi bi Ćwiczenie 1.21 Sprawdzić, że z + z = 2 Re z i z − z = 2i Im z dla dowolnej liczby zespolonej z. Ćwiczenie 1.22 Udowodnić tożsamości: (1) z + w = z + w, (2) z · w = z · w, (1.11) (3) z · z = |z| 2, (4) |z · w| = |z| · |w|. (1.12) Ćwiczenie 1.23 Dowieść i podać interpretację geometryczną następującej nierówności trójkąta: |z + w| ⩽ |z| + |w| dla dowolnych z, w ∈ C. Wskazówka. Rysunek 1.3a. Ćwiczenie 1.24 Sprawdzić, że jeżeli z = a + bi ̸= 0, to liczba z−1 := a |z|2 + −b |z|2 i = z |z|2 jest odwrotnością liczby z w tym sensie, że z · z−1 = z−1 · z = 1. Fakt, że każda n i e z e r o w a liczba zespolona z ma odwrotność z−1 (oznaczaną też oczywi- ście 1 z ) pokazuje, że w zbiorze C wykonalne jest dzielenie liczb (nie przez zero!). W praktyce dzielenie polega na mnożeniu licznika i mianownika przez liczbę sprzężoną do mianownika: a + bi c + di = (a + bi)(c − di) (c + di)(c − di) = ac + bd c2 + d2 + bc − ad c2 + d2 i. 1.5. Liczby zespolone 13 Ćwiczenie 1.25 Uzasadnić, że |z/w| = |z|/|w|. Oraz, że niezerowa liczba z ∈ C ma moduł równy 1 wtedy i tylko wtedy, gdy z−1 = z. Ćwiczenie 1.26 Niech z = 2 + 3i, w = 4 − i. Narysować z, z, z + w, z2, zw, z3w−2 i zbiór {kz + lw : k, l ∈ Z}. Ćwiczenie 1.27 Udowodnić, że zbiór C wraz z wprowadzonymi działaniami dodawania i mnożenia jest ciałem. W szczególności w C nie ma dzielników zera. To znaczy, że jeżeli zw = 0, to z = 0 lub w = 0, porównaj D1.9. Chcemy teraz zobaczyć geometryczną interpretację dodawania i mnożenia liczb zespolonych. Rys. 1.3b Rys. 1.4 10 z w Rys. 1.3a . 10 z w zw w + z Z formuły (1.9) łatwo wywnioskować, że punkt płaszczyzny odpowiadający sumie w + z jest jednoznacznie wyznaczony przez warunek: punkty odpowiadające liczbom 0, w, w + z, z są wierzchołkami równoległoboku, zobacz rysunek 1.3a. Widzimy stąd i z zasady równole- głoboku dodawania wektorów, że przekształcenie Aw : z 7−→ w + z polegające na dodawaniu ustalonej liczby zespolonej w do zmiennej liczby z jest, z geometrycznego punktu widzenia, translacją, która przesuwa punkt 0 w punkt w. Aby zobaczyć interpretację geometryczną mnożenia liczb zespolonych użyjemy współrzęd- nych biegunowych (r, ϕ) niezerowego (tzn. różnego od początku układu) punktu (a, b), który utożsamiamy z liczbą zespoloną z = a + bi. Tutaj r = |z| jest modułem liczby z, zaś ϕ jest miarą kąta między dodatnią częścią osi rzeczywistej i półprostą h0z. Kąt ten nazy- wamy argumentem liczby z i oznaczamy Arg z. Liczbę ϕ deﬁniujemy z dokładnością do 2π. Jeżeli Arg z = ϕ, to, z elementarnej trygonometrii, mamy (porównaj rysunek 1.2): z = |z| cos ϕ + i|z| sin ϕ = |z|(cos ϕ + i sin ϕ). (1.13) Taki zapis nazywamy postacią trygonometryczną liczby zespolonej z. 14 1. Pojęcia podstawowe Pomnóżmy dwie liczby zespolone zadane w postaci trygonometrycznej: |z|(cos ϕ + i sin ϕ) · |w|(cos ψ + i sin ψ) = |z| · |w| [(cos ϕ cos ψ − sin ϕ sin ψ) + i(cos ϕ sin ψ + sin ϕ cos ψ)] = |zw| [cos(ϕ + ψ) + i sin(ϕ + ψ)] . Ostatnia równość wynika z drugiej tożsamości (1.12) i z elementarnej trygonometrii, zobacz GEO T2.29. Wnioskujemy stąd, że zachodzi następująca r e g u ł a m n o ż e n i a: mnożąc liczby zespolone mnożymy ich moduły i dodajemy ich argumenty. Używając tej reguły z łatwością rozwiążemy ćwiczenie: A B C D EFGH Fig. 1.5 w w w w w w ww w 9 = 1 2 3 4 5 6 7 8Rys. 1.4 Ćwiczenie 1.28 Niech ABGH, BCF G i CDEF będą kwadratami, zobacz rysu- nek 1.4. Wykazać, że suma miar ką- tów: <) DAE, <) CAF, <) BAG jest równa 90 ◦ . Wskazówka. Pomnożyć: (3 + i)(2 + i)(1 + i). Z reguły mnożenia widzimy, że przekształcenie Mw : z 7−→ wz, tzn. mnożenie przez ustaloną niezerową liczbę zespoloną w jest, z geometrycznego punktu widzenia, złożeniem J λ 0 ◦ Rϕ 0 dwóch przekształceń płaszczyzny: obrotu wokół punktu 0 = (0, 0) o kąt ϕ = Arg w, i jednokładności o środku 0 i skali λ = |w|. Zobacz rysunek 1.3b, gdzie widać dwa podobne trójkąty △(0)(1)(z) i △(0)(w)(zw) = Mw(△(0)(1)(z)). W szczególności, mnożenie przez i jest obrotem wokół 0 o kąt prosty (przeciwnie do ruchu wskazówek zegara). Podobnie, mnożenie przez −i jest obrotem o kąt prosty, tym razem zgodnie z ruchem wskazówek zegara. Innym wnioskiem z reguły mnożenia jest wzór de Moivre’ a (cos ϕ + i sin ϕ) n = cos nϕ + i sin nϕ. (1.14) W następnych trzech ćwiczeniach widzimy sympatyczne zastosowania wzoru de Moivre’a: Ćwiczenie 1.29 Przedstawić w postaci a + bi liczby: (1 + i) 2011, (1 + √3 i) 2010. Ćwiczenie 1.30 Zapisać w postaci a + bi: (1 + i tg ϕ) n, (1 + cos ϕ + i sin ϕ) n. Ćwiczenie 1.31 Używając wzoru dwumiennego (zobacz (1.7)) i wzoru de Moivre’a udo- wodnić, że dla dowolnego x ∈ R zachodzą równości sin 3x = −4 sin 3 x + 3 sin x cos 5x = 16 cos5 x − 20 cos 3 x + 5 cos x. 1.5. Liczby zespolone 15 Wnioskiem z reguły mnożenia jest fakt, że dla liczby zespolonej w = |w|(cos ϕ + i sin ϕ), w ̸= 0, istnieje d o k ł a d n i e n pierwiastków n-tego stopnia z liczby w: zk = n√ |w| ( cos ϕ + 2kπ n + i sin ϕ + 2kπ n ) . (1.15) Należy tak długo przyglądać się liczbom zk, aż stanie się jasne, że tworzą wierzchołki pewnego n-kąta foremnego i każda z nich spełnia warunek zn k = w. Patrz rysunek 1.5a. Ćwiczenie 1.32 Udowodnić, że jeżeli az2 + bz + c = 0 dla pewnych liczb zespolonych a ̸= 0, b, c, to z = −b + √∆ 2a , gdzie √ ∆ oznacza jeden z pierwiastków stopnia drugiego z liczby ∆ := b2 − 4ac. Ćwiczenie 1.33 Uzasadnić, że każdy pierwiastek równania kwadratowego z2 − 2(cos ϕ)z + 1 = 0, przy dowolnym parametrze ϕ ∈ R, jest liczbą zespoloną o module 1. Ćwiczenie 1.34 Narysować 6-elementowy zbiór pierwiastków stopnia 6 z liczby i. Wska- zówka. Zaznaczony na rysunku 1.5a kąt ϕ ma miarę π/12. Szczególnie sympatycznym jest zbiór wszystkich pierwiastków n-tego stopnia z liczby 1. Ćwiczenie 1.35 Udowodnić, że zbiór µn(C) wszystkich pierwiastków stopnia n z 1 jest grupą względem mnożenia. Rys. 1.5bRys. 1.5a w 9 2 3 4 5 6 7 8 w w w w ww w w 1=j Ćwiczenie 1.36 Udowodnić, że grupa (µn(C), ·) jest grupą cykliczną (grupę Γ nazywamy grupą cykliczną, gdy istnieje taki element ω ∈ Γ , że zachodzi równość zbiorów Γ = {ωn : n ∈ Z}). Patrz rysunek 1.5b, gdzie pokazano przypadek n = 9. 16 1. Pojęcia podstawowe Liczby zespolone, dzięki swojej ”budowie” pozwalają zgrabnie uzasadniać tożsamości try- gonometryczne, zobacz na przykład C1.31. Inny przykład widzimy w rozwiązaniu kolejnego zadania: ZADANIE 1.7 Udowodnić, że dla dowolnego x ̸= 2lπ zachodzi równość 1 2 + N∑ k=1 cos kx = sin(N + 1 2)x 2 sin x 2 . R o z w i ą z a n i e. Weźmy liczbę zespoloną z = cos x + i sin x i niech w = cos x 2 + i sin x 2 będzie (jednym z dwóch) pierwiastkiem kwadratowym z liczby z. Dzięki wzorowi de Moivre’a wiemy, że rozważana suma jest częścią rzeczywistą liczby 1 2 N∑ k=−N zk = 1 2z−N 2N∑ k=0 zk = 1 2 z−N z2N +1 − 1 z − 1 = w(zN +1w−1 − z−N w−1) 2w(zw−1 − w−1) , czyli liczby w2N +1 − w2N +1 2(w − w) = 2i sin(2N + 1) x 2 2 · 2i sin x 2 . Radzimy Czytelnikowi tak długo sprawdzać napisane równości, aż wszystko będzie dla niego całkowicie jasne. ♦ Ćwiczenie 1.37 Udowodnić, że dla każdego x ̸= 2lπ zachodzi równość N∑ k=0 sin kx = sin N x 2 sin (N +1)x 2 sin x 2 . Liczby zespolone są też wygodnym narzędziem w planimetrii. Wynika to z prostoty zapi- sywania obrotów. Widzieliśmy to w C1.28, zobaczymy i teraz, patrz też GEO : ZADANIE 1.8 (Zadanie o zakopanym skarbie.) Na płaszczyźnie dane są ustalone dwa punkty A, B i zmienny punkt Z. Niech ZBKL i AZM N będą dwoma kwadratami zorientowanymi przeciwnie do ruchu wskazówek zegara. Udowodnić, że wszystkie proste lN K przechodzą przez ten sam punkt (są współpękowe). R o z w i ą z a n i e. Po utożsamieniu płaszczyzny, w której leżą te kwadraty z płaszczyzną zespoloną, będziemy uważać wszystkie występujące w zadaniu punkty za liczby zespolone. Wówczas N = A + i(Z − A), K = B − i(Z − B). Wobec tego środek odcinka N K utożsamiamy z liczbą zespoloną N + K 2 = A + B + i(B − A) 2 . A B Z K L M N Rys. 1.6 Widzimy więc, że środek odcinka N K n i e z a l e ż y od wyboru punktu Z i przez ten środek przechodzą (oczywiście) wszystkie proste lN K. ♦ 1.5. Liczby zespolone 17 ZADANIE 1.9 (Zadanie o trójkątach Napoleona) Na zewnątrz danego trójkąta △ABC, na jego bokach, zbudowano trójkąty równoboczne △BCAn, △CABn i △ABCn. Udowodnić, że środki ciężkości tych trójkątów są wierzchołkami trójkąta równobocznego. A B Z K L M N Rys. 1.7 C A n Bn Cn R o z w i ą z a n i e. Podobnie jak wyżej, utożsa- miamy punkty płaszczyzny z liczbami zespolonymi. Oznaczmy ω = cos π 3 + i sin π 3 . Mnożenie przez ω jest więc obrotem o kąt 60 ◦ . Wobec tego, patrz rysunek 1.7, An = C + ω(B − C), (1.16) Bn = A + ω(C − A), (1.17) Cn = B + ω(A − B). (1.18) Chcemy zaś uzasadnić, że zachodzi równość ω(L − K) = M − K. (1.19) Ponieważ środek ciężkości K jest średnią arytmetyczną odpowiednich wierzchołków, więc, na mocy równości (1.16), 3K = An +B +C = (1+ω)B +(2−ω)C. Podobnie, z równości (1.17) i (1.18) dostajemy 3L = (1 + ω)C + (2 − ω)A i 3M = (1 + ω)A + (2 − ω)B. Korzystając z tych równości i (łatwej do zobaczenia – sprawdzić!) równości ω2 + 1 = ω, po prostych rachunkach, dostaniemy równość ω(3L − 3K) = 3M − 3K, czyli (1.19). ♦ Rozdział 2 Elementarz Euclid, whose fame rests on the portion of his E l e m e n t s that forms the foundation of g e o m e t r y studied in high school, seems to have made original contributions to n u m b e r t h e o r y, while his geometry was largely a compilation of previous results. (Richard Courant) W tym rozdziale przedstawiamy podstawowe pojęcia i twierdzenia elementarnej teorii liczb. Najważniejsze idee pochodzą zapewne od E u k l i d e s a. 2.1 Największy wspólny dzielnik w pierścieniu Z W tym paragraﬁe zbieramy i systematyzujemy wstępne wiadomości o podzielności liczb całko- witych. Przekonamy się, że najważniejszym narzędziem służącym do badania podzielności liczb całkowitych jest tak zwane d z i e l e n i e z r e s z t ą, zobacz twierdzenie T2.2. Z twierdzenia tego wynikają kolejno wnioski: ✓ każdy ideał w Z jest ideałem głównym, zobacz T2.3, ✓ każde dwie (niezerowe) liczby całkowite mają NWD , zobacz T2.4, ✓ NWD da się przedstawić w postaci kombinacji liniowej, zobacz T2.6, ✓ prawdziwe jest Zasadnicze Twierdzenie Arytmetyki, zobacz T2.7, ✓ każde dwie (niezerowe) liczby całkowite mają NWW , zobacz T2.8. Paragraf zakończymy prezentacją algorytmu Euklidesa, który redukuje (beznadziejnie trudne w szkole) zadanie wyznaczania NWD do kilku prostych dzieleń z resztą. 2.1.1 Podzielność i dzielenie z resztą w Z Zaczynamy od podstawowej deﬁnicji. Zwróćmy uwagę, że w tej deﬁnicji n i e występują ułamki. Deﬁnicja 2.1 Niech a, b będą liczbami całkowitymi. Mówimy, że a dzieli b, gdy istnieje taka liczba q ∈ Z, że b = a · q. Zapisujemy to tak: a|b. Mówimy również w takiej sytuacji, że b jest wielokrotnością a, lub że a jest dzielnikiem b. 2.1. Największy wspólny dzielnik w pierścieniu Z 19 Podstawowe własności relacji podzielności w pierścieniu liczb całkowitych Z zawarte są w naszym pierwszym twierdzeniu. TWIERDZENIE 2.1 Dla dowolnych liczb całkowitych a, b, c, d zachodzą: (1) a|a, 1|a, (−1)|a, a|0, (2) jeżeli a|b i b|c, to a|c, (3) jeżeli a|b i b|a, to a = ±b, (4) jeżeli a|b i a|c, to a|b ± c i a|bd, (5) jeżeli ak|bk, dla k ⩾ 1, to a|b. □ Ćwiczenie 2.1 Udowodnić prawdziwość wszystkich, z wyjątkiem ostatniej, tez. Ćwiczenie 2.2 Uzasadnić szczegółowo, że jeżeli a|b i b ̸= 0, to |a| ⩽ |b|. Jeden wniosek z tezy T2.1(4) jest tak c z ę s t o wykorzystywany w rozumowaniach, że stosu- jemy go w dalszym ciągu prawie ”mimochodem”, czasami nazywając Zasadą Podstawową: ZASADA PODSTAWOWA Jeżeli ai, xi, bj, yj oraz c są liczbami całkowitymi i a1x1 + a2x2 + . . . + anxn = b1y1 + b2y2 + . . . + bmym + c, a wszystkie liczby ai, bj są podzielne przez daną liczbę całkowitą d, to d|c. P r z y k ł a d. Udowodnimy, że liczba An = 5 2n + 1 jest, dla każdej liczby naturalnej n, podzielna przez 2, ale nie jest podzielna przez 4. Rzeczywiście, wzór dwumienny daje: An = ( 5 2)n + 1 = (1 + 8 · 3) n + 1 = 1 + n∑ k=1 ( n k ) 8 k · 3 k + 1 = 2 + n∑ k=1 (n k )8 k · 3 k, skąd 2|An. Gdyby 4|An, to, na mocy Zasady Podstawowej, mielibyśmy 4|2. ♦ Oznaczmy przez D(a) zbiór wszystkich dzielników liczby całkowitej a. Jasne, że D(0) = Z. Jeżeli a, b są liczbami całkowitymi, to oznaczmy D(a, b) = D(a) ∩ D(b). Zbiór D(a, b) jest więc po prostu zbiorem wszystkich wspólnych dzielników liczb a i b. Na przykład, ponieważ D(−30) = {±1, ±2, ±3, ±5, ±6, ±10, ±15, ±30} i D(21) = {±1, ±3, ±7, ±21}, więc D(−30, 21) = {−1, +1, −3, +3}. Zauważmy, że zbiór D(a, b) jest zbiorem nieskończonym w jednym tylko przypadku: gdy a = b = 0. W każdym innym przypadku jest to zbiór n i e p u s t y (jeżeli a ̸= 0, to a ∈ D(a, b), zob. T2.1(1)) i s k o ń c z o n y (jeżeli a ̸= 0, to D(a, b) ⊆ [ −|a|; |a| ], zob. C2.2), a jego największy element (istniejący na mocy zasady maksimum) nazywa się (w szkole) największym wspólnym dzielnikiem liczb całkowitych a i b. Arcyważnym narzędziem w teorii liczb całkowitych jest dzielenie z resztą. 20 2. Elementarz TWIERDZENIE 2.2 (Dzielenie z resztą w Z) Jeżeli a, b ∈ Z i b ̸= 0, to istnieje dokładnie jedna taka para liczb q, r ∈ Z, że a = qb + r oraz 0 ⩽ r < |b|. (2.1) D O W Ó D. Rozważmy zbiór X = {a − xb : x ∈ Z, a − xb ⩾ 0}. Zbiór ten jest niepusty (dlaczego?). Niech r = a − qb będzie najmniejszą liczbą zbioru X. Jasne, że 0 ⩽ r < |b|. W ten sposób uzasadniliśmy i s t n i e n i e liczb q i r. Załóżmy teraz, że pary (q1, r1) i (q2, r2) spełniają narzucone warunki. Wtedy a = q1b + r1 = q2b + r2. Stąd (q1 − q2)b = r2 − r1, więc |q1 − q2| · |b| = |r2 − r1|. Ale |r2 − r1| < |b|, bo 0 ⩽ r1, r2 < |b|. Wobec tego |q1 − q2| = 0. Zatem q1 = q2, a więc i r1 = r2. Widzimy zatem j e d y n o ś ć liczb q, r. □ Liczba q nazywa się (niepełnym) ilorazem, a liczba r, resztą z dzielenia a przez b. Możliwymi resztami z dzielenia liczb całkowitych przez daną liczbę naturalną m są liczby 0, 1, 2, . . . , m − 1. Ten układ liczb nazywa się standardowym zupełnym układem reszt modulo m. Ćwiczenie 2.3 Niech n ∈ Z będzie liczbą nieparzystą. Wyznaczyć resztę z dzielenia liczby 3n3 + 2n2 + n − 1 przez 8. Ćwiczenie 2.4 Wyznaczyć resztę z dzielenia liczby 2 2009 + 1 przez 7. 2.1.2 Ideały w pierścieniu Z Ideały w zbiorze (pierścieniu) liczb całkowitych Z grają ważną rolę przy badaniu relacji po- dzielności w tym zbiorze. Deﬁnicja 2.2 Podzbiór I ⊆ Z nazywamy ideałem, gdy zawiera liczbę 0 oraz spełnia poniższe dwa warunki: (1) jeżeli a ∈ I i b ∈ I, to a + b ∈ I, (2) jeżeli k ∈ Z i a ∈ I, to ka ∈ I. P r z y k ł a d. Ustalmy dowolną liczbę całkowitą a. Zbiór (a) := {ka : k ∈ Z} = { . . . , −3a, −2a, −a, 0, a, 2a, 3a, . . . } wszystkich wielokrotności liczby a jest ideałem. Warunek (1) mówi bowiem po prostu, że suma dwóch wielokrotności liczby a jest wielokrotnością liczby a: ka + la = (k + l)a. Zaś warunek (2) mówi, że wielokrotność wielokrotności liczby a jest wielokrotnością liczby a: k(la) = (kl)a. Zauważmy, że jeżeli a, b ∈ I, to a−b = a+(−1)b ∈ I. Zauważmy wreszcie, że (1) = (−1) = Z oraz (0) = {0}. Ideał (0) nazywamy ideałem zerowym. ♦ Deﬁnicja 2.3 Ideał (a) nazywa się ideałem głównym generowanym przez a, zaś samą liczbę a nazywamy generatorem tego ideału. 2.1. Największy wspólny dzielnik w pierścieniu Z 21 Ćwiczenie 2.5 Dowieść, że dla dowolnych liczb całkowitych a, b: a|b ⇐⇒ (b) ⊆ (a). Teza ćwiczenia C2.5 pozwala zastępować relację podzielności liczb relacją inkluzji ideałów. W szczególności, (a) = (b) wtedy i tylko wtedy, gdy a = ±b, zobacz T2.1(3). Ćwiczenie 2.6 Udowodnić, że przekrój (= część wspólna = iloczyn teoriomnogościowy) dowolnej rodziny ideałów jest ideałem. Ćwiczenie 2.7 Udowodnić, że jeżeli zawierający 0 podzbiór zbioru Z spełnia warunek (1) deﬁnicji D2.2, to jest on ideałem. Wskazówka. Udowodnić przez indukcję, że jeżeli a ∈ I, to na ∈ I dla każdego n ∈ N. Niech dane będą dwie liczby całkowite a, b. Zdeﬁniujemy zbiór (a, b) := {ax + by : x, y ∈ Z}. (2.2) Element ax + by tego zbioru nazywamy kombinacją liniową liczb a i b. Kombinacja liniowa jest więc po prostu sumą pewnej wielokrotności liczby a i pewnej wielokrotności liczby b. Zbiór (a, b) nazywamy ideałem generowanym przez liczby a, b. Możemy używać takiej terminologii, bowiem: Ćwiczenie 2.8 Dowieść, że zbiór (a, b) jest ideałem. Najważniejszym wnioskiem z możliwości dzielenia z resztą w pierścieniu liczb całkowitych Z jest fakt, że k a ż d y ideał w tym pierścieniu jest zbiorem wielokrotności pewnej liczby, czyli jest ideałem głównym. Rozumowanie, które prowadzi do tego wniosku, jest laboratoryjnie czystym przykładem pięknego kawałka matematyki olimpijskiej. TWIERDZENIE 2.3 Jeżeli I ⊆ Z jest ideałem, to istnieje jedyna taka liczba całkowita nieujemna d, że I = (d) := {qd : q ∈ Z}. D O W Ó D. Jeżeli ideał I jest ideałem zerowym, czyli zawiera tylko jeden element 0, to I = (0). Jeżeli nie jest ideałem zerowym, to zawiera jakąś liczbę b ̸= 0 i wtedy zawiera też liczby dodatnie (bo zawiera liczby b i −b = (−1) · b, a któraś z nich jest dodatnia). Niech d będzie n a j m n i e j s z ą d o d a t n i ą liczbą w zbiorze I. Taka liczba istnieje na mocy Zasady Minimum. Pokażemy, że każda liczba a ∈ I jest wielokrotnością d. Podzielmy w tym celu a przez d z resztą: a = qd + r, 0 ⩽ r < d. Wówczas r = a − qd ∈ I, bo a ∈ I i qd ∈ I. Ale d jest najmniejszą dodatnią liczbą w zbiorze I, a 0 ⩽ r < d, stąd r = 0, czyli a = qd. Wykazaliśmy w ten sposób, że I ⊆ (d). Ponieważ zawieranie (d) ⊆ I jest oczywiste, więc I = (d). □ U w a g a. Twierdzenie T2.3 może być (i zazwyczaj jest) wyrażone tak: pierścień Z liczb całkowitych jest dziedziną ideałów głównych (skrót: dig). Ćwiczenie 2.9 Dane są dowolne liczby całkowite a1, a2, . . . , an. Udowodnić, że zbiór (a1, a2, . . . , an) := {a1x1 + a2x2 + . . . + anxn : x1, x2, . . . , xn ∈ Z} jest n a j m n i e j s z y m ideałem zawierającym liczby a1, a2, . . . , an. Nazywamy go ideałem generowanym przez te liczby. 22 2. Elementarz 2.1.3 Największy wspólny dzielnik Najważniejszym pojęciem elementarnej teorii liczb jest pojęcie największego wspólnego dziel- nika. Przyjęta niżej (zobacz D2.4) deﬁnicja tego pojęcia jest, jak się okaże, równoważna, ze wspomnianą w ustępie 2.1.1, deﬁnicją szkolną. Deﬁnicja 2.4 Załóżmy, że a, b są, nie równymi jednocześnie 0, liczbami całkowitymi. Liczbę naturalną d nazywamy największym wspólnym dzielnikiem liczb a i b, gdy (1) d ∈ D(a, b) (d jest wspólnym dzielnikiem), (2) jeżeli e ∈ D(a, b), to e|d (d jest wielokrotnością każdego wspólnego dzielnika). Łatwo widzieć, że c o n a j w y ż e j j e d n a liczba dodatnia d spełnia powyższe warunki: gdyby d1 też je spełniała, to d1|d i d|d1, skąd d = d1. Udowodnimy więc teraz, że dla dowolnych dwóch niezerowych liczb całkowitych i s t n i e j e ich największy wspólny dzielnik. TWIERDZENIE 2.4 Dla dowolnych, nie równych jednocześnie 0, liczb całkowitych a, b istnieje największy wspólny dzielnik liczb a, b. D O W Ó D. Rozważmy ideał (a, b) generowany przez liczby a, b, zobacz (2.2). Ponieważ każdy ideał w Z jest główny, zobacz T2.3, więc istnieje taka liczba d o d a t n i a d, że (a, b) = (d). Sprawdzamy, że tak wyznaczona liczba d spełnia warunki D2.4(1) i D2.4(2): (1) Ponieważ a ∈ (a, b) (bo a = a · 1 + b · 0), a (a, b) = (d), więc a ∈ (d), czyli d|a. Podobnie sprawdzamy, że d|b. (2) Ponieważ d ∈ (d) = (a, b), a zbiór (a, b) składa się ze wszystkich kombinacji liniowych ax + by, więc d = ax0 + by0 (2.3) dla pewnych x0, y0 ∈ Z. Niech teraz e|a i e|b dla pewnej liczby całkowitej e. Wtedy a = ke i b = le, skąd, dzięki (2.3), d = (ke)x0 + (le)y0 = e(kx0 + ly0). Więc e|d. □ Widzimy więc, że d o k ł a d n i e j e d n a liczba naturalna d spełnia warunki (1), (2) deﬁnicji D2.4. Tę, jednoznacznie wyznaczoną, liczbę oznaczamy symbolem NWD (a, b). Łatwo sprawdzić, że jest to ta sama liczba, którą tak nazywaliśmy w szkole. Mianowicie: TWIERDZENIE 2.5 Jeżeli a, b są, nie równymi jednocześnie 0, liczbami całkowitymi, to NWD (a, b) jest n a j w i ę k s z ą liczbą w zbiorze D(a, b) wspólnych dzielników liczb a i b. D O W Ó D. Niech d = NWD (a, b) i niech d1 oznacza największą liczbę w D(a, b). Wtedy d ⩽ d1, bo d1 jest największy. Jednocześnie d1|a i d1|b (bo d1 jest wspólnym dzielnikiem), więc d1|d (bo d spełnia warunek D2.4(2)). Zatem, zob. C2.2, d1 ⩽ d. Przeto d1 = d. □ 2.1. Największy wspólny dzielnik w pierścieniu Z 23 Deﬁnicja 2.5 Jeżeli NWD (a, b) = 1, to mówimy, że liczby a, b są względnie pierwsze. Piszemy też a ⊥ b dla wskazania, że liczby a, b są względnie pierwsze. Liczby całkowite a, b są więc względnie pierwsze wtedy i tylko wtedy, gdy 1 jest ich j e d y n y m w s p ó l n y m dzielnikiem dodatnim. Ćwiczenie 2.10 Udowodnić, że dla dowolnych liczb całkowitych a, b zachodzi NWD (a, a + b)|b. Wywnioskować stąd, że dwie kolejne liczby całkowite są względnie pierwsze. Ćwiczenie 2.11 Wybrano n + 1 liczb ze zbioru {1, 2, 3, . . . , 2n}. Udowodnić, że znajdą się wśród nich dwie liczby względnie pierwsze. (Zagadka Erd˝osa) ZADANIE 2.1 Udowodnić, że jeśli n, m ∈ N i m jest nieparzysta, to NWD (2 m − 1, 2 n + 1) = 1. R o z w i ą z a n i e. Niech d = NWD (2m − 1, 2 n + 1). Wtedy d jest liczbą nieparzystą(!) i mamy 2 m − 1 = dx, 2 n + 1 = dy dla pewnych liczb naturalnych x, y. Na mocy wzoru dwumiennego mamy 2 mn = (dx + 1)n = du + 1 i 2 nm = (dy − 1)m = dv − 1, (2.4) gdzie u = n−1∑ k=0 ( n k ) dn−k−1xn−k, v = m−1∑ l=0 ( m l ) (−1) ldm−l−1ym−l. Dzięki równościom (2.4) mamy du + 1 = dv − 1. Stąd 2 = d(v − u). Więc d = 1. ♦ ZADANIE 2.2 Liczby Fn = 22n + 1, dla n ∈ Z≥0, nazywamy liczbami Fermat’a. Udowodnić Twierdzenie Goldbacha: Dwie różne liczby Fermat’a są względnie pierwsze. R o z w i ą z a n i e. Niech n = m + r i r > 0. Wówczas mamy Fn = 2 2n + 1 = 2 2m+r + 1 = (2 2m) 2r + 1 = (Fm − 1) 2r + 1. Na mocy wzoru dwumiennego, podobnie jak w poprzednim zadaniu, dostajemy więc Fn = (Fm − 1) 2r + 1 = (A · Fm + 1) + 1 = A · Fm + 2 przy pewnym A ∈ N. Z otrzymanej równości Fn = AFm + 2, na mocy Zasady Podstawowej, wnosimy, że każdy wspólny dzielnik liczb Fn i Fm jest dzielnikiem 2. Ponieważ jednak liczby Fermat’a są nieparzyste, więc jedynym dodatnim wspólnym dzielnikiem Fn i Fm jest 1. ♦ Fakt, że największy wspólny dzielnik dwóch liczb całkowitych a, b da się przedstawić w postaci kombinacji liniowej ax + by tych liczb, jest tak ważny, że zapiszemy go jeszcze raz: 24 2. Elementarz TWIERDZENIE 2.6 (Twierdzenie Gaussa-B´ezout’ a) Dla niezerowych liczb całkowi- tych a, b istnieją liczby całkowite x, y, dla których NWD (a, b) = ax + by. (2.5) W szczególności: a ⊥ b wtedy i tylko wtedy, gdy ax + by = 1 dla pewnych x, y ∈ Z. □ Kolejne cztery ćwiczenia rozwiązuje się bardzo łatwo korzystając z przedstawienia najwięk- szego wspólnego dzielnika w postaci (2.5): Ćwiczenie 2.12 Jeżeli d jest największym wspólnym dzielnikiem a, b oraz a = da′ i b = db′, to NWD (a′, b′) = 1. Ćwiczenie 2.13 Jeżeli NWD (a, b) = 1 oraz c|a, to NWD (c, b) = 1. Ćwiczenie 2.14 Jeżeli NWD (a, b) = NWD (c, b) = 1, to NWD (ac, b) = 1. Ćwiczenie 2.15 Udowodnić przez indukcję względem n, m ⩾ 0, że jeżeli liczby całkowite a, b są względnie pierwsze, to NWD (an, bm) = 1 dla dowolnych n, m ∈ Z≥0. Można również mówić o największym wspólnym dzielniku dowolnych układów liczb: Ćwiczenie 2.16 Zdeﬁniować NWD (a1, a2, . . . , as) i wykazać, że jest on równy (z dokład- nością do znaku) generatorowi ideału (a1, a2, . . . , as), zobacz też C2.9. 2.1.4 Zasadnicze Twierdzenie Arytmetyki Jesteśmy teraz w stanie udowodnić tak zwane Zasadnicze Twierdzenie Arytmetyki, ZTA. Niektórzy nazywają je również twierdzeniem Gaussa, chociaż poprawniej powinno się je nazy- wać twierdzeniem Euklidesa – znajduje się bowiem w jego ”Elementach”. TWIERDZENIE 2.7 (ZTA) Niech a, b i c będą liczbami całkowitymi. Wówczas: Jeżeli a|bc i NWD (a, b) = 1, to a|c. D O W Ó D. Założenie a ⊥ b daje, jak wiemy, równość 1 = ax+by, przy pewnych x, y ∈ Z. Mnożąc tę równość obustronnie przez c, otrzymamy c = acx + bcy = acx + aky = a(cx + ky), gdzie druga równość wynika z założenia, że bc = ak dla pewnego k ∈ Z. Zatem a|c. □ Teza kolejnego ćwiczenia jest b a r d z o w a ż n a. Ćwiczenie 2.17 Jeżeli liczby całkowite a, b są względnie pierwsze i a|c i b|c, to ab|c. ZADANIE 2.3 Udowodnić prawdziwość tezy T2.1(5). 2.1. Największy wspólny dzielnik w pierścieniu Z 25 R o z w i ą z a n i e. Niech bk = cak. Oznaczmy d = NWD (a, b) i a = da′, b = db ′. Mamy więc d k(b′) k = cd k(a′) k, skąd (b′) k = c(a′)k. Z C2.12 wiemy, że NWD (a′, b′) = 1, więc z C2.15, NWD ((a′) k, (b′) k) = 1. Stąd i z równości 1 · (b′) k = c(a′)k, dzięki ZTA, widzimy, że (a′)k|1. Zatem (a′)k = ±1, czyli a′ = ±1. Ostatecznie, a = ±d, więc a|b. ♦ Następne zadanie pokazuje efektywną metodę znajdowania wszystkich wymiernych pier- wiastków wielomianów o współczynnikach całkowitych. ZADANIE 2.4 Jeżeli liczba wymierna h k dana w postaci ułamka nieskracalnego (to znaczy takiego, że NWD (h, k) = 1) jest pierwiastkiem wielomianu f (X) = a0 + a1X + a2X 2 + . . . + anX n o współczynnikach całkowitych, to k|an, a h|a0. R o z w i ą z a n i e. Jeżeli f ( h k ) = 0, to, po wymnożeniu przez kn, dostajemy równość a0kn + a1kn−1h + a2kn−2h 2 + . . . + an−1kh n−1 + anh n = 0. Z tej równości, dzięki Zasadzie Podstawowej, wnosimy, że h|a0kn oraz k|anh n. Wiedząc z C2.15, że NWD (h, kn) = 1 oraz NWD (k, h n) = 1, wnioskujemy, dzięki ZTA, że h|a0 oraz k|an. To kończy rozwiązanie. ♦ Ćwiczenie 2.18 Udowodnić, że liczba wymierna ma tylko jedno, z dokładnością do znaku licznika i mianownika, przedstawienie w postaci ułamka nieskracalnego. Ćwiczenie 2.19 Udowodnić, że jeżeli przy naturalnym n, dana liczba całkowita jest n-tą potęgą liczby wymiernej, to jest też n-tą potęgą liczby całkowitej. 2.1.5 Najmniejsza wspólna wielokrotność Czasami używamy również najmniejszej wspólnej wielokrotności dwóch (lub większej liczby) liczb całkowitych. Podamy deﬁnicję tego pojęcia dualną do deﬁnicji D2.4. Deﬁnicja 2.6 Liczbę naturalną m nazywamy najmniejszą wspólną wielokrotnością niezerowych liczb całkowitych a i b, gdy (1) a|m i b|m (m jest wspólną wielokrotnością), (2) jeżeli a|n i b|n, to m|n (m jest dzielnikiem każdej wspólnej wielokrotności). Łatwo sprawdzić, że c o n a j w y ż e j jedna liczba naturalna m spełnia powyższe dwa wa- runki. Jeszcze łatwiej sprawdzić, że dla dowolnych dwóch niezerowych liczb całkowitych a, b i s t n i e j e ich najmniejsza wspólna wielokrotność, oznaczana NWW (a, b): TWIERDZENIE 2.8 Jeżeli a, b ̸= 0 są liczbami całkowitymi i zachodzi równość (a) ∩ (b) = (m), (2.6) to liczba |m| jest najmniejszą wspólną wielokrotnością liczb a, b. 26 2. Elementarz D O W Ó D. Ćwiczenie dla Czytelnika. Porównać C2.6. □ Ciekawą i ważną własność NWD i NWW podaje: TWIERDZENIE 2.9 Dla dowolnych liczb naturalnych a, b zachodzi równość: NWD (a, b) · NWW (a, b) = ab. D O W Ó D. Niech d = NWD (a, b) i niech a = a′d i b = b′d. Wówczas, jak wiemy, NWD (a′, b′) = 1. Pokażemy, że liczba m := ab d = a′b = ab′ spełnia warunek D2.6(2) (bo warunek D2.6(1), oczywiście, spełnia). Niech więc a|n i b|n dla pewnej liczby całkowitej n. Mamy zatem dla pewnych k, l ∈ Z n = ak = bl. (2.7) Stąd, ak = bl, czyli da′k = db′l, więc a′k = b′l. Ale, NWD (a′, b′) = 1 i a′|b′l, zatem, na mocy ZTA, a′|l. Kładąc l = a′s mamy, dzięki (2.7), n = bl = ba′s = ms. □ Ćwiczenie 2.20 Udowodnić, że dla a, b, c ∈ Z zachodzi równość NWW (a, NWW (b, c)) = NWW (NWW (a, b), c). Ćwiczenie 2.21 Udowodnić, że (na ogół) NWD (a, b, c) · NWW (a, b, c) ̸= abc, ale NWD (ab, bc, ca) · NWW (a, b, c) = abc = NWD (a, b, c) · NWW (ab, bc, ca). 2.1.6 Algorytm Euklidesa Proste twierdzenie T2.10 leży u podstaw efektywnej metody (czyli algorytmu) wyznaczania największego wspólnego dzielnika. Ten, pochodzący od Euklidesa, algorytm jest absolutnie n a j w a ż n i e j s z y m narzędziem rachunkowym (elementarnej) teorii liczb. TWIERDZENIE 2.10 Jeżeli dla liczb całkowitych a, b, q, r zachodzi równość a = qb + r, to NWD (a, b) = NWD (b, r). D O W Ó D. Dzięki Zasadzie Podstawowej z łatwością sprawdzamy, że warunek a = qb + r implikuje równość D(a, b) = D(b, r) zbiorów wspólnych dzielników. Stąd teza. □ TWIERDZENIE 2.11 (Algorytm Euklidesa wyznaczania NWD ) Dane są liczby cał- kowite a i b, przy czym b ̸= 0. Wykonujemy kolejne dzielenia z resztą:  |||||| |||||| a = qb + r, b = q1r + r1, r = q2r1 + r2, r1 = q3r2 + r3, . . . (2.8) Wówczas ciąg reszt r, r1, r2, . . . jest ściśle malejącym ciągiem liczb całkowitych nieujemnych. Ostatnia n i e z e r o w a reszta równa jest NWD (a, b). □ 2.1. Największy wspólny dzielnik w pierścieniu Z 27 Ćwiczenie 2.22 Udowodnić twierdzenie T2.11. Wskazówka. Ostatnia linijka algorytmu (2.8) ma postać rs = qs+2rs+1 + 0. Z niej: D(rs+1) = D(rs+1, 0) = · · · = D(a, b). P r z y k ł a d. Ciąg oczywistych równości 17464 = 1 · 9322 + 8142 9322 = 1 · 8142 + 1180 8142 = 6 · 1180 + 1062 1180 = 1 · 1062 + 118 1062 = 9 · 118 + 0 (2.9) pokazuje, że D(17464, 9322) = D(9322, 8142) = D(8142, 1180) = . . . = D(1062, 118) = D(118, 0) = D(118). Wobec tego mamy: NWD (17464, 9322) = NWD (9322, 8142) = · · · = = NWD (1062, 118) = NWD (118, 0) = 118. ♦ Zrobimy trzy w a ż n e u w a g i dotyczące algorytmu Euklidesa: U w a g a 1. W praktyce, zamiast wykonywać w kolejnej linii algorytmu Euklidesa dzielenie z resztą nieujemną mniejszą niż dzielnik, wygodnie jest ”dzielić z resztą ujemną”, jeżeli prowadzi to do mniejszych co do wartości bezwzględnej reszt. Poniższy przykład (po porównaniu z (2.9)) pokazuje wyraźnie o co chodzi: 17464 = 2 · 9322 − 1 180 9322 = 8 · 1180 − 118 1180 = 10 · 118 + 0 (2.10) Ćwiczenie 2.23 Wyznaczyć NWD (234567, 765432). U w a g a 2. W matematyce szkolnej, aby wyznaczyć NWD (a, b), musimy znać rozkłady liczb a, b na czynniki pierwsze. Algorytm Euklidesa pozwala wyznaczyć największy wspólny dzielnik dowolnych dwóch liczb całkowitych bez najmniejszej znajomości ich rozkładów na czynniki pierwsze (można nawet n i e w i e d z i e ć co to jest liczba pierwsza). Na przykład, trzy proste równości (2.10) wystarczają do sprawdzenia, że NWD (17464, 9322) = 118, W matematyce szkolnej tymczasem wymaga się od uczniów uprzedniego rozwiązania (znacznie trudniejszego) zadania rozkładu na czynniki pierwsze: 9322 = 2 · 59 · 79, 17464 = 2 · 2 · 2 · 37 · 59. U w a g a 3. Algorytm Euklidesa daje jeszcze więcej: Wiemy, że największy wspólny dzielnik dwóch liczb całkowitych a i b da się zapisać jako kombinacja liniowa ax+by tych liczb, zobacz (2.5). Często chcemy jednak z n a ć k o n k r e t n e x, y (a nie tylko wiedzieć, że takowe istnieją). Otóż, równości (2.8) z algorytmu Euklidesa (czytane od tyłu) dają e f e k t y w n ą (i efektowną!) metodę wyznaczania x i y. Na przykład, dzięki (2.9): 118 = 1180 − 1062 = 1180 − (8142 − 6 · 1180) = −8142 + 7 · 1180 = = −8142 + 7 · (9322 − 8142) = 7 · 9322 − 8 · 8142 = = 7 · 9322 − 8 · (17464 − 9322) = 9322 · 15 + 17464 · (−8). Za pomocą równości (2.10) możemy to zrobić jeszcze szybciej: 118 = 8 · 1180 − 9322 = 8 · (2 · 9322 − 17464) − 9322 = 9322 · 15 + 17464 · (−8). 28 2. Elementarz 2.2 Równanie ax + by = n Niech a, b, n będą dowolnymi liczbami całkowitymi. Możemy teraz podać kompletną teorię równania ax + by = n. 2.2.1 Twierdzenie Brahmagupty-Bachet’a Zajmiemy się najpierw rozwiązaniami równania ax + by = n w liczbach całkowitych x, y. TWIERDZENIE 2.12 (Brahmagupta-Bachet) Niech a, b, n będą takimi liczbami cał- kowitymi, że istnieje d := NWD (a, b). Wówczas równanie ax + by = n (2.11) ma rozwiązania w liczbach całkowitych x, y wtedy i tylko wtedy, gdy d|n. Gdy ten warunek jest spełniony, to w s z y s t k i e r o z w i ą z a n i a tego równania dane są przez formuły x = nx0 − bt d , y = ny0 + at d , t ∈ Z, (2.12) gdzie para (x0, y0) jest jakimkolwiek rozwiązaniem równania ax + by = d. D O W Ó D. Wobec określenia ideału (a, b), zobacz (2.2), widzimy, że x, y ∈ Z spełniające równość ax + by = n istnieją wtedy i tylko wtedy, gdy n ∈ (a, b), czyli wtedy i tylko wtedy, gdy n ∈ (d), zobacz dowód T2.4, czyli wtedy i tylko wtedy, gdy d|n. Załóżmy więc, że d|n i oznaczmy n = dk, a = da′, b = db′. Niech x0, y0 będą takimi liczbami całkowitymi, że ax0 + by0 = d. Takie x0, y0 istnieją na mocy twierdzenia Gaussa- B´ezout’a T2.6 (można je, jak wiemy, wyznaczyć za pomocą algorytmu Euklidesa, zobacz U3 z ustępu 2.1.6). Mnożąc przez k znajdujemy a · kx0 + b · ky0 = n. (2.13) Załóżmy teraz, że para (x, y) jest jakimś (całkowitoliczbowym) rozwiązaniem, czyli, że zacho- dzi równość ax + by = n. Odejmując tę równość obustronnie od równości (2.13) i porządkując wyrazy, otrzymamy a(kx0 − x) + b(ky0 − y) = 0, czyli, po podzieleniu przez d: a′(kx0 − x) = b′(y − ky0). Ale, zobacz C2.12, NWD (a′, b′) = 1, więc, na mocy ZTA, b′|kx0 − x, czyli kx0 − x = b′t dla pewnego t ∈ Z. Stąd x = kx0 − b′t. Co daje y = ky0 + a′t. Udowodniliśmy więc równości (2.12). Z drugiej strony, sprawdzenie, że para (kx0 − b′t, ky0 + a′t) jest, dla każdego t ∈ Z, rozwiązaniem równania (2.11), jest natychmiastowe. □ Ćwiczenie 2.24 Rozwiązać w liczbach całkowitych równanie 13x + 21y = 511. Ćwiczenie 2.25 Rozwiązać równanie 21x − 9y + 16z = 7 w Z. Wskazówka. Ponieważ NWD (21, 16) = 1, więc równanie 21x + 16z = 7 + 9y ma rozwiązania d l a k a ż d e j liczby całkowitej y ∈ Z. Ćwiczenie 2.26 Rozwiązać równanie 6x + 15y − 10z = 26 w Z. Wskazówka. Wyznaczyć najpierw wszystkie z ∈ Z, dla których 3|26 + 10z. 2.2. Równanie ax + by = n 29 2.2.2 Twierdzenie Sylvestera Które liczby dadzą się przedstawić w postaci ax + by z n i e u j e m n y m i x, y? Częściowej odpowiedzi udzielił Sylvester. Załóżmy, że a, b są danymi liczbami n a t u r a l n y m i. Liczbę całkowitą n nazwiemy osiągalną, gdy istnieją takie liczby x, y ∈ Z⩾0, że n = ax + by. Liczba 0 jest, oczywiście, osiągalna, a liczby ujemne są, oczywiście, nieosiągalne. TWIERDZENIE 2.13 (Twierdzenie Sylvestera) Niech NWD (a, b) = 1. Wówczas: (1) moc zbioru liczb nieosiągalnych jest równa 1 2(a − 1)(b − 1); (2) największą liczbą nieosiągalną jest ab − a − b. D O W Ó D. Załóżmy, że a < b i ustawmy wszystkie liczby całkowite nieujemne w tablicy 0 1 2 . . . k . . . a − 1 a a + 1 a + 2 . . . a + k . . . 2a − 1 2a 2a + 1 2a + 2 . . . 2a + k . . . 3a − 1 ... ... ... ... ... ... ... (2.14) (1) Każda kolumna tej tablicy jest ciągiem arytmetycznym o różnicy a. Rozważmy liczby 0 · b, 1 · b, 2 · b, . . . , (a − 1) · b. (2.15) Wszystkie te liczby są, oczywiście, osiągalne i każda z nich stoi w i n n e j kolumnie tablicy (2.14). Gdyby bowiem sb i tb, przy pewnych 0 ⩽ s < t ⩽ a − 1, stały w tej samej kolumnie, to liczba tb − sb byłaby wielokrotnością a, co wobec nierówności t − s ⩽ a − 1 jest niemożliwe. Zatem, w każdej z kolumn o ”nagłówku” 0, 1, . . . , a − 1 stoi dokładnie jedna z liczb (2.15). Oznaczmy przez ykb liczbę z ciągu (2.15) stojącą w kolumnie o nagłówku k. Jasne, że wszystkie liczby stojące pod liczbą ykb w k-tej kolumnie są osiągalne. Nato- miast, wszystkie liczby k-tej kolumny stojące nad liczbą ykb są nieosiągalne. Aby to zobaczyć wystarczy (dlaczego?) udowodnić, że liczba stojąca tuż nad ykb, czyli liczba ykb − a, jest nieosiągalna. Załóżmy, nie wprost, że ykb − a jest osiągalna, czyli że ykb − a = ax + by dla pewnych x, y ∈ Z⩾0. Wtedy b(yk − y) = a(x + 1), co, dzięki ZTA i nieujemności x, daje yk − y = at > 0. To jednakże jest niemożliwe, bo y ⩾ 0, a yk ⩽ a − 1. Wobec tego liczba liczb nieosiągalnych w k-tej kolumnie wynosi ⌊ ykb a ⌋ = ykb − k a . Ostatecznie, moc zbioru liczb nieosiągalnych wynosi a−1∑ k=0 ykb − k a = b a a−1∑ k=0 yk − 1 a a−1∑ k=0 k = (a − 1)(b − 1) 2 . (2) Największa nieosiągalna liczba stoi w pewnej kolumnie tablicy (2.14) tuż nad liczbą (a − 1)b. Jest to więc liczba (a − 1)b − a. □ W poniższym zadaniu pokażemy pewien rodzaj wzajemności uzupełniający naszą wiedzę na temat liczb osiągalnych (i nieosiągalnych): 30 2. Elementarz ZADANIE 2.5 Niech, jak wyżej, a, b ∈ N > 0 i a ⊥ b. Udowodnić, że liczba n ∈ Z jest osiągalna wtedy i tylko wtedy, gdy liczba I(n) := ab − a − b − n jest nieosiągalna. R o z w i ą z a n i e. Używamy oznaczeń i założeń z dowodu T2.13. Załóżmy, że liczba n stoi w k-tej kolumnie tablicy (2.14) rozszerzonej w górę do −∞. Wtedy, jak wiemy, n = ykb + sa dla pewnego s ∈ Z. Przy czym n jest osiągalna wtedy i tylko wtedy, gdy s ⩾ 0. Przy tych oznaczeniach mamy: I(n) = ab − a − b − ykb − sa = (a − 1 − yk)b − (s + 1)a = ylb − (s + 1)a. Liczba (a − 1 − yk)b jest jedną z liczb ciągu (2.15), bo 0 ⩽ yk ⩽ a − 1. Oznaczyliśmy ją więc ylb. Wobec tego I(n) jest nieosiągalna wtedy i tylko wtedy, gdy −(s + 1) < 0, czyli wtedy i tylko wtedy, gdy s ⩾ 0, czyli wtedy i tylko wtedy, gdy n jest liczbą osiągalną. ♦ Ćwiczenie 2.27 Wskazać najmniejszą liczbę naturalną dającą się przedstawić na cztery różne sposoby w postaci 5x + 6y przy x, y ∈ N. Ćwiczenie 2.28 Niech a, b będą względnie pierwszymi liczbami naturalnymi. Udowodnić, że liczba nieujemnych rozwiązań równania ax + by = n równa jest ⌊ n ab⌋ lub ⌊ n ab⌋ + 1. Ćwiczenie 2.29 W pewnej grze można zdobyć a lub b punktów w jednym ”rozdaniu” (a, b ∈ N, a > b). Wynik gry po pewnej liczbie rozdań jest sumą zdobytych punktów. Zauwa- żono, że nie można osiągnąć wyniku 58 punktów, oraz że jeszcze dokładnie 34 inne wyniki są w tej grze nieosiągalne. Wyznaczyć a i b. Ćwiczenie 2.30 Mamy do dyspozycji cegły o wymiarach 6 × 14 × 21. Możemy, kładąc je jedną na drugiej (”leżąco”, ”na sztorc” i ”stojąco”), budować ”wieże”. Wyznaczyć taką n a j m n i e j s z ą liczbę G ∈ N, że da się zbudować wieże k a ż d e j wysokości ⩾ G. U w a g a. Frobenius postawił p r o b l e m ogólniejszy: Dane są względnie pierwsze liczby naturalne a1, . . . , ak. Znaleźć taką najmniejszą liczbę całkowitą G = G(a1, . . . , ak), że każdą liczbę całkowitą m ⩾ G można przedstawić w postaci a1x1 + a2x2 + · · · + akxk, gdzie liczby x1, . . . , xk są całkowite i nieujemne. Z T2.13(2) wiemy, że G(a, b) = (a − 1)(b − 1). Ła- two(?!) dowieść, że dla dowolnych względnie pierwszych liczb naturalnych a1, . . . , ak liczba Frobeniusa G(a1, a2, . . . , ak) i s t n i e j e. Ćwiczenie 2.31 Udowodnić, że zachodzi szacowanie G(a, b, c) ⩽ D + (d − 1)(a − 1), gdzie d = NWD (b, c), D = d ( b d − 1 ) ( c d − 1 ). ZADANIE 2.6 Niech a, b, c ∈ N i NWD (a, b) = NWD (b, c) = NWD (c, a) = 1. Udo- wodnić, że G(ab, bc, ca) = 2abc − ab − bc − ca. R o z w i ą z a n i e. Niech bcx + cay + abz = 2abc − ab − bc − ca dla pewnych x, y, z ∈ Z⩾0, czyli 2abc = bc(x + 1) + ca(y + 1) + ab(z + 1). Stąd, na mocy Zasady Podstawowej, a|bc(x + 1), b|ca(y + 1), c|ab(z + 1). Więc, na mocy ZTA, a|x + 1, b|y + 1 i c|z + 1. Przeto, na mocy C2.2, a ⩽ x + 1, b ⩽ y + 1 i c ⩽ z + 1. Wobec tego 2abc = bc(x + 1) + ca(y + 1) + ab(z + 1) ⩾ bca+cab+abc = 3abc. Sprzeczność. Niech teraz m > 2abc−ab−bc−ca. Weźmy taką j e d y n ą liczbę z ∈ Z, dla której c|m−abz i 0 ⩽ z < c (dla dowodu istnienia takiej liczby z, rozważmy c liczb m, m − ab, m − 2ab, . . . , m − (c − 1)ab i zauważmy, że każda z nich daje i n n ą resztę z dzielenia przez c). Dla tej liczby z mamy więc cn := m − abz > 2abc − ab − bc − ca − abz ⩾ 2abc − ab − bc − ca − ab(c − 1) = c(ab − b − a). Stąd n > ab − b − a, więc, na mocy Z2.5, istnieją x, y ∈ Z⩾0, dla których n = bx + ay. Ostatecznie m = cn + abz = bcx + cay + abz. ♦ 2.3. Liczby pierwsze 31 2.3 Liczby pierwsze Liczby pierwsze są elementarnymi cegiełkami, z których zbudowane są (multyplikatywnie) liczby naturalne, zobacz T2.16. To jest podstawowy powód, dla którego interesujemy się nimi. 2.3.1 Istnienie i jednoznaczność rozkładu na czynniki pierwsze W matematyce szkolnej deﬁniujemy liczbę pierwszą jako taką liczbę naturalną większa od 1, która dzieli się tylko przez 1 i przez samą siebie. Deﬁnicja D2.7 jest równoważna z tą szkolną. W praktyce olimpijskiej znacznie częściej używa się c h a r a k t e r y z a c j i liczb pierwszych po- kazanej w T2.15. Deﬁnicja 2.7 Liczbę naturalną p nazywamy liczbą pierwszą, gdy zbiór D(p) jej dziel- ników całkowitych ma dokładnie cztery elementy: D(p) = {1, −1, p, −p}. Zbiór liczb pierw- szych oznaczamy symbolem P. Różną od 1 liczbę naturalną nazywamy liczbą złożoną, gdy nie jest liczbą pierwszą. (Liczba 1 nie jest ani pierwsza ani złożona!) Czytelnik powinien bezwzględnie rozwiązać dwa proste ćwiczenia: Ćwiczenie 2.32 Jeżeli p jest liczbą pierwszą, to, dla danej liczby całkowitej a, albo p|a albo NWD (p, a) = 1. Ćwiczenie 2.33 Udowodnić, że liczba naturalna n jest liczbą złożoną wtedy i tylko wtedy, gdy istnieją takie liczby całkowite a, b, że 1 < a, b < n oraz n = ab. Równoważnie, wtedy i tylko wtedy, gdy liczba n ma dzielnik właściwy, czyli gdy istnieje a ∈ D(n) spełniające warunek 1 < a < n. Możemy teraz naprawić jeden z podstawowych niedostatków matematyki szkolnej: udo- wodnimy mianowicie twierdzenie o istnieniu i jednoznaczności rozkładu liczb naturalnych na iloczyn liczb pierwszych. W dowodzie i s t n i e n i a rozkładu liczb naturalnych na iloczyn liczb pierwszych wykorzystamy następujące podstawowe: TWIERDZENIE 2.14 Każda liczba naturalna n > 1 dzieli się przez pewną liczbę pierwszą. D O W Ó D. Z a ł ó ż m y, że nie. Wówczas, na mocy Zasady Minimum, istnieje najmniejsza liczba naturalna n0 > 1 nie dzieląca się przez ż a d n ą liczbę pierwszą. Liczba n0 nie jest liczbą pierwszą, gdyż dzieli się przez siebie. Jest więc liczbą złożoną. Zatem, zobacz C2.33, n0 = kl dla pewnych 1 < k, l < n0. Liczba k, jako mniejsza od n0, ale większa od 1, ma dzielnik pierwszy p. Ten dzielnik p dzieli również n0, zobacz T2.1(2). S p r z e c z n o ś ć. □ W dowodzie jednoznaczności rozkładu (i w ogóle w teorii liczb) wykorzystujemy następującą charakteryzację liczb pierwszych: TWIERDZENIE 2.15 Liczba naturalna p ̸= 1 jest liczbą pierwszą w t e d y i t y l k o w t e d y, g d y dla dowolnych liczb całkowitych a, b zachodzi p|ab =⇒ p|a lub p|b. (2.16) 32 2. Elementarz D O W Ó D. (=⇒) Niech p będzie liczbą pierwszą, niech p|ab i niech p ∤ a. Wówczas, na mocy C2.32, NWD (p, a) = 1, więc, na mocy ZTA, p|b. (⇐=) Jeżeli p n i e jest liczbą pierwszą, to, zobacz C2.33, p = ab, gdzie 1 < a, b < p. Wtedy p|ab, ale p ∤ a i p ∤ b. Zatem p n i e spełnia warunku (2.16). □ Ćwiczenie 2.34 Udowodnić przez indukcję, że jeżeli liczba pierwsza p jest dzielnikiem iloczynu a1a2 · . . . · as liczb całkowitych, to jest dzielnikiem co najmniej jednego z czynników tego iloczynu. TWIERDZENIE 2.16 (Twierdzenie o jednoznaczności rozkładu w N) Każda liczba naturalna n > 1 da się w jeden i tylko jeden, z dokładnością do porządku czynników, sposób zapisać w postaci iloczynu liczb pierwszych n = p1p2p3 · . . . · ps. (2.17) D O W Ó D. I s t n i e n i e takiego przedstawienia jest natychmiastowym wnioskiem z zasady minimum i T2.14. Istotnie, załóżmy nie wprost, że istnieją liczby naturalne nie dające się zapisać w postaci (2.17) i oznaczmy przez m najmniejszą taką liczbę. Przedstawiamy ją (dzięki T2.14 wiemy, że jest to możliwe) w postaci iloczynu m = p1n, gdzie p1 jest liczbą pierwszą, a n liczbą naturalną. Wówczas, jeżeli n = 1, to mamy sprzeczność, bo równość m = p1 daje zapis postaci (2.17). Jeżeli zaś n > 1, to n < m i, wobec minimalności liczby m, możemy napisać równość n = p2 · . . . · ps, gdzie pi są liczbami pierwszymi. Zatem m = p1n = p1p2 · . . . · ps. I znowu mamy sprzeczność. Zajmiemy się teraz j e d n o z n a c z n o ś c i ą. Załóżmy nie wprost, że istnieją liczby naturalne mające istotnie różne rozkłady na iloczyn liczb pierwszych i że m jest najmniejszą taką liczbą: m = p1p2 · . . . · ps = q1q2 · . . . · qt. (2.18) Ponieważ p1|m czyli p1|q1q2 · . . . · qt więc, na mocy C2.34, p1|qr dla pewnego 1 ⩽ r ⩽ t. Przenumerowując możemy uznać, że r = 1. Jasne, że wówczas p1 = q1. Ponieważ liczba m p1 = m q1 = p2 · . . . · ps = q2 · . . . · qt jest mniejsza niż m, więc ma tylko jedno, z dokładnością do porządku czynników, przedstawienie w postaci iloczynu liczb pierwszych. Stąd t = s i, po ewentualnym dalszym przenumerowaniu, p2 = q2, . . . , ps = qs. To jest jednakże sprzeczne z założeniem, że rozkłady (2.18) są istotnie różne. □ 2.3.2 Sito Eratostenesa. Twierdzenie Euklidesa Z twierdzenia T2.14 wynika, że zbiór P liczb pierwszych jest n i e p u s t y. Na przykład 2 jest liczbą pierwszą. W tym ustępie pokażemy najpierw metodę (algorytm) wyznaczania w s z y s t k i c h liczb pierwszych niewiększych niż dana liczba n ∈ N. Następnie udowodnimy (na cztery sposoby), że zbiór P jest zbiorem nieskończonym. Już w starożytności wymyślono prosty algorytm wyznaczania wszystkich liczb pierwszych mniejszych niż dana liczba naturalna n. Nazywamy go sitem Eratostenesa 1. 1Eratostenes nie wymyślił tego sita. Znalazł je w Elementach swojego poprzednika na stanowisku ”dyrek- tora” Biblioteki Aleksandryjskiej, Euklidesa. Wyznaczył za to promień Ziemi (zdumiewająco dokładnie), dzięki czemu, korzystając z pomysłów Anaksagorasa i Arystarcha, mógł wyznaczyć promienie Księżyca (wcale dokład- nie) i Słońca (ze znacznym błędem), a także odległości Ziemia-Księżyc (całkiem poprawnie) i Ziemia-Słońce (z dwudziestokrotnym błędem). 2.3. Liczby pierwsze 33 Polega on na tym, że mając wypisany ciąg kolejnych liczb naturalnych od 2 do n, ota- czamy kółkiem liczbę 2, a następnie skreślamy (czysto automatycznie, czyli po prostu co drugą) jej właściwe wielokrotności: 4, 6, 8, itd. Pierwszą nieskreśloną liczbą jest 3. Otaczamy ją kółkiem, a następnie skreślamy jej właściwe wielokrotności 6, 9, 12, itd. Teraz pierwszą nie- skreśloną liczbą jest 5 (zobacz rysunek), więc otaczamy ją kółkiem, skreślamy jej właściwe wielokrotności. Itd. Robimy to tak długo dopóki nie natraﬁmy na pierwszą nieskreśloną liczbę większą niż √ n. Wówczas liczby otoczone kółkiem i nieskreślone są (wszystkimi!) liczbami pierwszymi z przedziału [ 2; n ]. 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 25 26 27 28 29 30 21 22 23 24 31 32 33 34 35 36 37 38 39 40 4241 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 Ćwiczenie 2.35 Udowodnić, że jeżeli n > 1 jest liczbą złożoną, to istnieje taki dzielnik pierwszy p liczby n, że p ⩽ √n. Wywnioskować stąd poprawność sita Eratostenesa. Na powyższym rysunku widzimy jak, po czterech (bo √100 < 11) krokach, odnaleźliśmy wszystkie dwadzieścia pięć liczb pierwszych ⩽ 100. Jednak ciągle jeszcze nie wiemy czy zbiór P jest skończony czy nie. Mamy więc niespodziankę: TWIERDZENIE EUKLIDESA Zbiór P liczb pierwszych n i e jest zbiorem skończonym. P I E R W S Z Y D O W Ó D. (wg. Euklidesa) Załóżmy, że A = {q1, q2, . . . , qs} ⊆ P jest s k o ń c z o n y m (niepustym) podzbiorem. Rozważmy liczbę naturalną m = 1 + q1q2 · . . . · qs. Liczba ta, jako większa od 1, dzieli się przez jakąś liczbę pierwszą q ∈ P. Ponieważ żadna liczba pierwsza qi ∈ A nie dzieli m, więc q /∈ A. Przeto A ̸= P. Czyli: ż a d e n s k o ń c z o n y zbiór nie jest równy P. [Trudno się nie zachwycić urodą 2 tego rozumowania!] □ D R U G I D O W Ó D. (wg. Goldbacha 3 i Pólya’i) Niech qn oznacza dowolny (na przykład najmniejszy) dzielnik pierwszy n-tej liczby Fermat’a Fn, zobacz Z2.2. Względna pierwszość różnych liczb Fermata dowodzi, że qn ̸= qm dla n ̸= m. □ T R Z E C I D O W Ó D. (wg. Eulera – szkic) Załóżmy, nie wprost, że p1, p2, . . . , ps są w s z y s t k i m i liczbami pierwszymi. Wówczas iloczyn s∏ i=1 ( 1 + 1 pi + 1 p2 i + 1 p3 i + . . . ) 2W pięknej książeczce [ 8 ] czytamy takie zdanie: Nie wiadomo, co bardziej podziwiać w tym miejscu u Eukli- desa; czy to, że greccy matematycy stawiali sobie w ogóle takie pytania, same dla siebie, z wewnętrznej potrzeby myślenia matematycznego, jakiej nie spotykamy u wcześniejszych narodów i którą też wszystkie późniejsze narody przejęły wprost od Greków; czy to, że postawili sobie właśnie to pytanie, które naiwny obserwator może łatwo przeoczyć, uważać za zbędne, trywialne i którego trudność ten dopiero zauważy, kto starał się bezskutecznie zna- leźć w ciągu liczb pierwszych proste prawo, które gwarantowałoby możliwość nieograniczonego posuwania się w tym ciągu naprzód; czy to wreszcie, że umieli oni ominąć brak takiego prawa przez kunsztowny dowód, z którym dopiero co zapoznaliśmy się. 3Christian Goldbach jest najbardziej znany jako autor słynnej (nie udowodnionej do dzisiaj) tak zwanej hipotezy Goldbacha, według której każda liczba parzysta ⩾ 4 jest sumą dwóch liczb pierwszych. 34 2. Elementarz jest, z jednej strony, równy l i c z b i e ∏s i=1 1 1− 1 pi , z drugiej zaś (dzięki istnieniu i jednoznaczności rozkładu mianowników n na czynniki pierwsze), ∑ n⩾1 1 n . Ale, zobacz twierdzenie T12.5,∑ n⩾1 1 n = ∞. S p r z e c z n o ś ć. □ C Z W A R T Y D O W Ó D. (wg. Erd˝osa) Niech n ⩾ 2 będzie dowolną liczbą natu- ralną. Niech s = π(n) oznacza ilość liczb pierwszych niewiększych niż n. Oznaczmy przez p1, p2, . . . , ps wszystkie liczby pierwsze z przedziału [ 1; n ]. Każdą liczbę naturalną m ⩽ n przedstawiamy, na mocy ćwiczenia C2.36, jednoznacznie w postaci m = k · a2 = (pe1 1 pe2 2 · . . . · pes s ) · a2, (2.19) gdzie ei = 0 lub 1, bo k jest bezkwadratowa. Policzmy ile (co najwyżej) istnieje iloczynów (2.19). Ponieważ wykładniki ei mogą przyjmować wartości 0 lub 1, więc możliwych czynników k jest co najwyżej 2 s. Możliwych zaś czynników a2 jest co najwyżej √ n. Zatem n ⩽ 2 s√n. Stąd, po zlogarytmowaniu, dostajemy 1 2 log n ⩽ s log 2, czyli π(n) ⩾ log n 2 log 2. (2.20) Ponieważ funkcja C log n rośnie do nieskończoności (przy C > 0 i n → ∞), więc zbiór P jest zbiorem nieskończonym. □ Ćwiczenie 2.36 Liczbę naturalną k nazywamy bezkwadratową, gdy nie dzieli się przez kwadrat żadnej liczby pierwszej. Dowieść, że każdą niezerową liczbę całkowitą m da się na j e d e n i t y l k o j e d e n s p o s ó b zapisać w postaci iloczynu m = ka2, gdzie k jest liczbą bezkwadratową. Ćwiczenie 2.37 Udowodnić, że jeżeli najmniejszy dzielnik pierwszy p liczby naturalnej n jest większy niż 3√n, to liczba n/p jest liczbą pierwszą lub jedynką. 2.3.3 Kilka pytań dotyczących liczb pierwszych Z twierdzenia Euklidesa wiemy, że ciąg: p1 = 2, p2 = 3, p3 = 5, . . . , p25 = 97, . . . , p168 = 997, . . . , p305 = 2011, . . . (2.21) (zobacz naszą tabelkę liczb pierwszych na stronie vi), którego n-tym wyrazem jest n-ta (w kolejności rosnącej) liczba pierwsza, jest ciągiem n i e s k o ń c z o n y m. Jest to ciąg bardzo ”nieregularny”: n i e z n a m y żadnego sensownego wzoru na n-ty wyraz tego ciągu. To znaczy, nie znamy żadnej takiej funkcji elementarnej (wielomianu, funkcji wymiernej, wykładniczej czy ich złożeń) f , że f (n) = pn. Nie znamy też żadnej takiej niestałej funkcji elementarnej g, że g(n) ∈ P dla wszystkich n ∈ N. Można zadać nieskończenie wiele pytań na temat ciągu (2.21). Powiemy tu o paru takich pytaniach. P r z y k ł a d 1. W ciągu (pn) są dowolnie duże ”dziury”, czyli, dla dowolnie dużej liczby N istnieje taki indeks n, że pn+1 − pn ⩾ N . Rzeczywiście, ponieważ k o l e j n e liczby N ! + 2, N ! + 3, N ! + 4, . . . , N ! + N 2.3. Liczby pierwsze 35 wszystkie są złożone, więc największy taki indeks n, że pn ⩽ N ! + 1, jest oczywiście dobry. Z drugiej strony, zdarzają się najmniejsze możliwe ”dziury”. To znaczy, istnieją takie indeksy n, że pn+1 − pn = 2. Pary {p, p + 2} liczb pierwszych nazywamy parami liczb pierwszych bliźniaczych. Para 3 756 801 695 685 · 2 666 669 ± 1 jest największą znaną (koniec 2013) parą liczb pierwszych bliźniaczych. N i e wiadomo czy takich ”bliźniaków” jest nieskończenie wiele. Zobacz też 12.3.2 U2. ♦ P r z y k ł a d 2. Euler zwrócił uwagę świata na wielomian E(X) = X 2 + X + 41, który dla x = 0, 1, 2, . . . , 40 przyjmuje wartości będące liczbami pierwszymi (sprawdźcie!). [Ta interesująca własność wielomianu E(X) jest ściśle związana z faktem, że pierścień kwa- dratowy Z[τ−163] jest dig’iem, zobacz T10.10.] Oczywiście 41|E(41) i 41 < E(41), więc E(41) jest liczbą z ł o ż o n ą. Nie ma w tym nic nadzwyczajnego: w Z5.3 pokazujemy, że jeżeli f (X) = a0 + a1X + · · · + anX n jest wielomianem stopnia ⩾ 1 o współczynnikach całkowitych, to wartości |f (x)| n i e mogą być liczbami pierwszymi dla wszystkich x ∈ Z. ♦ Ćwiczenie 2.38 Udowodnić, że jeżeli liczba naturalna, której wszystkie cyfry (w dowolnym systemie pozycyjnym) są jedynkami, jest liczbą pierwszą, to liczba tych cyfr jest liczbą pierwszą (ale nie na odwrót, na przykład (111)7 dzieli się przez 19 = (25)7). U w a g a 1. Wśród liczb trzycyfrowych (111)m = m2 +m+1, przy 2 ⩽ m ⩽ 44, występuje, jak to można sprawdzić posługując się naszą tabelką liczb pierwszych, dokładnie 16 liczb pierwszych. Wielomian X 2 + X + 1 przyjmuje więc (dla argumentów całkowitych) dosyć ”chętnie” wartości będące liczbami pierwszymi. Nie wiadomo jednak czy ”robi” to nieskończenie wiele razy. Podobnie ma się rzecz z wielomianem X 2 + 1. Wielomiany (jednej zmiennej) nie ”chcą” dawać samych wartości będących liczbami pierw- szymi. Próbowano więc szukać liczb pierwszych w postaci wykładniczej. P r z y k ł a d 3. Rozważmy liczby Mersenne’a Mn = 2 n − 1. Liczba Mn na pewno jest liczbą złożoną, gdy n jest liczbą złożoną. To wynika z tożsamości ”nieśmiertelnej” (1.8). Rzeczywiście, jeżeli n = ab, gdzie a, b ⩾ 2, to mamy rozkład Mn = 2 ab − 1 = (2a − 1)((2 a) b−1 + (2a) b−2 + · · · + 2a + 1), i oba czynniki są ⩾ 2. Jeżeli n = p jest liczbą pierwszą, to takiego (systemowego) rozkładu nie ma. Więc jest szansa na pierwszość liczby Mp. Na przykład M2 = 3, M3 = 7, M5 = 31, M7 = 127 są liczbami pierwszymi. Ale już M11 = 23 · 89. Liczby Mp będące liczbami pierwszymi nazywamy liczbami pierwszymi Mersenne’a. Nie wiadomo czy jest ich nieskończenie wiele. Do dzisiaj (maj 2017 roku) znamy tylko 49 liczb pierwszych Mersenne’a. N a j w i ę k s z ą z nich jest M74 207 281. Nie wiadomo również czy istnieje nieskończenie wiele liczb złożonych Mersenne’a, chociaż wydaje się to bardzo prawdopodobnym. Na przykład, wśród początkowych 50 000 liczb Mn występuje t y l k o 27 liczb pierwszych (największą z nich jest M44 497). Pewną metodę sprawdzania złożoności liczb Mp poznamy w rozdziale 5, zobacz 5.7.8 U2. ♦ Jeszcze ”gorzej” ma się sprawa z liczbami Vn := 2 n + 1: Ćwiczenie 2.39 Udowodnić, że jeżeli 2 n + 1 ∈ P, to n = 2 k dla pewnego k ∈ N. 36 2. Elementarz P r z y k ł a d 4. Liczby V2k oznaczamy Fk i nazywamy liczbami Fermat’a, zobacz Z2.2. Fermat sądził, że wszystkie liczby Fk są liczbami pierwszymi. Nietrudno(?) to sprawdzić dla k = 0, 1, 2, 3 i 4: F0 = 3, F1 = 5, F2 = 17, F3 = 257, F4 = 65 537. Niemałym zaskoczeniem okazał się, udowodniony przez Eulera4, F a k t: 641|F5. Można go uzasadnić następująco: Mamy równość F5 = 2 32 + 1 = 2 28(5 4 + 24) − (5 · 2 7) 4 + 1 = 2 28 · 641 − (640 4 − 1). Wystarczy teraz przywołać tożsamość x4 − 1 = (x + 1)(x − 1)(x2 + 1) i położyć x = 640. Warto wiedzieć, że od czasów Eulera znaleziono (skończenie!) wiele złożonych liczb Fermat’a i a n i j e d n e j, poza F0, F1, F2, F3 i F4, liczby pierwszej Fermat’a. Wspomnimy jeszcze, że największą liczbą Fermat’a, o której udowodniono, że jest liczbą z ł o ż o n ą, jest F3 329 780. Jej dzielnikiem jest liczba pierwsza(!) 386 · 2 3 329 781 + 1 (lipiec 2014). Porównaj Z5.15. ♦ Ćwiczenie 2.40 Udowodnić, że jeżeli k ∈ N, to liczba Fk + Fk−1 − 1 ma co najmniej k różnych dzielników pierwszych. Wskazówka. Zastosować rozumowanie indukcyjne z wykorzy- staniem tożsamości x4 + x2 + 1 = (x2 + 1 − x)(x2 + 1 + x). 2.4 Wykładniki p-adyczne Na zbiorze niezerowych liczb wymiernych działają funkcje vp wykładników p-adycznych. Funk- cji vp jest nieskończenie wiele (tyle ile jest liczb pierwszych). Dostarczają one wygodnego spo- sobu myślenia o podzielności w pierścieniu Z. Warto więc poznać najprostsze ich własności. 2.4.1 Deﬁnicje. Formuła Legendre’a Zdeﬁniujemy najpierw funkcje vp na zbiorze liczb całkowitych, a następnie rozszerzymy ich dziedzinę do zbioru liczb wymiernych. Deﬁnicja 2.8 Jeżeli p jest liczbą pierwszą, a c ̸= 0 jest liczbą całkowitą, to symbolem vp(c) oznaczamy największą liczbę całkowitą k, dla której pk|c. Kładziemy też vp(0) = +∞. Liczbę vp(c) nazywamy wykładnikiem p-adycznym liczby c ∈ Z. Jeżeli m jest niezerową liczbą całkowitą, to biorąc rozkład (2.17) liczby |m| i grupując ewentualne powtarzające się takie same czynniki w potęgę, dostajemy tak zwany kanoniczny rozkład liczby całkowitej na iloczyn liczb pierwszych m = ±pe1 1 pe2 2 · . . . · pes s . (RK) Przy takim zapisie rozumiemy, że występujące w nim liczby pierwsze pi są p a r a m i r ó ż n e. Jasne, że wykładnik ei, z jakim występuje liczba pierwsza pi w kanonicznym rozkładzie (RK) liczby naturalnej |m| na czynniki pierwsze, jest równy wykładnikowi pi-adycznemu liczby m. Kanoniczny rozkład liczby naturalnej n na czynniki pierwsze możemy więc zapisać: n = ∏ p pvp(n), 4Napisał wtedy z dumą: 2 32 + 1 non esse primum inveni, sed divisibilem per numeri 641 2.4. Wykładniki p-adyczne 37 gdzie iloczyn rozciąga się na w s z y s t k i e liczby pierwsze, ale p r a w i e w s z y s t k i e czynniki są równe 1. Zwrot prawie wszystkie znaczy: wszystkie z wyjątkiem skończenie wielu. Ćwiczenie 2.41 Udowodnić, że a|b wtedy i tylko wtedy, gdy vp(a) ⩽ vp(b) dla każdej liczby pierwszej p. Ćwiczenie 2.42 Udowodnić, że dodatnia liczba d jest równa NWD (a, b) wtedy i tylko wtedy, gdy vp(d) = min {vp(a), vp(b)} dla każdej liczby pierwszej p. Analogicznie dla naj- mniejszej wspólnej wielokrotności: vp(NWW (a, b)) = max {vp(a), vp(b)}. Ćwiczenie 2.43 Ustalmy liczbę pierwszą p. Udowodnić, że funkcja vp ma własności: 1. vp(ab) = vp(a) + vp(b), 2. vp(a + b) ⩾ min {vp(a), vp(b)} (przy tym, gdy vp(a) ̸= vp(b), to zachodzi równość). Ćwiczenie 2.44 Liczba naturalna a jest n-tą potęgą liczby naturalnej wtedy i tylko wtedy, gdy n|vp(a) dla każdej liczby pierwszej p. Udowodnić. ZADANIE 2.7 Liczby naturalne a i b są takie, że an|bn+1 dla każdej liczby naturalnej n. Udowodnić, że a|b. R o z w i ą z a n i e. Niech p będzie dowolną liczbą pierwszą. Mamy wykazać, że k ⩽ l, gdzie k = vp(a), l = vp(b). Z założenia i C2.41 wiemy, że nk ⩽ (n + 1)l dla każdej liczby naturalnej n. Załóżmy, nie wprost, że k > l i połóżmy k = l + r, r ⩾ 1. Wówczas, na mocy nierówności nk ⩽ (n + 1)l, mamy n(l + r) ⩽ (n + 1)l, skąd n ⩽ nr ⩽ l dla każdego n ∈ N. Ta, oczywista, s p r z e c z n o ś ć kończy rozwiązanie. ♦ Ćwiczenie 2.45 (1) Obliczyć ∑1000 k=1 v2(k). (2) Rozłożyć na czynniki pierwsze liczbę 20!. Po rozwiązaniu tego ćwiczenia z łatwością udowodnimy poniższe twierdzenie: TWIERDZENIE 2.17 (Legendre) Wykładnik p-adyczny liczby n! (silnia) wynosi vp(n!) = ⌊ n p ⌋ + ⌊ n p2 ⌋ + ⌊ n p3 ⌋ + . . . + ⌊ n pk ⌋ , gdzie k jest taką liczbą naturalną, że pk ⩽ n < p k+1. □ Ćwiczenie 2.46 Dowieść, że 2 n ∤ n! dla n ∈ N. Wyznaczyć zbiór {n ∈ N : 2n−1|n!}. Funkcja vp wykładnika p-adycznego, określona wyjściowo na zbiorze Z liczb całkowitych, może być rozszerzona do funkcji vp : Q −→ Z ∪ {+∞} za pomocą równości: vp (a b ) = vp(a) − vp(b) oraz vp(0) = +∞. 38 2. Elementarz Ćwiczenie 2.47 Udowodnić, że to określenie jest poprawne (to znaczy, że nie zależy od przedstawienia liczby wymiernej w postaci ułamka) oraz że funkcja vp ma własności: 1. vp(xy) = vp(x) + vp(y), 2. vp(x + y) ⩾ min {vp(x), vp(y)} (przy tym, gdy vp(x) ̸= vp(y), to zachodzi równość). Ćwiczenie 2.48 Udowodnić, że liczba wymierna x jest liczbą całkowitą wtedy i tylko wtedy, gdy vp(x) ⩾ 0 dla każdej liczby pierwszej p. Ćwiczenie 2.49 Podać czysto arytmetyczny (to znaczy bez wykorzystywania interpretacji kombinatorycznej) dowód faktu, że liczba (n k) = n! k!(n−k)! jest liczbą całkowitą dla dowolnych liczb całkowitych 0 ⩽ k ⩽ n. Wskazówka. 0! = 1. W razie potrzeby zobacz C12.1.5. Ćwiczenie 2.50 Udowodnić, że jeżeli p jest liczbą pierwszą, s jest dowolną liczbą natu- ralną, a 1 ⩽ k ⩽ ps − 1, to p dzieli (ps k ) . Wskazówka. Zobacz Z12.11. U w a g a. Określona na zbiorze Q funkcja vp przyjmuje wartości w zbiorze Z ∪ {+∞}, gdzie +∞ jest d o d a t k o w y m elementem (n i e liczbą!) spełniającym wymagania: (+∞) + k = +∞, (+∞) + (∞) = +∞ oraz + ∞ > k dla dowolnej liczby całkowitej k. 2.4.2 Lemat o zwiększaniu wykładnika p-adycznego Zastanowimy się nad zależnością wykładnika p-adycznego vp(xk ±yk) liczb całkowitych postaci xk ± yk od wykładników p-adycznych vp(x ± y) i vp(k). Wprowadzimy wygodne oznaczenie: Qk(x, y) = xk−1+xk−2y+· · ·+xyk−2+yk−1. Tożsamość ”nieśmiertelna” (zob. (1.8)) pisze się więc tak: xk − yk = (x − y)Qk(x, y) (2.22) Jeżeli x, y są liczbami całkowitymi, to ta równość i teza ćwiczenia C2.43.1 pokazują, że vp(xk − yk) = vp(x − y) + vp(Qk(x, y)). Widzimy stąd, że wykładnik p-adyczny liczby xk − yk jest n i e m n i e j s z y od wykładnika p-adycznego liczby x − y. Głównym morałem płynącym z tego ustępu jest fakt, że, przy pewnych dodatkowych założeniach, mamy pełną kontrolę nad przyrostem vp(xk − yk) − vp(x − y) = vp(Qk(x, y)). W dowodzie tego wyniku wykorzystamy tezy poniższych dwóch zadań. ZADANIE 2.8 Dana jest liczba pierwsza p i liczby całkowite x, y. Udowodnić, że jeżeli vp(xy) = 0, vp(x − y) ⩾ 1 i p ∤ k, to zachodzi równość vp(xk − yk) = vp(x − y). (2.23) R o z w i ą z a n i e. Wobec równości (2.22) wystarczy udowodnić, że p ∤ Qk(x, y). Założenie vp(x − y) ⩾ 1 zapisujemy w postaci: x = y + pc, dla pewnego c ∈ Z. Mamy wtedy Qk(x, y) = (y + pc) k−1 + (y + pc)k−2y + · · · + (y + pc)yk−2 + yk−1. Występujące tu czynniki (y + pc)s, dzięki równości dwumiennej (1.7), zapisujemy w postaci ys + pC, gdzie C ∈ Z. Stąd, po uporządkowaniu, Qk(x, y) = kyk−1 + pD dla pewnego D ∈ Z. Jasne, że to kończy dowód równości (2.23). Bowiem p ∤ k i p ∤ y. ♦ 2.4. Wykładniki p-adyczne 39 ZADANIE 2.9 Dana jest liczba pierwsza n i e p a r z y s t a p i liczby całkowite x, y. Udo- wodnić, że jeżeli vp(xy) = 0 i vp(x − y) ⩾ 1, to dla dowolnego s ∈ N zachodzi równość vp(xsp − ysp) = vp(xs − ys) + 1. (2.24) R o z w i ą z a n i e. Rozważamy najpierw przypadek s = 1. Teza jest wówczas równoważna d w ó m faktom: p|Qp(x, y) oraz p2 ∤ Qp(x, y). Dla ich dowodu postępujemy tak jak wyżej z tą różnicą, że wykorzystujemy wzór dwumienny ”z dokładnością do wyrazów kwadratowych”: (y + pc) s = ys + (s 1 )pcys−1 + p2A = ys + spcys−1 + p2A. Dostaniemy wówczas Qp(x, y) = pyp−1 + [(p − 1) + (p − 2) + · · · + 1 + 0] pcyp−2 + p2B. Ponieważ suma 0 + 1 + · · · + (p − 1) jest równa 1 2(p − 1)p (zob. 1.1.2 P), więc j e s t liczbą podzielną przez p (tutaj jest w a ż n a nieparzystość liczby p). Wobec tego mamy Qp(x, y) = pyp−1 + p2 [ p−1 2 cyp−2 + B]. Stąd widać prawdziwość obu faktów. Bowiem p ∤ y. Przypadek dowolnego s ∈ N sprowadza się do rozważonego: kładziemy x1 = xs, y1 = ys i sprawdzamy założenia vp(x1y1) = 0 oraz vp(x1 − y1) ⩾ 1. Drugie jest spełnione, bowiem vp(x1 − y1) = vp((x − y)Qs(a, b)) = vp(x − y) + vp(Qs(x, y)) ⩾ vp(x − y) ⩾ 1, a pierwsze jest spełnione, bowiem vp(x1y1) = svp(xy) = 0. To kończy rozwiązanie. ♦ W twierdzeniu T2.18, które nazywać będziemy Lematem o Zwiększaniu Wykładnika, dowodzimy, że, przy wypisanych założeniach, przyrost vp(xk − yk) − vp(x − y) jest równy vp(k). TWIERDZENIE 2.18 (LZW) Niech x, y ∈ Z, k ∈ N i p ∈ P. Wówczas, jeżeli spełnione są warunki vp(xy) = 0 i vp(x − y) ⩾ 3 p , to vp(xk − yk) = vp(x − y) + vp(k). (2.25) D O W Ó D. Warunek vp(x − y) ⩾ 3/p oznacza, oczywiście, że vp(x − y) ⩾ 1 w przypadku gdy p > 2 oraz vp(x − y) ⩾ 2 w przypadku gdy p = 2. Rozważymy osobno te dwa przypadki. P r z y p a d e k p > 2. Niech k = pαm, gdzie α = vp(k). Liczby x1 = xpα, y1 = ypα spełniają(!) założenia vp(x1y1) = 0, vp(x1 − y1) ⩾ 1. Ponieważ p ∤ m, więc, na mocy Z2.8, vp(xk − yk) = vp(xm 1 − ym 1 ) = vp(x1 − y1) = vp(xpα − ypα). Jasne, że α-krotne zastosowanie równości (2.24) daje tezę: vp(xpα − ypα) = vp(xpα−1 − ypα−1) + 1 = vp(xpα−2 − ypα−2) + 2 = . . . = vp(x − y) + α. P r z y p a d e k p = 2. Niech k = 2α m, 2 ∤ m. Załóżmy najpierw, że m = 1. Wielokrotne zastosowanie wzoru na różnicę kwadratów daje wówczas rozkład xk − yk = (x2α−1 + y2α−1)(x2α−2 + y2α−2) · . . . · (x2 + y2)(x + y)(x − y). Mamy tu α czynników z plusem i jeden czynnik (x−y). Sprawdzamy, że wykładnik 2-adyczny każdego czynnika z plusem równy jest 1. Tu konieczne jest (mocniejsze niż w przypadku nieparzystego p) założenie v2(x − y) ⩾ 2. Rzeczywiście, jeżeli x = 2c + 1 i x − y = 4d, to x + y = 4(c − d) + 2 = 2(2c − 2d + 1), skąd v2(x + y) = 1. Jeszcze łatwiej 5 sprawdzić, 5Chodzi o to, że pozostałe czynniki z plusem są sumami dwóch kwadratów liczb nieparzystych, a kwadrat liczby nieparzystej daje resztę 1 z dzielenia przez 4, więc suma dwóch takich kwadratów daje resztę 2 z dzielenia przez 4. Ta uwaga przydaje się w rozwiązaniu C2.51. 40 2. Elementarz że wykładnik 2-adyczny pozostałych czynników z plusem jest równy 1. To kończy dowód równości (2.25) w tym podprzypadku. Przypadek dowolnego nieparzystego m rozpatrujemy tak jak wyżej (za pomocą (2.23)). □ Ćwiczenie 2.51 Udowodnić, że jeżeli v2(xy) = 0, v2(x − y) ⩾ 1, a k ∈ N jest liczbą p a r z y s t ą, to zachodzi równość v2(xk − yk) = v2(x2 − y2) + v2(k) − 1. (2.26) U w a g a. Dla n i e p a r z y s t y c h wykładników k istnieje ”plusowy” wariant tożsamości nieśmiertelnej: xk +yk = (x+y)(xk−1 −xk−2y + . . . −xyk−2 +yk−1) (jego prawdziwość wynika z równości (1.8) i oczywistych równości (−y) s = −ys dla nieparzystych s). Dzięki niemu łatwo rozwiążemy poniższe ćwiczenie: Ćwiczenie 2.52 Udowodnić następujący wariant ”plusowy” lematu LZW. Mianowicie: Jeżeli x, y ∈ Z, vp(xy) = 0 i vp(x + y) ⩾ 1, a k jest liczbą n i e p a r z y s t ą, to vp(xk + yk) = vp(x + y) + vp(k). (2.27) Pokażemy parę przykładów wykorzystania LZW. P r z y k ł a d 1. Przez jaką najwyższą potęgę liczby 3 dzieli się liczba Ln = 11 . . . 1 zapisana (w systemie dziesiętnym) za pomocą n cyfr 1? Ponieważ (zob. tożsamość nieśmiertelną) 9Ln = 9(10 n−1 + 10n−2 + · · · + 10 + 1) = 9 · 10 n − 1 10 − 1 = 10 n − 1 n, więc v3(9Ln) = 2 + v3(Ln) = 2 + v3(10 − 1) + v3(n). Zatem v3(Ln) = 2 + v3(n). ♦ P r z y k ł a d 2. Wyznaczymy wszystkie takie liczby naturalne n, że 3 n|5 n + 1. Jasne, że n = 1 jest dobra. Ponieważ para (x, y) = (5, 1) spełnia założenia ”plusowego” wariantu LZW (zob. C2.52) dla p = 3, więc dla każdej n i e p a r z y s t e j liczby n mamy: v3(5 n + 1) = v3(6) + v3(n). Gdyby więc 3 n|5 n + 1, mielibyśmy nierówność n ⩽ 1 + v3(n). Aby zobaczyć, że taka nierówność jest możliwa jedynie dla n = 1 musimy opuścić arytmetykę i wejść na teren analizy matematycznej. Mielibyśmy bowiem wówczas dla n = 3 k · m, gdzie 3 ⊥ m, jawnie fałszywą nierówność 3 k ⩽ n ⩽ 1 + k (dla każdego k ∈ N prawdziwa jest bowiem nierówność odwrotna 1 + k < 3 k, co bardzo łatwo udowodnić przez indukcję!). Również jest jasne, że n nie może być liczbą parzystą, wtedy bowiem liczba 5 n + 1, jako równa (24 + 1)n/2 + 1 = 3A + 2, w ogóle nie dzieli się przez 3. ♦ P r z y k ł a d 3. W 33 OM należało udowodnić, że: Jeżeli a jest liczbą naturalną parzystą, to dla dowolnego n ∈ N liczba a (a+1)n + 1 dzieli się przez (a + 1) n+1 ale nie dzieli się przez (a + 1) n+2. Aby to udowodnić bierzemy dowolny dzielnik pierwszy p liczby a + 1. Ponieważ a jest liczbą parzystą, więc p > 2. Kładąc x = a, y = 1 oraz k = (a + 1) n znajdujemy się w sytuacji opisanej przez ”plusowy” wariant LZW z ćwiczenia C2.52. Dostajemy więc równość vp ( a(a+1)n + 1) = vp(a + 1) + vp((a + 1)n) = vp(a + 1) + nvp(a + 1) = (n + 1)vp(a + 1). Jasne(?!), że to kończy dowód. ♦ Ćwiczenie 2.53 Niech p ∈ P⩾5. Wyznaczyć vp [ (p − 2) 2(p−1) − (p − 4)p−1]. 2.4. Wykładniki p-adyczne 41 Ćwiczenie 2.54 Niech A = (n − 1)nn+1 + (n + 1)nn−1 dla danej liczby nieparzystej n ⩾ 3. Wyznaczyć największą taką liczbę naturalną k, że nk|A. Ćwiczenie 2.55 Udowodnić, że dla każdej liczby naturalnej n ⩾ 2 zachodzi nierówność v2(5 n − 3 n) ⩽ 3 + log2 n. ZADANIE 2.10 Wyznaczyć wszystkie takie czwórki (x, y, n, k) ∈ N × N × N × N⩾2, że x < y, x ⊥ y i 3 n = xk + yk. R o z w i ą z a n i e. Po pierwsze: jasne, że v3(xy) = 0 (gdy 3|x, to dzięki Zasadzie Podstawo- wej widzimy, że 3|y, co jest niemożliwe, bo x ⊥ y). Po drugie: k nie może być liczbą parzystą (parzysta potęga liczby niepodzielnej przez 3 jest kwadratem liczby niepodzielnej przez 3, a (3u ± 1) 2 = 9u 2 ± 6u + 1, więc suma dwóch parzystych potęg liczb niepodzielnych przez 3 daje resztę 1 + 1 z dzielenia przez 3). Zatem k = 2m + 1 ⩾ 3 i możemy zastosować (2.27): n = v3(3 n) = v3(xk + yk) = v3(x + y) + v3(k), bo v3(x + y) ⩾ 1 (ta nierówność wynika z równości 3 n = (x + y)(xk−1 − · · · + yk−1), z której widać, że x + y jest potęgą liczby 3 o dodatnim wykładniku). Mamy więc xk + yk = 3 n = 3 v3(x+y) · 3 v3(k) ⩽ (x + y)k. Taka nierówność jest sprzeczna z nierównościami xk > kx i yk > ky (prawdziwymi dla x, y ⩾ 2 i k ⩾ 3). Pozostaje zbadać przypadek x = 1. Mamy wówczas 1 + yk ⩽ k + ky. Stąd: k + ky ⩾ 1 + yk = 1 + [1 + (y − 1)] k = 1 + 1 + k(y − 1) + ( k 2 ) (y − 1) 2 + . . . > > 2 − k + ky + k(k − 1) 2 (y − 1) 2, bo w miejscu kropek stoją wyrazy dodatnie. Stąd, po prostych przekształceniach, k(y−1) 2 < 4. Ta nierówność jest możliwa tylko dla y = 2 (pamiętamy, że y ⩾ 2 i k ⩾ 3). W ten sposób znajdujemy j e d y n e rozwiązanie: (x, y, n, k) = (1, 2, 2, 3). ♦ ZADANIE 2.11 Udowodnić, że jeżeli dla pewnego k ∈ N zachodzi równość 3 k − 2 k = pn, gdzie p ∈ P, a n ⩾ 2, to k jest liczbą pierwszą. R o z w i ą z a n i e. Jasne, że p ̸= 2, 3 i k > 1. Pokażemy, że jeżeli k = ab, przy czym a, b ⩾ 2, to p|a (i p|b): Mamy równość 3 k −2 k = (3 a −2 a)Qb(3 a, 2 a). Stąd i z jednoznaczności rozkładu, mamy 3 a − 2 a = pα, gdzie 1 ⩽ α < n. Dzięki LZW dostajemy równość n = vp(3 k − 2 k) = vp(3 a − 2 a) + vp(b) = α + vp(b) (∗) Zatem vp(b) ⩾ 1. Podobnie dostajemy nierówność vp(a) ⩾ 1. To oznacza, że k jest p o t ę g ą liczby pierwszej, konkretnie: k = ps. Wystarczy wykazać, że s = 1. Załóżmy więc, nie wprost, że s ⩾ 2. Wówczas k = p · ps−1. W równości (∗) połóżmy a = p, b = ps−1. Otrzymujemy n = vp(3p − 2 p) + s − 1. Wobec tego (3 a) b − (2 a)b = 3 k − 2 k = pn = pvp(3p−2p)+s−1 = (3 p − 2 p)b. 42 2. Elementarz Stąd dostajemy nonsensowną równość b = Qb(3 p, 2 p) (gdy x, y ∈ N⩾3, to Qb(x, y) jest sumą b składników postaci xtyb−1−t, z których każdy jest większy niż 2 b−1). ♦ Proponujemy jeszcze trzy ćwiczenia na zastosowanie LZW 6. Ćwiczenie 2.56 Załóżmy, że xk + yk = pn, gdzie x, y, k, n ∈ N, 2 ∤ k i p ∈ P>2. Udowodnić, że k ma co najwyżej jeden dzielnik pierwszy. Ćwiczenie 2.57 Liczba naturalna n ⩾ 2 jest dzielnikiem liczby (a−1) k, gdzie k, a ∈ N⩾2. Udowodnić, że wówczas n|(an−1 + an−2 + · · · + a + 1). Ćwiczenie 2.58 Wyznaczyć wszystkie n ∈ N, dla których zachodzi podzielność 2 n|3 n −1. 2.5 Trójki pitagorejskie W tym paragraﬁe poznamy jeden prosty ale ważny trik, i zobaczymy jak za jego pomocą rozwiązuje się równanie Pitagorasa. 2.5.1 Trik Prosty trik , który jest treścią kolejnego twierdzenia, jest bardzo często używany. Jest on natychmiastowym wnioskiem z jednoznaczności rozkładu. Jego rozliczne uogólnienia są bardzo ważnym motywem w całej teorii liczb. TWIERDZENIE 2.19 (Trik ) Jeżeli liczby naturalne a, b są względnie pierwsze i zachodzi równość ab = ck dla pewnych c, k ∈ N, to liczby a, b są k-tymi potęgami liczb naturalnych. D O W Ó D. Niech p będzie dowolną liczbą pierwszą dzielącą a. Wówczas p|ck i, wobec założenia a ⊥ b, p ∤ b, czyli vp(b) = 0. Zatem k · vp(c) = vp(ck) = vp(ab) = vp(a) + vp(b) = vp(a). Stąd, na mocy C2.44, a jest k-tą potęgą. Podobnie, b jest k-tą potęgą liczby naturalnej. □ ZADANIE 2.12 Niech n, m ∈ Z będą takimi liczbami całkowitymi, że zachodzi równość 7n2 − n = 8m 2 − m. Udowodnić, że |n − m| jest kwadratem liczby całkowitej. R o z w i ą z a n i e. Równość 7n2 − n = 8m 2 − m po przekształceniu daje (n − m) · (7(n + m) − 1) = m2. (2.28) Teraz z łatwością sprawdzamy, że NWD (n − m, 7(n + m) − 1) = 1. Istotnie, jeżeli liczba pierwsza p dzieli n − m, to, wobec równości (2.28), dzieli m 2, czyli też m. Więc dzieli też (n − m) + 2m = n + m. Zatem nie dzieli 7(n + m) − 1. Na mocy triku T2.19 widzimy więc, że zarówno |n − m| jak i |7(n + m) − 1| są kwadratami liczb całkowitych. ♦ 6W literaturze olimpijskiej używa się skrótu LTE (Lifting the Exponent Lemma) 2.5. Trójki pitagorejskie 43 2.5.2 Trójki pitagorejskie Pokażemy teraz jak się rozwiązuje jedno klasyczne równanie diofantyczne stopnia 2. Rozwią- zaniom tego równania w geometrii odpowiadają tak zwane trójkąty pitagorejskie. Deﬁnicja 2.9 Rozwiązanie (x, y, z) równania Pitagorasa x2 + y2 = z2 (2.29) w liczbach naturalnych nazywamy trójką pitagorejską. Trójka pitagorejska (x, y, z) nazywa się pierwotną trójką pitagorejską, gdy NWD (x, y, z) = 1. U w a g a 1. Jest prawdopodobne, że jakieś ogólne metody znajdowania rozwiązań równania Pitagorasa były znane w Mezopotamii dwanaście wieków p r z e d Pitagorasem. Na przykład z tego okresu pochodzi gliniana tabliczka z zapisaną pismem klinowym trójką pitagorejską (6480, 4961, 8161). Pierwszy zaświadczony dowód twierdzenia T2.20 pochodzi od Euklidesa. TWIERDZENIE 2.20 Jeżeli (x, y, z) jest pierwotną trójką pitagorejską, w której x jest liczbą parzystą, to istnieją takie liczby u, v ∈ N różnej parzystości, że u > v, u ⊥ v oraz: (x, y, z) = (2uv, u2 − v2, u2 + v2). D O W Ó D. Niech (x, y, z) ∈ N będzie trójką pierwotną. Wówczas z jest liczbą niepa- rzystą, a z liczb x, y dokładnie jedna jest parzysta (dlaczego?). Połóżmy więc z = 2n + 1, x = 2m, y = 2k + 1. Ponieważ x2 = (z − y)(z + y), więc m 2 = (n − k)(n + k + 1). Po- kazujemy, że NWD (n − k, n + k + 1) = 1: Gdy d ∈ D(n − k, n + k + 1), to d dzieli sumę tych liczb i ich różnicę: d|2n + 1 i d|2k + 1. Więc d|z i d|y. Zatem d2|z2 − y2, stąd d 2|x2, zatem d|x. I, dzięki założonej pierwotności trójki (x, y, z), mamy d = ±1. Stosujemy więc trik : znajdujemy takie liczby u, v ∈ N, że n + k + 1 = u2 i n − k = v2. Stąd dostajemy: z = 2n + 1 = u2 + v2, x = 2m = 2uv i y = u 2 − v2. Przy tym u, v, jak łatwo się przekonać, są różnej parzystości i, wobec założenia pierwotności trójki (x, y, z), zachodzi u ⊥ v. □ Ćwiczenie 2.59 Uzupełnić szczegóły w powyższym dowodzie. Wskazówka. Uzasadnić, że kwadrat (liczby całkowitej) przy dzieleniu przez 4 daje resztę 0 lub 1. U w a g a 2. Jeżeli (a, b, c) jest trójką pitagorejską, a d = NWD (a, b, c), to trójka (x, y, z) = ( a d , b d , c d ) jest, oczywiście, trójką pitagorejską. Ponadto NWD (x, y, z) = 1, więc (x, y, z) jest trójką pierwotną. Wobec tego każda trójka pitagorejska jest postaci ( 2duv, d(u 2 − v2), d(u 2 + v2) ). (2.30) Ćwiczenie 2.60 Wyznaczyć wszystkie takie trójki pitagorejskie, że b = 15 lub c = 15. Ćwiczenie 2.61 Udowodnić, że jeśli (a, b, c) jest trójką pitagorejską, to 60|abc. Trójkąt prostokątny △ABC (zwyczajowo uznajemy m(<) C) = 90◦ ) nazywa się trójkątem pitagorejskim, gdy długości wszystkich jego boków są liczbami całkowitymi. 44 2. Elementarz Ćwiczenie 2.62 Udowodnić, że w trójkącie pitagorejskim zarówno promień r okręgu wpi- sanego jak i promienie rA, rB, rC okręgów dopisanych, są liczbami naturalnymi. Udowodnić też, że istnieją trzy i, z dokładnością do przystawania, tylko trzy takie trójkąty pitagorejskie, że promień r okręgu w nie wpisanego jest równy 3. Ćwiczenie 2.63 Wyznaczyć wszystkie trójkąty pitagorejskie o polu równym obwodowi, tzn., takie trójki pitagorejskie (a, b, c), że a + b + c = ab/2. Ćwiczenie 2.64 Wyznaczyć wszystkie trójkąty pitagorejskie, w których przeciwprosto- kątna jest o 1 dłuższa niż jedna z przyprostokątnych. Ćwiczenie 2.65 Wyznaczyć wszystkie rozwiązania równania x2 + y2 = 2z2 w liczbach naturalnych. Wskazówka. Podstawić x = u + v, y = u − v. Ćwiczenie 2.66 Udowodnić, że okręgi o równaniach x2 + y2 = 1 i x2 + y2 = 2 prze- chodzą przez nieskończenie wiele punktów wymiernych (o obu współrzędnych wymiernych), natomiast okrąg o równaniu x2 + y2 = 3 nie przechodzi przez żaden punkt wymierny. 2.6 Zadania dodatkowe Pokazujemy zbiorek zadań do naszego Elementarza. Ich poziom trudności należy do przedziału [ SP; IMO ], a do ich rozwiązania wystarcza teoria wyłożona w tym rozdziale. 2.6.1 Treści zadań Podział naszego zbiorku na podzbiorki jest mniej lub bardziej przypadkowy. Wszystkie ozna- czenia są standardowe lub wyjaśnione. A. Podzielność ZADANIE 2.A0 Udowodnić, że ułamek 21n+4 14n+3 jest nieskracalny dla każdego n ∈ N. ZADANIE 2.A1 Wyznaczyć cyfry x, y jeżeli wiadomo, że 13|(3 0x0 y03)10. ZADANIE 2.A2 Niech x, y, z oznaczają liczby całkowite. Udowodnić, że zachodzą równoważ- ności: (1) 37|2x + 15y ⇐⇒ 37|3x + 4y, (2) 6|x + y + z ⇐⇒ 6|x3 + y3 + z3. ZADANIE 2.A3 Niech k, l ∈ N. Udowodnić, że jeżeli liczba 100kl − 1 jest dzielnikiem liczby (100k2 − 1)2, to jest też dzielnikiem liczby (100l2 − 1)2. ZADANIE 2.A4 Udowodnić, że jeżeli x, y ∈ Z oraz 11|x2 + y2, to 11|x i 11|y. ZADANIE 2.A5 Dane są takie liczby naturalne a, b, c, że liczby a2 + b2, b2 + c2 i c2 + a2 są kwadratami (liczb naturalnych). Dowieść, że co najmniej jedna z liczb a, b, c jest podzielna przez 5. ZADANIE 2.A6 Liczby naturalne a, b, c i m są takie, że m|a + b, m|b + c, m|c + a i m3|abc. Udowodnić, że m|a, m|b i m|c. ZADANIE 2.A7 Wyznacz zbiór: (1) {n ∈ N : n + 5|n5 + 5}; (2) {n ∈ N : 5n−1 + 7n−1|5n + 7n}. ZADANIE 2.A8 Dana jest nieparzysta liczba naturalna k. Udowodnić, że dla każdego n ∈ N zachodzi podzielność (1 + 2 + · · · + n)|(1k + 2k + · · · + nk). ZADANIE 2.A9 Dowieść, że istnieje dokładnie jedna taka trójka (a, b, c) liczb naturalnych, że 1 < a < b < c oraz a|bc + 1, b|ca + 1 i c|ab + 1. 2.6. Zadania dodatkowe 45 ZADANIE 2.A10 Udowodnić, że jeżeli a, b ∈ N i n ∈ N⩾2, to (an − bn) ∤ (an + bn). ZADANIE 2.A11 Wyznaczyć wszystkie takie pary (a, b) liczb naturalnych, że liczba ab2 + b + 7 jest dzielnikiem liczby a2b + a + b. ZADANIE 2.A12 Udowodnić, że jeżeli m, n ∈ N, to (1) (2m m )(2n n ) (m+n n ) ∈ N, (2) (2m)!(3n)! (m!)2(n!)3 ∈ N, (3) (n!)! n!(n−1)! ∈ N, (4) Cn := (2n n ) n + 1 ∈ N. [Teza (1) nazywa się Twierdzeniem Catalana, a liczba Cn nazywa się liczbą Catalana.] ZADANIE 2.A13 Dane są takie liczby całkowite A1, A2, . . . , As i B1, B2, . . . , Bs, że dla każdej liczby naturalnej m zachodzi nierówność card {t : 1 ⩽ t ⩽ s, m|Bt} ⩽ card {t : 1 ⩽ t ⩽ s, m|At}. (2.31) Udowodnić, że wówczas B1B2 · . . . · Bs|A1A2 · . . . · As. ZADANIE 2.A14 Dane są dowolne liczby całkowite a1, a2, . . . , an ∈ Z. Udowodnić, że liczba L := ∏ 1⩽k<l⩽n al − ak l − k (2.32) jest liczbą całkowitą. B. NWD i NWW ZADANIE 2.B1 Udowodnić, że jeżeli a ̸= b są liczbami naturalnymi, to NWD (a, b) ⩽ a+b 3 . ZADANIE 2.B2 Niech a, b ∈ N. Udowodnić, że NWD (a + b, NWW (a, b)) = NWD (a, b). ZADANIE 2.B3 Udowodnić, że dla dowolnych a, b, c ∈ Z̸=0 zachodzi równość NWW (a2, b2, c2) NWW (a, b) · NWW (b, c) · NWW (c, a) = NWD (a2, b2, c2) NWD (a, b) · NWD (b, c) · NWD (c, a) . ZADANIE 2.B4 Liczby naturalne an, bn wyznaczamy z równości an + bn√2 = (1 + √2)n, dla wszystkich n ∈ N. Wyznaczyć NWD (an, bn). ZADANIE 2.B5 Udowodnić, że dla liczb naturalnych m ⩽ n zachodzi n| ( n m)NWD (m, n). ZADANIE 2.B6 Niech p > 2 będzie liczbą pierwszą i niech a, b będą liczbami naturalnymi względnie pierwszymi. Wykazać, że liczba NWD (a + b, ap−1 − ap−2b + . . . − abp−2 + bp−1) dzieli p. ZADANIE 2.B7 Dowieść, że n! = ∏n k=1 NWW (1, 2, . . . , ⌊n/k⌋) dla dowolnego n ∈ N. ZADANIE 2.B8 Wykazać, że istnieje nieskończenie wiele takich par (m, n) liczb naturalnych, dla których zachodzi równość NWD (m2 + 1, n2 + 1) = m + n. ZADANIE 2.B9 Niech a ∈ N⩾2. Dowieść, że dla dowolnych m, n ∈ N zachodzi równość: NWD (am − 1, an − 1) = aNWD (m, n) − 1. ZADANIE 2.B10 Ciąg (an)n⩾1 o wyrazach z N spełnia warunek NWD (ak, al) = NWD (k, l) dla dowolnych k ̸= l. Uzasadnić, że an = n dla każdego n ∈ N. ZADANIE 2.B11 Dowieść, że jeśli k1 < k2 < · · · < kn ∈ N, to NWW (k1, k2, . . . , kn) ⩾ nk1. ZADANIE 2.B12 Funkcja f : N × N −→ N spełnia warunki: (1) f (x, x) = x; (2) f (x, y) = f (y, x); (3) f (x, y + x) = f (x, y) 46 2. Elementarz dla dowolnych x, y. Udowodnić, że f (m, n) = NWD (m, n) dla dowolnej pary (m, n) ∈ N × N. ZADANIE 2.B13 Niech 0 < k ⩽ n będą liczbami całkowitymi. Udowodnić, że największy wspólny dzielnik liczb (n k), (n+1 k ), . . . , (n+k k ) jest równy 1. ZADANIE 2.B14 Dane są takie liczby naturalne a1 < a2 < · · · < an ⩽ 1951, że dla każdej pary 1 ⩽ i < j ⩽ n zachodzi nierówność NWW (ai, aj) > 1951. Udowodnić, że 1 a1 + 1 a2 + . . . + 1 an < 2. C. Dzielniki i złożoność liczb ZADANIE 2.C1 Załóżmy, że p < q są dwiema k o l e j n y m i liczbami pierwszymi nieparzystymi. Udowodnić, że liczba p + q ma co najmniej trzy (niekoniecznie różne) dzielniki pierwsze. ZADANIE 2.C2 Udowodnić, że następujące liczby są złożone (w (3) dla każdego n ⩾ 2): (1) 3 2012 + 42013, (2) 5125 − 1 525 − 1 , (3) f (n) := n2012 + n2011 + 1, (4) Tn := 3 3n + 1, przy czym Tn ma co najmniej 2n + 1 (niekoniecznie różnych) dzielników pierwszych. ZADANIE 2.C3 Udowodnić, że dla danej n ∈ N, w przedziale [ √n; √n + 4√n ] znajdzie się co najwyżej jeden dzielnik liczby n. ZADANIE 2.C4 Dane są a, d ∈ N, a ⩾ 2. Udowodnić, że liczba a2d − 1 ma te same dzielniki pierwsze co liczba ad − 1 wtedy i tylko wtedy, gdy d = 1 oraz a = 2r − 1 przy pewnym r. ZADANIE 2.C5 Dane są takie k, m, n ∈ N, że m ⩽ n i m|nk. Dowieść, że mmm|nnn. ZADANIE 2.C6 Załóżmy, że k, a ∈ N⩾2. Dowieść, że jeżeli liczby ak −1 i a−1 mają dokładnie te same dzielniki pierwsze, to k = 2 oraz a = Mr (l. Mersenne’a) dla pewnego r ∈ N. ZADANIE 2.C7 Liczbę naturalną n nazywa się liczbą Nov´aka, gdy n|2n + 1. Udowodnić, że (1) jeżeli n jest liczbą Nov´aka, to 2n + 1 również jest liczbą Nov´aka; (2) NWD i NWW dwóch liczb Nov´aka jest liczbą Nov´aka; (3) jeżeli n jest liczbą Nov´aka, p ∈ P i p|2n + 1, to np jest liczbą Nov´aka; (4) iloczyn liczb Nov´aka jest liczbą Nov´aka; (5) istnieje liczba Nov´aka mająca dokładnie 2017 dzielników pierwszych. D. Kwadraty i inne potęgi ZADANIE 2.D0 Udowodnić, że ani suma x2+y2 dwóch kwadratów liczb nieparzystych, ani suma x2 + y2 + z2 trzech kwadratów liczb nieparzystych n i e jest kwadratem (liczby całkowitej). Dowieść istnienia nieskończenie wielu takich czwórek x, y, u, w różnych nieparzystych liczb całkowitych, że liczba x2 + y2 + u2 + w2 jest kwadratem. ZADANIE 2.D1 Liczba n ∈ N zapisana jest w systemie dziesiętnym za pomocą 30 cyfr równych 0 lub 6. Czy n może być kwadratem? ZADANIE 2.D2 Czterocyfrowa (w systemie dziesiętnym) liczba naturalna (aabb)10 jest kwa- dratem. Wyznaczyć cyfry a i b. ZADANIE 2.D3 Udowodnić, że jeżeli a2 + a = 3b2 dla a, b ∈ N, to a + 1 jest kwadratem. ZADANIE 2.D4 Wyznaczyć wszystkie liczby naturalne n, dla których: (1) liczba 4n − 3n jest kwadratem (liczby całkowitej); (2) liczba 5n − 3n jest kwadratem (liczby całkowitej). ZADANIE 2.D5 Liczby naturalne Tn = n(n + 1)/2 nazywają się liczbami trójkątnymi. Udowodnić, że istnieje nieskończenie wiele liczb trójkątnych będących kwadratami (liczb całkowitych). ZADANIE 2.D6 Udowodnić, że iloczyn dwóch, ani trzech, ani czterech kolejnych liczb natural- nych nie jest kwadratem. 2.6. Zadania dodatkowe 47 ZADANIE 2.D7 Udowodnić, że jeżeli różnica dwóch kolejnych sześcianów liczb naturalnych jest kwadratem liczby naturalnej m, to m jest sumą dwóch kolejnych kwadratów liczb naturalnych. ZADANIE 2.D8 Udowodnić, że liczba Vn := 2n + 1, przy n ∈ N, jest właściwą7 potęgą liczby naturalnej wtedy i tylko wtedy, gdy n = 3. ZADANIE 2.D9 Udowodnić, że liczba Mersenne’a Mm := 2m − 1, przy m ⩾ 2, n i e jest właściwą potęgą liczby naturalnej. ZADANIE 2.D10 Wyznaczyć wszystkie takie pary (x, y) liczb naturalnych, że liczby x2 + 5y i y2 + 5x są kwadratami. ZADANIE 2.D11 Dana jest liczba pierwsza p > 2 i takie liczby naturalne x, y ⩽ (p − 1)/2, że iloczyn x(p − x)y(p − y) jest kwadratem. Udowodnić, że x = y. ZADANIE 2.D12 Czy istnieją takie liczby naturalne x, y, że liczby x + 2y, 5x + 13y, 7x + 11y są kwadratami? E. Równania diofantyczne ZADANIE 2.E1 Udowodnić, że równanie: (1) 14x2 + 197xy + 14y2 = 2z nie ma rozwiązań w liczbach całkowitych x, y, z; (2) y2 = x5 + 4 nie ma rozwiązań w liczbach naturalnych nieparzystych. ZADANIE 2.E2 Dowieść, że jeżeli a, b, c, n ∈ N i an + bn = cn, to min{a, b} ⩾ n. ZADANIE 2.E3 Udowodnić, że równanie x3 + y4 = z5 ma nieskończenie wiele rozwiązań w liczbach naturalnych x, y, z. ZADANIE 2.E4 Udowodnić, że dla każdej liczby naturalnej n istnieje taka liczba naturalna m, że zachodzi równość (√2 − 1)n = √m − √m − 1. F. Liczby pierwsze, jednoznaczność rozkładu ZADANIE 2.F1 Wyznaczyć wszystkie takie: (1) liczby pierwsze p, dla których 2p + 1 i 4p + 1 są liczbami pierwszymi; (2) liczby pierwsze p, dla których 4p2 + 1 i 6p2 + 1 są liczbami pierwszymi; (3) trójki (p, q, r) kolejnych liczb pierwszych, dla których p2 + q2 + r2 jest liczbą pierwszą; (4) liczby naturalne n, że para (2n − 1, 2n + 1) jest parą liczb pierwszych bliźniaczych. ZADANIE 2.F2 Niech γ(n) = card{p ∈ P : p|n} (czyli γ(n) oznacza liczbę różnych dzielników pierwszych liczby naturalnej n, na przykład γ(1) = 0, γ(p) = 1, itp.). Udowodnić, że dla każdego m ∈ N istnieją takie liczby k, l ∈ N, że m = k − l i γ(k) = γ(l). ZADANIE 2.F3 Załóżmy, że wszystkie wyrazy ciągu arytmetycznego q, q + r, . . . , q + (n − 1)r są liczbami pierwszymi. Udowodnić, że różnica r tego ciągu jest podzielna przez iloczyn wszystkich liczb pierwszych p < n. ZADANIE 2.F4 Udowodnić, że dla n ∈ N zachodzi nierówność n√n! ⩽ ∏p⩽n p1/(p−1). ZADANIE 2.F5 Niech (p1, p2, p3, . . . ) = (2, 3, 5, . . . ) będzie ciągiem wszystkich (ustawionych rosnąco) liczb pierwszych. Udowodnić, że dla każdego n ⩾ 4 zachodzi nierówność Bonse pn+1 < √p1p2 · . . . · pn. (2.33) ZADANIE 2.F6 Liczby całkowite ai spełniają nierówności 1 < a1 < a2 < · · · < an < 2a1. Udowodnić, że jeżeli m jest liczbą różnych dzielników pierwszych iloczynu a1a2 · . . . · an, to zachodzi nierówność (a1a2 · . . . · an)m−1 ⩾ (n!)m. ZADANIE 2.F7 Wykazać, że zbiór N można przedstawić w postaci sumy pięciu parami roz- łącznych podzbiorów o następującej własności: każda piątka liczb n, 2n, 3n, 4n, 5n, gdzie n ∈ N, zawiera po jednej liczbie z każdego z tych pięciu podzbiorów. 7Potęgę xm liczby całkowitej x nazywamy właściwą (ang. perfect power ), gdy m ∈ N⩾2. 48 2. Elementarz ZADANIE 2.F8 Dane są nieparzyste liczby pierwsze r < s. Dowieść, że liczba Mrs := 2rs − 1 ma co najmniej 3 różne dzielniki pierwsze. G. Liczby bezkwadratowe ZADANIE 2.G1 Udowodnić, że istnieje nieskończenie wiele takich liczb naturalnych bezkwadra- towych n, że liczby n + 1, n + 2 również są bezkwadratowe. ZADANIE 2.G2 Udowodnić, że każda liczba naturalna n > 1 da się przedstawić w postaci sumy dwóch liczb naturalnych bezkwadratowych. H. Zadania addytywne ZADANIE 2.H1 Udowodnić, że liczba naturalna m jest sumą dwóch kwadratów (liczb całko- witych) wtedy i tylko wtedy, gdy liczba 2m jest sumą dwóch kwadratów (liczb całkowitych). ZADANIE 2.H2 Udowodnić, że jeżeli liczba naturalna n jest sumą trzech kwadratów liczb naturalnych, to również liczba n2 jest sumą trzech kwadratów liczb naturalnych. ZADANIE 2.H3 Udowodnić, że potęga 2n (n ∈ N) n i e da się przedstawić w postaci sumy dwóch czy więcej k o l e j n y c h liczb naturalnych, a każda liczba naturalna nie będąca naturalną potęgą dwójki d a się przedstawić w postaci takiej sumy. ZADANIE 2.H4 Udowodnić, że każda liczba całkowita daje się na nieskończenie wiele sposobów przedstawić w postaci ±12 ± 22 ± · · · ± m2, gdzie m ∈ N, a znaki +, − są odpowiednio dobrane. ZADANIE 2.H5 Udowodnić, że każda liczba całkowita daje się (na nieskończenie wiele sposobów) przedstawić w postaci sumy p i ę c i u sześcianów liczb całkowitych. ZADANIE 2.H6 Dana jest liczba naturalna n. Udowodnić, że dla każdej liczby naturalnej a < n! istnieją takie (dodatnie) dzielniki d1 < · · · < ds liczby n!, że a = d1 + · · · + ds i s ⩽ n. I. Cztery zastosowania LZW ZADANIE 2.I1 Niech p ∈ P i a, n ∈ N. Udowodnić, że jeżeli 2p + 3p = an, to n = 1. ZADANIE 2.I2 Liczbę n ∈ N nazwiemy ciekawą, gdy n|1n + 2n + · · · + 8n. Udowodnić, że istnieje nieskończenie wiele ciekawych liczb naturalnych. ZADANIE 2.I3 Dane są takie r ó ż n e liczby rzeczywiste x, y, że wszystkie liczby xn − yn, dla n ∈ N, są liczbami całkowitymi. Dowieść, że x, y ∈ Z. ZADANIE 2.I4 Udowodnić, że jeżeli (x, y; m, n) jest czwórką Catalan’a (zobacz rozwiązanie Z2.D8), w której y jest liczbą pierwszą, to (x, y; m, n) = (3, 2; 2, 3). 2.6.2 Wskazówki i rozwiązania Pokazujemy rozwiązania/wskazówki wszystkich zadań. Z2.A0 (IMO’59) Zobacz równość 3(14n + 3) − 2(21n + 4) = 1. Z2.A1 Niech L := 3 000 003 i A(x, y) := 104x+102y. Zadanie polega na wyznaczeniu wszystkich par (x, y) liczb naturalnych z przedziału [ 0; 9 ], dla których 13|L + A(x, y). Dzielimy więc z resztą przez 13. Mamy: L = 13 · 230 769 + 6, 104 = 13 · 769 + 3 i 102 = 13 · 7 + 9. To daje równość L + A(x, y) = 13(230 769 + 769x + 7y) + 6 + 3x + 9y, z której widzimy, że 13|L + A(x, y) wtedy i tylko wtedy, gdy 13|3(2+x+3y). To z kolei, na mocy ZTA, zachodzi wtedy i tylko wtedy, gdy 13|2+x+3y. Ponieważ 0 ⩽ x, y ⩽ 9, więc ostatnia podzielność może mieć miejsce tylko gdy 2 + x + 3y = 13 lub 2 + x + 3y = 26. Musimy więc rozwiązać równania x + 3y = 11 i x + 3y = 24. Wobec ”małości” występujących liczb nie musimy przywoływać twierdzenia T2.12. Znajdujemy rozwiązania: (x, y) = (0, 8), (2, 3), (3, 7), (5, 2), (6, 6), (8, 1) i (9, 5). 2.6. Zadania dodatkowe 49 Z2.A2 (1) Równość 13(3x + 4y) = 2x + 15y + 37(x + y), Zasada Podstawowa i ZTA pozwalają natychmiast uzasadnić żądaną równoważność. (2) Patrz na równość: (x3 + y3 + z3) − (x + y + z) = x(x − 1)(x + 1) + y(y − 1)(y + 1) + z(z − 1)(z + 1) i zauważ, że liczba u(u − 1)(u + 1), jako iloczyn trzech k o l e j n y c h liczb całkowitych, jest podzielna przez 2 i 3, więc, zobacz C2.17, też przez 6. Z2.A3 Mamy równość k2(100l2 − 1)2 − l2(100k2 − 1)2 = (l2 − k2)(100kl − 1)(100kl + 1). Stosujemy Zasadę Podstawową i, po zauważeniu względnej pierwszości k2 ⊥ 100kl − 1, korzystamy z ZTA. Z2.A4 Jeżeli 11 ∤ x, to istnieją takie liczby całkowite u, v, że xu + 11v = 1, zobacz C2.32 i T2.6. Wobec tego równość x2 + y2 = 11a daje (xu)2 + (yu)2 = 11au2, czyli (1 − 11v)2 + (yu)2 = 11au2, więc 11|1 + (yu)2. Teraz trzeba zobaczyć jakie reszty z dzielenia przez 11 dają kwadraty. Robimy to tak: każda liczba całkowita jest jednej z postaci 11s, 11s ± 1, 11s ± 2, 11s ± 3, 11s ± 4 lub 11s ± 5. Ich kwadraty są równe odpowiednio: 11S, 11S + 1, 11S + 4, 11S + 9, 11S + 5 lub 11S + 3. Wobec tego 1 + (yu)2 daje jedną z reszt 1, 2, 5, 10, 6 lub 4 przy dzieleniu przez 11. Nie jest więc podzielna przez 11. Znaleziona sprzeczność kończy rozwiązanie. U w a g a. Udowodniona teza jest przypadkiem szczególnym tezy ogólniejszej: Jeżeli p jest liczbą pierwszą postaci 4k+3 i p|x2+y2 dla pewnych liczb całkowitych x, y, to p|x i p|y. Po zapoznaniu się z elementami teorii reszt kwadratowych modulo p (zob. rozdział 5) Czytelnik z łatwością udowodni tę tezę, jak również będzie rozumiał wagę założenia p = 4k + 3 (przecież, na przykład, 5|72 + 42 ale 5 ∤ 7 i 5 ∤ 4). Z2.A5 Rozstrzygającą jest tu uwaga, że jeżeli liczba całkowita x nie jest podzielna przez 5, to jej kwadrat x2 daje resztę 1 lub 4 przy dzieleniu przez 5. Gdyby więc, żadna z liczb a, b, c nie była podzielna przez 5, to co najmniej dwie z liczb a2, b2, c2 dawałyby przy dzieleniu przez 5 tę samą resztę (1 lub 4). Ich suma dawałaby wtedy resztę 2 lub 3, nie mogłaby więc być kwadratem. Czytelnik mógłby zechcieć podobnie uzasadnić, że w badanej sytuacji co najmniej jedna z liczb a, b, c jest podzielna przez 11. Z2.A6 Korzystamy z C2.41. Niech vp(a) = s, vp(b) = t, vp(c) = u i vp(m) = r dla danej (dowolnej) liczby pierwszej p. Załóżmy (b.s.o.), że s ⩽ t ⩽ u. Teza zadania jest więc równoważna nierówności r ⩽ s. Zakładamy, nie wprost, że s < r. Założenie m3|abc daje nierówność 3r ⩽ s+t+u, skąd r ⩽ u. Mamy więc s < r ⩽ u. Wówczas, zobacz C2.43.2, r ⩽ vp(a + c) = min {s, u} = s < r (pierwsza nierówność wynika z założenia m|a + c). Otrzymana sprzeczność kończy rozwiązanie. Z2.A7 (1) Zapisz n5 + 5 = n5 + 55 − 55 + 5. Wykorzystaj tożsamość nieśmiertelną (1.8) dla dowodu, że n + 5|n5 + 55. Powołaj się na Zasadę Podstawową. (2) Oznacz an = 5n + 7n. Wtedy an = (5n−1 + 7n−1)(5 + 7) − 5 · 7n−1 − 7 · 5n−1, czyli an = 12an−1 − 35an−2 dla wszystkich n ⩾ 2. Podzielność an−1|an daje więc podzielność an−1|35an−2. Ale an−1 ⊥ 35 (sprawdź!), więc, na mocy ZTA, an−1|an−2. Nonsens, bo an−1 > an−2. Pozostaje więc tylko n = 1. Z2.A8 Rozważymy osobno przypadki: (1) n = 2a, (2) n = 2a + 1. W przypadku (1) liczba 1 + · · · + n jest równa a(2a + 1). Ponieważ liczby a i 2a + 1 są względnie pierwsze, więc, wobec C2.17, wystarczy uzasadnić podzielności a|1k + · · · + (2a)k i (2a + 1)|1k + · · · + (2a)k. To łatwo uzasadnić wykorzystując ”nieparzystą” wersję tożsamości nieśmiertelnej i odpowiednie pogrupowanie składników. Mianowicie, równość xk + yk = (x + y)(xk−1 − xk−2y + · · · − xyk−2 + yk−2) zacho- dząca dla dowolnych liczb (w rzeczywistości, elementów dowolnego pierścienia przemiennego) x, y i n i e p a r z y s t e g o k pokazuje podzielność (x + y)|xk + yk. Stąd, grupując składniki sumy ∑2a s=1 sk, pierwszy z ostatnim, drugi z przedostatnim, itd., dostajemy podzielność tej sumy przez 2a + 1, zaś grupując pierwszy z przedostatnim, drugi z przedprzedostatnim, itd., znajdujemy a − 1 sumek po- dzielnych przez 2a oraz dwa wyrazy ak i (2a)k podzielne przez a i, ostatecznie, podzielność sumy∑2a s=1 sk przez a. W przypadku (2) postępujemy podobnie. Z2.A9 Sprawdź najpierw, że liczby a, b, c są p a r a m i względnie pierwsze. Zauważ następnie, że liczba N := ab + bc + ca + 1 jest podzielna przez każdą z liczb a, b, c. Wywnioskuj z C2.17, że 50 2. Elementarz abc|N , i z C2.2, że abc ⩽ N . Teraz już musisz porzucić arytmetykę (teorię podzielności) na rzecz analizy (w tym przypadku – nierówności): widać bowiem, że liczba abc jest rzędu wielkości b3, a liczba N rzędu wielkości 3b2, więc już przy b ⩾ 4 możesz się spodziewać sprzeczności. Rzeczywiście, gdy b ⩾ 4, to c ⩾ 5 i, wobec tego, N = ab + bc + ca + 1 = abc c + abc a + abc b + 1 ⩽ abc 5 + abc 2 + abc 4 + 1 < abc. Pozostaje Ci sprawdzić przypadek, gdy b = 3 i a = 2. Z2.A10 Załóż, nie wprost, że an + bn = q(an − bn) dla pewnego q ∈ Z. Dostaniesz równość (q + 1)bn = (q − 1)an. Nie tracąc ogólności rozważań, załóż też, że a ⊥ b (gdyby tak nie było, podziel wszystko przez dn, gdzie d = NWD (a, b), i zastosuj C2.12). Wykorzystaj ZTA. Otrzymasz równości q + 1 = ank, q − 1 = bnk dla pewnego k ∈ Z. Odejmij stronami. Dostaniesz 2 = (an − bn)k. Wywnioskuj stąd, że |an −bn| ⩽ 2. Teraz przyglądnij się dobrze ciągowi (1, 4, 9, 16, . . . ) kwadratów, ciągowi (1, 8, 27, 64, . . . ) sześcianów, ciągowi (1, 16, 81, 256, . . . ) bikwadratów, itd. Z2.A11 (IMO’98) b(a2b+a+b)−a(ab2 +b+7) = b2 −7a, więc podzielność (ab2 +b+7)|(a2b+a+b) i m p l i k u j e podzielność (ab2 + b + 7)|(b2 − 7a). Rozważamy osobno trzy przypadki: (1) b2 − 7a < 0, (2) b2 − 7a > 0, (3) b2 − 7a = 0. W przypadku (1) mamy ab2 + b + 7 ⩽ |b2 − 7a| = 7a − b2 (zobacz C2.2). Taka nierówność, wobec dodatniości a, b, jest możliwa tylko, gdy b2 < 7, czyli gdy zachodzi jeden z podprzypadków: (i ) b = 1 lub (ii ) b = 2. W podprzypadku (i ) badamy podzielność (a + 8)|(a2 + a + 1), czyli podzielność (a + 8)|(a(a + 8) − 7(a + 8) + 57), więc podzielność (a + 8)|57. Ponieważ 57 = 3 · 19, więc to może zachodzić tylko dla a = 11 i a = 49. Sprawdzamy, że pary (a, b) = (11, 1), (49, 1) są d o b r e. W podprzypadku (ii ) badamy podzielność (4a + 9)|(4 − 7a), czyli podzielność (4a + 9)|(4 − 7a + 2(4a + 9)), więc (4a + 9)|(a + 22). Taka podzielność implikowałaby nierówność 4a + 9 ⩽ a + 22, która (dla a ∈ N) jest możliwa tylko gdy a = 1, 2, 3, 4. Jednakże dla żadnej z tych wartości a nie zachodzi podzielność. W przypadku (2), znowu na mocy C2.2, dostajemy nieprawdziwą (dla liczb naturalnych!) nierówność ab2 + b + 7 ⩽ b2 − 7a. Pozostał do rozważenia przypadek (3). Wówczas b2 = 7a, skąd 7|b, czyli b = 7c, więc a = 7c2. Łatwo widzieć, że pary (a, b) = (7c2, 7c), przy dowolnym c ∈ N, spełniają warunki. Z2.A12 (1) Sprowadź tezę do nierówności ⌊2x⌋ + ⌊2y⌋ − ⌊x + y⌋ − ⌊x⌋ − ⌊y⌋ ⩾ 0 dla dowolnych x, y ∈ Q⩾0 (zob. C2.48, 47 i T2.17). W przypadku trudności, zob. ustęp 12.1.1; (2) Podobnie jak przed chwilą sprowadź tezę do nierówności ⌊2x⌋ + ⌊3y⌋ − 2⌊x⌋ − 3⌊y⌋ ⩾ 0; (3) Podobnie jak przed chwilą sprowadź tezę do nierówności ⌊(n − 1)! · n/ps⌋ − (n − 1)!⌊n/ps⌋ ⩾ 0; (4) Najprostsze rozwiązanie wynika z równości 1 n+1 (2n n ) = 2 (2n n ) − (2n+1 n+1 ). Eleganckie (kombinatoryczne) rozwiązanie znaleźć można w KOM . Arytmetyczne (za pomocą C2.48) rozwiązanie jest też możliwe! Z2.A13 Wystarczy udowodnić nierówność (∗) vp(B1B2· . . . ·Bs) ⩽ vp(A1A2· . . . ·As) dla dowolnej liczby pierwszej p, zob. C2.41. Ustalmy więc liczbę p ∈ P i zapiszmy At = pktA′ t, Bt = pltB′ t dla t = 1, 2, . . . , s, gdzie A′ t i B′ t są względnie pierwsze z p. Przestawiając ewentualnie czynniki możemy uznać, że k1 ⩾ k2 ⩾ . . . ⩾ ks i l1 ⩾ l2 ⩾ . . . ⩾ ls. Przyjmując kolejno m = pl1, pl2, . . . , pls, sprawdzamy, dzięki założeniu (2.31), że k1 ⩾ l1, k2 ⩾ l2, . . . , ks ⩾ ls. Stąd k1 + k2 + . . . + ks ⩾ l1 + l2 + . . . + ls, co, na mocy C2.43.1, dowodzi nierówności (∗) i kończy rozwiązanie. Z2.A14 S p o s ó b 1. Korzystamy z Z2.A13. Iloczyn (2.32) ma s := (n 2) = n(n−1) 2 czynników. Niech A1, A2, . . . , As oznaczają (dowolnie ustawione w ciąg) liczniki al −ak czynników tego iloczynu, zaś B1, B2, . . . , Bs oznaczają odpowiednie mianowniki l−k. Ustalmy teraz dowolną liczbę naturalną m. Twierdzimy, że liczby całkowite At i Bt spełniają nierówności (2.31). Aby to udowodnić oznaczmy przez nr moc zbioru tych indeksów i, dla których wyraz ai przy dzieleniu przez m daje resztę r. Tu r przebiega zbiór możliwych reszt, czyli r ∈ {0, 1, . . . , m − 1}. Jasne, że m|al − ak wtedy i tylko wtedy, gdy al i ak dają tę samą resztę z dzielenia przez m. Stąd wynika, że ilość par (k, l), dla 2.6. Zadania dodatkowe 51 których m|al − ak, czyli liczba stojąca po prawej stronie (2.31), równa jest (n0 2 ) + ( n1 2 ) + . . . + ( nm−1 2 ) = n2 0 + n2 1 + . . . + n2 m−1 − n 2 , (2.34) bo n0 + n1 + . . . + nm−1 = n. Aby wyznaczyć liczbę stojącą z lewej strony nierówności (2.31), zapiszmy n = qm + r, gdzie 0 ⩽ r < m i rozważmy następujące podzbiory zbioru {1, 2, . . . , n}: X1 = {1, m + 1, 2m + 1, . . . , qm + 1}, . . . . . . . . . Xr = {r, m + r, 2m + r, . . . , qm + r}, Xr+1 = {r + 1, m + r + 1, 2m + r + 1, . . . , (q − 1)m + r + 1}, . . . . . . . . . Xm = {m, 2m, . . . , qm}. Każdy ze zbiorów X1, . . . , Xr ma q+1 elementów dających stałą (w każdym zbiorze) resztę z dzielenia przez m. Każdy z pozostałych zbiorów Xr+1, . . . , Xm ma q elementów dających stałą (w każdym zbiorze) resztę z dzielenia przez m. Stąd widzimy, że liczba stojąca z lewej strony nierówności (2.28) jest równa r(q+1 2 ) + (m − r)(q 2 ), czyli rq + m (q 2). Aby zakończyć rozwiązanie wystarczy więc, dzięki Z2.A13 i równości (2.34), udowodnić, że rq + m (q 2 ) ⩽ n2 0 + n2 1 + . . . + n2 m−1 − n 2 . Nierówność ta jest r ó w n o w a ż n a następującej nierówności: ∑m−1 i=0 (ni − q) ⩽ ∑m−1 i=0 (ni − q)2, co wynika z równości ∑m−1 i=0 ni = n i r = n − mq (sprawdzenie pozostawiamy Czytelnikowi). Ponieważ dla liczb całkowitych zachodzi oczywista nierówność c ⩽ c2, więc wszystko jasne. S p o s ó b 2. Skorzystamy teraz z elementarnej wiedzy dotyczącej wyznaczników, w szczegól- ności tak zwanego wyznacznika Vandermonde’a. Czytelnik, który zna ten (skądinąd bardzo w a ż n y) wyznacznik, zauważył, że licznik, danej w (2.32), liczby L, jest równy wyznacznikowi (Van- dermonde’a) V (a1, a2, . . . , an). Rzeczywiście: V (x1, x2, . . . , xn) := det [xj−1 i ]1⩽i, j⩽n = ∏ 1⩽l<k⩽n (xk − xl). [Dowód (drugiej, bo pierwsza jest deﬁnicją!) równości jest prostym i sympatycznym zastosowaniem elementarnych własności wyznaczników (wystarczy to co można znaleźć w KOM 4.7.2) i indukcji matematycznej.] Wobec tego licznik liczby wymiernej L jest równy V (a1, a2, . . . , an), czyli det      1 a1 a2 1 . . . an−1 1 1 a2 a2 2 . . . an−1 2 .. .. .. . . . .. 1 an a2 n . . . an−1 n      (2.35) Z tej postaci, oczywiście, jeszcze nie widać, że ta liczba całkowita jest podzielna przez mianownik równy, jak łatwo widzieć, 1! · 2! · . . . · (n − 1)!. Korzystając z elementarnych (nie zmieniających wartości wyznacznika) operacji na kolumnach, znajdziemy postać wyznacznika (2.35), z której wszystko będzie jasne. W KOM znajdujemy (wygodne w kombinatoryce) oznaczenie tak zwanych potęg malejących: X k := X(X − 1) · . . . · (X − k + 1). Wymnażając dostaniemy równość X k = s0(k) + s1(k)X + . . . + sk(k)X k. 52 2. Elementarz (W KOM 4.4.4 są nieco inne oznaczenia.) Mając to, mnożymy j-tą kolumnę wyznacznika (2.35), dla j = 1, . . . , (n − 2), przez sj−1(n − 1) i dodając do ostatniej (n-tej) kolumny, otrzymamy (równy(!) liczbowo) wyznacznik, który różni się od (2.35) tym, że w jego ostatniej kolumnie zamiast zwykłych potęg a n−1 i stoją potęgi malejące a n−1 i . Podobnie postępujemy z kolumną (n − 1)-szą, (n − 2)-gą, itd. W wyniku dostaniemy wygodniejszą dla naszych celów postać wyznacznika (2.35): det       1 a1 a 2 1 . . . an−1 1 1 a2 a 2 2 . . . an−1 2 .. .. .. . . . .. 1 an a 2 n . . . an−1 n       Bardzo łatwo bowiem podzielić ten wyznacznik przez mianownik 0! · 1! · . . . · (n − 1)! liczby L, dzieląc wyrazy j-tej kolumny przez (j − 1)!. Dostaniemy w ten sposób równość L = det       (a1 0 ) (a1 1 ) (a1 2 ) . . . ( a1 n−1 ) (a2 0 ) (a2 1 ) (a2 2 ) . . . ( a2 n−1 ) .. .. .. . . . .. (an 0 ) (an 1 ) (an 2 ) . . . ( an n−1 )       , bowiem, porównaj KOM , liczbę 1 k! xk wygodnie jest oznaczać symbolem (x k) dla dowolnej liczby x (a nie tylko dla liczb naturalnych x). Oczywiście, dla zakończenia rozwiązania trzeba wykazać jeszcze, że liczba (x k) jest liczbą całkowitą dla d o w o l n e j całkowitej liczby x. Zostawiamy to jako ćwiczenie dla Czytelnika (zob. również Z3.C1(1) oraz C12.43). Liczba L została w ten sposób zinterpretowana jako wyznacznik macierzy kwadratowej o wyrazach całkowitych. Więc L ∈ Z. Z2.B1 Oznacz d = NWD (a, b). Niech a = da′, b = db′. Ponieważ a ̸= b, więc a′ ̸= b′. Zatem a′ +b′ ⩾ 3 (bo 3 jest najmniejszą sumą dwóch różnych liczb naturalnych). Stąd a+b = d(a′ +b′) ⩾ 3d. U w a g a. Tak samo można udowodnić uogólnienie: Jeżeli liczby naturalne a1, . . . , an są parami różne, to zachodzi nierówność NWD (a1, . . . , an) ⩽ 2 n(n+1) (a1 + · · · + an). Z2.B2 Oznacz d = NWD (a, b) i połóż a = da′, b = db′. Masz więc wykazać, że zachodzi równość NWD (d(a′ + b′), da′b′) = d (zobacz T2.9), czyli NWD (a′ + b′, a′b′) = 1. Robisz to tak: jeżeli k ∈ D(a′ +b′, a′b′) i k > 1, to istnieje liczba pierwsza p|k (zobacz T2.14). Wówczas p|a′b′, więc (b.s.o.) p|a′, oraz p|a′ + b′, więc p|b′ (na mocy Zasady Podstawowej). Stąd dostaniesz: p ∈ D(a′, b′). Ale to jest sprzeczne z względną pierwszością a′ ⊥ b′, zobacz C2.12. Z2.B3 Zapisz |a| = ∏i p αi i , |b| = ∏i pβi i , |c| = ∏i pγi i , zob. (RK) w 2.4.1. Dzięki C2.42, C2.47.1 sprowadź dowodzoną równość do równości max{2αi, 2βi, 2γi} + min{αi, βi} + min{βi, γi} + min{γi, αi} = min{2αi, 2βi, 2γi} + max{αi, βi} + max{βi, γi} + max{γi, αi}. Z2.B4 Z równości an + bn√2 = (1 + √2)n = (1 + √2)(1 + √2)n−1 = (1 + √2)(an−1 + bn−1√2) wywiedź równości an = an−1 + 2bn−1 i bn = an−1 + bn−1 (m u s i s z wykorzystać niewymierność√2, zob. 1.1.1 P). Stąd dostaniesz natychmiast an − 2bn = −an−1 i an − bn = bn−1. Załóż teraz, że d ∈ D(an, bn) (d jest wspólnym dzielnikiem). Dzięki udowodnionym związkom zobaczysz, że d ∈ D(an−1, bn−1). Oczywista indukcja wsteczna pokazuje więc, że d ∈ D(a1, b1). Ale D(a1, b1) = {1, −1}. I ostatecznie, NWD (an, bn) = 1 dla każdego n ∈ N. Z2.B5 Przedstaw NWD (m, n) w postaci kombinacji liniowej (o współczynnikach całkowitych) liczb m i n, zobacz (2.5). Możliwe jest też rozwiązanie za pomocą wzoru Legendre’a z T2.17 (!). Z2.B6 Oznaczmy k(X) = a + X i l(X) = ap−1 − ap−2X + ap−3X 2 − · · · + X p−1. Badamy więc największy wspólny dzielnik d := NWD (k(b), l(b)). Rozważmy w tym celu wielomian f (X) = 2.6. Zadania dodatkowe 53 k(X)p−1 − l(X) + (−1)spasX s zmiennej X o współczynnikach całkowitych, gdzie (dla uproszczenia) oznaczyliśmy s = (p − 1)/2. Sprawdzenie, że f (−a) = 0, jest natychmiastowe. Wobec tego (tu korzystamy z twierdzenia B´ezout’a, zobacz T3.2) istnieje taki wielomian g(X) o współczynnikach całkowitych, że zachodzi równość f (X) = (X + a)g(X). Kładąc tu X = b dostajemy więc równość k(b)p−1 − l(b) + (−1)spasbs = k(b)g(b). Z tej równości, na mocy Zasady Podstawowej, widzimy, że d|pasbs. Ale d ⊥ a i d ⊥ b (dlaczego?). Więc, na mocy ZTA, mamy tezę. Z2.B7 Zauważ, że vp(NWW (1, 2, . . . , ⌊n/k⌋)) = s iﬀ ⌊n/ps+1⌋ < k ⩽ ⌊n/ps⌋. Z2.B8 Przetestuj liczby m = a, n = a2 − a + 1, dla a ∈ N. Możesz też ”pobawić” się z (9.8). Z2.B9 O ciągu (an)n∈N = (a1, a2, . . . ) o wyrazach całkowitych mówimy, że ▷ ma własność podzielności, gdy am|an dla wszystkich m|n; ▷ jest NWD -ciągiem, gdy NWD (am, an) = ± aNWD (m, n) dla wszystkich m, n. Mamy więc dowieść, że ciąg (an − 1)n∈N jest NWD -ciągiem. Udowodnimy ogólniejsze: T w i e r d z e n i e 1. Jeżeli a, b ∈ Z i a ⊥ b, to ciąg (un) = (an − bn) jest NWD -ciągiem. D o w ó d. Pokazujemy najpierw, że: ciąg (un) = (an − bn) ma własność podzielności. To wynika z (1.8): jeżeli n = qm, to un = (am(q−1) + am(q−2)bm + · · · + ambm(q−2) + bm(q−1))(am − bm) =: cum. Niech teraz n = qm + r, 0 ⩽ r < m, będzie dzieleniem z resztą. Wtedy un = a n − b n = b r(aqm − b qm) + aqm(a r − b r) = b ruqm + a qmur = b rcum + a qmur. Z tej równości natychmiast wynika zawieranie D(um, ur) ⊆ D(un, um) zbiorów wspólnych dzielników. Jest też odwrotnie: D(un, um) ⊆ D(um, ur). Rzeczywiście, jeżeli d ∈ D(un, um), to d|aqmur, więc, dzięki d ⊥ a (uzasadnić!) i ZTA, d|ur. Zatem D(un, um) = D(um, ur). Kontynuując algorytm Euklidesa dla pary n, m, dostajemy kolejno: D(un, um) = D(um, ur) = · · · = D(ud, 0) = D(ud), gdzie d = NWD (n, m). Q.e.d. U w a g a 1. Każdy NWD -ciąg ma własność podzielności. Rzeczywiście, a|b wtedy i tylko wtedy, gdy NWD (a, b) = ±a. Jeżeli więc m|n, to am = aNWD (m, n) = ±NWD (am, an), czyli am|an. U w a g a 2. Zastanowimy się nad przypadkiem ”plusowym”, czyli nad ciągiem (vn) = (an + bn). Taki ciąg na ogół n i e jest NWD -ciągiem, a nawet nie ma własności podzielności (Czytelnik zechce to przetestować na przykładzie ciągu (Vn) = (2n +1)). Możemy jednak udowodnić, że ma on następującą własność nieparzystej podzielności: Jeżeli m|n i n/m jest liczbą nieparzystą, to vm|vn. To wynika z ”plusowej” wersji tożsamości nieśmiertelnej, zob. 2.4.2 U: skoro n = km i 2 ∤ k, to an +bn = (am)k + (bm)k = (am + bm)Qk(am, −bm). Czasem korzystamy również z poniższego twierdzenia: T w i e r d z e n i e 2. Jeżeli a, b ∈ Z, gdzie a ⊥ b, to dla n i e p a r z y s t y c h m, n ∈ N zachodzi równość NWD (vm, vn) = ±vNWD (m, n). D o w ó d. Niech b1 = −b. Wówczas ak + bk = ak − bk 1, gdy 2 ∤ k. Zatem, dla nieparzystych m, n: D(an + bn, am + bm) = D(an − bn 1 , am − bm 1 ) = D(ad − bd 1) = D(ad + bd), gdzie d = NWD (m, n). Druga równość wynika z Twierdzenia 1 (bo a ⊥ b iﬀ a ⊥ b1), a trzecia z nieparzystości d (dzielnik liczby nieparzystej jest nieparzysty!). Q.e.d. Z2.B10 Równości NWD (an, aln) = NWD (n, ln) = n pokazują, że n|an dla każdego n ∈ N. Wywnioskuj stąd ogólnie równość zbiorów dzielników D(an) = D(n) dla każdego n ∈ N. Z2.B11 Oznacz M = NWW (k1, k2, . . . , kn). Zauważ, że M/kn < M/kn−1 < · · · < M/k1. Udowodnij przez i n d u k c j ę, że jeżeli A ⊂ N i card(A) = n, to max(A) ⩾ n. Z2.B12 Uzasadniamy, przez indukcję względem q, że dla dowolnych x, y, q ∈ N zachodzi równość f (x, y + qx) = f (x, y). Bazą tej indukcji jest po prostu założona równość (3). Oto krok indukcyjny: f (x, y + (q + 1)x) = f (x, (y + x) + qx) = f (x, y + x) = f (x, y). Załóżmy teraz, że n > m i że n = qm + r jest dzieleniem z resztą d o d a t n i ą. Wówczas f (m, r) = f (m, r + qm) = f (m, n). Jasne, że analogicznie dostajemy f (r, r1) = f (m, r), jeżeli m = q1r + r1 jest drugą linijką algorytmu 54 2. Elementarz Euklidesa i reszta r1 jest dodatnia. Itd. W ten sposób możemy ”dojść” do ostatniej niezerowej reszty w algorytmie, czyli dzielenia rs−1 = qs+1rs + rs+1 i otrzymać równości f (m, n) = f (r, m) = · · · = f (rs+1, rs). Wiemy, że rs = qs+2rs+1 oraz rs+1 = NWD (m, n). Dla zakończenia rozwiązania wystarczy więc udowodnić (przez prostą indukcję względem k), że f (x, kx) = x dla x, k ∈ N. Z2.B13 Teza wynika natychmiast z tożsamości kombinatorycznej (zobacz Z3.C4). ( k 0 )(n k ) − (k 1 )( n + 1 k ) + . . . + (−1) k(k k )( n + k k ) = (−1) k. (2.36) Z2.B14 Oznaczmy Ai = (ai) ∩ [1951]. Zbiór Ai jest więc podzbiorem (wszystkich) dodatnich wielokrotności liczby ai niewiększych niż 1951 (zawartych w zbiorze [1951] := {1, 2, . . . , 1951}). Moc zbioru Ai jest równa ⌊1951/ai⌋. Założenie NWW (ai, aj) > 1951 implikuje r o z ł ą c z n o ś ć zbiorów Ai, Aj. Wobec tego 1951 ⩾ |A1| + |A2| + · · · + |An| = n∑ i=1 ⌊ 1951 ai ⌋ > n∑ i=1 ( 1951 ai − 1) = 1951 n∑ i=1 1 ai − n, bo ⌊x⌋ > x − 1 dla każdej liczby rzeczywistej x. Jednocześnie n ⩽ 1951. Stąd teza. Z2.C0 Wystarczy zauważyć, że p + q = 2 · p+q 2 , a liczba p+q 2 nie jest liczbą pierwszą (bo leży między k o l e j n y m i liczbami pierwszymi). Z2.C1 Liczba a2 + b2 + c2 + d2 jest(!) różnicą kwadratów (a + d)2 − (b + c)2, więc jest iloczynem (a + d + b + c)(a + d − b − c). Jasne, że 1 < a + d + b + c ⩽ a2 + d2 + b2 + c2, przy czym druga nierówność jest nieostra t y l k o gdy a = b = c = d = 1 (ale wtedy ad ̸= b2 + bc + c2). Z2.C2 (1) Zobacz tożsamość Sophie Germain. (2) Wykorzystaj tożsamość (1.8) i tożsamość x4+x3+x2+x+1 = (x2+3x+1)2−5x(x+1)2. (3) Rozłóż f (x) := x3k+2+x3l+1+1 na iloczyn: Odejmij i dodaj x2+x+1. Otrzymasz x3k+2+x3l+1+1 = x2((x3)k−1)+x((x3)l−1)+x2+x+1. Tożsamość (1.8) pozwala napisać równość postaci x3k+2 +x3l+1 +1 = (x2 +x+1)g(x). U w a g a. Warto też przeczytać ustęp 3.4.5, gdzie można się dowiedzieć, że istnienie rozkładu f (x) = (x2 + x + 1)g(x) jest równoważne dwóm równościom f (ω3) = f (ω2 3) = 0. (4) Indukcja względem n: Bazą jest T1 = 28 = 2 · 2 · 7. Dzięki tożsamości x3 + 1 = (x + 1)(x2 − x + 1) dostaniesz równość Tn+1 = Tn · (32·3n − 33n + 1). Drugi czynnik jest różnicą kwadratów (33n + 1)2 − (3(3n+1)/2)2. To wystarcza. Z2.C3 Załóżmy, nie wprost, że a < b są dzielnikami danej liczby naturalnej n leżącymi w przedziale [ √ n; √n + 4√n ]. Niech d = NWD (a, b), i a = dk, b = dl dla k < l, k ⊥ l. Zapisać n = d0dkl. Z założenia √d0dkl ⩽ dk wywieść nierówność d0 < d. Stąd √d0d ⩽ √ (d − 1)d < d − 1 2 (druga z tych nierówności jest nierównością AG). Podobnie √kl ⩽ √ (l − 1)l < l − 1 2 . Stąd dl = b ⩽ √d0d √kl + 4√d0d 4√kl < (d − 1 2 ) ( l − 1 2 ) + √(d − 1 2 ) ( l − 1 2 ) < dl − d+l 2 + 1 4 + d+l−1 2 , gdzie ostatnia nierówność znowu wynika z AG. Sprzeczność. Z2.C4 Będziemy (tu i w innych miejscach) korzystać z wygodnego oznaczenia. Jeżeli a ∈ Z, to oznaczamy Supp(a) = {p ∈ P : p|a}. Zbiór Supp(a) jest więc zbiorem wszystkich dzielników pierwszych liczby a ∈ Z. Nazywamy go nośnikiem (ang. support) liczby a. Należy przekonać się o prawdziwości poniższych tez: T e z a 0. Supp(0) = P; T e z a 1. Supp(a) = ∅ ⇐⇒ a = ±1; T e z a 2. a|b =⇒ Supp(a) ⊆ Supp(b); T e z a 3. Supp(NWD (a, b)) = Supp(a) ∩ Supp(b); T e z a 4. a ⊥ b ⇐⇒ Supp(a) ∩ Supp(b) = ∅; T e z a 5. Supp(NWW (a, b)) = Supp(ab) = Supp(a) ∪ Supp(b). 2.6. Zadania dodatkowe 55 Jeżeli wszystkie dzielniki pierwsze liczby a2d − 1 są jednocześnie dzielnikami pierwszymi liczby ad − 1, czyli jeżeli Supp(a2d − 1) ⊆ Supp(ad − 1), to zachodzi równość zbiorów Supp(a2d − 1) = Supp(ad − 1) (zawieranie przeciwne Supp(ad − 1) ⊆ Supp(a2d − 1) wynika bowiem z podzielności ad − 1|a2d − 1). Przeto Supp(ad + 1) ⊆ Supp(a2d − 1) = Supp(ad − 1). Jeżeli więc p ∈ Supp(ad + 1), to p ∈ Supp(ad − 1), i wówczas p dzieli różnicę (ad + 1) − (ad − 1) = 2. Stąd p = 2. Wobec tego ad + 1 = 2r przy pewnym r ∈ N. Czyli Mr = ad. Ale, zobacz Z2.D9, to jest możliwe tylko, gdy d = 1, czyli gdy a = Mr. Z2.C5 Zauważmy, że m|nk ⇐⇒ Supp(m) ⊆ Supp(n). Mamy wykazać, że dla dowolnego p ∈ Supp(m) zachodzi vp(mmm) ⩽ vp(nnn), zob. C2.41, czyli mmvp(m) ⩽ nnvp(n), zob. C2.43.1. Ta nierówność jest oczywista, gdy m = n. Gdy zaś m < n, czyli, zob. Zasada Skwantowania, m+1 ⩽ n, to mmvp(m) ⩽ mm+1 ⩽ mn < nn ⩽ nnvp(n), bo vp(m) ⩽ m i 1 ⩽ vp(n). Dowód nierówności vp(m) ⩽ m: Niech e = vp(m). Wtedy e < 2e ⩽ pe ⩽ m (pierwszej nierówności dowodzimy przez indukcję). U w a g a. Przy założeniach z zadania, na ogół mm ∤ nn. Przykład 44 ∤ 66. Z2.C6 Używamy skrótu Ar := ar − 1. Mamy Supp(Ak) = Supp(A1). Dowodzimy, że wówczas: F a k t 1. Jeżeli l|k, to Supp(Al) = Supp(Ak) = Supp(A1). D o w ó d. Mamy Supp(A1) ⊆ Supp(Al) ⊆ Supp(Ak) = Supp(A1). Q.e.d. F a k t 2. Jeżeli l|k, to Supp(Al/A1) ⊆ Supp(l). D o w ó d. Niech p ∈ Supp(Al/A1). Wtedy p ∈ Supp(Al) = Supp(A1), czyli a = pu + 1. Stąd Al/A1 = l−1∑ j=0 a j = (pu + 1)l−1 + (pu + 1)l−2 + · · · + (pu + 1) + 1 = pU + l. Skoro więc p|(Al/A1), to (Zasada Podstawowa!) p|l, czyli p ∈ Supp(l). Q.e.d. Mając to, dowodzimy, że Supp(k) ⊆ {2}. Załóżmy, nie wprost, że vp(k) = α ⩾ 1 dla pewnej liczby pierwszej p > 2. Niech l = pα. Wtedy Supp(l) = {p}, więc, na mocy Faktu 2, Supp(Al/A1) = {p}. To znaczy, że Al/A1 = pβ przy pewnym β ⩾ 1. Mamy wówczas β = vp(pβ) = vp ( Al A1 ) = vp(Al) − vp(A1) = vp(l) = α. Trzecia równość wynika z LZW (który można zastosować, bo p > 2 i vp(A1) ⩾ 1, co wynika z {p} = Supp(Al/A1) ⊆ Supp(Al) = Supp(A1), zob. Fakt 1). Widzimy porażającą s p r z e c z n o ś ć: l = p α = p β = Al A1 = a l−1 + al−2 + · · · + a + 1. Wobec tego k może się dzielić tylko przez parzyste liczby pierwsze, czyli k = 2m. Pokazujemy teraz, że m = 1. Gdyby m ⩾ 2, to mielibyśmy 4|k, skąd Supp(a − 1) ⊆ Supp(a2 − 1) ⊆ Supp(a4 − 1) ⊆ Supp(ak − 1), więc Supp(a4 − 1) = Supp(a2 − 1). Ale taka równość, na mocy Z2.C4, może zachodzić wyłącznie dla a = 1. W ten sposób udowodniliśmy równość k = 2. Mamy więc równość Supp(a2 − 1) = Supp(a − 1), skąd Supp(a + 1) ⊆ Supp(a2 − 1) = Supp(a − 1). Jeżeli więc q ∈ Supp(a + 1), to q ∈ Supp(a − 1), skąd q|(a + 1) − (a − 1), czyli q|2. Zatem a + 1 = 2r. U w a g a 1. Teza daje się uogólnić. Zachodzi mianowicie (IMO’97 Shortlisted Problem 14): T w i e r d z e n i e. Jeżeli Supp(bm − 1) = Supp(bn − 1) dla b ∈ N⩾2 i pewnych liczb naturalnych 1 ⩽ m < n, to m = 1, n = 2 oraz b + 1 = 2r dla pewnego r ∈ N. D o w ó d. Niech d = NWD (m, n), n = dk, i połóżmy a = bd. Wówczas Supp(a − 1) = Supp(b m − 1) ∩ Supp(b n − 1) = Supp(b n − 1) = Supp(ak − 1), 56 2. Elementarz gdzie pierwsza równość wynika z równości a − 1 = NWD (bm − 1, bn − 1) = bd − 1, zobacz Z2.B9, i Tezy 3 z rozw. Z2.C4. Mamy albo k = 1 albo k ⩾ 2. W pierwszym przypadku, n = d ⩽ m, co jest nieprawdą (bo m < n). W drugim przypadku, na mocy naszego zadania, k = 2. Wtedy m = d, n = 2d, więc, zobacz Z2.C5, d = 1. Ostatecznie, b + 1 = a + 1 = Mr + 1 = 2r. Z2.C7(1) Niech n|2n + 1, czyli 2n + 1 = nk. Jasne, że k jest nieparzysta. Mamy wykazać, że N |2N + 1, gdzie N = 2n + 1 = nk. Wobec nieparzystości k mamy 2N + 1 = 2 nk + 1 = (2 n)k + 1 = (2 n + 1)((2n) k−1 − (2 n)k−2 + · · · − 2n + 1) = N a na mocy ”plusowego” wariantu tożsamości nieśmiertelnej (zob. 2.3.4 U). U w a g a. Ponieważ 1 jest liczbą Nov´aka, więc 3, 9, 513, . . . są liczbami Nov´aka. Wobec tego, istnieje n i e s k o ń c z e n i e wiele liczb Nov´aka. Łatwo też (przez indukcję) dowieść, że wszystkie liczby n = 3k są liczbami Nov´aka. Korzystając z LZW, mamy nawet więcej: v3(23k + 1) = v3(2 + 1) + v3(3k) = 1 + k. Z2.C7(2) Zauważmy, że liczby Nov´aka, jako dzielniki liczb nieparzystych Vn := 2n + 1, są n i e p a r z y s t e. Wiemy, że NWD (Vk, Vk) = VNWD (k, l) dla nieparzystych k, l (zobacz Tw 2 w rozwiązaniu Z2.B9). Zatem: jeżeli k, l są liczbami Nov´aka, a d = NWD (k, l), to k|Vk, l|Vl, więc d|Vk, d|Vl, skąd d|NWD (Vk, Vl) (zob. D2.4(2)), czyli d|Vd. Przeto d jest liczbą Nov´aka. Załóżmy teraz, że m = NWW (k, l) dla liczb Nov´aka k, l. Wówczas Vk|Vm, Vl|Vm, bowiem k|m, l|m, a ciąg (Vn), jak każdy ciąg (an + bn), ma ”nieparzystą” własność podzielności, zob. U2 w rozwiązaniu Z2.B9. Zatem k|Vm i l|Vm. Więc m|Vm. Z2.C7(3) Podkreślmy, że p > 2 (liczba 2n + 1 nie ma dzielników parzystych). Wobec tego Vn|Vnp. Więc p|Vn|Vnp i n|Vn|Vnp. To niestety nie wystarcza dla dowodu, że np|Vnp (bo nie mamy założenia n ⊥ p). Ale, oznaczając vp(n) = α i pisząc n = pαk, gdzie p ∤ k, mamy vp(Vnp) = vp((2 n) p + 1) = vp(2 n + 1) + 1 ⩾ vp(n) + 1 = α + 1, na mocy (2.24) (nierówność wynika z podzielności n|2n +1). Stąd pα+1|Vnp. Jednocześnie k|n|Vn|Vnp, więc, zobacz C2.17, pα+1k|Vnp, czyli np|Vnp. Z2.C7(4) Oczywista iteracja rozumowania z Z2.C7(3) pokazuje, że prawdziwy jest F a k t. Jeżeli p1, . . . , ps są dzielnikami pierwszymi liczby Vn, a przy tym n jest liczbą Nov´aka, to iloczyn n · pe1 1 · . . . · pes s jest liczbą Nov´aka dla dowolnych wykładników e1, . . . , es ∈ N. Mając to, weźmy dwie liczby Nov´aka m i n. Niech d := NWD (m, n) = ∏p∈P pvp(d) i niech m = dm′, n = dn′. Wówczas, zob. Z2.C7(2), N = dm′n′ jest liczbą Nov´aka i p|N |VN dla wszystkich p, dla których vp(d) > 0. Na mocy faktu, N d = mn jest więc liczbą Nov´aka. Z2.C7(5) L e m a t. Jeżeli n jest liczbą Nov´aka, przy czym n = 3αk, gdzie 3 ∤ k i α ⩾ 1, to istnieje taka liczba pierwsza p, że p|V3n i p ∤ k. D o w ó d. Mamy V3n = (2n + 1)(22n − 2n + 1). Twierdzimy, że każdy różny od 3 dzielnik pierwszy liczby 22n − 2n + 1 jest dobry. Wykazujemy najpierw, że liczba 22n − 2n + 1 m a dzielnik pierwszy różny od 3. To wynika z równości (zob. LZW) v3(V3n) = v3(2 3n + 1) = v3((23)3αk + 1) = v3(2 3 + 1) + v3(3 αk) = 2 + α, v3(Vn) = v3(2 n + 1) = v3((23) 3α−1k + 1) = v3(2 3 + 1) + v3(3 α−1k) = 2 + α − 1. Stąd v3(22n − 2n + 1) = v3(V3n) − v3(Vn) = 1. Wobec tego 22n − 2n + 1 = 3m, gdzie 3 ∤ m i m > 1. Weźmy dowolny dzielnik pierwszy p|m. Wykazujemy teraz, że p ∤ Vn. To wynika z równości NWD (a 2 − a + 1, a + 1) = NWD (3, a + 1) 2.6. Zadania dodatkowe 57 prawdziwej dla dowolnej liczby naturalnej a > 2 (równość ta jest natychmiastowym wnioskiem na- stępującego dzielenia z resztą a2 − a + 1 = (a − 2)(a + 1) + 3). Z równości tej wnioskujemy (kładąc a = 2n), że j e d y n y m wspólnym dzielnikiem pierwszym liczb 22n − 2n + 1 i Vn może być tylko 3. Zatem, ponieważ p|22n − 2n + 1 i p ̸= 3, więc p ∤ Vn i, tym bardziej, p ∤ k (bo k|n|Vn). Q.e.d. Jasne jest teraz jak, startując od liczby Nov´aka n1 = 3, udowodnić przez indukcję, że dla do- wolnej liczby s ∈ N istnieje podzielna przez 3 liczba Nov´aka ns mająca dokładnie s różnych dziel- ników pierwszych. Rzeczywiście, jeżeli znamy już liczbę ns, to, wobec lematu, wystarczy położyć ns+1 = 3nsp (i, korzystając najpierw z Z2.C7(4), uzasadnić, że 3ns jest liczbą Nov´aka, a następnie, korzystając z Z2.C7(3), że 3nsp również jest liczbą Nov´aka). Z2.D0 Jeżeli x = 2n + 1, to x2 = 4n2 + 4n + 1 = 4N + 1. Jeżeli zaś x = 2m, to x2 = 4M . Tak natraﬁamy na jeden z n a j w a ż n i e j s z y c h p o m y s ł ó w w teorii liczb: Kwadrat daje resztę 0 lub 1 przy dzieleniu przez 4. Stąd wyciągamy wniosek: Suma dwóch (trzech) kwadratów nieparzystych daje resztę 2 (resztę 3) przy dzieleniu przez 4. Dla rozwiązania trzeciej części zadania rozważmy równanie 12 + 32 + 52 + w2 = t2, czyli 35 = t2 − w2 = (t − w)(t + w). Rozwiązując układ równań t − w = 1, t + w = 35 znajdujemy równość 12 + 32 + 52 + 172 = 182. Możemy ją teraz pomnożyć stronami przez kwadrat dowolnej liczby nieparzystej. Z2.D1 Dowiedź kolejno tez: (1) Liczba jest podzielna przez 10 wtedy i tylko wtedy, gdy jej ostatnią cyfrą jest 0; (2) Kwadrat podzielny przez 10 jest podzielny przez 100; (3) Kwadrat ma parzystą liczbę cyfr 0 na końcu; (4) Jeżeli a, n ∈ N i a2|n, to n jest kwadratem wtedy i tylko wtedy, gdy iloraz n a2 jest kwadratem; (5) 2|n i 4 ∤ n. Z2.D2 Niech K := 103a + 102a + 10b + b. Wtedy K = 11(99a + (a + b)). Jeżeli więc K jest kwadratem, to 112|K, skąd 11|a + b. Musimy więc sprawdzić osiem(!) przypadków: a = 2, . . . , 9, b = 11 − a. Dobry jest tylko przypadek a = 7, b = 4. Z2.D3 Ponieważ NWD (a, a + 1) = 1 (zob. C2.10), więc NWD (3a, a + 1) = 1 lub 3. Założona równość 3a(a+1) = (3b)2 w pierwszym przypadku daje tezę (zobacz trik T2.19). W drugim przypadku mamy a + 1 = 3c i ac = b2, więc (trik !) a = d2, zatem d2 + 1 = 3c. To jest niemożliwe, bo dla d = 3t mamy d2 + 1 = 3T + 1 ̸= 3c, a dla d = 3t ± 1 mamy d2 + 1 = (9t2 ± 6t + 1) + 1 = 3T + 2 ̸= 3c. Z2.D4 (1) Jeżeli 4n −3n = x2, to (2n −x)(2n +x) = 3n. Stąd (na mocy jednoznaczności rozkładu na czynniki pierwsze) 2n − x = 3s i 2n + x = 3t dla s, t ∈ Z⩾0 spełniających s + t = n. Dodając te równości stronami dostajemy 2n+1 = 3s + 3t. To jest możliwe tylko, gdy s = 0, t = n. Więc 2n+1 = 1 + 3n. Ta równość zachodzi t y l k o dla n = 1 (bo 2n+1 < 1 + 3n dla wszystkich n ⩾ 2). (2) Gdy n = 2k + 1, to 5n − 3n = (4 + 1)2k+1 − (4 − 1)2k+1 = (4a + 1) − (4b − 1) = 4A + 2, więc 5n − 3n n i e jest kwadratem (zobacz rozwiązanie Z2.D1). Jeżeli zaś n = 2k i 5n − 3n = x2, to mamy (5k − x)(5k + x) = 3n, czyli 5k − x = 3s i 5k + x = 3t dla s, t ∈ Z⩾0, s + t = n. Dodając stronami mamy 2 · 5k = 3s + 3t, co jest możliwe tylko, gdy s = 0, t = n. Więc 2 · 5k = 1 + 32k. Ta równość zachodzi t y l k o dla k = 1 (bo 2 · 5k < 1 + 32k dla wszystkich k ⩾ 2). Z2.D5 Mamy T1 = 1, T2 = 3, T3 = 6, T4 = 10, T5 = 15, T6 = 21, T7 = 28, T8 = 36. I s t n i e j ą więc liczby trójkątne będące kwadratami. Załóżmy, że Tk = a2 jest kwadratem. Wówczas T4k2+4k = (4k2 + 4k)(4k2 + 4k + 1) 2 = 4 · k(k + 1) 2 · (2k + 1)2 = (2a(2k + 1))2. Mamy więc metodę znajdowania coraz większych liczb trójkątnych będących kwadratami. Stąd teza. U w a g a. Opisana metoda nie daje wszystkich rozwiązań równania Tx = y2. Na przykład T49 = 352. Później (zob. równanie indyjskie) nauczymy się znajdować w s z y s t k i e rozwiązania tego równania. Z2.D6 (A) Gdyby n(n + 1) = x2, to, zobacz C2.10 i T2.19, n = a2 i n + 1 = b2. Przyglądając się kwadratom (0, 1, 4, 9, . . . ) widzimy, że mogą się one różnić o 1 tylko gdy mniejszy jest równy 0. W 58 2. Elementarz naszym przypadku to odpada. (B) Liczby całkowite kolejne są względnie pierwsze. Zatem n ⊥ n + 1 i n+2 ⊥ n+1. Więc n(n+2) ⊥ n+1 dla dowolnej liczby n ∈ N. Gdyby n(n+1)(n+2) = x2, to, wobec powiedzianego i triku T2.19, byłoby n(n + 2) = a2 (i n + 1 = b2). Wtedy a2 = n(n + 2) = n2 + 2n = (n + 1)2 − 1 i, znowu, kwadraty (n + 1)2 i a2 leżałyby zbyt blisko siebie. (C) Mnożąc w iloczynie x(x + 1)(x + 2)(x + 3) osobno pierwszy czynnik przez czwarty i osobno drugi przez trzeci, dostajemy iloczyn (x2 + 3x)(x2 + 3x + 2). Iloczyn postaci A(A + 2) jest różnicą kwadratów (A + 1)2 − 12. Zatem x(x + 1)(x + 2)(x + 3) = (x2 + 3x + 1)2 − 12. Z tożsamości tej wnioskujemy, że iloczyn czterech kolejnych liczb naturalnych leży zbyt blisko kwadratu, by sam mógł być kwadratem. Z2.D7 Zauważmy, że (n + 1)3 − n3 = m2 ⇐⇒ 3(2n + 1)2 = (2m − 1)(2m + 1). Łatwo widzieć, że 2m − 1 ⊥ 2m + 1 (NWD tych liczb dzieli ich różnicę równą 2, ale jest ̸= 2, bo 3(2n + 1)2 jest liczbą nieparzystą). Zatem 3 dzieli jedną (i tylko jedną) z liczb 2m − 1, 2m + 1. Pokazujemy, że 3 ∤ 2m − 1: Gdyby 2m − 1 = 3k, to dostalibyśmy równość (2n + 1)2 = 2m−1 3 (2m + 1) = k(3k + 2) i, na mocy triku z T2.19, 3k + 2 = y2, co jest niemożliwe (kwadrat przy dzieleniu przez 3 nie daje reszty 2). Musi być więc 2m + 1 = 3l dla pewnego l ∈ N. Wtedy na mocy równości (2n + 1)2 = (3l − 2)l i triku mamy 3l − 2 = x2 = (2u + 1)2 (bo x, jako dzielnik liczby nieparzystej (2n + 1)2, jest postaci 2u + 1). Stąd 2m = 3l − 1 = x2 + 1 = (2u + 1)2 + 1 = 2((u + 1)2 + u2), czyli m = (u + 1)2 + u2. Z2.D8 Załóżmy, że Vn = xm. Gdy m = 2k, to, oznaczając xk = 2c + 1 (co jest możliwe, bo x jest nieparzyste!), dostajemy równość 2n = x2k − 1 = (xk − 1)(xk + 1) = 4c(c + 1), z której wynika, że c = 1 (z liczb c i c + 1 jedna jest bowiem nieparzysta!), czyli 2n = 8, więc n = 3. Załóżmy teraz, że m jest nieparzysta. Wtedy, na mocy tożsamości nieśmiertelnej, 2n = (x − 1)(xm−1 + · · · + x + 1). Drugi czynnik z prawej strony strony tej równości jest sumą nieparzystej (równej m) liczby składników nieparzystych, więc jest liczbą nieparzystą. Skąd m = 1. U w a g a. Czwórkę (x, y; m, n) liczb naturalnych nazwiemy czwórką Catalan’a, gdy m, n ⩾ 2 i zachodzi równość xm − yn = 1. Czwórki Catalan’a dostarczają więc właściwych potęg yn < xm (liczb naturalnych) będących liczbami kolejnymi (tzn., różniącymi się o 1). Eug`ene Catalan (Belgia) postawił (1842) hipotezę, że j e d y n ą czwórką Catalan’a jest czwórka (3, 2; 2, 3). Ta hipoteza, tzw. problem Catalan’ a, została ostatecznie udowodniona (2002) przez P. Mih˘ailescu (Rumunia). Poka- zane rozwiązanie jest więc dowodem przypadku szczególnego hipotezy: Jedyną czwórką Catalan’a, w której y = 2, jest czwórka (3, 2; 2, 3). Inny przypadek szczególny mamy poniżej. Zobacz też Z2.I4. Z2.D9 Niech Mm = yn. Sprawdzamy, że 2 ∤ n: Gdyby n = 2k, to równość 2m − 1 = yn dałaby się zapisać tak: 2 · (2m−1 − 1) = (yk − 1)(yk + 1). Taka równość jest niemożliwa, bo prawa strona jest iloczynem dwóch czynników parzystych (y jest liczbą nieparzystą!), więc jest podzielna przez 22, a lewa strona jest podzielna tylko przez 21. Niech więc n ⩾ 3 będzie liczbą nieparzystą. Korzystamy z ”plusowego” wariantu tożsamości nieśmiertelnej dla wykładnika nieparzystego, zobacz 2.4.2 U. Równość Mm = yn zapisujemy tak: 2m = (y+1)(yn−1−yn−2+ . . . −y+1). Z jednoznaczności rozkładu (liczb naturalnych) na czynniki pierwsze wnosimy stąd, że y +1 = 2l dla pewnego 1 ⩽ l < m (nie może być l = m, bo wtedy n = 1). Czyli v2(y + 1) ⩾ 1. Możemy teraz skorzystać z ”plusowego” wariantu LZW dla p = 2, zobacz C2.52. Dostajemy m = v2(2m) = v2(yn + 1) = v2(y + 1) + v2(n) = l + 0 = l. Sprzeczność. Widzimy więc, że Nie istnieje czwórka Catalan’a, w której x = 2. Z2.D10 Zbadamy najpierw czy może być x = y. Ponieważ x2 + 5x < (x + 3)2, więc liczba x2 + 5x, jako większa od x2, może być co najwyżej jednym z dwóch kwadratów: (x + 1)2, (x + 2)2. Pierwsza z równości x2 + 5x = (x + 1)2, x2 + 5x = (x + 2)2 (jako równoważna równości 3x = 1) jest niemożliwa, a druga daje x = 4. Mamy więc parę (x, y) = (4, 4). Załóżmy teraz, że x < y. Wówczas y2 +5x < y2 +5y < (y +3)2. Mamy zatem: (1) y2 +5x = (y +1)2 lub (2) y2 +5x = (y +2)2. Z2.D11 Zapiszmy xy = a2c i (p − x)(p − y) = b2d, gdzie c, d są bezkwadratowe (zob. C2.36). Wnioskujemy stąd, że c = d: Ponieważ xy(p − x)(p − y) = (ab)2cd jest kwadratem, więc cd jest kwadratem, skąd, wobec bezkwadratowości c i d, c = d. Zatem p(p − x − y) = (p − x)(p − y) − xy = 2.6. Zadania dodatkowe 59 c(b−a)(b+a). Jednocześnie a ⩽ √a2c = √xy ⩽ (x+y)/2 ⩽ (p−1)/2 i b ⩽ √b2c = √ (p − x)(p − y) ⩽ (2p − x − y)/2 < p (na mocy nierówności AG). Stąd wynika, że b − a < p, oraz b + a < 2p. Ponieważ p ∤ c (gdyby p|c mielibyśmy p|xy, czyli p|x lub p|y, co jest niemożliwe ze względów ”wielkościowych”). Przeto b + a = p. Zakładając teraz, że x ̸= y, mamy sprzeczność: p = b + a < 2p − x − y 2 + x + y 2 = p. Z2.D12 Nie. Gdyby bowiem x + 2y = a2, 5x + 13y = b2 i 7x + 11y = c2, mielibyśmy równość b2 + c2 = 3(2a)2 i punkt wymierny ( b 2a , c 2a ) na okręgu o równaniu u2 + w2 = 3, zobacz C2.66. Z2.E1 (1) Spróbuj rozwiązać układ równań 14x + y = 2u, x + 14y = 2w. (2) Zauważ, że NWD (y − 2, y + 2) = 1 i zastosuj trik z T2.19. Z2.E2 Załóżmy (b.s.o.), że a ⩽ b. Jasne, że c > b. Więc (Zasada Skwantowania) c ⩾ b + 1 skąd cn ⩾ (b + 1)n. I an + bn = cn ⩾ (b + 1)n = bn + (n 1)bn−1 + · · · + ( n n−1 )b + 1 ⩾ bn + nbn−1, więc an ⩾ nbn−1 ⩾ nan−1. I ostatecznie, min{a, b} = a ⩾ n. Z2.E3 Niech x = 24k, y = 23k. Wówczas x3 + y4 = 212k+1. Ponieważ 12k + 1 = 5(12t + 5) dla k = 5t + 2, więc mamy nieskończenie wiele rozwiązań (x, y, z) = (220t+8, 215t+6, 212t+5). U w a g a. Nie należy sądzić, że to są wszystkie rozwiązania. Na przykład trójka (7785158, 7584156, 7483155) jest również rozwiązaniem (bo 7 + 8 = 15). Z2.E4 Oznacz α = √2 − 1, β = √2 + 1 i sprawdź przez indukcję, że liczba m = m(n) = ( αn + βn 2 )2 jest liczbą naturalną dla każdego n ∈ N. Zobacz też Z2.B4. Z2.F1 (1) Jeżeli p ̸= 3, to p = 3t + 1 lub p = 3s − 1. Wówczas 2p + 1 = 6t + 3 = 3T , odpowiednio 4p + 1 = 12s + 3 = 3S. (2) Jeżeli p ̸= 5, to p = 5t ± 1 lub p = 5s ± 2. Wówczas 4p2 + 1 = 5T , odpowiednio 6p2 + 1 = 5S. (3) Kwadrat nieparzystej i niepodzielnej przez 3 liczby całkowitej daje resztę 1 przy dzieleniu przez 3 (sprawdzić!). Wobec tego suma p2 +q2 +r2 kwadratów liczb pierwszych > 3 jest podzielna przez 3. Nie jest więc liczbą pierwszą. (4) Z 2.3.3 P3 wiemy, że 2n − 1 może być liczbą pierwszą tylko, gdy n ∈ P, a z C2.39 wiemy, że 2n + 1 może być liczbą pierwszą tylko, gdy n = 2k. Jedyną liczbą pierwszą postaci 2k jest liczba 2. Z2.F2 Jeżeli m jest parzysta, to γ(m) = γ(2m). Można więc wziąć k = 2m i l = m. Jeżeli zaś m jest liczbą nieparzystą, to niech p oznacza najmniejszą nieparzystą liczbę pierwszą, która n i e dzieli m. Wówczas γ(pm) = γ(m)+1 = γ(pm−m). Wystarczy więc położyć k = pm i l = (p−1)m. Z2.F3 Zauważmy przede wszystkim, że q ⩾ n (gdyby q < n, to liczba złożona q + qr = q(1 + r) byłaby wyrazem badanego ciągu). Niech p < n będzie liczbą pierwszą. Niech ϱ0, ϱ1, . . . , ϱp−1 oznaczają reszty z dzielenia przez p początkowych p wyrazów naszego ciągu. Ponieważ 0 < ϱj < p dla każdego j = 0, . . . , p−1 (bo reszta 0 nie występuje!), więc, zgodnie z zasadą szuﬂadkową, istnieją liczby k, l takie, że 0 ⩽ k < l < p i ϱk = ϱl. To oznacza, że (q + lr) − (q + kr) = (l − k)r jest liczbą naturalną podzielną przez p. Zatem, na mocy C2.32 i ZTA, p|r. Teraz trzeba zastosować C2.17. Z2.F4 Równość Legendre’a daje vp(n!) = ∑∞ k=1 ⌊n/pk⌋ < n ∑∞ k=1 1/pk = n/(p − 1) dla dowolnej liczby pierwszej p ⩽ n (korzystaliśmy tu z oczywistych nierówności ⌊x⌋ ⩽ x i wzoru na sumę szeregu geometrycznego). Stąd n! = ∏p∈P pvp(n!) = ∏p⩽n pvp(n!) ⩽ ∏p⩽n pn/(p−1). Z2.F5 Oznaczmy A(n) = p1p2 · . . . · pn = ∏j⩽n pj. Dowodzimy najpierw nierówności słabszej: Dla n ⩾ 2 zachodzi nierówność A(n) > pn+1. Rozważmy w tym celu liczbę A(n) − 1. Liczba ta jest ⩾ 2, więc (zobacz T2.14) ma dzielnik pierwszy p. Wówczas p ⩽ A(n) − 1 (zobacz C2.2). Z drugiej 60 2. Elementarz strony, p jest różna od liczb p1, . . . , pn, więc p > pn. Czyli p ⩾ pn+1. Stąd pn+1 < A(n). Następnie sprawdzamy ”na piechotę” nierówność (2.33) dla 4 ⩽ n ⩽ 10. Teraz ustalmy n > 10 i rozważmy ciąg a = (A(n − 1) − pn, 2A(n − 1) − pn, . . . , (pn − 1)A(n − 1) − pn). Wszystkie jego wyrazy są (różnymi) liczbami naturalnymi. Ponadto, jeżeli p jest dzielnikiem pierwszym wyrazu kA(n − 1) − pn tego ciągu, to p > pn. Nie może być bowiem p = pn (bo wtedy pn|k, co jest niemożliwe wobec k < pn), ani p < pn (bo wtedy p = pi dla 1 ⩽ i ⩽ n − 1, więc pi|pn, nonsens!). Dzięki temu sprawdzamy, że wyrazy ciągu a są parami w z g l ę d n i e p i e r w s z e. Rzeczywiście, gdyby liczba pierwsza p > pn dzieliła kA(n − 1) − pn i lA(n − 1) − pn dla pewnych 1 ⩽ k < l < pn, to dzieliłaby też (l − k)A(n − 1), co jest niemożliwe. Oznaczmy przez qk dowolny dzielnik pierwszy liczby kA(n−1)−pn. W ten sposób znajdziemy liczby pierwsze q2, q3, . . . , qpn−1 (nie wpisaliśmy na tę listę q1, bo nie udowodniliśmy, że A(n − 1) − pn ̸= 1). Oznaczmy pn − 2 = t. (Pierwsza uwaga na marginesie: t > 2n dla wszystkich n ⩾ 7. W rzeczy samej, p7 = 17 > 2 · 7 + 2, a ciąg (2n + 2) n i e rośnie szybciej niż ciąg (pn)). Mamy t liczb pierwszych większych niż pn i parami różnych (pamiętamy o względnej pierwszości wyrazów ciągu a). Są to więc liczby pn+n1, pn+n2, . . . , pn+nt, gdzie 1 ⩽ n1 < n2 < . . . < nt (druga uwaga na marginesie: nt ⩾ t). Każda z nich jest dzielnikiem któregoś (każda swojego) wyrazu ciągu a, każda więc jest ⩽ od największego wyrazu (pn − 1)A(n − 1) − pn = A(n) − A(n − 1) − pn tego ciągu. Stąd A(n) > A(n) − A(n − 1) − pn ⩾ pn+nt ⩾ pn+t > p3n (trzecia nierówność wynika z drugiej uwagi na marginesie, a czwarta, z pierwszej). Otrzymana nierówność A(n) > p3n dla każdego n ⩾ 7, jest m o c n i e j s z a od nierówności Bonse. Rzeczywiście, Czytelnik łatwo właściwie zinterpretuje i uzasadni, że A(n) > A(n/2)2 > p2 3n/2 > p2 n+1. Z2.F6 (68 OM, III stopień) Niech {p1, p2, . . . , pm} = Supp(a1 ·. . .·an) będzie zbiorem wszystkich dzielników pierwszych iloczynu a1 · . . . · an. Niech ai = pe1(i) 1 pe2(i) 2 · . . . · p em(i) m , zob. 2.4.1 (RK). Mamy: a m−1 i = am i ai = ai pe1(i) 1 · ai p e2(i) 2 · . . . · ai pem(i) m . Po wypisaniu takich równości jedna pod drugą dla i = 1, . . . , n, dowodzimy, że w każdej kolumnie stoi n r ó ż n y c h liczb naturalnych: Gdyby dla i < j zachodziła równość aip−ek(i) k = ajp −ek(j) k , to mielibyśmy aj/ai = pek(j)−ek(i) k . Ale ai < aj < 2a1, skąd 1 < aj ai < 2a1 ai < 2a1 a1 = 2, co dałoby niemożliwe dla żadnej liczby pierwszej (pk) i dla żadnego wykładnika całkowitego α nierówności 1 < pα k < 2. Wystarczy teraz zauważyć, że iloczyn n różnych liczb naturalnych jest ⩾ n!. Z2.F7 (68 OM, III stopień) Przedstaw liczbę naturalną n w postaci 2a · 3b · 5c · n′, gdzie n′ ⊥ 30, i zdeﬁniuj funkcję f : N −→ Z wzorem f (n) = a + 3b − c. Sprawdź równość f (m · n) = f (m) + f (n) dla dowolnych m, n ∈ N. Do i-tego zbioru zalicz te i tylko te liczby n, dla których resztą z dzielenia liczby f (n) przez 5 jest i. Zauważ, że f (1) = 0, f (2) = 1, f (3) = 3, f (4) = 2, f (5) = 4. Zatem, dla dowolnego n ∈ N, liczby f (n), f (2n), f (3n), f (4n) i f (5n) dają r ó ż n e reszty z dzielenia przez 5. Z2.F8 (62 OM, I stopień) Tożsamość nieśmiertelna (1.8) daje rozkłady Mrs = (2 r − 1) ((2 r) s−1 + (2r) s−2 + . . . + 2r + 1) = MrA, (2.37) Mrs = (2 s − 1) ((2 s)r−1 + (2s)r−2 + . . . + 2s + 1) = MsB, (2.38) Z Z2.B9 wiemy, że liczby Mr i Ms są względnie pierwsze. Z tej względnej pierwszości i równości MrA = MsB, na mocy ZTA, mamy Mr|B, czyli równość B = MrC dla pewnego C ∈ N. Zapisujemy więc Mrs = MrMsC. W tym rozkładzie, czynniki Mr i Ms są większe od 1 i względnie pierwsze. Wobec tego jedyna możliwość, kiedy liczba Mrs n i e m a trzech różnych dzielników pierwszych, to taka, kiedy Mr = pk, Ms = ql, C = paqb, gdzie p, q są różnymi liczbami pierwszymi. Wówczas, zobacz Z2.D9, k = l = 1. Wobec tego nasze założenie nie wprost może być zapisane tak: Mrs = MrMsC = pq · paqb = pa+1qb+1. 2.6. Zadania dodatkowe 61 Pokazujemy, że w takiej sytuacji b = 0: Gdyby b > 0, to q|C, więc, tym bardziej, q|MrC. Czyli q|(2s)r−1 +(2s)r−2 + . . . +2s +1. Ale, na mocy określenia, 2s = q +1. Stąd (2s)t = (q +1)t = q ·coś+1 dla dowolnego t ∈ Z⩾0 (”coś” ∈ Z). Zatem (2s)r−1 + (2s)r−2 + . . . + 2s + 1 = q · COŚ + r. Stąd, na mocy Zasady Podstawowej, q|r. Sprzeczność, bo q = 2s − 1 > 2r − 1 > r. Przeto b = 0. Jednocześnie a ⩾ 1. Gdyby bowiem a = 0, równość Mrs = pa+1q nie mogłaby zachodzić ze względów ”wielkościowych”: liczba Mrs = 2rs − 1 jest bowiem znacznie większa od liczby 2r+s + 1, która jest większa od MrMs = pq. Widzimy stąd, że założenie nie wprost wygląda tak: Mrs = pa+1q, gdzie a ⩾ 1. Pokażemy teraz, że w t a k i m r a z i e Mr = s. Z równości (2.37) mamy bowiem A = Mrs p = (2 r)s−1 + (2r)s−2 + . . . + 2r + 1 = paq. Skąd wnosimy, że p|A. Ale, z określenia, 2r = p + 1, więc, podobnie jak wyżej, (2r)t = p · coś + 1 i powyższa równość daje A = p · COŚ + s. Stąd p|s. Wobec pierwszości liczb p, s widzimy, że p = s czyli 2r − 1 = s. Równość Mrs = pa+1q pisze się więc następująco: sa+1q = 2rs − 1 = (2r)s − 1 = (s + 1)s − 1. Ale (s + 1)s − 1 = ss + (s 1 ) ss−1 + . . . + ( s s − 2 )s 2 + ( s s − 1 ) s + 1 − 1 = s 3 · coś + s 2, bo s| ( s s−2 ), zobacz C2.50. Zatem sa+1q = s3 · coś + s2, a stąd, w oczywisty sposób, a + 1 = 2. Mamy więc Mrs = p2q. I dostajemy rozstrzygającą s p r z e c z n o ś ć: Mrs = p 2q = (2 r − 1) 2(2 s − 1) < (2 r) 2 · 2s = 2 2r+s < 2 rs − 1 = Mrs. Ta sprzeczność kończy rozwiązanie. Z2.G1 Zauważmy najpierw, że (dokładnie) jedna z kolejnych czterech liczb naturalnych jest po- dzielna przez 4 = 22, nie jest więc bezkwadratowa. Zatem, trójki kolejnych liczb bezkwadratowych (jeżeli istnieją) są postaci (4k − 3, 4k − 2, 4k − 1), dla k ∈ N. Załóżmy nie wprost, że takich trójek jest skończenie wiele i że największą z nich jest (4A − 3, 4A − 2, 4A − 1). Wówczas wśród czterech liczb 4k − 3, 4k − 2, 4k − 1, 4k, dla dowolnego k > A, występują co najwyżej dwie liczby bez- kwadratowe. Jeżeli więc oznaczymy przez Q(n) liczbę liczb naturalnych bezkwadratowych ⩽ n, to mamy Q(4n) ⩽ 3A + 2(n − A) dla wszystkich n > A. To i teza poniższego lematu, dają nierówność (2 + 2ε)n < 2n + A, czyli ε < A/(2n) dla w s z y s t k i c h n > A. N o n s e n s. L e m a t. Istnieje taka liczba ε > 0, że dla każdego n ∈ N zachodzi nierówność Q(n) > ( 1 2 + ε)n. D o w ó d. Ustalmy n ∈ N. Dla danej liczby pierwszej p oznaczmy: Ap = {k ∈ N : k ⩽ n, p2|k}. Jasne, że każda liczba naturalna ⩽ n nie będąca liczbą bezkwadratową jest podzielna przez kwadrat jakiejś liczby pierwszej, należy więc do pewnego (co najmniej jednego) zbioru Ap. Wobec tego zbiór [ n ] ∖ (A2 ∪ A3 ∪ · · · ∪ Aq) (suma po wszystkich liczbach pierwszych, których kwadrat jest ⩽ n), jest zbiorem w s z y s t k i c h liczb bezkwadratowych ⩽ n. Jasne, że card(Ap) = ⌊n/p2⌋. Zatem Q(n) = n − card(A2 ∪ A3 ∪ · · · ∪ Aq) ⩾ n − ∑ p∈P, p2⩽n ⌊ n p2 ⌋ ⩾ n − n ( 1 22 + 1 32 + · · · + 1 q2 ) . Dla zakończenia dowodu wystarczy więc uzasadnić, że 1 − (1/22 + 1/32 + · · · + 1/q2) > 1/2 + ε dla pewnej dodatniej liczby ε, czyli że 1/22 + 1/32 + · · · + 1/q2 < 1/2 − ε lub, równoważnie, że istnieje taka liczba dodatnia ε, że nierówność Sq := 1/32 + 1/52 + · · · + 1/q2 < 1/4 − ε zachodzi dla dowolnie wielu składników (będących odwrotnościami kwadratów nieparzystych liczb pierwszych) sumy z lewej strony. W C1.4 widzieliśmy, że ta suma jest < 3/4, ale to jest za słabe. Mamy jednak Sq = 1 32 + 1 52 + · · · + 1 q2 < 1 9 + 1 25 + 1 49 + n∑ k=5 1 (2k + 1)2 < 1891 11 025 + n∑ k=5 1 (2k − 1)(2k + 1) . 62 2. Elementarz Ostatnia suma, dzięki 1 (2k − 1)(2k + 1) = 1 2 ( 1 2k − 1 − 1 2k + 1 ), ”teleskopuje” się do 1 18 − 1 2(2n + 1) . Zatem Sq < 1891 11 025 + 1 18 < 0, 23. Więc można przyjąć ε = 0, 02. Q.e.d. Z2.G2 Niech b1 < b2 < · · · < bs będą wszystkimi liczbami naturalnymi bezkwadratowymi z przedziału [ 1; n ]. Rozpatrujemy dwa przypadki: (1) n > bs, (2) n = bs. W przypadku (1) zbadajmy przekrój {b1, . . . , bs} ∩ {n − b1, . . . , n − bs}. Ponieważ, zobacz lemat z poprzedniego rozwiązania, s > n/2, więc ten przekrój jest niepusty. Zatem dla pewnego j, bj ∈ {n − b1, . . . , n − bs}, czyli bj = n − bi. W przypadku (2) mamy s − 1 = Q(n − 1) > (n − 1)/2. Więc, znowu na mocy Zasady Łat na Kapocie, zob. KOM , zbiory {b1, . . . , bs−1} ∩ {n − b1, . . . , n − bs−1} mają niepusty przekrój. Z2.H1 Jeżeli m = u2 + w2, to 2m = (u + w)2 + (u − w)2. Jeżeli zaś 2m = x2 + y2, to x, y są tej samej parzystości(!), więc m = ((x + y)/2)2 + ((x − y)/2)2 jest sumą kwadratów liczb całkowitych. Z2.H2 Jeżeli n = a2 + b2 + c2 i a ⩾ b ⩾ c, to n2 = (a2 + b2 − c2)2 + (2ac)2 + (2bc)2. Trzeba jeszcze zauważyć, że a2 + b2 − c2 ∈ N. Z2.H3 Gdy k + (k + 1) + · · · + (k + r − 1) = 2n, czyli (2k + r − 1)r = 2n+1, to mamy sprzeczność. Bowiem liczby 2k + r − 1 i r są różnej parzystości. Niech teraz n = 2s(2m + 1), gdzie m ⩾ 1. Szukamy takich k ∈ N i r ∈ N⩾2, że zachodzi równość k + (k + 1) + · · · + (k + r − 1) = n, czyli (2k + r − 1)r = 2s+1(2m + 1). Równość ta jest spełniona w każdym z dwóch przypadków: (k, r) = (2s − m, 2m + 1), (k, r) = (m + 1 − 2s, 2s+1). Natomiast w jednym (i tylko jednym) z tych przypadków zachodzą żądane nierówności k ⩾ 1 i r ⩾ 2. U w a g a. Można wykazać, że jeżeli 2m + 1 jest liczbą pierwszą, to uzyskane przedstawienie liczby 2s(2m + 1) w postaci sumy dwóch lub więcej kolejnych liczb naturalnych jest jedyne. I tylko wtedy! Zróbcie to. Z2.H4 Liczbę a nazwijmy dobrą, gdy istnieje taka liczba m ∈ N i taki wybór znaków ±, że a = ±12 ± 22 ± · · · ± m2. Liczbę a ∈ Z nazwijmy superdobrą, gdy istnieje nieskończenie wiele odpowiednich liczb m (i odpowiednich wyborów znaków). Równości 0 = 12 +22 −32 +42 −52 −62 +72, 1 = 12, 2 = −12 − 22 − 32 + 42 i 3 = −12 + 22 pokazują, że liczby 0, 1, 2 i 3 są dobre. Oczywiste jest, że liczba a jest (super )dobra wtedy i tylko wtedy, gdy −a jest (super )dobra. Prawdziwa dla wszystkich m równość Em := (m + 1)2 − (m + 2)2 − (m + 3)2 + (m + 4)2 = 4 pozwala z łatwością uzasadnić, że jeżeli a jest liczbą dobrą, to również liczba a + 4 jest dobra. Stąd, dzięki pokazanej dobroci liczb 0, 1, 2, 3 i oczywistej indukcji, widzimy, że wszystkie liczby całkowite są dobre. Aby wykazać superdobroć wszystkich liczb całkowitych wystarczy wykorzystać tożsamość (m + 1)2 − (m + 2)2 − (m + 3)2 + (m + 4)2 − (m + 5)2 + (m + 6)2 + (m + 7)2 − (m + 8)2 = 0, która jest tylko inaczej zapisaną równością Em − Em+4 = 4 − 4 = 0. Z2.H5 Tezę można wywnioskować z tożsamości 6x = (x+1)3+(x−1)3+(−x)3+(−x)3. Dzięki niej, biorąc dowolną liczbę a ∈ Z, przedstawiając ją w postaci 6b + r i wiedząc, że (6b + r) − (6c + r)3 = 6x (zob. Z2.A2(2)), możemy (na nieskończenie wiele sposobów) przedstawić a w postaci sumy pięciu sześcianów. Z2.H6 Indukcja względem n. Baza jest oczywista. Niech a < (n + 1)!. Dzielimy z resztą: a = q(n + 1) + r, gdzie 0 ⩽ r < n + 1, czyli 0 ⩽ r ⩽ n. Jeżeli q = 0, to a = r jest żądaną ”sumą” (jednoskładnikową) dzielników liczby n!. Jeżeli zaś q ⩾ 1, to q < n!, więc, na mocy założenia indukcji, q = d1 + · · · + ds, gdzie d1 < · · · < ds są dzielnikami liczby n! i s ⩽ n. Wówczas a = r + d1(n + 1) + d2(n + 1) + · · · + ds(n + 1) jest żądaną sumą różnych dzielników liczby (n + 1)!. Z2.I1 Dla p = 2 rzecz jest oczywista. Załóżmy więc, że p jest nieparzysta. Wówczas, dzięki 2.4.2 U, mamy 5|a. Wtedy z C2.52 mamy n ⩽ nv5(a) = v5(a n) = v5(2 p + 3p) = v5(2 + 3) + v5(p) = 1 + v5(p). 2.6. Zadania dodatkowe 63 Gdyby więc n ⩾ 2, to musiałoby też być v5(p) ⩾ 1, czyli p = 5. Ale 25 + 35 = 275 = 52 · 11. Z2.I2 Zapisz sumę 1n + 2n + · · · + 8n w postaci (1n + 8n) + (2n + 7n) + (3n + 6n) + (4n + 5n) i stosownie zwiększaj wykładniki 3-adyczne. U w a g a. Łatwo zastąpić liczbę 8 przez 9. Wówczas sumę 1n + · · · + 9n zapisujemy w postaci (1n + 9n) + · · · + (4n + 6n) + 5n i zwiększamy wykładniki 5-adyczne. Do sumy 1n + · · · + 10n możemy podobnie zastosować liczbę p = 11 dla zwiększania wykładnika p-adycznego. Można też wykorzystać nieparzysty dzielnik pierwszy p ∈ Supp(A + 1) dla uogólnienia zadania na przypadek sumy 1n + · · · + An. Co można zrobić, gdy A + 1 = 2r ? Z2.I3 Łatwo zobaczyć, że x, y ∈ Q. Rzeczywiście, skoro x−y, x2 −y2 ∈ Z, to x+y = x2−y2 x−y ∈ Q. Zatem 2x = (x − y) + (x + y) ∈ Q, więc x ∈ Q i, podobnie, y ∈ Q. Wobec tego możemy zapisać x = a m , y = b m , gdzie a, b ∈ Z, a m ∈ N jest n a j m n i e j s z y m wspólnym mianownikiem. Wówczas, oznaczając xk − yk = ck, gdzie ck ∈ Z, dostajemy równości ak − bk = ckmk dla wszystkich k ∈ N. Czyli mk|ak −bk dla wszystkich k ∈ N. Chcemy udowodnić (bo to jest równoważne(!) z tezą zadania), że m = 1. Załóżmy, nie wprost, że m > 1 i że p|m, gdzie p ∈ P, zob. T2.14. Jeżeli p > 2, to wybierając k = pn, dostajemy, na mocy LZW (uzasadnić prawomocność stosowania tegoż!), pn = k ⩽ kvp(m) = vp(m k) ⩽ vp(ak − b k) = vp(a − b) + vp(k) = vp(a − b) + n, dla wszystkich n ∈ N. Zauważyć tu sprzeczność. Znaleźć podobną sprzeczność, gdy m = 2α. Z2.I4 Załóżmy, że w danej czwórce Catalan’a (x, y; m, n) mamy y = p ∈ P. Przypadek p = 2 został zbadany w Z2.D8. Znaleziona tam została czwórka Catalan’a (3, 2; 2, 3). Załóżmy więc teraz, że p > 2 i że (x, p; m, n) jest czwórką Catalan’a. Wówczas pn = xm − 1. Taka równość nie może zajść (przy n ⩾ 2), gdy x = 2, zobacz Z2.D9. Załóżmy więc dodatkowo, że x ⩾ 3. Tożsamość ”nieśmiertelna” (2.22) daje pn = (x − 1)Qm(x, 1). Stąd (i z jednoznaczności rozkładu) mamy równości x − 1 = pα, Qm(x, 1) = pβ dla pewnych wykładników α, β spełniających warunki α ⩾ 1 (bo x − 1 ⩾ 2!) i α + β = n. Możemy(!) teraz zastosować lemat LZW, zob. T2.18. Dostajemy vp(m) = vp(xm − 1) − vp(x − 1) = vp(p n) − α = n − α = β. Stąd m = pβc dla pewnej liczby naturalnej c. I mamy ”piękną” sprzeczność: pβ = Qm(x, 1) = m−1∑ j=0 xj > m = pβc. Rozdział 3 Wielomiany Gauß nous apparaˆιt, apr`es 150 ans, comme le ﬂambeau qui a montr´e la route `a de nombreuses g´en´erations de math´ematiciens, et illumin´e l’avenir comme nul autre l’a jamais fait. (Jean Dieudonn´e) Rozważać będziemy teraz zbiór R[X] wszystkich wielomianów o współczynnikach należą- cych do pierścienia R. Okaże się, i to jest g ł ó w n y m m o r a ł e m płynącym z tego rozdziału, że w przypadku, gdy pierścień R jest c i a ł e m (zobacz D1.10), w zbiorze R[X] (podobnie jak w zbiorze Z) zachodzi twierdzenie o i s t n i e n i u i j e d n o z n a c z n o ś c i r o z k ł a d u na czynniki nierozkładalne. 3.1 Pierścień wielomianów W matematyce szkolnej wielomian jest pewną, szczególnie prosto zdeﬁniowaną f u n k c j ą rze- czywistą, zob. 3.2.3 U2. W rzeczywistości wielomian jest czymś jeszcze prostszym. Deﬁnicja 3.1 Niech R będzie pierścieniem przemiennym z jedynką. Wyrażenie postaci f (X) = a0 + a1X + a2X 2 + . . . + anX n = n∑ k=0 akX k, (3.1) gdzie ak ∈ R, nazywamy wielomianem zmiennej X o współczynnikach z pierścienia R. Elementy ak nazywamy współczynnikami wielomianu f (X), współczynnik a0 nazywa się wyrazem wolnym. Zbiór wszystkich wielomianów zmiennej X o współczynnikach z pierścienia R oznaczamy symbolem R[X]. Wielomian, którego wszystkie współczynniki są równe 0 (zero pierścienia R) nazywamy wielomianem zerowym i oznaczamy 0. Wielomian postaci f (X) = a0 nazywamy wielomianem stałym. Wielomiany dodajemy i mnożymy tak j a k w s z k o l e. Ćwiczenie 3.1 Uzasadnić, że R[X] z ”wprowadzonymi” działaniami dodawania i mnoże- nia jest pierścieniem przemiennym z jedynką. Tak zbudowany pierścień nazywamy pierście- niem wielomianów jednej zmiennej o współczynnikach z pierścienia R. 3.1. Pierścień wielomianów 65 Czasami używamy skróconego zapisu f (X) = ∑ k⩾0 akX k, rozumiejąc przy tym, że prawie wszystkie (to znaczy wszystkie z wyjątkiem skończenie wielu) współczynniki ak s ą r ó w n e 0. Przy takim sposobie pisania mamy ∑ k⩾0 akX k + ∑ k⩾0 bkX k = ∑ k⩾0(ak + bk)X k oraz ∑ k⩾0 akX k · ∑ l⩾0 blX l = ∑ r⩾0 crX r, gdzie cr = ∑r j=0 ajbr−j. P r z y k ł a d 1. Klasyczny przykład wykorzystania mnożenia w pierścieniu wielomianów zobaczyć można w dowodzie tożsamości Cauchy’ ego-Vandermonde’ a: r∑ j=0 (m j )( n r − j ) = (m + n r ) . Robi się to tak: Rozważmy r-ty współczynnik wielomianu f (X) = (1 + X) m+n. Jest on równy, zobacz (1.7), ( m+n r ). Z drugiej strony wielomian f (X) jest równy iloczynowi (1 + X)m · (1 + X) n = m∑ k=0 ( m k ) X k · n∑ l=0 (n l )X l dwóch wielomianów i, wobec tego, jego r-ty współczynnik jest równy cr = r∑ j=0 ajbr−j = r∑ j=0 (m j )( n r − j ) . Podobne przykłady znaleźć można w KOM . ♦ Ćwiczenie 3.2 Mnożymy wielomian ∑100 k=0 X k przez wielomian ∑100 k=0(−1) kX k. Wykazać, że w otrzymanym wielomianie wszystkie współczynniki c2s−1 są równe zero. Deﬁnicja 3.2 Gdy f (X) = ∑ k⩾0 akX k ∈ R[X] i n jest największym indeksem, dla którego an ̸= 0, to an nazywamy współczynnikiem wiodącym, a liczbę n nazywamy stopniem wielomianu f (X). Stopień wielomianu f (X) oznaczamy deg f (X) lub po prostu deg f . Umawiamy się, że wielomian zerowy ma stopień równy −∞. Ćwiczenie 3.3 Udowodnić, że stopień wielomianu spełnia warunki: (1) deg (f (X) + g(X)) ⩽ max {deg f (X), deg g(X)}, (2) deg f (X)g(X) ⩽ deg f (X) + deg g(X). 66 3. Wielomiany Deﬁnicja 3.3 Element f (λ) := a0 + a1λ + a2λ 2 + . . . + anλ n ∈ R, gdzie f (X) jest wielomianem (3.1), a λ ∈ R, nazywamy wartością wielomianu f (X) dla argumentu λ. Element λ ∈ R nazywa się pierwiastkiem wielomianu f (X), gdy f (λ) = 0. Pierwiastek wielomianu nazywa się również miejscem zerowym wielomianu lub zerem wielomianu. Ostatnią z czterech deﬁnicji ogólnych jest deﬁnicja złożenia: Deﬁnicja 3.4 Jeżeli f (X) ∈ R[X] jest wielomianem danym w (3.1), a g(X) ∈ R[X] jest dowolnym wielomianem, to wielomian (f ◦ g)(X) dany przez (f ◦ g)(X) := f (g(X)) = a0 + a1g(X) + a2(g(X)) 2 + . . . + an(g(X)) n, nazywa się złożeniem (lub superpozycją) wielomianów g(X) i f (X) (w tej kolejności). P r z y k ł a d 2. Niech f (X) = X 2 + X + 2, g(X) = X + 1. Wtedy g(f (X)) = X 2 + X + 3, a f (g(X)) = (X + 1)2 + (X + 1) + 2 = X 2 + 3X + 4. Widzimy, że składanie wielomianów n i e j e s t przemienne, tzn., f ◦ g jest na ogół r ó ż n e od g ◦ f . ♦ 3.2 Siedem idei podstawowych W tym paragraﬁe przypomnimy i nieco usystematyzujemy szkolną wiedzę na temat wielomia- nów. Czytelnik, który boi się ogólnego pojęcia pierścienia, może chwilowo myśleć, że pierścień to taki zbiór liczb, w którym można bez ograniczeń dodawać, odejmować i mnożyć, a ciało, to taki pierścień, w którym można dodatkowo dzielić (nie przez 0, oczywiście). Znamy więc jeden pierścień n i e b ę d ą c y c i a ł e m, jest to Z, i trzy ciała, są to Q, R i C. W rzeczy samej znamy już nieskończenie wiele pierścieni: Jeżeli R jest dowolnym pierścieniem, to, jak wiemy z C3.1, zbiór R[X] wielomianów o współczynnikach w R jest również pierścieniem. Później poznamy jeszcze różne inne pierścienie, z których niektóre będą ciałami. 3.2.1 Pierwsza idea: twierdzenie B´ezout’a Pierwsza idea polega na ”wyciąganiu przed nawias” czynnika dwumiennego postaci X − α. Udowodnimy w tym celu w a ż n ą równość, którą nazwiemy równością B´ezout’ a: TWIERDZENIE 3.1 Jeżeli f (X) ∈ R[X] jest wielomianem stopnia n i α ∈ R, to istnieje taki wielomian g(X) ∈ R[X], że zachodzi równość f (X) = (X − α)g(X) + f (α). (3.2) Ponadto, deg g(X) = n−1, a wielomiany g(X) i f (X) mają t e n s a m współczynnik wiodący. D O W Ó D. Niech f (X) = a0 + a1X + . . . + anX n, gdzie an ̸= 0. Wówczas f (X) − f (α) = n∑ k=0 akX k − n∑ k=0 akαk = n∑ k=1 ak(X k − αk). 3.2. Siedem idei podstawowych 67 Tożsamość (1.8) pozwala zapisać każdą różnicę X k − αk w postaci iloczynu X k − αk = (X − α)(X k−1 + αX k−2 + . . . + αk−2X + αk−1) = (X − α)gk−1(X), gdzie, jak widać, wielomian gk−1(X) ma współczynniki w pierścieniu R i stopnień równy k − 1. Oznaczając przez g(X) sumę a1g0(X) + a2g1(X) + . . . + angn−1(X) dostajemy więc równość f (X) − f (α) = (X − α)g(X) równoważną równości (3.2). Ponadto, łatwo widzieć, że g(X) = anX n−1 + . . . . Zatem g(X) ma ten sam współczynnik wiodący co f (X), oraz deg g(X) = n − 1. □ U w a g a 1. Bardzo ważną okolicznością jest tu fakt, że współczynniki wielomianu g(X) z równości (3.2) należą do tego samego pierścienia, do którego należą współczynniki wielomianu f (X) i element α. W szczególności: Jeżeli f (X) ∈ Z[X] i α ∈ Z, to również g(X) ∈ Z[X]. Często używany wniosek z powyższego formułujemy w postaci ćwiczenia: Ćwiczenie 3.4 Uzasadnić, że dla dowolnego wielomianu f (X) ∈ Z[X] i liczb całkowitych a, b zachodzi relacja podzielności: a − b|f (a) − f (b). (3.3) ZADANIE 3.1 Dane są liczby całkowite a < b < c. Dowieść, że n i e istnieje wielomian f (X) o współczynnikach całkowitych, dla którego f (c) = a i f (a) = b. R o z w i ą z a n i e. Gdyby taki wielomian istniał, to, na mocy (3.3), c − a|f (c) − f (a), czyli c − a|a − b, co jest niemożliwe, bo |c − a| > |a − b|. ♦ Okazuje się, że czynnik X − α można ”wyciągnąć przed wielomian” f (X) wtedy i tylko wtedy, gdy α jest pierwiastkiem wielomianu f (X). Mówi o tym: TWIERDZENIE 3.2 (B´ezout) Element α ∈ R jest pierwiastkiem niezerowego wielo- mianu f (X) ∈ R[X] wtedy i tylko wtedy, gdy istnieje taki wielomian g(X) ∈ R[X], że f (X) = (X − α)g(X). (3.4) Przy tym deg g(X) = deg f (X) − 1. D O W Ó D. Wynika natychmiast z T3.1 i faktu, że 0 · g(α) = 0, por. Z1.6.(1). □ WNIOSEK. Dany jest pierścień R b e z d z i e l n i k ó w z e r a i niezerowy wielomian f (X) ∈ R[X]. Jeżeli r ó ż n e elementy αi ∈ R, dla 1 ⩽ i ⩽ s, są pierwiastkami wielo- mianu f (X), to zachodzi równość f (X) = (X − α1)(X − α2) · . . . · (X − αs)h(X), (3.5) gdzie h(X) ∈ R[X], deg h(X) = deg f (X) − s oraz h(X) i f (X) mają ten sam współczynnik wiodący. D O W Ó D. Dla s = 1 mamy równość f (X) = (X − α1)g(X). Załóżmy więc, że s > 1. Mamy 0 = f (α2) = (α2 − α1)g(α2). Ponieważ α1 ̸= α2, czyli α2 − α1 ̸= 0, a w R nie ma dzielników zera (co teraz zakładamy), więc α2 jest 1 pierwiastkiem wielomianu g(X). Zatem mamy równość typu (3.4): g(X) = (X − α2)h(X). Skąd f (X) = (X − α1)(X − α2)h(X). Tę sztuczkę można kontynuować. □ 1Bez założenia, że R jest dziedziną całkowitości, nie moglibyśmy tego twierdzić! 68 3. Wielomiany ZADANIE 3.2 Udowodnić, że jeżeli wielomian o współczynnikach całkowitych przyjmuje dla trzech różnych argumentów całkowitych wartość 1, to wielomian ten nie ma pierwiastków całkowitych (czyli, żadna liczba całkowita nie jest jego pierwiastkiem). R o z w i ą z a n i e. Załóżmy, że f (X) ∈ Z[X] jest tym wielomianem. Niech f (a) = f (b) = f (c) = 1. Wówczas wielomian g(X) = f (X) − 1 ma również współczynniki całkowite i trzy różne pierwiastki a, b, c. Zatem, rozkład (3.5) ma postać: g(X) = (X − a)(X − b)(X − c)h(X), (3.6) dla pewnego h(X) ∈ Z[X]. Załóżmy, nie wprost, że f (X) ma pierwiastek całkowity i że d jest tym pierwiastkiem, f (d) = 0. Wtedy −1 = f (d) − 1 = g(d) = (d − a)(d − b)(d − c)h(d), na mocy (3.6). Sprzeczność!, bo liczby −1 n i e d a s i ę rozłożyć na iloczyn czterech czynników całkowitych, z których trzy s ą r ó ż n e. ♦ Ćwiczenie 3.5 Dany jest wielomian f (X) ∈ Z[X]. Udowodnić, że jeżeli dla czterech różnych argumentów całkowitych wartością tego wielomianu jest liczba 5, to f (x) ̸= 8 dla każdej liczby całkowitej x. 3.2.2 Druga idea: algorytm dzielenia z resztą Pamiętamy jak duże usługi oddała nam możliwość dzielenia z resztą w pierścieniu Z. Jest więc bardzo obiecującym fakt, że w pierścieniu K[X] wielomianów jednej zmiennej o współczynni- kach w c i e l e możliwe jest dzielenie z resztą. Tę obietnicę zrealizujemy w 3.3. Ćwiczenie 3.6 Udowodnić, że jeżeli R jest dziedziną całkowitości, i f (X), g(X) ∈ R[X], to zachodzi równość deg f (X)g(X) = deg f (X) + deg g(X). Porównać C3.3(2). TWIERDZENIE 3.3 (Dzielenie z resztą) Jeżeli a(X), b(X) ∈ K[X] i b(X) ̸= 0, to istnieją takie, j e d n o z n a c z n i e wyznaczone wielomiany q(X), r(X) ∈ K[X], że a(X) = q(X)b(X) + r(X) i deg r(X) < deg b(X). (3.7) D O W Ó D. Dowód poprowadzimy przez indukcję względem stopnia wielomianu a(X). Niech a(X) = anX n + . . . + a1X + a0, b(X) = bmX m + . . . + b1X + b0, gdzie deg a(X) = n, deg b(X) = m ⩾ 0. Jeżeli n < m, to mamy równość a(X) = 0 · b(X) + a(X) i wystarczy położyć q(X) = 0, r(X) = a(X). Jeżeli zaś n ⩾ m, to rozważmy wielomian ̃a(X) = a(X) − an bm X n−mb(X). (3.8) Ponieważ wielomian ten ma stopień mniejszy niż n (sprawdzić!), więc, na mocy założenia indukcyjnego, istnieją takie wielomiany ̃q(X) i r(X), że ̃a(X) = ̃q(X)b(X) + r(X) i deg r(X) < deg b(X). Stąd mamy a(X) = q(X)b(X) + r(X), gdzie q(X) = an bm X n−m + ̃q(X). Dla dowodu jedno- znaczności załóżmy, że zachodzą równości a(X) = q1(X)b(X) + r1(X) = q2(X)b(X) + r2(X), 3.2. Siedem idei podstawowych 69 gdzie stopnie deg r1, deg r2 są mniejsze niż deg b. Wtedy (q1 − q2)b = r2 − r1. Stąd, ponieważ, na mocy C3.6 (patrz też C1.19), deg (q1 − q2)b = deg (q1 − q2) + deg b, więc deg (q1 − q2) + deg b = deg (r2 − r1) ⩽ max {deg r2, deg r1} < deg b. Zatem deg (q1 − q2) < 0, czyli q1(X) − q2(X) = 0 i, w końcu, r1(X) − r2(X) = 0. □ W opisanej sytuacji wielomian q(X) nazywamy (niepełnym) ilorazem, a wielomian r(X) resztą z dzielenia a(X) przez b(X). Gdy r(X) = 0, piszemy b(X)|a(X) i mówimy, że wielomian b(X) dzieli wielomian a(X). U w a g a 1. Czytelnik powinien tak długo wpatrywać się w (3.8), aż rozpozna k r o k naucza- nego w szkole algorytmu dzielenia wielomianów . Algorytm ten wykonuje się szczególnie łatwo, gdy bm = 1. Wielomiany spełniające taki warunek warto nazwać: Deﬁnicja 3.5 Wielomian ∑m k=0 bkX k ∈ R[X] nazywa się wielomianem unormowanym, gdy jego współczynnik wiodący bm jest równy 1 (jedynka pierścienia R). U w a g a 2. Zauważmy, że dowód i s t n i e n i a równości (3.7) przechodzi bez żadnych zmian dla wielomianów o współczynnikach w pierścieniu: trzeba jedynie żądać, by współczynnik bm był elementem o d w r a c a l n y m. W szczególności, zawsze można wykonać dzielenie (z resztą!) przez wielomian u n o r m o w a n y. Gorzej jest z jednoznacznością! Dlaczego? U w a g a 3. Należy też zauważyć, że równość B´ezout’a (3.2) jest szczególnym przypadkiem równości (3.7). Mamy tam do czynienia z dzieleniem przez dwumian b(X) = X − α. Resztą z tego dzielenia jest wielomian stopnia < 1, mianowicie element f (α) pierścienia R. W poniższych przykładach używamy oznaczeń: An(X) = X n − 1, Bn(X) = X n + 1, Cn(X) = X n + X n−1 + · · · + 1, Dn(X) = X n + X n−2 + X n−4 + . . . . Wyraz wolny wielomianu Dn(X) jest równy 1, gdy n jest liczbą parzystą, a jest równy 0, gdy n jest liczbą nieparzystą. P r z y k ł a d 2. Z faktu, że A1(X)|An(X) dla każdego n ∈ N korzystaliśmy już wyżej. Zobacz też tożsamość nieśmiertelną (1.8), z której wynika, że An(X) = Cn−1(X) · A1(X) (P2) jest odpowiednim dzieleniem z resztą (zerową). ♦ P r z y k ł a d 3. Podzielimy teraz (z resztą) wielomian Bn(X) przez B1(X). Dostajemy równość X n + 1 = q(X) · (X + 1) + rn, gdzie rn = Bn(−1) = (−1) n + 1. Konkretnie: Bn(X) = (−1) n−1Cn−1(−X) · B1(X) + [1 + (−1) n]. (P3) Widzimy stąd, że X +1|X n +1 wtedy i tylko wtedy, gdy (−1) n +1 = 0. Więc z całą pewnością, gdy n jest n i e p a r z y s t e. A także wtedy, gdy 2 := 1 + 1 = 0. ♦ 70 3. Wielomiany P r z y k ł a d 4. Chcemy teraz podzielić wielomian D4k(X) przez wielomian C2k(X). Mno- żąc D4k(X) przez X 2 − 1, czyli C2k(X 2) przez A1(X 2), dostajemy, wobec (P2), równość (X 2 − 1)D4k(X) = A1(X 2)C2k(X 2) = A2k+1(X 2) = X 4k+2 − 1 = (X 2k+1 − 1)(X 2k+1 + 1). Czyli, wobec (P2) i (P3), (X 2 − 1)D4k(X) = (X − 1)C2k(X) · (X + 1)C2k(−X). Zapiszmy to w posaci (X 2 − 1)D4k(X) = (X 2 − 1)C2k(−X)C2k(X). Stąd łatwo (jak?) wywnioskować równość: D4k(X) = C2k(−X) · C2k(X). ♦ (P4) P r z y k ł a d 5. Podzielimy wreszcie, z resztą(!), wielomian D4k+2(X) przez C2k+1(X). Mamy D4k+2(X) = X 2D4k(X) + 1 = X 2C2k(−X)C2k(X) = [XC2k(−X)] · [XC2k(X)] + 1. Stąd, ponieważ XC2k(X) = C2k+1(X)−1, D4k+2(X) = [XC2k(−X)]·C2k+1(X)+1−XC2k(−X). Ale 1 − XC2k(−X) = C2k+1(−X), więc, dodając i odejmując C2k+1(X), dostajemy D4k+2(X) = [XC2k(−X) − 1]C2k+1(X) + C2k+1(X) + C2k+1(−X). I ostatecznie D4k+2(X) = [−C2k+1(−X)] · C2k+1(X) + 2D2k(X). ♦ (P5) Ćwiczenie 3.7 (1) Wyznaczyć resztę z dzielenia X 100 − 2X 51 + 1 ∈ Q[X] przez X 2 − 1. (2) Wielomian f (X) ∈ R[X] daje przy dzieleniu przez X + 2 resztę 3, a przy dzieleniu przez X − 3 resztę −2. Jaką resztę daje wielomian f (X) przy dzieleniu przez X 2 − X − 6? Ćwiczenie 3.8 Dzielimy z resztą wielomian X 21−1 przez wielomian X 4+X 3+2X 2+X+1. Wyznaczyć współczynnik stojący przy X 14 w (niepełnym) ilorazie. 3.2.3 Trzecia idea: twierdzenie Lagrange’a i o jednoznaczności Twierdzenie B´ezout’a zachodzi dla wielomianów o współczynnikach w d o w o l n y m pierście- niu. Wniosek WT3.2 zachodzi tylko dla dziedzin całkowitości. Również poniższe twierdzenie zachodzi w tym przypadku2. TWIERDZENIE 3.4 (Twierdzenie Lagrange’ a 3) Jeżeli K jest ciałem, to wielomian stopnia n ⩾ 1 o współczynnikach w K ma c o n a j w y ż e j n pierwiastków w K. D O W Ó D. Załóżmy, nie wprost, że wielomian f (X) stopnia n ma n + 1 (lub więcej) pierwiastków. Niech to będą α1, α2, . . . , αn i λ. Wówczas, na mocy wniosku WT3.2, możemy napisać f (X) = (X − α1)(X − α2) · . . . · (X − αn) · a, gdzie a oznacza wielomian stopnia 0, czyli n i e z e r o w y element ciała K. Obliczając wartość wielomianu f (X) dla argumentu λ mamy więc 0 = f (λ) = (λ − α1)(λ − α2) · . . . · (λ − αn) · a. To jednakże jest niemożliwe, bo w ciele n i e m a dzielników zera, zobacz C1.19. □ U w a g a 1. Wielomian stopnia n może mieć m n i e j niż n pierwiastków (w ciele współ- czynników). Na przykład wielomian X 2 + 2X + 1 ma tylko jeden pierwiastek α = −1 (również w ciele liczb zespolonych!). A wielomian X 3 + X ∈ R[X] ma również tylko je- den pierwiastek α = 0 w zbiorze (ciele) liczb rzeczywistych R. Sprawdźcie! Jednakże, gdy potraktujemy go jako wielomian o współczynnikach zespolonych, to ma on dokładnie trzy pier- wiastki: α = 0, β = i, γ = −i. Odpowiedni rozkład (3.5) ma w tym przypadku postać X 3 + X = (X − 0)(X − i)(X − (−i)) · 1, czyli X 3 + X = X(X − i)(X + i). 2W algebrze dowodzi się, że każda dziedzina całkowitości jest podpierścieniem pewnego ciała, tak zwanego ciała ułamków, tak jak pierścień Z liczb całkowitych jest podpierścieniem ciała Q liczb wymiernych. 3Lagrange udowodnił prawdziwość tego twierdzenia w przypadku, gdy K = Fp, zob. ustęp 5.4.3. 3.2. Siedem idei podstawowych 71 Oczywistym (wystarczy rozważyć wielomian g(X) = f (X) − d) wnioskiem z T3.4 jest: WNIOSEK 1. Jeżeli f (X) ∈ K[X] ma stopień ⩽ n i dla n + 1 różnych argumentów z ciała K przyjmuje daną wartość d ∈ K, to f (X) = d. □ Pokażemy ładny przykład zastosowania tego wniosku: ZADANIE 3.3 Danych jest 2n liczb rzeczywistych a1, a2, . . . , an i c1, c2, . . . , cn. W (i, j)-te pole (czyli pole w przecięciu i-tego wiersza z j-tą kolumną) kwadratowej tablicy o wymiarach n × n wpisano liczbę ai + cj. Udowodnić, że jeżeli iloczyn liczb w wierszu nie zależy od wyboru wiersza, to iloczyn liczb w kolumnie nie zależy od wyboru kolumny. R o z w i ą z a n i e. Rozważmy dwa wielomiany stopnia n: f (X) = (X + a1)(X + a2) · . . . · (X + an), g(X) = (X − c1)(X − c2) · . . . · (X − cn). Niech r(X) = g(X) − f (X). Wielomian r(X) ma stopień ⩽ n − 1 i, zgodnie z założeniem, dla n różnych wartości argumentu, przyjmuje tę samą wartość (oznaczmy ją d): r(−a1) = r(−a2) = . . . = r(−an) = d. Zatem, na mocy wniosku, wielomian r(X) jest wielomianem stałym: r(X) = d. Stąd widzimy, że iloczyn liczb stojących w j-tej kolumnie, czyli f (cj), wynosi f (cj) = −(g(cj) − f (cj)) = −r(cj) = −d, i nie zależy od wyboru j. ♦ ZADANIE 3.4 Wyznaczyć wszystkie wielomiany f (X) ∈ R[X], spełniające warunek xf (x − 1) = (x + 1)f (x) dla każdego x ∈ R. R o z w i ą z a n i e. Niech f (X) będzie takim wielomianem. Kładąc x = 0 widzimy, że 0 = 1·f (0). Czyli f (0) = 0. Tę równość wykorzystamy jako b a z ę rozumowania indukcyjnego dowodzącego, że f (n) = 0 dla każdego n ∈ N. Oto k r o k i n d u k c y j n y: jeżeli f (k) = 0, to 0 = (k + 1)f (k) = (k + 2)f (k + 1), więc f (k + 1) = 0. Wielomian f (X) ma więc nieskończenie wiele pierwiastków. M u s i więc być wielomianem zerowym. ♦ Kolejnym wnioskiem z T3.4 jest poniższe twierdzenie o jednoznaczności: WNIOSEK 2. (Twierdzenie o jednoznaczności ) Jeżeli f (X) = ∑n k akX k i g(X) =∑n k bkX k są dwoma wielomianami o współczynnikach w ciele K, oraz f (α) = g(α) dla każdego α ∈ A, gdzie A ⊆ K jest podzbiorem mającym w i ę c e j niż n elementów, to ak = bk dla każdego k = 0, 1, 2, . . . , czyli f (X) = g(X). D O W Ó D. Wynika bezpośrednio z poprzedniego wniosku zastosowanego do wielomianu r(X) równego różnicy f (X) − g(X). Wielomian ten ma bowiem stopień ⩽ n i co najmniej n + 1 razy przyjmuje wartość d = 0. Jest więc wielomianem zerowym. □ Oto przykładowe zastosowanie twierdzenia o jednoznaczności: P r z y k ł a d. Dane są trzy (parami) różne liczby a, b, c. Chcemy udowodnić, że L := (d − b)(d − c) (a − b)(a − c) + (d − c)(d − a) (b − c)(b − a) + (d − a)(d − b) (c − a)(c − b) = 1 72 3. Wielomiany dla każdej liczby d. Myślimy o tym tak: Rozważamy wielomian f (X) = (X − b)(X − c) (a − b)(a − c) + (X − c)(X − a) (b − c)(b − a) + (X − a)(X − b) (c − a)(c − b) . Jest on wielomianem stopnia ⩽ 2. Wystarczy więc znaleźć t r z y różne argumenty α, dla których f (α) = 1, by stwierdzić, że f (X) = 1, w szczególności L = f (d) = 1. Sprawdzenie, że α = a, b, c są dobre, jest natychmiastowe. ♦ U w a g a 2. W matematyce szkolnej wielomian f j e s t f u n k c j ą określoną na zbiorze liczb rzeczywistych i zadaną wzorem f (x) = a0 + a1x + . . . + anxn, gdzie ak są ustalonymi licz- bami rzeczywistymi. W matematyce zaś, wielomian w y z n a c z a f u n k c j ę, zwaną funkcją wielomianową. To rozróżnienie jest w matematyce szkolnej (w świetle powyższego wnio- sku) b e z w i ę k s z e g o z n a c z e n i a, bowiem zbiór liczb rzeczywistych jest c i a ł e m i jest n i e s k o ń c z o n y. Wobec tego istnieje wzajemnie jednoznaczna odpowiedniość między wielo- mianami o współczynnikach rzeczywistych a funkcjami wielomianowymi określonymi na zbiorze liczb rzeczywistych. W ogólności tak dobrze n i e j e s t. W rozdziale 5 przekonamy się, że ist- nieją pierścienie (i ciała) mające tylko skończenie wiele elementów. Jeżeli R = {α1, α2, . . . , αs} jest skończonym pierścieniem, w którym 1 ̸= 0, to wielomian f (X) = (X − α1)(X − α2) · . . . · (X − αs) ∈ R[X] jest n i e z e r o w y m wielomianem, ale wyznaczona przez niego funkcja λ 7−→ f (λ) przyjmuje wyłącznie wartości równe 0 (pierścienia R). Przy okazji zauważmy, że pierścień, w którym 1 = 0 składa się w y ł ą c z n i e z elementu 0, zobacz D1.7(4) i Z1.6(1). 3.2.4 Czwarta idea: pierwiastki wymierne Czwarta podstawowa idea z dziedziny wielomianów dotyczy pierwiastków wymiernych wie- lomianów o współczynnikach c a ł k o w i t y c h. Odpowiednie twierdzenie to było przez nas sformułowane i udowodnione w ustępie 2.1.4, zobacz zadanie Z2.4. Ćwiczenie 3.9 Udowodnić, że jeżeli f (X) ∈ Z[X] jest unormowany i liczba k ∈ N nie dzieli żadnej z liczb f (a + j) dla pewnego a ∈ Z i wszystkich 1 ⩽ j ⩽ k, to wielomian f (X) nie ma pierwiastków wymiernych. Ćwiczenie 3.10 Udowodnić, że jeżeli nieskracalny ułamek h/k jest pierwiastkiem wielo- mianu f (X) = a0 + a1X + . . . + anX n ∈ Z[X], to h − kt|f (t) dla każdej liczby całkowitej t. Wskazówka. Dla danej liczby całkowitej t rozważyć wielomian gt(X) = f (X + t). N a j w a ż n i e j s z y m, z teoretycznego punktu widzenia, wnioskiem z zadania Z2.4, jest po- niższe twierdzenie. Byłoby bardzo dobrze, gdyby Czytelnik udowodnił je szczegółowo, wszystko zrozumiał i na zawsze zachował w pamięci ”operacyjnej”. TWIERDZENIE 3.5 Jeżeli α ∈ Q jest pierwiastkiem u n o r m o w a n e g o wielomianu o współczynnikach całkowitych (stopnia ⩾ 1), to α ∈ Z. □ 3.2. Siedem idei podstawowych 73 3.2.5 Piąta idea: postać kanoniczna trójmianu kwadratowego Piąta podstawowa idea z dziedziny wielomianów dotyczy trójmianów kwadratowych, czyli wielomianów drugiego stopnia, zapisywanych tradycyjnie w postaci aX 2 + bX + c, gdzie a ̸= 0. (3.9) Tym razem m u s i m y ograniczyć się do przypadku, gdy K jest takim ciałem, w którym możliwe jest d z i e l e n i e p r z e z 2, czyli ciałem, w którym 1 + 1 ̸= 0. Oczywiście, ciała Q, R i C spełniają ten (dziwnie – dla początkującego matematyka – wyglądający) warunek. Badając trójmian (3.9) sprowadzamy go do postaci kanonicznej. Robi się to za pomocą standardowej procedury uzupełniania do (pełnego) kwadratu: aX 2 + bX + c = a (X 2 + 2 · b 2a X + ( b 2a )2 − ( b 2a )2) + c = a ( X + b 2a )2 − ∆ 4a, (PK) gdzie ∆ = b2 − 4ac jest tak zwanym wyróżnikiem trójmianu (3.9). Podkreślmy już w tym miejscu, że wszystko czego dowiadujemy się w szkole (i poza szkołą) o trójmianie kwadratowym daje się odczytać z postaci kanonicznej. Pierwiastki trójmianu kwadratowego Zaczniemy od problemu i s t n i e n i a i (jeżeli istnieją) w y z n a c z a n i a pierwiastków trójmianu (3.9). Z postaci kanonicznej łatwo widać, że prawdziwe jest: TWIERDZENIE 3.6 Jeżeli w ciele K istnieje taki element d, że d2 = ∆, to α1 = −b − d 2a , α2 = −b + d 2a (3.10) są pierwiastkami trójmianu (3.9), przy czym α1 = α2 ⇔ ∆ = 0. Jeżeli dla żadnego d ∈ K nie zachodzi równość d2 = ∆, to trójmian (3.9) nie ma pierwiastków w ciele K. □ U w a g a 1. Jeżeli trójmian (3.9) ma pierwiastki α1, α2, to równość (3.5) ma postać aX 2 + bX + c = a(X − α1)(X − α2) (3.11) W przypadku α1 = α2 = α mówimy, że α jest pierwiastkiem podwójnym. U w a g a 2. Element d spełniający warunek d 2 = ∆ jest, oczywiście, pierwiastkiem wie- lomianu f (X) = X 2 − ∆. Wobec tego w ciele mogą istnieć co najwyżej dwa takie elementy i, co więcej, jeżeli d jest takim pierwiastkiem, to drugim może być tylko −d. Takie d oznacza się zazwyczaj √∆ i nazywa się pierwiastkiem kwadratowym z ∆. U w a g a 3. (1) W przypadku K = R (typowy przypadek szkolny), warunkiem koniecznym i wystarczającym i s t n i e n i a √ ∆ jest nieujemność: ∆ ⩾ 0. W przypadku K = C, k a ż d a liczba ∆ ma pierwiastek kwadratowy. Wobec tego każdy trójmian kwadratowy o współczynni- kach zespolonych ma pierwiastki w ciele liczb zespolonych. (3) W przypadku K = Q warunek 74 3. Wielomiany ∆ ⩾ 0 jest wprawdzie warunkiem koniecznym istnienia pierwiastka kwadratowego √∆ ∈ Q, ale zdecydowanie nie jest warunkiem wystarczającym. P r z y k ł a d 1. Niech f1(X) = X 2−7X +10, f2(X) = X 2−7X +9 i f3(X) = X 2−7X +13. Mamy ∆1 = 72 − 4 · 10 = 3 2, ∆2 = 49 − 36 = 13 = (√13) 2 i ∆3 = 49 − 52 = −3 = ( √3i)2. Zatem f1(X) ma w ciele Q liczb wymiernych dwa pierwiastki: α1 = 7+3 2 = 5, α2 = 7−3 2 = 2, f2(X) nie ma pierwiastków wymiernych, ale ma w ciele R liczb rzeczywistych dwa pierwiastki: α1 = 7+ √13 2 , α2 = 7− √13 2 , zaś trójmian f3(X) nie ma pierwiastków rzeczywistych, ale ma dwa pierwiastki zespolone α1 = 7+i√3 2 , α2 = 7−i√3 2 . ♦ P r z y k ł a d 2. Wyznaczymy wszystkie takie liczby całkowite x, że |4x2 + 12x − 27| jest liczbą pierwszą. Oto rozkład (3.11): 4X 2 + 12X − 27 = 4(X − 9/2)(X + 3/2). Stąd, dla każdego x ∈ Z, |4x2 + 12x − 27| = |2x − 9| · |2x + 3|. Szansę na pierwszość mamy więc tylko, gdy |2x − 9| = 1 lub |2x + 3| = 1. ♦ Ćwiczenie 3.11 Dowieść, że trójmiany f1(X) = aX 2 + bX + c, f2(X) = bX 2 + cX + a i f3(X) = cX 2 + aX + b mają w s p ó l n y pierwiastek wtedy i tylko wtedy, gdy a + b + c = 0. Ćwiczenie 3.12 Załóżmy, że każdy z trójmianów X 2 + 2aX + b2, X 2 + 2bX + c2 ∈ R[X] ma dwa (różne) pierwiastki rzeczywiste. Uzasadnić, że wielomian X 4 + 2(a2 − 2c2)X 2 + a4 nie ma pierwiastków rzeczywistych. ZADANIE 3.5 Udowodnić, że z odcinków o długościach a, b, c ∈ R>0 można zbudować trójkąt wtedy i tylko wtedy, gdy zachodzi nierówność 2a2b2 + 2b2c2 + 2c2a2 > a 4 + b4 + c4. R o z w i ą z a n i e. Zapiszmy badaną nierówność tak: a 4 − 2(b2 + c2)a2 + (b2 − c2) 2 < 0. To jest równoważne z faktem, że trójmian kwadratowy f (X) = X 2 − 2(b2 + c2)X + (b2 − c2) 2 przyjmuje wartość ujemną dla argumentu a2. Napiszmy rozkład (3.11) dla tego trójmianu. Mamy ∆ = 4(b2 + c2) 2 − 4(b2 − c2)2 = 16b2c2, więc √ ∆ = 4bc. Stąd, na mocy wzorów (3.10), α1 = (b − c)2, α2 = (b + c)2. Wobec tego f (X) = (X − (b − c)2)(X − (b + c) 2). Przeto: f (a2) = (a2 − (b − c) 2)((a2 − (b + c) 2) = (a − b + c)(a + b − c)(a − b − c)(a + b + c). Łatwo stąd wywnioskować, że f (a2) < 0 wtedy i tylko wtedy, gdy a + b > c, b + c > a i c + a > b. Pozostawiamy to Czytelnikowi. ♦ W ﬁnale 61 OM zadano takie zadanie: ZADANIE 3.6 Dodatnie liczby wymierne a i b spełniają równość a3 + 4a2b = 4a2 + b4. Udowodnić, że liczba √a − 1 jest kwadratem liczby wymiernej. R o z w i ą z a n i e. Równość a3 + 4a2b = 4a2 + b4 jest (jak łatwo sprawdzić) równoważna równości a = (2a+b2)2 (a+2b)2 . Widzimy stąd, że a jest kwadratem liczby wymiernej d = 2a+b2 a+2b . Równość d = 2a+b2 a+2b interpretujemy tak: liczba b jest (wymiernym) pierwiastkiem trójmianu f (X) = X 2 − 2dX + a(2 − d) ∈ Q[X]. Zatem, zobacz C3.13, wyróżnik ∆ = 4d2 − 4a(2 − d) = 4a(d − 1) tego trójmianu jest kwadratem liczby wymiernej. Zatem d − 1 = ∆/(2d) 2 też jest kwadratem liczby wymiernej. ♦ Ćwiczenie 3.13 Udowodnić, że jeżeli f (X) = aX 2+bX +c jest trójmianem kwadratowym o współczynnikach wymiernych i nieujemnym wyróżniku, to jego pierwiastki są w y m i e r n e wtedy i tylko wtedy, gdy wyróżnik ∆ = b2 − 4ac jest kwadratem liczby wymiernej. 3.2. Siedem idei podstawowych 75 3.2.6 Szósta idea: Wielomian jako funkcja rzeczywista W szkole uczymy się przypadku r z e c z y w i s t e g o, to znaczy, że pierścieniem współczynników jest ciało R liczb rzeczywistych. O wielomianie (3.1) myślimy wtedy jak o (oznaczanej, dla uproszczenia, tym samym znaczkiem) f u n k c j i f : R −→ R danej wzorem f (x) = a0 + a1x + . . . + anxn, (3.12) porównaj 3.2.3 U2. Taki sposób myślenia jest charakterystyczny dla analizy matematycznej i w zasadzie wolimy rozwijać go w RIN ’ie, jednak kilka najprostszych własności trójmianów kwadratowych (i ogólniej, wielomianów) o współczynnikach rzeczywistych, traktowanych jako funkcje rzeczywiste, przyda się nam już teraz. TWIERDZENIE 3.7 Niech f : R −→ R będzie funkcją kwadratową daną za pomocą przepisu f (x) = ax2 + bx + c. Załóżmy też, że a > 0. Wówczas: (1) funkcja f jest malejąca w ( −∞; −b/2a ] i rosnąca w [ −b/2a; ∞ ), (2) najmniejszą wartością funkcji f jest −∆/4a = f (−b/2a), (3) jeżeli f (x1) < y0 < f (x2), to między x1 i x2 istnieje taka liczba x0, że f (x0) = y0. D O W Ó D. (1) Niech x1 < x2 ⩽ −b/2a. Wówczas x1 + b/2a < x2 + b/2a ⩽ 0. Zatem f (x1) = a (x1 + b 2a )2 − ∆ 4a > a ( x2 + b 2a )2 − ∆ 4a = f (x2). Więc funkcja f jest malejąca w ( −∞; −b/2a ]. Podobnie sprawdzamy drugą tezę. (2) Ponieważ z2 ⩾ 0 dla każdej liczby rzeczywistej z, więc dla każdego x ∈ R f (x) = a ( x + b 2a )2 − ∆ 4a ⩾ − ∆ 4a i równość zachodzi tylko dla x = −b/2a. (3) Udowodnimy najpierw przypadek s z c z e g ó l n y, gdy y0 = 0. Zakładamy więc, że f (x1) < 0, f (x2) > 0 i, b.s.o., x1 < x2. Mamy uzasadnić, że w przedziale ( x1; x2 ) istnieje pierwiastek (= miejsce zerowe) funkcji f . Przede wszystkim uzasadniamy, że pierwiastek w ogóle istnieje. Ponieważ −∆/4a ⩽ f (x1) < 0 (bo −∆/4a jest najmniejszą wartością), więc ∆ > 0. Biorąc pierwiastek arytmetyczny d = √ ∆, widzimy w (3.10) d w a pierwiastki α1 < α2. Z punktu (1) wiemy, że funkcja f maleje od wartości 0 = f (α1) do wartości najmniejszej −∆/4a = f (−b/2a) w przedziale [ α1; −b/2a ] i rośnie od wartości najmniejszej −∆/4a do wartości 0 = f (α2) w przedziale [ −b/2a; α2]. W całym przedziale ( α1; α2 ) przyjmuje więc wyłącznie wartości ujemne. I tylko tam(!). Z tego wynika, że x1 ∈ ( α1; α2 ), a x2 ̸∈ [ α1; α2 ]. Zatem: albo α1 albo α2 leży między x1 i x2. Dla dowodu w przypadku ogólnym patrzymy na funkcję g : R −→ R daną wzorem g(x) = f (x) − y0. To jest funkcja wielomianowa wyznaczona przez trójmian kwadratowy g(X) = aX 2 + bX + c − y0. □ U w a g a 1. Czytelnik z pewnością potraﬁ zmienić to co zmienić należy, gdy a < 0. U w a g a 2. Własność wyrażona w T3.7(3) nazywa się własnością przyjmowania war- tości pośrednich lub własnością Darboux. Przysługuje ona wszystkim (zdeﬁniowanym na 76 3. Wielomiany przedziale) rzeczywistym funkcjom ciągłym, w szczególności wszystkim funkcjom wielomia- nowym (3.12). Dowód podamy w RIN . Tam też dowiemy się, że każda funkcja wielomianowa (3.12) stopnia n i e p a r z y s t e g o dla wszystkich, dostatecznie dużych, n ∈ N spełnia warunek f (−n)f (n) < 0, więc że prawdziwe jest poniższe twierdzenie: TWIERDZENIE 3.8 Wielomian f (X) ∈ R[X] stopnia n i e p a r z y s t e g o ma co najmniej jeden pierwiastek rzeczywisty. □ Pokażemy parę przykładów zastosowań T3.7. P r z y k ł a d 1. Dane są liczby rzeczywiste c1, c2, . . . , cn. Wyznaczamy taką liczbę rzeczy- wistą, że suma kwadratów jej odległości od liczb ci jest najmniejsza możliwa. Czyli znajdujemy argument, dla którego funkcja kwadratowa f (x) = (x − c1) 2 + (x − c2) 2 + . . . + (x − cn)2 przyjmuje najmniejszą wartość. Z T3.7(2) widzimy, że xmin = 1 n(c1 + c2 + · · · + cn). ♦ P r z y k ł a d 2. Załóżmy, że (4u − 2v + w)(u + v + w) + w(4u + 2v + w) = −1 dla liczb u, v, w ∈ R. Udowodnimy, że v2 > 4uw. Rzeczywiście, warunek oznacza, że f (−2)f (1) + f (0)f (2) = −1, gdzie f (x) = ux2 + vx + w. Stąd wnosimy, że co najmniej jeden z iloczynów f (−2)f (1), f (0)f (2) jest ujemny. Zatem, zobacz T3.7(3), trójmian f m a p i e r w i a s t e k (gdzieś w przedziale ( −2; 2)). Wobec tego jego wyróżnik jest dodatni. ♦ P r z y k ł a d 3. Szlachetnym zastosowaniem jest dowód nierówności Schwarza: (a1b1 + a2b2 + · · · + anbn)2 ⩽ (a2 1 + a2 2 + · · · + a2 n)(b2 1 + b2 2 + · · · + b2 n), (3.13) dla dowolnych układów a1, a2, . . . , an i b1, b2, . . . , bn liczb rzeczywistych. Dla dowodu roz- ważmy trójmian kwadratowy f (x) = Ax2 + 2Sx + B, gdzie A = a2 1 + · · · + a2 n, B = b2 1 + · · · + b2 n i S = a1b1 + · · · + anbn. Zauważamy, że nierówność (3.13) jest równoważna nierówności ∆ ⩽ 0. A to wynika z oczywistego faktu, że funkcja kwadratowa wyznaczona przez trójmian f (X) dana jest wzorem f (x) = (a1x − b1) 2 + (a2x − b2)2 + . . . + (anx − bn) 2, z którego widać, że przyjmuje ona w y ł ą c z n i e wartości nieujemne. Może mieć więc co najwy- żej jedno miejsce zerowe. Czyli rzeczywiście ∆ ⩽ 0. Co więcej, równość ∆ = 0 zachodzi tylko w przypadku, gdy istnieje taka liczba λ (pierwiastek trójmianu f (X)), że λai = bi dla każdego i = 1, . . . , n. Mówimy wtedy, że układy a1, a2, . . . , an i b1, b2, . . . , bn są proporcjonalne. ♦ ZADANIE 3.7 Dany jest trójmian kwadratowy f (X) = X 2+aX +b ∈ R[X]. Udowodnić, że istnieje taka liczba x ∈ [ −1; 1 ], że |f (x)| ⩾ 1 2. R o z w i ą z a n i e. Załóżmy, nie wprost, że |f (x)| < 1 2 dla wszystkich x ∈ [ −1; 1 ] i porów- najmy f (x) z funkcją kwadratową g(x) = x2 − 1/2. Z założeń mamy f (−1) − g(−1) < 0, f (0) − g(0) > 0 i f (1) − g(1) < 0. Dzięki własności Darboux wnosimy stąd, że funkcja wielo- mianowa f − g ma miejsce zerowe w przedziale ( −1; 0 ) i miejsce zerowe w przedziale ( 0; 1 ). To daje sprzeczność, bowiem f (x) − g(x) = ax + b − 1 2 jest funkcją wielomianową stopnia ⩽ 1, a taka może mieć dwa miejsca zerowe tylko gdy jest tożsamościowo równa 0, co tu nie ma miejsca, bo f (0) − g(0) > 0. ♦ 3.2. Siedem idei podstawowych 77 3.2.7 Siódma idea: wzory Vi`ete’a Siódma podstawowa idea z dziedziny wielomianów dotyczy sumy i iloczynu pierwiastków trój- mianu (3.9). Również tym razem zakładamy, że 1 + 1 ̸= 0. Ciała, w których 1 + 1 = 0 nazywają się ciałami charakterystyki 2. TWIERDZENIE 3.9 (wzory Vi`ete’ a) Jeżeli α1, α2 są pierwiastkami trójmianu (3.9), to zachodzą równości  | | α1 + α2 = − b a , α1α2 = c a. (3.14) I odwrotnie, przy zadanych elementach a, b, c ∈ K, przy czym a ̸= 0, rozwiązaniem układu równań (3.14) jest, z dokładnością do permutacji, para pierwiastków trójmianu (3.9). D O W Ó D. Wystarczy policzyć korzystając ze wzorów (3.10) i równości ∆ 2 = b2 − 4ac. Odwrotnie, załóżmy, że para (α1, α2) jest rozwiązaniem układu (3.14). Wówczas, wstawiając, wyliczone z pierwszej równości, α2 = −b/a − α1, do drugiej równości, otrzymujemy równość α1(−b/a − α1) = c/a równoważną równości aα2 1 + bα1 + c = 0. To pokazuje, że α1 jest pierwiastkiem wielomianu (3.9). Jasne, że tak samo sprawdzamy, że α2 jest pierwiastkiem tego wielomianu. □ Pokażemy kilka zadań na zastosowanie wzorów Vi`ete’a. ZADANIE 3.8 Dowieść, że jeżeli trójmian kwadratowy f (X) = aX 2 + bX + c ∈ Z[X] ma pierwiastek wymierny, to co najmniej jedna z liczb a, b, c jest parzysta. R o z w i ą z a n i e. Niech α będzie wymiernym pierwiastkiem wielomianu f (X). Wów- czas 0 = af (α) = (aα) 2 + b(aα) + ac. Stąd widzimy, że liczba w y m i e r n a u1 = aα jest pierwiastkiem u n o r m o w a n e g o wielomianu g(X) = X 2 + bX + ac o współczynnikach cał- kowitych. Zatem, u1 ∈ Z, zobacz T3.5. Drugi pierwiastek u2 wielomianu g(X) jest, na mocy wzoru Vi`ete’a, równy −b − u1. Jest więc również liczbą całkowitą. Jednocześnie u1u2 = ac. Stąd abc = −u1u2(u1 + u2). Ponieważ trzy liczby całkowite u1, u2, u1 + u2 n i e mogą być jednocześnie nieparzyste, więc mamy tezę. ♦ ZADANIE 3.9 Trójmian f1(X) = X 2 + a1X + b1 ma pierwiastki ϕ1, ψ1, a inny trój- mian f2(X) = X 2 + a2X + b2 ma pierwiastki ϕ2, ψ2. Wyrazić za pomocą współczynników a1, b1, a2, b2 iloczyn R(f1, f2) := (ϕ1 − ϕ2)(ψ1 − ϕ2)(ϕ1 − ψ2)(ψ1 − ψ2). R o z w i ą z a n i e. Iloczyn pierwszych dwóch czynników, czyli ϕ1ψ1 − (ϕ1 + ψ1)ϕ2 + ϕ2 2, jest, na mocy wzorów Vi`ete’a, równy b1 + a1ϕ2 + ϕ2 2 = f1(ϕ2). Podobnie, iloczyn trzeciego i czwartego czynnika jest równy f1(ψ2). Wobec tego, R(f1, f2) = (b1+a1ϕ2+ϕ 2 2)(b1+a1ψ2+ψ2 2). Stąd, korzystając z równości Vi`ete’a ϕ2 + ψ2 = −a2 i ϕ2ψ2 = b2, łatwo dostajemy: R(f1, f2) = (b1 − b2) 2 + (a1 − a2)(a1b2 − a2b1). ♦ (3.15) 78 3. Wielomiany ZADANIE 3.10 Załóżmy, że r jest nieparzystą liczbą całkowitą. Oznaczmy przez α, β pierwiastki trójmianu kwadratowego X 2 −rX −1 i niech an = αn +βn dla n ∈ Z. Udowodnić, że liczby a−2017 i a2016 są całkowite i względnie pierwsze. R o z w i ą z a n i e. Zauważmy, że an+1 = (α + β)(αn + βn) − αβ(αn−1 + βn−1) = ran + an−1 dla dowolnego n ∈ Z. Mamy więc związek rekurencyjny pozwalający wyznaczać liczby an z (dwóch) poprzednich, ale również z (dwóch) następnych. Dla znajomości całego ciągu (an)n∈Z wystarczy więc znać dwa kolejne wyrazy. Ponieważ a0 = 2, a1 = r, więc jesteśmy już prawie w domu: ponieważ zarówno rekurencja ”w przód” an+1 = ran + an−1, jak i rekurencja ”w tył” an−1 = −ran + an+1 zwraca liczby całkowite, więc dowód całkowitości liczb a−2017 i a2016 mamy załatwiony. Dzięki równości αβ = −1 widzimy, że a−n = α−n + β−n = αn+βn (αβ)n = (−1) nan. Zatem a−2017 = −a2017. Przypomnijmy sobie teraz twierdzenie T2.10. Dzięki niemu mamy równości NWD (an+1, an) = NWD (an, an−1). Stąd, przez oczywistą indukcję, NWD (an+1, an) = NWD (a1, a0) = NWD (r, 2) = 1 (pamiętamy o nieparzystości r). ♦ U w a g a 1. Wzory Vi`ete’a pozwalają wyznaczyć, za pomocą współczynników a, b, c, różne funkcje symetryczne pierwiastków α1, α2 trójmianu (3.9). Na przykład α2 1 + α2 2 = (α1 + α2) 2 − 2α1α2 = ( − b a )2 − 2 · c a = b2 − 2ac a2 , α3 1 + α3 2 = (α1 + α2) 3 − 3α1α2(α1 + α2) = −b3 + 3abc a3 . ♦ Ćwiczenie 3.14 Dane są liczby a, b, c, gdzie ac ̸= bc i α1, α2, α3. Ponadto, α1, α2 są pierwiastkami trójmianu X 2 + aX + bc, a α2, α3 są pierwiastkami trójmianu X 2 + bX + ac. Udowodnić, że wówczas α1, α3 są pierwiastkami trójmianu X 2 + cX + ab. Ćwiczenie 3.15 Niech u, v będą pierwiastkami trójmianu X 2 + pX − 1/(2p2) ∈ R[X]. Udowodnić, że zachodzi nierówność u 4 + v4 ⩾ 2 + √2. W powyższych zadaniach dostrzegamy taką i d e ę: Istnieje ścisły związek między parą liczb (α, β) a wielomianem (X − α)(X − β), którego te liczby są pierwiastkami. Wykorzystywanie tej idei nazwijmy (na nasz użytek) ﬁlozoﬁą Vi`ete’a. Oto prosta teza tej ﬁlozoﬁi: Jeżeli znamy sumę α + β i iloczyn αβ liczb α, β, to znamy te liczby (z dokładnością do przestawienia). Rzeczywiście, jeżeli α+β = p, αβ = q, to liczby α, β są pierwiastkami równania kwadratowego x2 − px + q = 0, a te pierwiastki umiemy wyznaczyć4 (czyli znamy). P r z y k ł a d 1. Załóżmy, że chcemy rozwiązać układ równań { u + uv + v = 19, u2 + v2 = 10. Zgodnie z ﬁlozoﬁą Vi`ete’a badamy wielomian (X − u)(X − v) = X 2 − pX + q. Widzimy, że p + q = 19 i p2 − 2q = 10. Mnożąc pierwszą z tych równości przez 2 i dodając do drugiej, 4Ta teza jest całkowicie prawdziwa w ś w i e c i e z e s p o l o n y m. Gdy poruszamy się tylko w świecie liczb rzeczywistych, musimy przedtem z b a d a ć w y r ó ż n i k, czyli liczbę p 2 − 4q = (α + β) 2 − 4αβ = (α − β) 2. Widzimy, że jeżeli liczby α, β mają być rzeczywiste, to musi zachodzić nierówność p2 − 4q ⩾ 0. 3.2. Siedem idei podstawowych 79 otrzymamy p2 + 2p = 48, czyli (p + 1) 2 = 49. Stąd p = 6 lub p = −8. I, odpowiednio q = 13 lub q = 27. Mamy więc ∆ = p2 − 4q = −16 lub ∆ = −44. Co oznacza, że badany układ równań n i e ma rozwiązań rzeczywistych. Na marginesie: pary (3 − 2i, 3 + 2i) i (−4−√−11, −4+√−11), a także (3+2i, 3−2i) i (−4+√ −11, −4−√−11), są rozwiązaniami badanego układu w dziedzinie zespolonej. ♦ Pięknym i bardzo ważnym przykładem myślenia w duchu ﬁlozoﬁi Vi`ete’a jest poniższe: ZADANIE 3.11 Udowodnić, że jeżeli co najmniej jedna z liczb a, b jest wymierna, a suma a + b i iloczyn ab są całkowite, to a i b są liczbami całkowitymi. R o z w i ą z a n i e. Załóżmy, że a ∈ Q oraz a + b, ab ∈ Z. Wówczas wielomian unormowany (X − a)(X − b) = X 2 − (a + b)X + ab jest wielomianem o współczynnikach całkowitych. Zatem, zobacz T3.5, jego wymierny pierwiastek a j e s t liczbą całkowitą. Wobec tego również b = (a + b) − a jest liczbą całkowitą. U w a g a. Założenie wymierności co najmniej jednej z liczb a, b, jest ważne. Kontrprzykład: a = 3 + 2√2, b = 3 − 2 √2. ♦ P r z y k ł a d 2. Jeżeli m, n są takimi niezerowymi liczbami całkowitymi, że m n + n m jest liczbą całkowitą, to |m| = |n|. Rzeczywiście, ponieważ m n · n m = 1 ∈ Z, więc, na mocy Z3.11, n|m i m|n. Stąd, zobacz C2.2, |n| ⩽ |m| i |m| ⩽ |n|. ♦ P r z y k ł a d 3. Jeżeli x2y2|x5 + y5 dla pewnych x, y ∈ N, to x2|y3. Rzeczywiście, liczby wymierne a = x3/y2 i b = y3/x 2 spełniają założenia zadania Z3.11. ♦ Skoki Vi`ete’a Jednym z przykładów myślenia w duchu ﬁlozoﬁi Vi`ete’a jest technika skoków Vi`ete’a (Vieta’s jumpings). Technika ta staje się coraz bardziej popularna w OM. Jej istotę zoba- czyć można w rozwiązaniu poniższego zadania. ZADANIE 3.12 Liczby naturalne a, b spełniają warunek ab|a2 + b2 + 2. Udowodnić, że zachodzi równość (a 2 + b2 + 2)/ab = 4. R o z w i ą z a n i e. Dla danej liczby naturalnej k oznaczmy przez A(k) zbiór wszystkich takich par uporządkowanych (a, b) liczb naturalnych, że a2 + b2 + 2 = kab. Teza zadania mówi więc, że jeżeli zbiór A(k) jest niepusty, to k = 4. Łatwo widzieć niepustość zbioru A(4): na przykład pary (1, 1) i (3, 1) należą do A(4). Weźmy więc liczbę naturalną k ̸= 4, załóżmy, nie wprost, że A(k) ̸= ∅ i że (a, b) ∈ A(k). Zauważamy najpierw, że wówczas a ̸= b. Rzeczywiście, gdyby a = b, to podzielność a2|2a2 + 2 dałaby (Zasada Podstawowa!) podzielność a2|2. Wtedy a = 1. Zatem a = b = 1, więc (a, b) /∈ A(k), bo k ̸= 4. Załóżmy więc, że a > b. Równość a2 + b2 + 2 = kab interpretujemy następująco: liczba a jest pierwiastkiem trójmianu kwadratowego f (X) = X 2 − kbX + b2 + 2 ∈ Z[X]. (3.16) Niech ̃a będzie d r u g i m pierwiastkiem tego trójmianu. Z zadania Z3.11 wiemy, że ̃a jest liczbą całkowitą. Co więcej, druga równość Vi`ete’a ãa = b2 + 2 dowodzi, że ̃a > 0. Więc ̃a jest liczbą naturalną i para (b, ̃a) również jest elementem zbioru A(k). Wykażemy teraz, że zachodzi nierówność b ⩾ ̃a. Gdyby było odwrotnie, czyli gdyby b < ̃a, to (Zasada Skwanto- wania!) b + 1 ⩽ ̃a, co, łącznie z założoną nierównością b + 1 ⩽ a i drugą równością Vi`ete’a, 80 3. Wielomiany dałoby nierówność nieprawdziwą: (b + 1)2 ⩽ ãa = b2 + 2. Ponieważ, jak wiemy, w zbiorze A(k) nie ma par postaci (c, c), więc w rzeczywistości zachodzi nierówność b > ̃a. Możemy więc znowu wykonać skok Vi`ete’a: rozważyć trójmian f1(X) = X 2 − k̃aX + ̃a2 + 2 i jego pierwiastki b i ̃b. W ten sposób znajdziemy kolejną parę (̃a, ̃b) należącą do zbioru A(k), przy czym a > b > ̃a > ̃b > 0. Jasne, że czegoś takiego n i e da się kontynuować w nieskończoność. Uzyskana sprzeczność kończy rozwiązanie. ♦ U w a g a 2. Przedstawione rozumowanie jest charakterystyczne dla tak zwanej metody desantu nieskończonego. Nieskończone schodzenie a > b > ̃a > ̃b > . . . można ”przeciąć” już w pierwszym kroku, dokładając na początku rozumowania założenie, że para (a, b) jest takim elementem zbioru A(k), dla którego wartość sumy a + b jest n a j m n i e j s z a. (Jeżeli zbiór A(k) jest niepusty, i składa się z par liczb naturalnych, to, na mocy Zasady Minimum, para z najmniejszą sumą i s t n i e j e.) Wówczas sprzeczność znajdujemy już w pierwszym kroku. U w a g a 3. Przejście od pary (a, b) ∈ A(k) do pary (b, ̃a) ∈ A(k) nazwaliśmy skokiem Vi`ete’a. W rozwiązaniu wykorzystaliśmy ”skok w dół”. Można też wykorzystać ”skok wzwyż”: P r z y k ł a d 4. Udowodnimy, że zbiór A(4) z zadania Z3.12 jest zbiorem nieskończonym. Startujemy od pary (a1, b1) := (1, 1) należącej do zbioru A(4). To znaczy, że liczba 1 jest pierwiastkiem trójmianu X 2 − 4X + 3. Drugim pierwiastkiem tego trójmianu jest 3. W ten sposób z pary (1, 1) wykonaliśmy skok Vi`ete’a do pary (a2, b2) := (1, 3). Ta para prowadzi do trójmianu X 2 − 12X + 11, którego mniejszym pierwiastkiem jest 1. Drugim pierwiastkiem tego trójmianu jest liczba 11. W ten sposób z pary (1, 3) wykonaliśmy skok Vi`ete’a do pary (a3, b3) := (3, 11). Itd. Jeżeli, dla danego n ⩾ 3, mamy parę (an, bn), gdzie an < bn, to ̃an, drugi (obok an) pierwiastek równania x2 − 4bnx + b2 n + 2 = 0, jest w i ę k s z y niż bn. W ten sposób powstaje para (an+1, bn+1) := (bn, ̃an). Z pierwszej równości Vi`ete’a mamy bn+1 = 4bn − an. Widzimy piękny skok Vi`ete’a (an, bn) ↷ (an+1, bn+1) := (bn, 4bn − an). Ten skok jest ”skokiem wzwyż”, bowiem an+1 + bn+1 = 5bn − an > an + bn. Łatwo sprawdzić, że ciąg (an) spełnia równanie rekurencyjne an+2 = 4an+1 − an dla każdego n ∈ N. W roz- dziale 9 nauczymy się teoryjki, dzięki której będziemy mogli uzasadnić, że zachodzi następująca równość: an = ( √ 3 − 1)(2 + √ 3)n−1 + (√3 + 1)(2 − √3) n−1 2 √3 . ♦ Ćwiczenie 3.16 Czy w opisany powyżej sposób znajdujemy w s z y s t k i e pary (a, b) ze zbioru A(4)? Ćwiczenie 3.17 Udowodnić, że jeżeli liczby naturalne c, d są takie, że k = c2+d2+1 cd jest liczbą naturalną, to k = 3. Udowodnić, że równanie x2 + y2 + 1 = 3xy ma rozwiązanie w liczbach naturalnych większych niż 20162017. Ćwiczenie 3.18 Udowodnić, że istnieją takie x, y, u, v ∈ N⩾2016, że zachodzi równość x yuv + y uvx + u vxy + v xyu = 1 x + 1 y + 1 u + 1 v . 3.3. Jednoznaczność rozkładu w pierścieniu wielomianów 81 W OM (na poziomie IMO) technika skoków Vi`ete’a pojawiła się w Australii w roku 1988, kiedy to tylko kilku uczestników poradziło sobie z takim zadaniem: ZADANIE 3.13 Dane są takie liczby naturalne a, b, że iloraz a2 + b2 1 + ab jest też liczbą naturalną. Udowodnić, że ten iloraz jest kwadratem liczby naturalnej. R o z w i ą z a n i e. Zorganizujmy rozwiązanie podobnie jak rozwiązanie Z3.12: dla danej liczby naturalnej k oznaczmy przez B(k) zbiór wszystkich takich par (a, b) liczb naturalnych, że a 2 + b2 = k(1 + ab). Teza zadania brzmi więc tak: jeżeli B(k) jest zbiorem niepustym, to k jest kwadratem. Weźmy więc liczbę k ∈ N n i e b ę d ą c ą kwadratem, załóżmy, nie wprost, że B(k) ̸= ∅ i że (a, b) ∈ B(k). Zauważmy najpierw, że wówczas a ̸= b. Rzeczywiście, gdyby a = b, to byłoby k = (a2 + b2)/(1 + ab) = 2a2/(1 + a2) < 2, czyli k = 1, a to j e s t kwadrat. Bez straty ogólności załóżmy więc, że a > b. Równość a2 + b2 = k(1 + ab) interpretujemy następująco: liczba a jest pierwiastkiem trójmianu f (X) = X 2 − kbX + b2 − k ∈ Z[X]. (3.17) Niech ̃a będzie drugim pierwiastkiem tego trójmianu. Z zadania Z3.11 wiemy, że ̃a jest liczbą całkowitą. Sprawdzamy, że ̃a > 0: gdyby ̃a = 0, to 0 = f (̃a) = b2 − k i k = b2 wbrew założeniu; gdyby zaś ̃a < 0, to z równości 0 = f (̃a) = ̃a2 − kb̃a + b2 − k dostalibyśmy równość niemożliwą ̃a2 + b2 = k(1 + ̃ab) (po jej lewej stronie jest liczba dodatnia, a po prawej stronie liczba niedodatnia). Dostajemy teraz rozstrzygającą nierówność: ̃a = b2 − k a < a2 − k a < a. (Równość jest, inaczej zapisaną, równością Vi`ete’a ãa = b2 − k.) Znajdujemy się w ten sposób w sytuacji niemożliwego d e s a n t u n i e s k o ń c z o n e g o: jeżeli (a, b) ∈ B(k), gdzie k ∈ N nie jest kwadratem, to w zbiorze B(k) znajdzie się para (̃a, b) z m n i e j s z ą sumą. ♦ U w a g a 4. W związku z powyższym zadaniem powstaje naturalne pytanie, czy dla danej liczby n ∈ N zbiór B(n 2) jest n i e p u s t y. Łatwo sprawdzić, że B(1) = {(1, 1)}. Ponieważ (2, 8) ∈ B(4), więc, podobnie jak w powyższym P4, można, ”skacząc wzwyż”, wyznaczyć wszystkie elementy zbioru B(4). Po zapoznaniu się z dalszymi fragmentami skryptu Czytelnik będzie w stanie wykazać, że najmniejszym elementem w B(9) jest para (2133, 18 957). Itp. 3.3 Jednoznaczność rozkładu w pierścieniu wielomianów Ten paragraf ma charakter teoretyczny. Chcemy w nim udowodnić twierdzenie o i s t n i e n i u i j e d n o z n a c z n o ś c i rozkładu wielomianu o współczynnikach z danego c i a ł a na iloczyn wielomianów nierozkładalnych (będących analogonami liczb pierwszych). Wykład prowadzimy według wzorca z rozdziału 2. Również oznaczenia wybraliśmy analogiczne. W dalszym ciągu K o z n a c z a u s t a l o n e c i a ł o. Pierścień który badamy, jest pierście- niem K[X] wielomianów jednej zmiennej X o współczynnikach z ciała K. Przede wszystkim musimy wyznaczyć grupę jedności w pierścieniu K[X], a następnie musimy się przekonać, że w tym pierścieniu nie ma dzielników zera: 82 3. Wielomiany Ćwiczenie 3.19 Uzasadnić, że K[X]∗ (zobacz D1.8) składa się ze wszystkich wielomianów stopnia zero. Możemy (i będziemy) więc utożsamiać: K[X]∗ = K∗ = K ∖ {0}. Wskazówka. Wykorzystać C3.6. Ćwiczenie 3.20 Udowodnić, że w pierścieniu K[X] n i e m a dzielników zera. To znaczy, że jeżeli a(X)b(X) = 0, to a(X) = 0 lub b(X) = 0. Wskazówka. Patrz C3.6. 3.3.1 Podzielność w pierścieniu wielomianów Deﬁnicja podzielności w pierścieniu K[X] naśladuje deﬁnicję podzielności w pierścieniu Z. Deﬁnicja 3.6 Mówimy, że wielomian b(X) ∈ K[X] dzieli wielomian a(X) ∈ K[X], gdy istnieje taki wielomian q(X) ∈ K[X], że a(X) = b(X) · q(X). Zapisujemy to tak: b(X)|a(X) lub, po prostu, b|a. Mówimy też w takiej sytuacji, że wielomian b(X) jest dzielnikiem wielomianu a(X) lub, że wielomian a(X) jest wielokrotnością wie- lomianu b(X). Zbiór wszystkich wielokrotności wielomianu b = b(X) oznaczamy symbolem (b) = (b(X)) i nazywamy ideałem głównym generowanym przez b(X). Ćwiczenie 3.21 Udowodnić, że jeżeli b(X) ̸= 0, to b|a wtedy i tylko wtedy, gdy reszta z dzielenia wielomianu a(X) przez wielomian b(X) jest wielomianem zerowym. Ćwiczenie 3.22 Udowodnić, że b(X)|a(X) wtedy i tylko wtedy, gdy (a) ⊆ (b). Ćwiczenie 3.23 Jeżeli b|a, to deg b ⩽ deg a. ZADANIE 3.14 Udowodnić analogony tez (1), (2), (3), (4) twierdzenia T2.1. R o z w i ą z a n i e. Jedynie teza (3) jest nowa i mówi, że jeżeli a|b i b|a, to istnieje taki niezerowy element u ∈ K, że a(X) = ub(X). To wynika z porównania stopni: jeżeli a(X) = u(X)b(X) dla pewnego wielomianu u(X) ∈ K[X], to deg a = deg u + deg b, zobacz C3.6. Ale deg a ⩽ deg b, bo a|b. Stąd deg u = 0, czyli u(X) jest niezerową stałą u ∈ K. ♦ Deﬁnicja 3.7 Jeżeli a(X), b(X) ∈ K[X] i istnieje taki niezerowy element u ∈ K, że a(X) = ub(X), to mówimy, że wielomiany a(X) i b(X) są stowarzyszone i oznaczamy to tak: a(X) ∼ b(X). Ćwiczenie 3.24 Dane są niezerowe wielomiany a(Y ), b(Y ) ∈ K[Y ]. Dowieść, że a(Y ) ∼ b(Y ) wtedy i tylko wtedy, gdy a(Y )|b(Y ) i b(Y )|a(Y ). Ćwiczenie 3.25 Wykazać, że równość (a(X)) = (b(X)) zachodzi wtedy i tylko wtedy, gdy a(X) ∼ b(X). 3.3. Jednoznaczność rozkładu w pierścieniu wielomianów 83 3.3.2 Ideał. Największy wspólny dzielnik W zbiorze (pierścieniu) liczb całkowitych Z duże usługi oddało nam pojęcie ideału, a zwłaszcza fakt, że każdy ideał w Z jest ideałem głównym. Okazuje się, że podobny fakt ma miejsce w pierścieniu K[X] wielomianów jednej zmiennej o współczynnikach z ciała K. Deﬁnicja 3.8 Podzbiór I ⊆ K[X] nazywamy ideałem, gdy zawiera wielomian zerowy 0 oraz spełnia następujące warunki: (1) jeżeli a(X) ∈ I i b(X) ∈ I, to a(X) + b(X) ∈ I, (2) jeżeli k(X) ∈ Z[X] i a(X) ∈ I, to k(X)a(X) ∈ I. Ćwiczenie 3.26 Udowodnić, że iloczyn teoriomnogościowy (czyli część wspólna) dowolnej rodziny ideałów pierścienia K[X] jest ideałem. Ćwiczenie 3.27 Udowodnić, że jeżeli a(X), b(X) są wielomianami w K[X], to zbiór (a, b) := {a(X)s(X) + b(X)t(X) : s(X), t(X) ∈ K[X]} (3.18) jest ideałem w K[X]. Jest to ideał generowany przez wielomiany a(X), b(X). Arcyważnym twierdzeniem jest analogon twierdzenia T2.3. TWIERDZENIE 3.10 Każdy ideał w pierścieniu K[X] jest ideałem głównym. D O W Ó D. Dowód tego twierdzenia przebiega według takiego samego schematu jak dowód twierdzenia T2.3. Jeżeli ideał I ⊆ K[X] zawiera tylko jeden element, to I = (0). Jeżeli zawiera elementy niezerowe, to niech d(X) będzie niezerowym wielomianem n a j n i ż s z e g o s t o p n i a należącym do I. Wówczas dowolny wielomian a(X) należący do I jest wielokrotnością d(X). Rzeczywiście, dzieląc z resztą, mamy a(X) = q(X)d(X) + r(X), gdzie deg r(X) < deg d(X). Stąd, ponieważ r(X) = a(X) − q(X)d(X) ∈ I, mamy r(X) = 0. Czyli d|a. Widzimy więc, że I ⊆ (d). Ponieważ zawieranie przeciwne jest oczywiste, więc mamy ostatecznie I = (d). To kończy dowód. □ Mówimy, że pierścień K[X] jest dziedziną ideałów głównych. Podamy teraz deﬁnicję największego wspólnego dzielnika dwóch wielomianów. Czytelnik zechce porównać tę deﬁnicję z deﬁnicją D2.4. Deﬁnicja 3.9 Niech dane będą dwa, nie równe oba zero, wielomiany a(X), b(X) ∈ K[X]. Wielomian d(X) ∈ K[X] nazywa się największym wspólnym dzielnikiem wielomianów a(X) i b(X), gdy (1) d(X)|a(X) i d(X)|b(X) (d(X) jest wspólnym dzielnikiem), (2) jeżeli e(X)|a(X) i e(X)|b(X), to e(X)|d(X), (d(X) jest podzielny przez każdy wspólny dzielnik). 84 3. Wielomiany Nie wiemy jeszcze, czy taki wielomian d(X) istnieje! Jeżeli tak jest, to oznaczamy go symbolem NWD (a(X), b(X)) lub NWD (a, b). Istnienie największego wspólnego dzielnika dwóch wielomianów w y n i k a z faktu, że każdy ideał jest ideałem głównym: TWIERDZENIE 3.11 (Gauss) Jeżeli wielomiany a(X), b(X) nie są oba równe zero, to i s t n i e j e największy wspólny dzielnik tych wielomianów. Jest on wyznaczony jednoznacznie z dokładnością do mnożenia przez element niezerowy, czyli z dokładnością do relacji stowarzy- szenia. Ponadto istnieją takie wielomiany s(X), t(X) ∈ K[X], że NWD (a(X), b(X)) = a(X)s(X) + b(X)t(X). D O W Ó D. Rozważmy ideał (a, b), zob. (3.18). Wiemy, że jest on główny. Niech więc: (d(X)) = (a(X), b(X)) = {a(X)s(X) + b(X)t(X) : s(X), t(X) ∈ K[X]}. Twierdzimy, że d(X) = NWD (a(X), b(X)). Dowód przebiega tak samo (mutatis mutandis) jak dowód T2.4. □ Ćwiczenie 3.28 Udowodnić, że jeżeli dla wielomianów a, b, przy czym b ̸= 0, i wielomia- nów q, r zachodzi równość a(X) = q(X)b(X) + r(X), to NWD (a, b) = NWD (b, r). Ćwiczenie 3.29 Sformułować i udowodnić poprawność algorytmu Euklidesa w pier- ścieniu K[X] wielomianów jednej zmiennej o współczynnikach w c i e l e. Ćwiczenie 3.30 Dla jakiej wartości k ∈ Q wielomiany X 4 + kX 2 + 1 i X 3 + kX + 1 mają wspólny pierwiastek? Wskazówka. Wykorzystać algorytm Euklidesa. 3.3.3 Zasadnicze twierdzenie arytmetyki wielomianów Dokładnie tak samo (mutatis mutandis) jak w pierścieniu liczb całkowitych dochodzimy do zasadniczego twierdzenia arytmetyki w pierścieniu wielomianów o współczynnikach w ciele. Deﬁnicja 3.10 Wielomiany a(X), b(X) ∈ K[X] takie, że NWD (a(X), b(X)) ∼ 1 nazy- wamy wielomianami względnie pierwszymi. Ćwiczenie 3.31 Udowodnić, że wielomiany a(X), b(X) są względnie pierwsze wtedy i tylko wtedy, gdy istnieją takie wielomiany s(X), t(X), że a(X)s(X) + b(X)t(X) = 1. Sformułujemy teraz analogon zasadniczego twierdzenia arytmetyki: TWIERDZENIE 3.12 (Zasadnicze Twierdzenie Arytmetyki w K[X]) Dla dowol- nych wielomianów a(X), b(X) i c(X) z pierścienia K[X] zachodzi jeżeli a(X)|b(X)c(X) i NWD (a(X), b(X)) ∼ 1, to a(X)|c(X) . D O W Ó D. Dowód różni się tylko tym czym musi od dowodu twierdzenia T2.7. □ Ćwiczenie 3.32 Sformułować i rozwiązać analogony następujących zadań: C2.12, Z2.3, C2.13, C2.14, C2.15, C2.18 i C2.19. 3.3. Jednoznaczność rozkładu w pierścieniu wielomianów 85 3.3.4 Wielomiany nierozkładalne Analogonami liczb pierwszych w pierścieniach wielomianów są wielomiany nierozkładalne. W szkole uczymy się, że liczba pierwsza to taka, która ma mało dzielników. Równoważnie, taka, której się w żaden i s t o t n y sposób nie da rozłożyć na iloczyn dwóch czynników: zawsze któryś z nich okaże się być równym ±1. Deﬁnicja wielomianu nierozkładalnego jest (prawie) automatycznym przetłumaczeniem, na przypadek pierścienia K[X], szkolnej deﬁnicji liczby pierwszej w N: Deﬁnicja 3.11 Wielomian p(X) ∈ K[X] nazywa się wielomianem nierozkładalnym, gdy deg p(X) ⩾ 1 i ma następującą własność: jeżeli p(X) = a(X)b(X) dla pewnych wielo- mianów a(X), b(X) ∈ K[X], to deg a = 0 lub deg b = 0. Ćwiczenie 3.33 Każdy wielomian stopnia pierwszego jest nierozkładalny. Udowodnić, że wielomian aX 2 + bX + c ∈ K[X] stopnia drugiego jest nierozkładalny wtedy i tylko wtedy, gdy wyróżnik ∆ = b2 − 4ac n i e j e s t k w a d r a t e m żadnego elementu z ciała K. Ćwiczenie 3.34 Udowodnić, że wielomian trzeciego stopnia jest nierozkładalny w K[X] wtedy i tylko wtedy, gdy n i e m a pierwiastków w K. Ćwiczenie 3.35 Jeżeli p(X) jest wielomianem nierozkładalnym, to dla danego wielomianu a(X) ∈ K[X], albo p(X)|a(X), albo NWD (p, a) ∼ 1. Udowodnimy teraz bardzo ważną charakteryzację wielomianów nierozkładalnych. Jest ona analogiczna do charakteryzacji liczb pierwszych podanej w T2.15. TWIERDZENIE 3.13 Wielomian p(X) jest wielomianem nierozkładalnym wtedy i tylko wtedy, gdy dla dowolnych wielomianów a(X), b(X) ∈ K[X] zachodzi implikacja: p(X)|a(X)b(X) =⇒ p(X)|a(X) lub p(X)|b(X). (3.19) D O W Ó D. (=⇒) Niech p(X) będzie wielomianem nierozkładalnym, niech p(X)|a(X)b(X) i niech p(X) ∤ a(X). Wówczas, na mocy C3.35, NWD (a, p) ∼ 1, więc, na mocy ZTA w pier- ścieniu K[X], zobacz T3.12, p(X)|b(X). (⇐=) Jeżeli p(X) nie jest nierozkładalny, to istnieją takie wielomiany a(X), b(X), że p(X) = a(X)b(X) i deg a(X), deg b(X) < deg p(X). Wtedy p(X)|a(X)b(X), ale p(X) ∤ a(X) i p(X) ∤ b(X), bo wielomiany a i b mają za małe stopnie. Zatem p(X) nie spełnia (3.19). □ Ćwiczenie 3.36 Uzasadnić przez indukcję, że jeżeli wielomian nierozkładalny jest dzielni- kiem iloczynu n wielomianów, to jest dzielnikiem co najmniej jednego czynnika tego iloczynu. 3.3.5 Jednoznaczność rozkładu Zrealizujemy teraz ważny cel tego rozdziału: udowodnimy, że w pierścieniu wielomianów jednej zmiennej o współczynnikach z ciała zachodzi twierdzenie o jednoznaczności rozkładu na iloczyn wielomianów nierozkładalnych. 86 3. Wielomiany TWIERDZENIE 3.14 (O jednoznaczności rozkładu w K[X]) Dowolny wielomian f (X) ∈ K[X] stopnia > 0 daje się zapisać w postaci iloczynu wielomianów nierozkładalnych: f (X) = p1(X)p2(X) · . . . · ps(X). Przedstawienie takie jest jednoznaczne w takim sensie: Jeżeli f (X) = q1(X)q2(X) · . . . · qt(X) jest również przedstawieniem wielomianu f (X) w postaci iloczynu wielomianów nierozkładal- nych, to s = t i, po ewentualnym przenumerowaniu, p1(X) ∼ q1(X), p2(X) ∼ q2(X), . . . , ps(X) ∼ qs(X). D O W Ó D. Dowód jest teraz (po zrobionych przygotowaniach) prosty i naśladuje dowód T2.16. Najpierw dowodzimy analogonu T2.14, czyli że każdy wielomian stopnia ⩾ 1 dzieli się przez wielomian nierozkładalny. Gdyby tak nie było, to niech f (X) będzie wielomianem najniższego stopnia, który nie dzieli się przez żaden wielomian nierozkładalny. Wówczas wielo- mian f (X) n i e jest nierozkładalny (bo dzieli się przez siebie), więc istnieją takie wielomiany b(X), c(X) ∈ K[X] stopnia ⩾ 1, że f (X) = b(X)c(X). Ale wówczas b(X) dzieli się przez jakiś wielomian nierozkładalny, nazwijmy go p(X), bo ma stopień < deg f . Zatem i f (X) dzieli się przez p(X). Sprzeczność. Dowód jednoznaczności przeprowadzamy tak samo (mutatis mutandis) jak dowód T2.16, wykorzystując C3.36 zamiast C2.39. □ 3.4 Dalsze twierdzenia o wielomianach W tym paragraﬁe nauczymy się paru nowych rzeczy o wielomianach. Zaczynamy od ważnego przypadku pieścienia Z[X] wielomianów jednej zmiennej o współczynnikach całkowitych. Oka- zuje się, że, mimo że Z n i e jest ciałem i w pierścieniu Z[X] n i e istnieje algorytm dzielenia z resztą, w Z[X] prawdziwy jest analogon twierdzenia T3.14 o jednoznaczności rozkładu. Po- znamy kilka metod badania nierozkładalności wielomianów w pierścieniu Q[X], w szczególności za pomocą kryterium Eisensteina. W pierścieniu C[X] wielomianów jednej zmiennej o współ- czynnikach zespolonych nierozkładalne są jedynie wielomiany stopnia pierwszego. Ta teza jest tylko innym sformułowaniem tak zwanego Zasadniczego Twierdzenia Algebry. Po omówieniu tego twierdzenia przechodzimy do rozkładu tak zwanych wielomianów podziału koła X n − 1 na iloczyn wielomianów cyklotomicznych, do rozwiązywania równań trzeciego stopnia, wzorów Vi`ete’a, wielomianów palindromicznych, wielomianu interpolacyjnego Lagrange’a i rozkładu funkcji wymiernych na ułamki proste. 3.4.1 Zawartość wielomianu Wielomiany o współczynnikach całkowitych można d o d a w a ć i m n o ż y ć (i w wyniku otrzy- muje się wielomiany o współczynnikach całkowitych). To oznacza, że zbiór Z[X] wszystkich takich wielomianów j e s t p i e r ś c i e n i e m. Jasne jest, co oznacza, że jeden taki wielomian d z i e l i drugi taki, patrz deﬁnicja D3.6. Ponieważ w pierścieniu Z liczb całkowitych nie ma dzielników zera, więc równość z ćwiczenia C3.6 jest prawdziwa. Zobaczymy najpierw które elementy w Z[X] są odwracalne (zobacz D1.8): 3.4. Dalsze twierdzenia o wielomianach 87 Ćwiczenie 3.37 Z[X] ∗ = Z ∗ = {−1, +1}. Udowodnić te równości. Jeżeli f (X) = f0 + f1X + . . . + fnX n jest dowolnym wielomianem o współczynnikach całkowitych, C = NWD (f0, f1, . . . , fn) jest największym wspólnym dzielnikiem jego współ- czynników, to możemy zapisać f (X) = C(a0 + a1X + . . . + anX n), (3.20) gdzie fk = C · ak. Wiemy, porównaj C2.12, że wówczas największy wspólny dzielnik współ- czynników wielomianu a0 +a1X + . . . +anX n jest równy 1. Wielomiany mające taką własność nazywamy wielomianami pierwotnymi: Deﬁnicja 3.12 Wielomian a0 + a1X + . . . + anX n ∈ Z[X] nazywa się wielomianem pierwotnym, gdy NWD (a0, a1, . . . , an) = 1. Pierwsze twierdzenie w tym paragraﬁe jest kolejnym lematem Gaussa: LEMAT 3.1 (Lemat Gaussa) Jeżeli f (X), g(X) ∈ Z[X] są dwoma wielomianami pier- wotnymi, to ich iloczyn f (X)g(X) jest wielomianem pierwotnym. D O W Ó D. Niech f (X) = a0 + a1X + . . . + akX k, g(X) = b0 + b1X + . . . + blX l. Wówczas f (X)g(X) = c0 + c1X + . . . + cnX n gdzie ct = t∑ i=0 at−ibi. Załóżmy nie wprost, że NWD (c0, c1, . . . , cn) ̸= 1 i niech p będzie taką liczbą pierwszą, że p|c0, p|c1, . . . , p|cn. Ponieważ NWD (a0, a1, . . . , ak) = NWD (b0, b1, . . . , bl) = 1, więc p nie może dzielić ani wszystkich ai, ani wszystkich bj. Niech p|a0, p|a1, . . . , p|as i p ∤ as+1 oraz p|b0, p|b1, . . . , p|bt i p ∤ bt+1. Rozważmy współczynnik cs+t+2 = a0bs+t+2 + . . . + as+1bt+1 + . . . + as+t+2b0. Ponieważ wszystkie, z wyjątkiem as+1bt+1, iloczyny po prawej stronie są podzielne przez p, więc mamy sprzeczność, bo p|cs+t+2, zobacz Zasadę Podstawową. □ Lemat Gaussa L3.1 dostarcza podstawowego narzędzia w dowodzie twierdzenia Gaussa, które mówi, że rozkład w pierścieniu Q[X] wielomianu o współczynnikach całkowitych jest w istocie tym samym, co rozkład tego wielomianu w pierścieniu Z[X]. Wielomiany o współczynnikach wymiernych mają tak zwaną zawartość: Deﬁnicja 3.13 Jeżeli f (X) = f0 + f1X + . . . + fnX n ∈ Q[X] jest niezerowym wielomia- nem o współczynnikach wymiernych, to zawartością tego wielomianu nazywamy taką liczbę wymierną C = C(f ) > 0, dla której zachodzi równość f (X) = C(f )(a0 + a1X + . . . + anX n) = C(f )a(X), gdzie a(X) = a0 + a1X + . . . + anX n ∈ Z[X] jest wielomianem pierwotnym. 88 3. Wielomiany ZADANIE 3.15 Udowodnić, że niezerowy wielomian o współczynnikach wymiernych m a d o k ł a d n i e j e d n ą zawartość. R o z w i ą z a n i e. Jeżeli f (X) = ∑ akX k ∈ Q[X] i m > 0 jest wspólnym mianownikiem wszystkich liczb wymiernych ak = bk m , a d = NWD (b0, b1, . . . , bn), to f (X) = d m (b′ 0 + b′ 1X + . . . + b′ nX n), gdzie bk = db′ k. Kładąc C(f ) = d m widzimy, że istnieje takie C = C(f ) ∈ Q>0, że f (X) = C(f )a(X), gdzie a(X) ∈ Z[X] jest wielomianem pierwotnym. Załóżmy teraz, że f (X) = C · a(X) = ̃C · ̃a(X), gdzie a(X), ̃a(X) ∈ Z[X] są pierwotne, a C, ̃C ∈ Q>0. Wówczas, oznaczając C ̃C = a b , gdzie NWD (a, b) = 1, mamy ahk = b̃hk dla każdego k ⩽ deg f. Tu, przez hk (odpowiednio ̃hk) oznaczyliśmy współczynnik wielomianu a(X) (odpowiednio ̃a(X)) stojący przy X k. Dzięki ZTA mamy a|̃hk, b|hk dla każdego k. Z pierwotności wielo- mianów a, ̃a mamy więc a = ±1, b = ±1, co kończy dowód jednoznaczności. ♦ ZADANIE 3.16 Udowodnić, że dla dowolnych dwóch niezerowych wielomianów f (X), g(X) ∈ Q[X] zachodzi równość C(f g) = C(f ) · C(g). R o z w i ą z a n i e. Teza jest natychmiastowym wnioskiem z Z3.15 i L3.1. ♦ TWIERDZENIE 3.15 (Gauss) Jeżeli f (X) ∈ Z[X] i f (X) = g(X)h(X) jest rozkła- dem na iloczyn wielomianów o współczynnikach w y m i e r n y c h, to istnieją takie wielomiany g(X), h(X) o współczynnikach c a ł k o w i t y c h, że f (X) = g(X)h(X) oraz g(X) ∼ g(X), h(X) ∼ h(X). D O W Ó D. Niech g(X) = C(g)a(X), h(X) = C(h)b(X) będą rozkładami wielomianów g(X), h(X) na iloczyn zawartości i części pierwotnych a, b ∈ Z[X]. Wówczas C(g) · C(h) = C(gh) = C(f ) ∈ Z. Wystarczy położyć G(X) = C(f )a(X), H(X) = b(X). □ Widzimy, że nierozkładalność wielomianu o współczynnikach całkowitych w pierścieniu Z[X] pociąga za sobą jego nierozkładalność w pierścieniu Q[X]. Wnioskiem z T3.14 i po- wyższego jest: TWIERDZENIE 3.16 (Twierdzenie o jednoznaczności rozkładu w Z[X]) Każdy wielomian f (X) ∈ Z[X] stopnia większego niż zero da się zapisać w postaci iloczynu wielo- mianów nierozkładalnych w Z[X]: f (X) = p1(X)p2(X) · . . . · ps(X). Ponadto przedstawienie takie jest jednoznaczne w następującym sensie: Jeżeli f (X) = q1(X)q2(X) · . . . · qt(X) jest również przedstawieniem wielomianu f (X) w postaci iloczynu wielomianów nierozkładal- nych, to s = t i, po ewentualnym przenumerowaniu, p1(X) ∼ q1(X), p2(X) ∼ q2(X), . . . , ps(X) ∼ qs(X). □ 3.4. Dalsze twierdzenia o wielomianach 89 3.4.2 Wielomiany nierozkładalne w Q[X] Wiemy, że wielomiany nierozkładalne w pierścieniu wielomianów o współczynnikach w danym ciele grają rolę elementarnych cegiełek, z których zbudowane są inne wielomiany tego pier- ścienia, zobacz T3.14. Warto więc wiedzieć, k t ó r e wielomiany są nierozkładalne w danym pierścieniu K[X]. Zajmiemy się teraz tym problemem w przypadku K = Q i pokażemy parę przykładów rozumowań pokazujących nierozkładalność wybranych wielomianów o współczyn- nikach wymiernych (równoważnie, jak wiemy z twierdzenia Gaussa, całkowitych). Oto pierwszy przykład: P r z y k ł a d 1. Załóżmy, że wielomian f (X) ∈ Z[X] ma stopień n i spełnia warunki: |f (xj)| ∈ P dla pewnych (różnych) liczb całkowitych x1, x2, . . . , x2n+1. Chcemy udowodnić nierozkładalność f (X). Zakładamy (nie wprost), że f (X) = g(X)h(X) jest rozkładem w Z[X] na iloczyn dwóch wielomianów stopni mniejszych niż n (korzystamy tu oczywiście z twierdzenia Gaussa T3.15). Oznaczmy k = deg g(X), l = deg h(X). Wówczas mamy 2n + 1 równości |g(xj)| · |h(xj)| = pj, gdzie pj są liczbami pierwszymi (niekoniecznie różnymi). Stąd, dla każdego j, albo g(xj) = ±1, albo h(xj) = ±1. Oznaczmy przez G+ = {j : g(xj) = 1}, G− = {j : g(xj) = −1}, H+ = {j : h(xj) = 1} i H− = {j : h(xj) = −1}. Zbiory te są parami rozłączne(!), a ich sumą jest zbiór {1, 2, . . . , 2n + 1}. Ponadto, na mocy W1T3.4 card (G+) ⩽ k, card (G−) ⩽ k i card (H+) ⩽ l, card (H−) ⩽ l. Stąd mamy sprzeczność: 2n + 1 = k + k + l + l = 2n. ♦ Ćwiczenie 3.38 Niech |f (0)| = |f (1)| = |f (2)| = |f (3)| = |f (4)| = 1 dla wielomianu f (X) ∈ Z[X] stopnia 5. Udowodnić, że wielomian f (X) jest nierozkładalny w Q[X]. ZADANIE 3.17 Liczby a1, a2, . . . , an ∈ Z są parami różne. Udowodnić, że wielomian (X − a1)(X − a2) · . . . · (X − an) − 1 jest nierozkładalny w Q[X]. R o z w i ą z a n i e. Załóżmy nie wprost, że (X − a1)(X − a2) · . . . · (X − an) − 1 = f (X)g(X), (3.21) gdzie f (X), g(X) ∈ Z[X] są unormowane i deg f (X), deg g(X) ⩽ n − 1. (3.22) Obliczamy wartości obu stron równości (3.21) dla argumentów a1, a2, . . . , an. Znajdujemy f (ak)g(ak) = −1 dla każdego 1 ⩽ k ⩽ n. To, wobec całkowitości, może zajść tylko, gdy f (ak) = 1, g(ak) = −1 lub f (ak) = −1, g(ak) = 1. Zatem, wielomian f (X) + g(X), który (na mocy (3.22)) ma stopień ⩽ n − 1, przyjmuje wartość 0 dla n różnych argumentów a1, . . . , an. Więc, zobacz W1T3.4, f (X) + g(X) = 0. Stąd wynika, że równość (3.21) ma postać (X − a1)(X − a2) · . . . · (X − an) − 1 = −f (X) 2. Ale taka równość jest niemożliwa, bo wielomian z lewej strony jest wielomianem unormowanym, a współczynnik przy najwyższej potędze X ze strony prawej jest równy −1. ♦ Jedno ogólne twierdzenie o nierozkładalności wielomianów o współczynnikach całkowitych obowiązuje każdego olimpijczyka: 90 3. Wielomiany TWIERDZENIE 3.17 (Kryterium Eisensteina) Jeśli a0 + a1X + . . . + anX n ∈ Z[X] i istnieje taka liczba pierwsza p, że p|a0, p|a1, . . . , p|an−1, p ∤ an oraz p2 ∤ a0, to wielomian a0 + a1X + . . . + anX n jest nierozkładalny w Q[X]. D O W Ó D. Załóżmy nie wprost, że a0 + a1X + . . . + anX n = (b0 + b1X + . . . + bkX k)(c0 + c1X + . . . + clX l) jest rozkładem naszego wielomianu na iloczyn dwóch czynników stopnia co najmniej pierwszego o współczynnikach całkowitych. Wówczas p|b0c0, więc, nie zmniejszając ogólności rozważań, możemy uznać, że p|b0. Ale wtedy p ∤ c0, bo p2 ∤ a0. Jednocześnie p|b0c1 + b1c0, zatem p|b1c0, więc p|b1. Podobnie, ponieważ p|b0c2 + b1c1 + b2c0, więc p|b2. Postępując tak dalej widzimy, że p|b0, p|b1, . . . , p|bk. To jest niemożliwe, bo bkcl = an, a p ∤ an. Sprzeczność. □ Kryterium Eisensteina rzadko udaje się zastosować bezpośrednio. Jeden przykład takiego bezpośredniego zastosowania pokazujemy w poniższym ćwiczeniu: Ćwiczenie 3.39 Udowodnić, że jeżeli dla liczby całkowitej a i liczby pierwszej p, zachodzi równość vp(a) = 1, gdzie vp(a) oznacza wykładnik p-adyczny liczby a, to wielomian X n + a jest nierozkładalny w Q[X]. Kryterium Eisensteina czasem daje się zastosować po stosownej zamianie zmiennej. Klasy- czny przykład widzimy w poniższym zadaniu: ZADANIE 3.18 Jeżeli p jest liczbą pierwszą, to wielomian (tzw. wielomian cykloto- miczny, zob. 3.4.6) Φp(X) = 1 + X + X 2 + . . . + X p−1 jest nierozkładalny w Q[X]. R o z w i ą z a n i e. Korzystając z rozkładu (zobacz też tożsamość ”nieśmiertelną” (1.8)) X p − 1 = (X − 1)(1 + X + . . . + X p−2 + X p−1) i dokonując podstawienia X − 1 = Y widzimy, że nasz wielomian (względem nowej zmiennej Y ) ma postać (Y + 1)p − 1 Y = Y p−1 + (p 1 ) Y p−2 + . . . + ( p p − 2 ) Y + ( p p − 1 ) , do której bezpośrednio stosuje się kryterium Eisensteina, zobacz C2.50. ♦ Ćwiczenie 3.40 Do wielomianu 14 + 3X − 3X 2 + 2X 3 nie można bezpośrednio zastosować kryterium Eisensteina. Znaleźć taką liczbę całkowitą a, by zamiana zmiennej X = Y + a pozwalała stwierdzić nierozkładalność tego wielomianu. W poniższym przykładzie zobaczymy jeszcze jedną modyﬁkację rozumowania zastosowanego w trakcie dowodu kryterium Eisensteina. Należy ją dobrze przemyśleć, a następnie udowodnić sformułowane w ćwiczeniu C3.41, uogólnione kryterium Eisensteina. P r z y k ł a d 2. Udowodnimy, że wielomian X 11 + 11X 10 + 7 jest nierozkładalny w Q[X]. Załóżmy w tym celu, że mamy rozkład w Z[X] 7 + 11X 10 + X 11 = (b0 + b1X + . . . + X k)(c0 + c1X + . . . + X l) (3.23) 3.4. Dalsze twierdzenia o wielomianach 91 na dwa czynniki unormowane. Bez straty ogólności możemy założyć, że b0 = ±7 i c0 = ±1. Wówczas 0 = b0c1 + b1c0. Stąd, dzięki Zasadzie Podstawowej, 7|b1. Dalej, równość 0 = b0c2 + b1c1 + b2c0, tak samo jak przed chwilą, daje 7|b2. I tak dalej, aż do: 7|b9. (Zauważmy nawiasem, że, zgodnie z umową z paragrafu 3.1, wielomian m a wszystkie współczynniki, choć od pewnego miejsca są one równe zero.) Ponieważ bk = 1, więc k > 9. Czyli k = 10, a l = 1. Zatem, drugi czynnik w równości (3.23) ma postać X ± 1. To by jednakże oznaczało, że badany wielomian ma pierwiastek 1 lub −1. Sprzeczność, bo nie ma! ♦ Ćwiczenie 3.41 Udowodnić uogólnione kryterium Eisensteina: Niech a(X) = a0 + a1X + . . . + an−1X n−1 + X n ∈ Z[X]. Załóżmy, że istnieje liczba pierwsza p i taki indeks k ∈ {0, 1, . . . , n − 1}, że spełnione są warunki: p|as dla 0 ⩽ s ⩽ k, ale p2 ∤ a0. Wówczas, wielomian a(X) m a nierozkładalny dzielnik stopnia co najmniej k + 1. Ćwiczenie 3.42 Dana jest liczba pierwsza p. Uzasadnić, że istnieje wielomian F (X) ∈ Z[X], którego wartość dla dowolnego argumentu całkowitego x ̸= ±1 wynosi xp3 − 1 xp2 − 1 . Udowodnić, że ten wielomian jest nierozkładalny w Q[X]. Uogólnić. W rozwiązaniu kolejnego zadania korzystamy z tak zwanego Małego Twierdzenia Fermat’a, zobacz 5.2.3. Nie będziemy się też wzdragać przed używaniem notacji kongruencyjnej. ZADANIE 3.19 Udowodnić, że jeżeli 5 ∤ a, to wielomian X 5 − X + a ∈ Z[X] jest nierozkładalny w pierścieniu Q[X] wielomianów o współczynnikach wymiernych. R o z w i ą z a n i e. Na mocy twierdzenia Gaussa T3.15, wystarczy udowodnić, że wielomian ha(X) = X 5 − X + a nie da się nietrywialnie rozłożyć na iloczyn w pierścieniu Z[X]. Każdy ewentualny rozkład jest jednej z dwóch postaci: X 5 − X + a = (X − b)(X 4 + cX 3 + dX 2 + eX + f ), (3.24) X 5 − X + a = (X 2 + bX + c)(X 3 + dX 2 + eX + f ). (3.25) Czytelnik powinien przekonać się samodzielnie, dlaczego można (bez straty ogólności) uznać, że oba czynniki w rozkładzie na iloczyn w Z[X] wielomianu unormowanego w Z[X], są wie- lomianami unormowanymi. Pokażemy najpierw, że przypadek (3.24) zajść nie może. Gdyby zachodził, to byłoby ha(b) = 0. Ale b5 − b ≡ 0 (mod 5) (zobacz (5.12)), więc 0 = ha(b) = b5 − b + a ≡ a (mod 5), co jest sprzeczne z założeniem 5 ∤ a. Załóżmy więc, że zachodzi równość (3.25), czyli: X 5 − X + a = X 5 + (b + d)X 4 + (c + bd + e)X 3 + (f + be + cd)X 2 + (ce + bf )X + cf. 92 3. Wielomiany Porównujemy współczynniki: b + d = 0, c + bd + e = 0, f + be + cd = 0, (3.26) ce + bf = −1, cf = a. (3.27) Z równości (3.26) wyrażamy d, e i f za pomocą b i c: d = −b e = b2 − c i f = 2bc − b3. Wobec tego, równości (3.27) dają: 3b2c − c2 = b4 − 1, (3.28) bc(2c − b2) = a. (3.29) Założenie, że a ̸≡ 0 (mod 5) i równość (3.29) dowodzą, że b ̸≡ 0 (mod 5) i c ̸≡ 0 (mod 5). Zatem b i c są odwracalne modulo 5. Przeto, prawa strona równości (3.28) jest podzielna przez 5, patrz MTF, więc c(3b2−c) ≡ 0 (mod 5). Stąd, wobec odwracalności c (mod 5), 3b2 ≡ c (mod 5). Mnożąc przez 2, dostajemy b2 ≡ 2c (mod 5), co, dzięki (3.29) daje a = bc(2c−b2) ≡ 0 (mod 5). Sprzeczność. ♦ 3.4.3 Zasadnicze Twierdzenie Algebry Liczby zespolone już znamy, zobacz paragraf 1.5. Zbiór tych liczb jest ciałem względem doda- wania (1.9) i mnożenia (1.10). Ciało liczb zespolonych jest szczególnie sympatyczne jeśli chodzi o istnienie w n i m pierwiastków równań wielomianowych. Deﬁnicja 3.14 Jeżeli k a ż d y wielomian f (X) ∈ K[X] s t o p n i a d o d a t n i e g o ma w ciele K pierwiastek, to ciało K nazywa się ciałem algebraicznie domkniętym. Ważnym twierdzeniem, po raz pierwszy w historii matematyki udowodnionym (bez luk) przez Gaussa w końcu XVIII wieku (zobacz motto do tego rozdziału), jest: TWIERDZENIE 3.18 (Zasadnicze Twierdzenie Algebry ) Ciało C liczb zespolonych jest algebraicznie domknięte. Równoważnie, jeżeli f (X) = a0 + a1X + . . . + anX n ∈ C[X] jest wielomianem stopnia n, to zachodzi równość f (X) = an (X − α1)(X − α2) · . . . · (X − αn), (3.30) dla pewnych, niekoniecznie różnych, liczb zespolonych αi. D O W Ó D. Równoważność dwóch sformułowań wynika z WT3.2. Istnieje wiele dowodów tego twierdzenia. Opowiemy (bez szczegółów) o jednym z dowodów t o p o l o g i c z n y c h. Przy- pomnijmy, że liczby zespolone utożsamiamy z punktami płaszczyzny. Liczba zespolona oznacza więc to samo co punkt (płaszczyzny). Niech f (X) = a0 + a1X + . . . + X n będzie wielomianem unormowanym stopnia n o współczynnikach zespolonych. Rozważmy okrąg C(r) = {z ∈ C : |z| = r} o środku w punkcie 0 i promieniu r > 0. Jeżeli zmienna liczba zespolona w przebiega okrąg C(r), to jej obraz (wartość wielomianu) f (w) przebiega pewną krzywą W(r). Przyjrzyjmy się bliżej krzywym W(r). W tym celu zapiszmy wartość f (w)/wn w postaci f (w) wn = 1 + an−1 w + . . . + a1 wn−1 + a0 wn = 1 + k(w). 3.4. Dalsze twierdzenia o wielomianach 93 Możemy dzielić przez w, bo |w| = r > 0. Wyznaczona przez tę równość liczba zespolona k(w) jest, przy dostatecznie dużych r, bardzo m a ł a. Konkretnie, jeżeli przez M oznaczymy max(|a0|, |a1|, . . . , |an−1|), to, korzystając z nierówności trójkąta (zobacz C1.23), faktu, że moduł ilorazu równy jest ilorazowi modułów (zobacz C1.25) i tożsamości fundamentalnej (1.8), znajdujemy: |k(w)| = \f \f \f an−1 w + . . . + a1 wn−1 + a0 wn \f \f \f ⩽ \f \f \f an−1 w \f \f \f + . . . + \f \f \f a1 wn−1 \f \f \f + \f \f \f a0 wn \f \f \f ⩽ ⩽ M r + . . . + M rn−1 + M rn = M r · 1 − 1 rn 1 − 1 r < M r − 1. Niech R = 5M + 1. Widzimy, że dla każdego r ⩾ R zachodzi nierówność |k(w)| < 1/5. Jeżeli więc r ⩾ R, to wartość f (w) = wn + k(w)wn jest równa wn z błędem względnym mniejszym niż 0, 2. Czyli, punkt f (w) znajduje się ”w pobliżu” punktu wn, zobacz rys. 3.1. Rys. 3.1 w j C C w A(w) A(w) w n jn Zobaczmy jeszcze gdzie znajduje się punkt wn. Jeżeli w ∈ C(r) ma argument ϕ, to w = r(cos ϕ + i sin ϕ), więc, na mocy wzoru de Moivre’a (1.14), wn = rn(cos nϕ + i sin nϕ). Widzimy stąd, że jeżeli punkt w porusza się ze stałą prędkością kątową po okręgu C(r), to punkt wn porusza po (dużo) większym okręgu C(rn) z n razy większą prędkością kątową. Gdy więc argument ϕ liczby w zmienia się od ϕ = 0 do ϕ = 2π, to punkt wn n-krotnie okrąża 0. To samo więc robi bliski mu punkt f (w). Obserwacja ruchu punktu f (w), gdy punkt w porusza się ze stałą prędkością kątową po okręgu C(r), jest podobna do ptolemejskiej obserwacji ruchu planety. Widzimy jednostajny ruch po okręgu C(rn) opisywany przez składnik wn i skomplikowany układ ”epicykli” opisy- wany przez składnik k(w)wn. Jakby to nie było, jedno jest pewne: jeżeli r ⩾ R, to krzywa W(r) n-krotnie okrąża punkt 0 startując od punktu f (r) i kończąc w tym samym punkcie. Załóżmy teraz, n i e w p r o s t, że wielomian f n i e m a pierwiastków. Wtedy a0 ̸= 0 (gdy a0 = 0, to w = 0 jest pierwiastkiem wielomianu f ). Ponadto, ż a d n a z k r z y w y c h W(r) n i e przechodzi przez punkt 0. Jest więc zawarta w ”płaszczyźnie z dziurką” C ∖ {0}. Jeżeli teraz będziemy stopniowo (w sposób ciągły) zmniejszali promień r, zaczynając od r = R, to krzywa W(r) będzie się stopniowo (w sposób ciągły) deformowała cały czas pozostając w C∖{0}. I w ”końcu”, przy bardzo małym r będzie leżała w pewnym małym kole wokół punktu f (0) = a0. Czytelnik z pewnością widzi w tym p o r a ż a j ą c ą s p r z e c z n o ś ć. Sprzeczność ta kończy dowód. □ 94 3. Wielomiany 3.4.4 Rozkłady w pierścieniu C[X] i R[X] Będziemy teraz rozkładać na czynniki nierozkładalne wielomiany w pierścieniach C[X] i R[X]. Ćwiczenie 3.43 Ciało K jest algebraicznie domknięte wtedy i tylko wtedy, gdy jedynymi wielomianami nierozkładalnymi w pierścieniu K[X] są wielomiany stopnia pierwszego. Ponieważ, dzięki Gaussowi, wiemy na pewno, że ciało C liczb zespolonych jest algebraicznie domknięte, więc widzimy, że j e d y n y m i wielomianami nierozkładalnymi w pierścieniu C[X] są wielomiany stopnia pierwszego. Natomiast w pierścieniu R[X] wielomianów o współczyn- nikach rzeczywistych, poza wielomianami stopnia pierwszego, tylko jeszcze niektóre trójmiany kwadratowe są nierozkładalne (por. C3.33). Przed dowodem stosownego twierdzenia, udowod- nimy lemat: LEMAT 3.2 Jeżeli liczba zespolona w jest pierwiastkiem wielomianu f (X) ∈ R[X], to liczba sprzężona w również jest pierwiastkiem tego wielomianu. D O W Ó D. Niech f (X) = a0 + a1X + . . . + anX n ∈ R[X] (i f (w) = 0). Wówczas 0 = 0 = a0 + a1 · w + . . . + an · wn = a0 + a1 · w + . . . + an · wn = = a0 + a1 · w + . . . + an · wn = f (w). Napisane równości wynikają z faktu, że sprzężenie sumy równe jest sumie sprzężeń, zobacz C1.22(1), sprzężenie iloczynu równe jest iloczynowi sprzężeń, zobacz C1.22(2), i z faktu, że sprzężenie liczby rzeczywistej równe jest tej liczbie. □ Możemy teraz udowodnić zapowiedziane: TWIERDZENIE 3.19 W pierścieniu R[X], nierozkładalnymi są tylko wielomiany stopnia pierwszego i trójmiany kwadratowe aX 2 + bX + c, dla których ∆ < 0. D O W Ó D. Załóżmy, że p(X) ∈ R[X] jest nierozkładalny. Wtedy deg p(X) ⩾ 1, więc, na mocy T3.18, istnieje liczba α ∈ C będąca pierwiastkiem wielomianu p(X). Dzięki twierdzeniu B´ezout’a T3.2, możemy napisać p(X) = (X − α)s(X), (3.31) gdzie s(X) ∈ C[X]. Zachodzi jedna z możliwości: albo α ∈ R, albo α /∈ R. Jeżeli α ∈ R, to, jak wiemy (zobacz 3.2.1 U1), wielomian s(X) ma współczynniki rzeczywi- ste, a, wobec nierozkładalności wielomianu p(X), wielomian s(X) jest stopnia zero. W takiej więc sytuacji, wielomian p(X) jest wielomianem stopnia 1. Jeżeli zaś α /∈ R, to α ̸= α oraz 0 = p(α) = (α − α)s(α), gdzie pierwsza równość wynika z L3.2, a druga z (3.31). Stąd s(α) = 0, więc, znów na mocy twierdzenia B´ezout’a, s(X) = (X − α)t(X). Zatem p(X) = (X − α)(X − α)t(X) = (X 2 − (α + α)X + αα)t(X). (3.32) 3.4. Dalsze twierdzenia o wielomianach 95 Wielomian X 2 − (α + α)X + αα jest wielomianem o współczynnikach rzeczywistych (zobacz C1.21 i C1.22), zatem i wielomian t(X) jest wielomianem o współczynnikach rzeczywistych. Nierozkładalność wielomianu p(X) i równość (3.32) dowodzą, że t(X) jest wielomianem stop- nia zero, t(X) = c, a p(X) jest trójmianem kwadratowym cX 2 − c(α + α)X + cαα o współ- czynnikach rzeczywistych i wyróżniku ∆ = c2(α + α) 2 − 4c2αα = c2(α − α) 2 = 4c2i2(Im α)2, jak widać, ujemnym (zobacz jeszcze raz C1.21). □ U w a g a. W ustępie 3.4.2 widzieliśmy, że w pierścieniu Q[X] istnieją wielomiany nierozkła- dalne dowolnych stopni ⩾ 1. Na przykład X n + 7 jest nierozkładalny w Q[X] przy dowolnym n ∈ N, zobacz C3.39. Dzięki zdobytej wiedzy na temat wielomianów nierozkładalnych w C[X] i R[X] możemy uszczegółowić twierdzenie T3.14 w tych przypadkach. Sformułujemy to w postaci wniosków: WNIOSEK 1. Jeżeli f (X) ∈ C[X] jest wielomianem stopnia n, to istnieją takie, jedno- znacznie wyznaczone, liczby zespolone λ1, λ2, . . . , λt i takie, jednoznacznie wyznaczone, liczby naturalne e1, e2, . . . , et, że zachodzi równość f (X) = C(X − λ1)e1(X − λ2) e2 · . . . · (X − λt)et, (3.33) gdzie C jest współczynnikiem przy X n w wielomianie f (X), oraz e1 + · · · + et = n. □ Zauważmy bijące w oczy podobieństwo równości (3.33) i 2.4.1 (RK). WNIOSEK 2. Jeżeli f (X) ∈ R[X] jest wielomianem stopnia n, to istnieją takie, jed- noznacznie wyznaczone, liczby rzeczywiste a1, a2, . . . , ar oraz liczby zespolone nierzeczywiste b1 + ic1, b2 + ic2, . . . , bs + ics i takie, jednoznacznie wyznaczone, liczby naturalne e1, e2, . . . , er oraz d1, d2, . . . , ds, że zachodzi równość f (X) = C(X − a1)e1 · . . . · (X − ar) er · ((X − b1) 2 + c2 1)d1 · . . . · ((X − bs)2 + c2 s)ds, (3.34) gdzie C jest współczynnikiem przy X n w f (X), oraz e1 + · · · + er + 2d1 + · · · + 2ds = n. □ Dzięki istnieniu rozkładu (3.34) możemy rozwiązać interesujące: Ćwiczenie 3.44 Udowodnić, że jeżeli wielomian f (X) ∈ R[X] przyjmuje dla każdego argumentu rzeczywistego wartość n i e u j e m n ą, to istnieją wielomiany a(X), b(X) ∈ R[X], dla których zachodzi równość f (X) = a(X) 2 + b(X) 2. Wskazówka. Wykorzystać, prawdziwą w każdym pierścieniu(!), tożsamość (α2 + β2)(γ2 + δ2) = (αγ − βδ) 2 + (αδ + βγ) 2, por. (8.1). 3.4.5 Pierwiastki wielomianu X n − 1 Zobaczymy teraz jak wyglądają pierwiastki wielomianów X n − 1, przy n ∈ N. Sytuacja jest, oczywiście, różna w zależności od wyboru ciała, w którym szukamy tych pierwiastków. Ćwiczenie 3.45 Udowodnić, że wielomian X n − 1 nie ma różnych od ±1 pierwiastków rzeczywistych. Przy czym 1 jest pierwiastkiem każdego z tych wielomianów, n ⩾ 1, a −1 jest dodatkowo pierwiastkiem X n − 1 dla n parzystych (i większych od 0). 96 3. Wielomiany Przejdźmy do liczb zespolonych i przywołajmy ćwiczenie C1.36. Ustalmy n. Niech ω = ωn = cos 2π n + i sin 2π n (3.35) będzie pierwiastkiem n-tego stopnia z jedynki o najmniejszym d o d a t n i m argumencie. Jest oczywiste, że liczby ω, ω2, . . . , ωn−1 i ω0 = 1 są pierwiastkami wielomianu X n − 1. Liczby te są są parami różne (tworzą wierzchołki n-kąta foremnego wpisanego w okrąg jednostkowy, zobacz przypadek n = 9 na rysunku 1.5b), więc równość (3.33) ma tu postać: X n − 1 = (X − 1)(X − ω)(X − ω2) · . . . · (X − ωn−1). (3.36) Rozkład (3.36) wielomianu X n−1 na czynniki liniowe (to znaczy stopnia 1) w pierścieniu C[X] pozwala łatwo napisać rozkład tego wielomianu na czynniki kwadratowe (to znaczy stopnia 2) w pierścieniu R[X]. Zauważmy w tym celu, że dla każdego k zachodzi równość ωn−k = ωk. (3.37) Grupując i wymnażając w iloczynie (3.36) czynniki X − ωk i X − ωn−k, dostaniemy (X − ωk)(X − ωn−k) = (X − ωk)(X − ωk) = X 2 − 2Re (ωk)X + 1, bo, patrz (1.12), ωk · ωk = 1. Ale Re (ωk) = cos 2kπ n , więc, w zależności od parzystości wykładnika n, dostajemy rozkłady wielomianu X n − 1 na czynniki w pierścieniu R[X]: X 2m+1 − 1 = (X − 1) · m∏ k=1 (X 2 − ( 2 cos 2kπ 2m+1 ) X + 1) , (3.38) X 2m − 1 = (X − 1)(X + 1) m−1∏ k=1 ( X 2 − ( 2 cos 2kπ 2m ) X + 1) . (3.39) Ćwiczenie 3.46 Udowodnić, że dla dowolnych liczb (zespolonych, rzeczywistych, wymier- nych, całkowitych) a, b i dowolnego wykładnika n ⩾ 1 zachodzą równości an − bn = (a − b) · (a − ωb) · . . . · (a − ωn−1b), (3.40) an + bn = (a − ηb) · (a − η3b) · . . . · (a − η2n−1b), (3.41) gdzie ω = ωn, η = ω2n, patrz (3.35). TWIERDZENIE 3.20 (Twierdzenie o strażakach) Niech n ⩾ 2. Suma wszystkich pierwiastków n-tego stopnia z jedynki jest równa zero. D O W Ó D. Po rozwiązaniu ćwiczenia C1.36, rzecz jest jasna: 1 + ω + ω2 + . . . + ωn−1 = 1 − ωn 1 − ω = 1 − 1 1 − ω = 0, zobacz tożsamość nieśmiertelną (1.8). □ 3.4. Dalsze twierdzenia o wielomianach 97 U w a g a. Zauważmy, że, wobec równości (3.36), twierdzenie o strażakach jest równoważne z faktem, że (n − 1)-szy współczynnik wielomianu X n − 1 jest równy 0. Podobnie widzimy, że zerowy współczynnik jest równy (−1) n · 1 · ω · ω2 · . . . · ωn−1 = −1, skąd: 1 · ω · ω2 · . . . · ωn−1 = (−1)n−1. (3.42) Zobacz też wzory Vi`ete’a w ustępie 3.4.8. ZADANIE 3.20 Wyznaczyć wszystkie takie układy (a, b, c) liczb naturalnych, że wielo- mian f (X) := X a + X b + X c dzieli się w pierścieniu Q[X] przez wielomian X 2 + X + 1. R o z w i ą z a n i e. Załóżmy, że liczby a, b, c dają r ó ż n e reszty z dzielenia przez 3. Niech na przykład a = 3k + 2, b = 3l + 1, c = 3m. Wówczas f (X) = X 2[(X 3) k − 1] + X[(X 3) l − 1] + [(X 3) m − 1] + X 2 + X + 1. Stąd, stosując tożsamość nieśmiertelną (1.8) do każdego z wyrażeń w nawiasach kwadratowych, widzimy, że f (X) = (X 3 − 1)q(X) + X 2 + X + 1. Ale, znów dzięki (1.8), wiemy, że wielomian X 3 − 1 dzieli się przez X 2 + X + 1. Zatem X 2 + X + 1|X a + X b + X c w tym przypadku. Odwrotnie, załóżmy, że zachodzi równość X a + X b + X c = q(X) · (X 2 + X + 1). (3.43) Zauważmy, że zarówno ω = ω3 jak i ω2 = ω2 3 s ą pierwiastkami wielomianu X 2 + X + 1. Wobec tego, jeżeli zachodzi równość (3.43), to zachodzą równości f (ω) = f (ω2) = 0. Ale f (ω) = ωa + ωb + ωc = ωr1 + ωr2 + ωr3, gdzie r1, r2, r3 oznaczają reszty z dzielenia a, b, c przez 3. Łatwo sprawdzić, że ta suma jest równa 0 wtedy i tylko wtedy, gdy te reszty są różne. Wtedy też, i tylko wtedy, f (ω2) = 0. Wobec tego X 2 + X + 1|X a + X b + X c wtedy i tylko wtedy, gdy wykładniki a, b, c dają różne reszty z dzielenia przez 3. ♦ Ćwiczenie 3.47 Wyznaczyć wszystkie takie liczby naturalne n, dla których liczba natu- ralna 1 00 . . . 0| {z } n 1 00 . . . 0| {z } n 1 jest podzielna przez 37. Ćwiczenie 3.48 Załóżmy, że liczby a0, a1, a2, a3, a4 ∈ Z⩾0 dają różne reszty z dzielenia przez 5. Udowodnić, że wielomian Φ5(X) := 1 + X + X 2 + X 3 + X 4 jest w pierścieniu Z[X] dzielnikiem wielomianu X a0 + X a1 + X a2 + X a3 + X a4. 3.4.6 Wielomiany cyklotomiczne Wielomiany 1 + X + X 2 oraz 1 + X + X 2 + X 3 + X 4 są przykładami tak zwanych wielomianów cyklotomicznych. 98 3. Wielomiany Deﬁnicja 3.15 Niech n będzie dowolną liczbą naturalną i niech ω = ωn będzie zadana przez (3.35). Wielomian Φn(X) = ∏ k⊥n(X − ωk), (3.44) gdzie iloczyn rozciąga się na wszystkie takie k, że 1 ⩽ k ⩽ n i NWD (k, n) = 1, nazywa się n-tym wielomianem cyklotomicznym. P r z y k ł a d. Jasne, że Φ1(X) = X − 1. Policzmy jeszcze (korzystając z (3.37): Φ2(X) = X − ω2 = X + 1, Φ3(X) = (X − ω3)(X − ω2 3) = X 2 + X + 1, Φ4(X) = (X − ω4)(X − ω3 4) = (X − i)(X + i) = X 2 + 1, Φ5(X) = (X − ω5)(X − ω2 5)(X − ω3 5)(X − ω4 5) = X 4 + X 3 + X 2 + X + 1, Φ6(X) = (X − ω6)(X − ω5 6) = X 2 − X + 1. ♦ Ćwiczenie 3.49 Udowodnić, że wszystkie wielomiany cyklotomiczne mają współczynniki rzeczywiste. Porównaj też C4.22. Ćwiczenie 3.50 Uzasadnić, że jeżeli p jest liczbą pierwszą, to Φp(X) = X p−1 + X p−2 + . . . + X + 1. (3.45) Ćwiczenie 3.51 Udowodnić, że dla dowolnej liczby naturalnej n zachodzi równość: X n − 1 = ∏ d|n Φd(X). (3.46) W Z3.18 wykazaliśmy, że wielomiany cyklotomiczne Φp(X) (dla p ∈ P) są nierozkładalne w pierścieniu Q[X]. Poniższe twierdzenie jest w a ż n e. Wynika z niego, między innymi, że rozkład (3.46) jest rozkładem na czynniki n i e r o z k ł a d a l n e. Dowód będziemy w stanie podać dopiero w rozdziale 6. TWIERDZENIE 3.21 Niech n ∈ N. Wielomian cyklotomiczny Φn(X) ma współczynniki całkowite i jest nierozkładalny w pierścieniu Q[X]. □ 3.4.7 Rozwiązywanie równań stopnia 3 i 4 Powiemy tu parę słów na temat wyznaczania pierwiastków wielomianów stopnia 3, czyli roz- wiązywania równań postaci u 3 + au2 + bu + c = 0, (3.47) gdzie a, b, c są liczbami (zespolonymi). 3.4. Dalsze twierdzenia o wielomianach 99 Chcąc wyznaczyć pierwiastki równania (3.47), najpierw redukujemy takie równanie do po- staci bez wyrazu kwadratowego. Uzyskuje się to przez podstawienie u = x + k ze stosownie dobranym k. Mamy (x + k) 3 + a(x + k)2 + b(x + k) + c = x3 + (3k + a)x2 + · · · = 0, gdzie kropkami oznaczamy wyrazy niższego stopnia. Widzimy stąd, że przyjmując k = −a/3 dostaniemy równanie bez wyrazu kwadratowego (tzw. postać zredukowaną): x3 + Ax + B = 0, (3.48) gdzie A = − 1 3a2+b, B = 2 27a 3− 1 3ab+c. Rozwiązanie równania (3.48) w przypadku, gdy B = 0, jest oczywiste: jednym pierwiastkiem jest wówczas α1 = 0, pozostałe dwa są pierwiastkami równania x2 + A = 0. Również w przypadku, gdy A = 0 nie mamy żadnych kłopotów ze znalezieniem pierwiastków: jeżeli α1 jest taką liczbą (zespoloną), że α3 1 = −B, to α2 = ωα1 i α3 = ω2α1 są pozostałymi pierwiastkami równania x3 + B = 0. Tu (i dalej w tym ustępie) ω oznacza ω3, zobacz (3.35). W dalszym ciągu zakładamy więc, że A ̸= 0 i B ̸= 0. Niccol`o Fontana Tartaglia był prawdopodobnie pierwszym, który zauważył, że pierwiastki równania (3.48) można wyrazić za pomocą pierwiastków równania trzykwadratowego: z6 + Bz3 − A3 27 = 0 (3.49) zwanego równaniem rozwiązującym. Wyróżnik trójmianu kwadratowego X 2+BX −A3/27, czyli liczbę ∆ = 4 ( B2 4 + A 3 27 ) (3.50) nazywamy wyróżnikiem równania sześciennego (3.48). TWIERDZENIE 3.22 Jeżeli λ ̸= 0 jest pierwiastkiem równania (3.49), to µ = −A/3λ jest również pierwiastkiem równania (3.49). Ponadto liczby α1 := λ + µ, α2 := ωλ + ω2µ, α3 := ω2λ + ωµ (3.51) są pierwiastkami równania (3.48). D O W Ó D. Niech f (X) = X 6 + BX 3 − A 3/27. Załóżmy, że f (λ) = 0. Wtedy, jak łatwo widzieć, f (−A/3λ) = −A 3/(27λ 6)f (λ) = 0. Więc f (µ) = 0. Sprawdzenie, że liczby (3.51) są pierwiastkami równania (3.48), jest prostym rachunkiem. Na przykład: α3 2 + Aα2 + B = (ωλ + ω2µ)3 + A(ωλ + ω2µ) + B = ω3λ 3 + ω6µ3 + 3ωλω2µ(ωλ + ω2µ) + A(ωλ + ω2µ) + B = λ3 + µ3 + (3λµ + A)(ωλ + ω2µ) + B = λ 3 + µ3 + B = λ−3 ( λ6 + Bλ3 − A3 27 ) = λ−3f (λ) = 0. 100 3. Wielomiany Podobnie sprawdzamy, że α3 1 + Aα1 + B = α3 3 + Aα3 + B = 0. □ U w a g a 1. Wyjaśnimy jeszcze jak Tartaglia mógł wpaść na pomysł rozważania równania rozwiązującego. Szukał on mianowicie rozwiązania x równania (3.48) w postaci sumy dwóch nowych n i e w i a d o m y c h u, v. Podstawiając x = u + v otrzymujemy: (u + v) 3 + A(u + v) + B = u3 + v3 + (3uv + A)(u + v) + B = 0. Narzucając dodatkowy warunek 3uv + A = 0 widzimy, że liczby u 3 i v3 spełniają układ równań typu Vi`ete’a, zobacz (3.14):    u3 + v3 = −B, u 3v3 = −A 3 27 . (3.52) To, zgodnie z twierdzeniem T3.9, oznacza, że liczby u 3 i v3 są pierwiastkami równania kwa- dratowego u 2 +Bu−A3/27 = 0 o wyróżniku ∆. Jasne jest wobec tego, że dowolny pierwiastek 3-go stopnia z u czy z v jest pierwiastkiem równania rozwiązującego (3.49). I odwrotnie, 3-cia potęga dowolnego pierwiastka równania (3.49) jest jedną z liczb u 3, v3. Ćwiczenie 3.52 Udowodnić, że pewne dwie z liczb (3.51) są równe wtedy i tylko wtedy, gdy ∆ = 0. Jeżeli ∆ ̸= 0, to równanie rozwiązujące ma sześć pierwiastków, które tworzą wierzchołki dwóch trójkątów: {λ, ωλ, ω2λ} oraz {µ, ωµ, ω2µ}. Nazwijmy je trójkątami Tartaglia’i . Na rysunku 3.2a pokazujemy trójkąty Tartaglia’i w przypadku, gdy współczynniki A, B są rzeczywiste i ∆ < 0. Na rysunku 3.2b pokazujemy przypadek rzeczywistych A, B i dodatniego wyróżnika ∆. Kółkami zaznaczyliśmy pierwiastki odpowiedniego równania (3.48). Rys. 3.2a Rys. 3.2b wl w 2l l l wm m w 2m m w 2l wl wm w 2m Ćwiczenie 3.53 Znaleźć rozwiązania (pierwiastki) równania x3 − 3 2x2 − 3x + 5 4 = 0. Na- rysować odpowiednie trójkąty Tartaglia’i. Ćwiczenie 3.54 Udowodnić tożsamość x3 + y3 + z3 − 3xyz = (x + y + z)(x + ωy + ω2z)(x + ω2y + ωz). Podstawiając tu x = X, y = −λ oraz z = −µ, wywnioskować, że pierwiastkami wielomianu X 3 − 3λµX − λ 3 − µ3 są liczby α1 = λ + µ, α2 = ωλ + ω2µ i α3 = ω2λ + ωµ. 3.4. Dalsze twierdzenia o wielomianach 101 Uwaga o równaniach stopnia 4 Równania (wielomianowe) stopnia 2 (równania kwadratowe) umieli rozwiązywać starożytni Babilończycy. Domyślili się bowiem, że wzory (3.10) z łatwością można wyprowadzić z postaci kanonicznej (PK) z ustępu 3.2.5. Niedługo po tym jak Cardano wyłudził od Tartaglia’i opi- saną powyżej metodę rozwiązywania równań stopnia 3, jego uczeń Ludovico Ferrari pokazał analogiczną metodę postępowania z równaniami stopnia 4. Jej szkic jest następujący: (0) Mamy (do rozwiązania) równanie: u 4 + au3 + bu2 + cu + d = 0. (1) Kładąc u = x − a/4 sprowadzamy je do postaci zredukowanej (bez wyrazu z trzecią potęgą niewiadomej): x4 + Ax2 + Bx + C = 0. Jeżeli okaże się, że B = 0, to rozwiązujemy otrzymane równanie dwukwadratowe. (2) Jeżeli zaś B ̸= 0, to, wprowadzając niewiadomą y (do wyznaczenia!), nasze równanie zapisujemy w postaci: (x2 + y) 2 − [(2y − A)x2 − Bx + (y2 − C)] = 0. (3) Staramy się teraz tak dobrać y, by wyrażenie w nawiasie kwadratowym było kwadratem. Robimy to za pomocą standardowej babilońskiej metody uzupełniania do pełnego kwadratu (zob. wyprowadzenie (PK) w ustępie 3.2.5). To prowadzi do równania sześciennego! (4) Wiemy już teraz co zrobić z otrzymaną różnicą kwadratów. U w a g a 2. Na tej drodze to już k r e s możliwości: za pomocą sztuczek polegających na tworzeniu kombinacji algebraicznych (dodawania, odejmowania, mnożenia i dzielenia) współ- czynników, n i e u d a j e się sprowadzić problemu znajdowania pierwiastków równania wielo- mianowego stopnia wyższego niż 4 do problemu wyciągania pierwiastków. Nie chodzi tu o to, że nie potraﬁmy tego zrobić. Chodzi o to, że tego się zrobić n i e d a. Udowodnili to Ruﬃni (1799) i Abel (1824). Jest to jedno z pierwszych ważnych twierdzeń n e g a t y w n y c h matematyki. Niestety nie możemy tu opowiedzieć o jego dowodzie. 3.4.8 Wzory Vi`ete’a Prawdopodobnie najczęściej stosowanym w zadaniach olimpijskich narzędziem dotyczącym wie- lomianów i ich pierwiastków są tak zwane wzory Vi`ete’a, których przypadek szczególny, dla wielomianów stopnia drugiego, przypomnieliśmy w (3.14). WZORY VI`ETE’a Liczby (zespolone) α1, α2, . . . , αn są wszystkimi (z uwzględnieniem krotności) pierwiastkami wielomianu unormowanego a0 +a1X + . . . +X n ∈ C[X] wtedy i tylko wtedy, gdy dla każdego 1 ⩽ s ⩽ n zachodzi równość: ∑ 1⩽i1<i2< ... <is⩽n αi1αi2 · . . . · αis = (−1)san−s. (3.53) D O W Ó D. Zwrot z uwzględnieniem krotności oznacza, że w ciągu (α1, α2, . . . , αn) wy- stępują wszystkie pierwiastki wielomianu, i każdy z nich tyle razy ile wynosi jego krotność. Zobacz (3.33), gdzie ej oznacza krotność pierwiastka λj. Dowód równości (3.53) polega na wymnożeniu i porównaniu współczynników w równości a0 + a1X + a2X 2 + . . . + X n = (X − α1)(X − α2) · . . . · (X − αn). Należy się przy tym powołać na twierdzenie o jednoznaczności W2T3.4. □ 102 3. Wielomiany W OM istnieje mnóstwo przykładów zastosowania wzorów Vi`ete’a. P r z y k ł a d 1. Rozpatrując przypadki, łatwo sprawdzić, że jeżeli suma p = α + β i iloczyn q = αβ dwóch liczb rzeczywistych są dodatnie, to α i β są dodatnie. Dużo prościej jest rozważyć wielomian f (X) = (X − α)(X − β) i zauważyć, że, ponieważ f (x) = x2 − px + q > 0 dla wszystkich x ⩽ 0, więc jego pierwiastki nie są ⩽ 0. Oto analogiczna sztuczka dla trzech liczb: Jeżeli α, β, γ ∈ R i p := α + β + γ ⩾ 0, q := αβ + βγ + γα ⩾ 0 oraz r := αβγ ⩾ 0, to α ⩾ 0, β ⩾ 0 i γ ⩾ 0. Rzeczywiście, rozważmy wielomian f (X) = (X − α)(X − β)(X − γ) = X 3 − pX 2 + qX − r. Jeżeli x < 0, to x = −y, gdzie y > 0 i wówczas f (x) = f (−y) = −(y3+py2+qy+r) < 0. Widzimy, że żaden pierwiastek wielomianu f (X) n i e jest ujemny, tzn. α, β, γ ⩾ 0. Czytelnik z łatwością uogólni tę sztuczkę na przypadek n liczb rzeczywistych. ♦ P r z y k ł a d 2. Niech α, β, γ będą pierwiastkami wielomianu X 3 − X − 1. Wyznaczmy L = α − 1 α + 1 + β − 1 β + 1 + γ − 1 γ + 1 . Po odjęciu 1 od każdego składnika tej sumy i podzieleniu przez −2, otrzymujemy równość 3−L 2 = 1 α+1 + 1 β+1 + 1 γ+1 = βγ+β+γ+1+αγ+α+γ+1+αβ+α+β+1 αβγ+αβ+βγ+γα+α+β+γ+1 . Korzystając teraz z równości Vi`ete’a α + β + γ = 0, αβ + βγ + γα = −1 i αβγ = 1 dostajemy 3−L 2 = 2. Skąd L = −1. Można też wyznaczyć wielomian, którego pierwiastkami są składniki sumy L: zauważmy w tym celu, że x = α−1 α+1 wtedy i tylko wtedy, gdy α = 1+x 1−x. Stąd, wobec założonej równości α3 = α + 1, mamy ( 1+x 1−x )3 = 2 1−x , czyli (1 + x)3 = 2(1 − x)2. Widzimy więc, że składniki sumy L są pierwiastkami wielomianu X 3 + X 2 + 7X − 1. Znowu (na mocy równości Vi`ete’a) dostajemy nie tylko równość L = −1, ale również równości (α − 1)(β − 1) (α + 1)(β + 1) + (β − 1)(γ − 1) (β + 1)(γ + 1) + (γ − 1)(α − 1) (γ + 1)(α + 1) = 7, (α − 1)(β − 1)(γ − 1) (α + 1)(β + 1)(γ + 1) = 1. ♦ Pokazane sztuczki są przykładami myślenia w duchu nazwanym w ustępie 3.2.7 ﬁlozoﬁą Vi`ete’ a. Oto jej myśl przewodnia: Jeżeli badamy liczby α1, . . . , αn, to dobrze jest zbadać wielomian (X − α1) · . . . · (X − αn), którego te liczby są pierwiastkami. To może być szczególnie użyteczne, gdy w problemie występują funkcje s y m e t r y c z n e zmiennych αi, zob. 6.2. Ćwiczenie 3.55 Uogólnić tezę zadania Z3.11. Tzn., udowodnić, że Jeżeli a, b, c ∈ Q są takie, że liczby a + b + c, ab + bc + ca i abc są liczbami całkowitymi, to a, b, c ∈ Z. Uogólniać dalej. Na przykład, Jeżeli a, b, c, d są liczbami wymiernymi, dla których liczby a + b + c + d, ab + ac + ad + bc + bd + cd, abc + abd + acd + bcd i abcd są całkowite, to a, b, c, d ∈ Z. Itd. ZADANIE 3.21 Udowodnić, że jeżeli a + b + c = 0, to a5 + b5 + c5 5 = a 2 + b2 + c2 2 · a3 + b3 + c3 3 . (3.54) R o z w i ą z a n i e. Rozważmy wielomian f (X) = (X − a)(X − b)(X − c) = X 3 + qX + r, którego liczby a, b, c są pierwiastkami. Współczynnik przy X 2 jest, na mocy założenia, równy 0. Ponieważ f (a) = f (b) = f (c) = 0, więc mamy  | | a3 = −qa − r, b3 = −qb − r, c3 = −qc − r. (3.55) 3.4. Dalsze twierdzenia o wielomianach 103 Dodając stronami, po uwzględnieniu założenia a + b + c = 0, dostajemy a3 + b3 + c3 3 = −r. (3.56) Z drugiej strony, 0 = (a + b + c) 2 = a2 + b2 + c2 + 2(ab + bc + ca) = a2 + b2 + c2 + 2q, więc a2 + b2 + c2 2 = −q. (3.57) Pomnóżmy teraz pierwszą z równości (3.55) przez a2, drugą przez b2, trzecią przez c2 i dodajmy stronami. Dostaniemy: a5 + b5 + c5 = −q(a3 + b3 + c3) − r(a2 + b2 + c2). Wstawiając tu w miejsce −q i −r wartości z równości (3.56) i (3.57), po prostych przekształ- ceniach, otrzymamy (3.54). ♦ ZADANIE 3.22 Rozwiązać układ równań  | | x + y + z = 3, x2 + y2 + z2 = 5, x3 + y3 + z3 = 9. (3.58) R o z w i ą z a n i e. Załóżmy, że trójka (a, b, c) jest rozwiązaniem i, w zgodzie z ﬁlozoﬁą Vi`ete’a, rozważmy wielomian f (X) = (X − a)(X − b)(X − c) = X 3 + σ1X 2 + σ2X + σ3. Oznaczamy tu (i w dalszym ciągu – zobacz też ustęp 6.2.1): σ1 = a + b + c, σ2 = ab + bc + ca, σ3 = abc. (3.59) Wygodnie też będzie specjalnie oznaczyć sumy potęg badanych liczb, na przykład tak: s1 = a + b + c, s2 = a2 + b2 + c2, s3 = a3 + b3 + c3. (3.60) Przy tych oznaczeniach założenie, że (a, b, c) jest rozwiązaniem układu (3.58), zapisujemy tak: s1 = 3, s2 = 5, s3 = 9. Druga część rozwiązania zasadza się na obserwacji, że dla dowolnych a, b, c, istnieją zależności pozwalające wyrazić s1, s2, s3 za pomocą σ1, σ2, σ3 i odwrotnie, zobacz C3.56. Wobec tego równości (3.62) dają: σ1 = 3, σ2 = 2, σ3 = 0. Zatem f (X) = X 3 − 3X 2 + 2X. Pierwiastkami tego wielomianu są liczby 0, 1, 2. Stąd odpowiedź: Układ (3.58) ma s z e ś ć rozwiązań. Są to: trójka (0, 1, 2) i jej permutacje. ♦ Ćwiczenie 3.56 Przy oznaczeniach wprowadzonych w (3.59) i (3.60), zachodzą równości: s1 = σ1, s2 = σ2 1 − 2σ2, s3 = σ3 1 − 3σ1σ2 + 3σ3, (3.61) σ1 = s1, σ2 = 1 2(s2 1 − s2), σ3 = 1 6(s3 1 − 3s1s2 + 2s3). (3.62) Ucząc się o wielomianach symetrycznych, powiemy nieco więcej o równościach takiego typu. 104 3. Wielomiany Ćwiczenie 3.57 Udowodnić, że jeżeli a + b + c = 0, to 2a4 + 2b4 + 2c4 = (a 2 + b2 + c2)2. Ćwiczenie 3.58 Udowodnić, że jeżeli a + b + c = 0, to a7 + b7 + c7 7 = a 2 + b2 + c2 2 · a5 + b5 + c5 5 . Ćwiczenie 3.59 Wyznaczyć wszystkie rzeczywiste rozwiązania równania 4√337 − x + 4√ x = 7. Ćwiczenie 3.60 Udowodnić, że jeżeli u, v, w ̸= 0 i zachodzą równości u + v + w = a oraz 1/u + 1/v + 1/w = 1/a, to co najmniej jedna z liczb u, v, w jest równa a. 3.4.9 Wielomiany palindromiczne Ostatnim rozważanym teraz tematem związanym z pierwiastkami wielomianów jest temat tak zwanych wielomianów palindromicznych. Deﬁnicja 3.16 Wielomian q(X) = a0 + a1X + . . . + anX n nazwiemy wielomianem palindromicznym, gdy a0 ̸= 0 i as = an−s dla każdego s. Poniższe ćwiczenia pokazują, że rozwiązywanie równań wielomianowych q(x) = 0, z wielo- mianem palindromicznym q(X), może być uproszczone. Ćwiczenie 3.61 Wielomian q(X) stopnia n jest wielomianem palindromicznym wtedy i tylko wtedy, gdy zachodzi równość X nq ( 1 X ) = q(X). Ćwiczenie 3.62 Jeżeli α jest pierwiastkiem wielomianu palindromicznego, to α ̸= 0 i α−1 jest również pierwiastkiem. Ćwiczenie 3.63 Jeżeli wielomian q(X) jest wielomianem palindromicznym nieparzystego stopnia, to −1 jest jego pierwiastkiem i w rozkładzie q(X) = (X + 1) · r(X) wielomian r(X) jest wielomianem palindromicznym stopnia parzystego. Ćwiczenie 3.64 Jeżeli q(X) jest wielomianem palindromicznym stopnia parzystego 2m, to można go zapisać w postaci q(X) = X m · s(Z), gdzie s(Z) jest wielomianem stopnia m zmiennej Z = X + X −1. P r z y k ł a d. Chcemy rozwiązać równanie q(x) = 0 przy q(X) = 2 + 3X + 4X 2 + 4X 3 + 3X 4 + 2X 5. Wiemy z C3.63, że (X + 1)|q(X). To daje rozwiązanie α1 = −1. Dzieląc otrzymamy: q(X) = (X + 1)(2X 4 + X 3 + 3X 2 + X + 2) = (X + 1) · r(X). 3.4. Dalsze twierdzenia o wielomianach 105 Podstawienie z ćwiczenia C3.64 daje r(x) = x2 [ 2 ( x2 + 1 x2 ) + (x + 1 x ) + 3] = x2(2(z2 − 2) + z + 3) = x2(2z2 + z − 1). Rozwiązując równanie kwadratowe 2z2 + z − 1 otrzymujemy dwa rozwiązania: z1 = −1 i z2 = 1/2. Wracając do niewiadomej x, otrzymujemy dwa równania kwadratowe: x + 1 x = −1, oraz x + 1 x = 1/2, a te już potraﬁmy rozwiązać. ♦ U w a g a. O tym, że d a się wyrazić X n + X −n jako wielomian zmiennej Z = X + X −1, i jak to zrobić dla dużych n, powiemy w ustępie poświęconym wielomianom Czebyszewa. 3.4.10 Wielomian interpolacyjny Lagrange’a Udowodnimy teraz proste (i przydatne) twierdzenie interpolacyjne Lagrange’ a. TWIERDZENIE 3.23 Niech α0, α1, . . . , αn będą (parami) różnymi elementami ciała K, a β0, β1, . . . , βn, dowolnymi elementami tego ciała. Wówczas istnieje dokładnie jeden taki wielomian f (X) ∈ K[X], że deg f (X) ⩽ n oraz f (αj) = βj dla każdego j = 0, 1, . . . , n. D O W Ó D. Dla każdego 0 ⩽ k ⩽ n zdeﬁniujmy wielomian stopnia n gk(X) = n∏ j=0, j̸=k(αk − αj)−1(X − αj). (3.63) Jasne, że gk(αl) = 0 dla k ̸= l, oraz gk(αk) = 1. Widzimy stąd natychmiast, że wielomian f (X) = ∑n k=0 βkgk(X) spełnia żądane warunki. Jeżeli h(X) również spełnia te warunki, to wielonian f (X) − h(X) ma stopień mniejszy bądź równy n i n + 1 różnych pierwiastków α0, α1, . . . , αn, jest więc wielomianem zerowym, zobacz W2T3.4. □ Ćwiczenie 3.65 Niech f (X) ∈ R[X] będzie takim wielomianem stopnia n, że dla k = 0, 1, . . . , n zachodzi równość f (k) = k/(k + 1). Wyznaczyć f (n + 1). Ćwiczenie 3.66 Udowodnić następujące równości: n∑ k=0 (−1)kkm(n k ) = { 0, gdy 0 ⩽ m < n, (−1) nn!, gdy m = n. Wskazówka. Zbadać wielomian interpolacyjny Lagrange’a, który dla argumentów αk = k, k = 0, 1, . . . , n, przyjmuje wartości km. 106 3. Wielomiany 3.4.11 Funkcje wymierne. Ułamki proste Ten ustęp poświęcimy na rozkładanie funkcji wymiernych na ułamki proste. Deﬁnicja 3.17 Niech K będzie ciałem. Napis a(X) b(X) , gdzie a(X), b(X) ∈ K[X], przy czym b(X) ̸= 0, nazywamy funkcją wymierną zmiennej X nad ciałem K. Uważamy, że funkcja wymierna a(X) b(X) jest równa funkcji wymiernej c(X) d(X) , co zapisujemy a(X) b(X) = c(X) d(X) , gdy zachodzi równość wielomianów a(X)d(X) = b(X)c(X). Zbiór wszystkich funkcji wymiernych zmiennej X nad ciałem K oznaczamy symbolem K(X). Wielomian a(X) ∈ K[X] utożsamiamy z funkcją wymierną a(X) 1 . W szczególności, gdy mianownik b(X) funkcji wymiernej a(X) b(X) jest dzielnikiem licznika a(X) i zachodzi równość a(X) = b(X)cX) w pierścieniu K[X], to funkcja wymierna a(X) b(X) jest r ó w n a wielomianowi c(X) w K(X). P r z y k ł a d 1. Przepiszmy tożsamość (1.8) jako równość w ciele funkcji wymiernych: an − X n a − X = an−1 + an−2X + · · · + aX n−2 + X n−1. ♦ Zbiór K(X) funkcji wymiernych nad K ma się tak do swojego podzbioru K[X] wielomia- nów nad K, jak zbiór liczb wymiernych Q ma się do swojego podzbioru Z liczb całkowitych. Czytelnik zdaje sobie sprawę z pożytków płynących z rozszerzenia zbioru Z liczb całkowitych do zbioru Q liczb wymiernych (ułamków). Podobnie użyteczne jest rozszerzenie K[X] ⊂ K(X). Aby to pełniej zobaczyć nauczymy się wykonywać działania dodawania i mnożenia, a także dzielenia w K(X). Funkcje wymierne dodajemy i mnożymy w sposób naturalny: a(X) b(X) + c(X) d(X) : = a(X)d(X) + b(X)c(X) b(X)d(X) , a(X) b(X) · c(X) d(X) : = a(X)c(X) b(X)d(X) . Ćwiczenie 3.67 Załóżmy, że ϕ1(X), ϕ2(X), ψ(X) ∈ K(X) i ϕ1(X) = ϕ2(X). Udowod- nić, że wówczas ϕ1(X) + ψ(X) = ϕ2(X) + ψ(X), oraz ϕ1(X) · ψ(X) = ϕ2(X) · ψ(X). Ćwiczenie 3.68 Udowodnić, że K(X) z określonymi wyżej działaniami jest ciałem. Matematycy mówią, że Q jest ciałem ułamków pierścienia Z, a K(X) jest ciałem ułam- ków pierścienia K[X]. P r z y k ł a d 2. Rozważmy wielomian f (X) = ∑n k=0 (k + 1)X k ∈ Q[X]. Zapiszemy go jako funkcję wymierną, czyli w postaci ułamka a(X) b(X) . W tym celu liczymy iloczyn (1 − X)f (X): f (X) − Xf (X) = n∑ k=0 (k + 1)X k − n∑ k=0 (k + 1)X k+1 = 1 + X + X 2 + · · · + X n − (n + 1)X n+1. Pierwszy składnik sumy zapisujemy (tak jak w P1) w postaci (1−X n+1)/(1−X). Po wykonaniu działań i podzieleniu przez 1 − X (to znaczy, po pomnożeniu w Q(X) przez 1 1−X ), dostajemy n∑ k=0 (k + 1)X k = 1 − (n + 2)X n+1 + (n + 1)X n+2 (1 − X)2 . ♦ 3.4. Dalsze twierdzenia o wielomianach 107 Deﬁnicja 3.18 Funkcję wymierną postaci a(X) p(X)n , gdzie wielomian p(X) jest nierozkładalny (w K[X]), oraz deg a(X) < deg p(X), nazywamy funkcją wymierną prostą lub ułamkiem prostym. Chcemy zapisywać funkcje wymierne w postaci sum ułamków prostych: LEMAT 3.3 Jeżeli mianownik funkcji wymiernej ϕ(X) = a(X) u(X)v(X) jest iloczynem dwóch wielomianów względnie pierwszych, to ϕ(X) jest sumą postaci a1(X) u(X) + a2(X) v(X) . D O W Ó D. Założenie względnej pierwszości wielomianów u(X), v(X) pozwala napisać równość Gaussa u(X)k(X) + v(X)l(X) = 1 dla pewnych wielomianów k(X), l(X), zobacz T3.11. Mnożąc tę równość przez a(X) dostajemy a(X) u(X)v(X) = u(X)k(X)a(X) + v(X)l(X)a(X) u(X)v(X) = k(X)a(X) v(X) + l(X)a(X) u(X) . Wystarczy więc położyć a1(X) = l(X)a(X) i a2(X) = k(X)a(X). □ TWIERDZENIE 3.24 Każdą funkcję wymierną ϕ(X) ∈ K(X) można przedstawić w po- staci sumy wielomianu i pewnej liczby funkcji wymiernych prostych. D O W Ó D. Jasnym być powinno jak za pomocą prostej indukcji uogólnić tezę lematu na przypadek, gdy w mianowniku funkcji wymiernej ϕ(X) stoi iloczyn dowolnej liczby parami względnie pierwszych czynników. Przedstawmy więc mianownik b(X) danej funkcji wymiernej a(X) b(X) w postaci b(X) = Cp1(X) e1p2(X) e2 · . . . · ps(X) es, gdzie pj(X) są parami niestowarzyszonymi wielomianami nierozkładalnymi, a C ∈ K. [Taki rozkład uzyskuje się z rozkładu opowiedzianego w T3.14 przez zgrupowanie w jedną potęgę czynników stowarzyszonych. To samo zrobiliśmy w 2.4.1 (RK) w przypadku pierścienia Z.] ”Wrzucając” czynnik C do licznika widzimy funkcję wymierną mającą s parami względnie pierwszych czynników pi(X)ei w mianowniku. Mamy więc rozkład ϕ(X) = a1(X) p1(X)e1 + a2(X) p2(X)e2 + . . . + as(X) ps(X)es . Składniki tej sumy nie muszą być ułamkami prostymi, bo deg ai(X) może być za duży. Gdy tak jest, dzielimy licznik ai(X) przez pi(X) z resztą: ai(X) = qi(X)pi(X) + di(X). Otrzymamy: ai(X) pi(X)ei = qi(X) pi(X)ei−1 + di(X) pi(X)ei . Drugi składnik w tej sumie jest już ułamkiem prostym. Czytelnik z pewnością wie co zrobić z pierwszym składnikiem dla zakończenia dowodu. □ P r z y k ł a d 3. Wiemy, że X 2 + X + 1 = (X − ω)(X − ω), zobacz Z3.20. Stąd 2X + 1 X 2 + X + 1 = 1 X − ω + 1 X − ω . ♦ Ćwiczenie 3.69 Wymyślić co to jest rozkład liczby wymiernej na sumę ułamków prostych i udowodnić możliwość takiego rozkładu. 108 3. Wielomiany 3.4.12 Funkcje wymierne jako funkcje Funkcja wymierna jest n a p i s e m, zobacz D3.17. Podobnie jak wielomian!, zobacz D3.1. I, podobnie jak wielomian, w y z n a c z a pewną funkcję. Deﬁnicja 3.19 Niech K będzie ciałem, a ϕ(X) = a(X) b(X) ∈ K(X). Kładziemy ϕ(λ) = a(λ) b(λ) = a(λ)b(λ) −1 dla wszystkich λ ∈ K, dla których b(λ) ̸= 0. (Zauważyć i udowodnić, że jeżeli ϕ1(X) = ϕ2(X), to ϕ1(λ) = ϕ2(λ) dla wszystkich λ ∈ K, dla których to ma sens!) Tak określony element ϕ(λ) ∈ K nazywamy wartością funkcji wymiernej dla argumentu λ ∈ Dϕ. Przy tym symbolem Dϕ oznaczamy dziedzinę określoności funkcji wymiernej ϕ(X), czyli zbiór Dϕ := K ∖ {λ1, . . . , λs}, gdzie {λ1, . . . , λs} jest zbiorem wszystkich pierwiastków (miejsc zerowych) wielomianu b(X). W ten sposób funkcja wymierna ϕ(X) ∈ K(X) określa funkcję Dϕ ∋ λ 7−→ ϕ(λ) ∈ K określoną na dopełnieniu (w K) zbioru zer mianownika. TWIERDZENIE 3.25 (Twierdzenie o jednoznaczności dla funkcji wymiernych) Jeżeli ϕ(X), ψ(X) ∈ K(X) są takimi funkcjami wymiernymi, że funkcje λ 7−→ ϕ(λ) i λ 7−→ ψ(λ) pokrywają się na zbiorze Dϕ ∩ Dψ, a ten zbiór jest nieskończony, to ϕ(X) = ψ(X) w K(X). D O W Ó D. Niech ϕ(X) = a(X) b(X) i ψ(X) = c(X) d(X) . Jeżeli a(λ)b(λ) −1 = c(λ)d(λ)−1 dla λ ∈ Dϕ ∩ Dψ, to a(λ)d(λ) = b(λ)c(λ) dla wszystkich takich λ. Te równości oznaczają, że wielomiany a(X)d(X) i b(X)c(X) przyjmują te same wartości na dużym (mającym nieskoń- czenie wiele, w szczególności, więcej niż maksimum stopni tych wielomianów) zbiorze Dϕ ∩ Dψ. Powołując się na twierdzenie o jednoznaczności dla wielomianów, zob. W2T3.4, otrzymujemy równość a(X)d(X) = b(X)c(X) w pierścieniu K[X]. Czyli, zgodnie z deﬁnicją równości funkcji wymiernych, równość ϕ(X) = ψ(X). □ 3.5 Wielomiany wielu zmiennych Często zmiennych jest więcej niż jedna. Myślimy i mówimy wtedy o wielomianach wielu zmien- nych. Postępowanie z takimi wielomianami jest prawie tak samo proste jak z wielomianami jednej zmiennej. 3.5.1 Deﬁnicje Czytelnik z pewnością domyśla się, co to jest wielomian wielu zmiennych. Na przykład A(X, Y ) = a0(X) + a1(X)Y + a2(X)Y 2 + · · · + an(X)Y n, gdzie ai(X) są wielomianami zmiennej X o współczynnikach z ciała K, jest wielomianem dwóch zmiennych. 3.5. Wielomiany wielu zmiennych 109 Zbiór wielomianów dwóch zmiennych o współczynnikach w ciele K oznaczamy symbolem K[X, Y ]. Pierścień K[X, Y ] może być uważany za pierścień wielomianów jednej zmiennej Y o współczynnikach z pierścienia K[X]: K[X, Y ] = K[X][Y ]. Ponieważ w pierścieniu współczynników K[X] istnieje, jak wiemy z 3.3.2, NWD dowolnego skończonego układu elementów, więc możemy wprowadzić pojęcie zawartości wielomianu dwóch zmiennych, udowodnić a n a l o g o n y lematu i twierdzenia Gaussa (zobacz L3.1 i T3.15), a następnie twierdzenia o jednoznaczności rozkładu na czynniki nierozkładalne. Byłoby dobrze gdyby Czytelnik zechciał się o tym przekonać. Pojęcie wielomianu n zmiennych jest natychmiastowym uogólnieniem: Deﬁnicja 3.20 Skończoną sumę postaci A(X1, X2, . . . , Xn) = ∑ ak1k2...knX k1 1 X k2 2 . . . X kn n , (3.64) gdzie ak1k2...kn ∈ K, nazywamy wielomianem n zmiennych o współczynnikach z ciała K. Zbiór wielomianów n zmiennych X1, X2, . . . , Xn, oznaczany przez K[X1, X2, . . . , Xn], może być uważny za zbiór wielomianów jednej zmiennej Xn o współczynnikach z pierścienia K[X1, . . . , Xn−1] wielomianów (n − 1) zmiennych: K[X1, X2, . . . , Xn] = K[X1, . . . , Xn−1][Xn]. Wielomiany dodajemy i mnożymy w sposób ”naturalny”. Przy tych działaniach zbiór K[X1, X2, . . . , Xn] jest pierścieniem przemiennym z jedynką. R ó w n i e ż w t y m pierście- niu zachodzi twierdzenie o istnieniu i jednoznaczności rozkładu na czynniki nierozkładalne. Deﬁnicja 3.21 Wielomian postaci aX k1 1 X k2 2 · . . . · X kn n , gdzie a ∈ K, nazywamy jedno- mianem. Jeżeli przy tym jego współczynnik a jest różny od 0, to stopniem tego jednomianu nazywamy liczbę k1 + k2 + . . . + kn. Maksymalny ze stopni (niezerowych!) jednomianów występujących w danym wielomianie A nazywamy stopniem wielomianu A i oznaczamy symbolem deg A. Ćwiczenie 3.70 Udowodnić, że dla dowolnych wielomianów A, B ∈ K[X1, . . . , Xn], (1) deg (A · B) = deg A + deg B, (2) deg (A + B) ⩽ max{deg A, deg B} (gdy deg A ̸= deg B, to zachodzi równość). Jednomiany występujące w sumie (3.64), wygodnie jest porządkować (rosnąco lub malejąco) według stopni. Piszemy więc A(X1, X2, . . . , Xn) = A(0) + A(1) + A(2) + . . . + A(d), (3.65) 110 3. Wielomiany gdzie A(k) oznacza sumę wszystkich (niezerowych) jednomianów stopnia k występujących w (3.64), a d jest stopniem wielomianu A. Taki sposób (”malejąco”) uporządkowania wi- dzimy w (11.45) dla wielomianu dwóch zmiennych stopnia 2 i w (11.50) dla wielomianu dwóch zmiennych stopnia 3. Składnik A(k) nazywa się składnikiem jednorodnym stopnia k wielomianu A. Jasne, że spełnia on warunek jednorodności stopnia k: A(k)(λx1, λx2, . . . , λxn) = λk · A(k)(x1, x2, . . . , xn) dla dowolnych λ, x1, x2, . . . , xn ∈ K. 3.5.2 Tożsamość Sophie Germain Do wielomianów wielu zmiennych powrócimy jeszcze w rozdziale 6. Teraz wykorzystamy nada- rzającą się okazję, by powiedzieć parę słów na temat pewnego wzoru skróconego mnożenia. U w a g a. Olimpijczycy mogą używać terminu wzory skróconego mnożenia, pod warunkiem, że wiedzą, że chodzi o tożsamości algebraiczne. Sprawdzenie, że w pierścieniu Q[X, Y ] zachodzi równość 4X 4 + Y 4 = (2X 2 + 2XY + Y 2)(2X 2 − 2XY + Y 2), (3.66) jest natychmiastowe. Zapisujemy to też w postaci tak zwanej tożsamości Sophie Germain: 4x4 + y4 = (2x2 + 2xy + y2)(2x2 − 2xy + y2). (3.67) Znający wzór na różnicę kwadratów łatwo się domyślają skąd to się wzięło: 4x4 + y4 = 4(x2)2 + 4x2y2 + (y2) 2 − (2xy) 2 = (2x2 + y2) 2 − (2xy) 2. ZADANIE 3.23 Niech An = 2 2n−2 + 1. Dowieść, że An jest złożona dla n ∈ N⩾3. R o z w i ą z a n i e. Dzięki tożsamości (3.67) mamy: An = 1 4 (4 · 1 4 + 22n) = 1 4 (2 + 2 · 2 2n−2 + 22n−1) ( 2 − 2 · 2 2n−2 + 22n−1) = = (1 + 22n−2 + 22n−1−1) ( 1 − 2 2n−2 + 22n−1−1) . Wystarczy teraz sprawdzić, że drugi z tych czynników jest liczbą naturalną ⩾ 2. To jest jasne, bo 2 n−2 < 2 n−1 − 1 dla n ⩾ 3. ♦ Ćwiczenie 3.71 Wyliczyć sumy ∑100 k=1 4k 4k4 + 1 oraz ∑64 k=1 4k2 − 2 4k4 + 1 . Ćwiczenie 3.72 Udowodnić, że dla wszystkich n istnieje nieskończenie wiele liczb natu- ralnych a, dla których liczba n 4 + a jest liczbą złożoną. Ćwiczenie 3.73 Liczba n 4 + 4n jest liczbą pierwszą wtedy i tylko wtedy, gdy n = 1. Ćwiczenie 3.74 Rozłożyć wielomian X 4 + 324 na iloczyn czynników najmniejszych moż- liwych stopni, najpierw w pierścieniu Q[X], potem w R[X], a następnie w C[X]. 3.5. Wielomiany wielu zmiennych 111 3.5.3 Jeszcze dwie faktoryzacje Na zakończenie tego paragrafu powrócimy do tożsamości z ćwiczenia C3.54. Czytelnicy, którym nie udało się dotychczas rozwiązać tego ćwiczenia, powinni spróbować jeszcze raz: Ćwiczenie 3.75 Udowodnić tożsamości: x3 + y3 + z3 − 3xyz = (x + y + z)(x + ωy + ω2z)(x + ω2y + ωz), (3.68) x3 + y3 + z3 − 3xyz = (x + y + z)(x2 + y2 + z2 − xy − yz − zx), (3.69) x3 + y3 + z3 − 3xyz = 1 2 (x + y + z) ((x − y) 2 + (y − z) 2 + (z − x) 2) . (3.70) Wskazówka. Dla dowodu (3.68) zobacz twierdzenie o strażakach T3.20. Pokażemy kilka przykładów zastosowania tych tożsamości. P r z y k ł a d. Niech a, b, c ∈ R, a ̸= b. Załóżmy, że zachodzi równość c3 = a3 + b3 + 3abc. Udowodnimy, że c = a + b. Korzystając z tożsamości (3.68), możemy przepisać założenie w postaci 0 = c3 + (−a)3 + (−b) 3 − 3(−a)(−b)c = (c − a − b)(c − ωa − ω2b)(c − ω2a − ωb). Stąd, ponieważ c ̸= ωa + ω2b (bo ωa + ω2b /∈ R) i c ̸= ω2a + ωb (bo również ω2a + ωb /∈ R), więc c = a + b. To, że ωa + ω2b /∈ R sprawdzamy sprzęgając: ωa + ω2b = ω2a + ωb ̸= ωa + ω2b. ♦ TWIERDZENIE 3.26 Jeżeli x + y + z = 0, to x3 + y3 + z3 = 3xyz. □ Ćwiczenie 3.76 Rozwiązać równanie (x2 − x − 2) 3 + (x2 − 5x + 6) 3 = (2x2 − 6x + 4)3. Wskazówka. Podstawmy u = x2 − x − 2, v = x2 − 5x + 6 i w = −2x2 + 6x − 4. Widzimy, że u + v + w = 0. Ćwiczenie 3.77 Liczba 3 3n (3 3n + 1)+33n+1−1 jest złożona dla każdego n ∈ N. Dowieść. ZADANIE 3.24 Oznaczmy F (a, b, c) = a3 + b3 + c3 − 3abc. Udowodnić, że zbiór S liczb całkowitych dających się przedstawić w postaci F (a, b, c) przy a, b, c ∈ Z, jest multy- plikatywnym podzbiorem zbioru Z (tzn., że uv ∈ S dla dowolnych u, v ∈ S ). R o z w i ą z a n i e. Wykorzystamy (3.68). Z równości tej widzimy, że liczba u należy do zbioru S wtedy i tylko wtedy, gdy istnieje taki wielomian f (X) = a + bX + cX 2 ∈ Z[X], że u = f (1)f (ω)f (ω2). Niech dodatkowo v = g(1)g(ω)g(ω2) będzie również elementem zbioru S . Wówczas u·v = f (1)f (ω)f (ω2)·g(1)g(ω)g(ω2) = h(1)h(ω)h(ω2), gdzie h(X) = f (X)g(X) jest wielomianem stopnia ⩽ 4 o współczynnikach całkowitych. Dzieląc (z resztą) wielo- mian h(X) przez wielomian X 3 − 1 dostajemy h(X) = q(X)(X 3 − 1) + r(X). Reszta r(X) jest wielomianem stopnia ⩽ 2 o współczynnikach całkowitych(!). Oraz, oczywiście, h(1) = r(1), h(ω) = r(ω) i h(ω2) = r(ω2). Zatem uv = r(1)r(ω)r(ω2), więc uv ∈ S . ♦ Ćwiczenie 3.78 Udowodnić, że równanie x3 + y3 + z3 − 3xyz = 3 nie ma rozwiązań w liczbach całkowitych. Wskazówka. Wykorzystać równość (3.70) Ćwiczenie 3.79 Udowodnić, że zbiór S z zadania Z3.24 jest równy {a ∈ Z : v3(a) ̸= 1}, czyli że składa się ze wszystkich liczb całkowitych postaci 3k ± 1 lub 9k. 112 3. Wielomiany Ćwiczenie 3.80 Udowodnić, że jeżeli dla liczb całkowitych a, b, c zachodzi równość (a − b) 2 + (b − c) 2 + (c − a)2 = abc, to liczba a + b + c + 6 jest dzielnikiem liczby a3 + b3 + c 3. Ćwiczenie 3.81 Udowodnić tożsamość: (x + y + z) 3 − x3 − y3 − z3 = 3(x + y)(y + z)(z + x). (3.71) Wskazówka. Zobaczyć, że wielomian (X + Y + Z) 2 − X 3 − Y 3 − Z 3 ∈ Q[Y, Z] [X] jednej zmiennej X ma w pierścieniu współczynników Q[Y, Z] pierwiastek −Y . Więc dzieli się przez wielomian nierozkładalny X − (−Y ). Itd. Można też po prostu mnożyć. Tożsamość (3.71) można wykorzystać w rozwiązaniu poniższego ćwiczenia: Ćwiczenie 3.82 Udowodnić, że dla dowolnych liczb naturalnych k, l, m liczba (k + l + m)2013 − k2013 − l2013 − m 2013 jest podzielna przez liczbę (k+l+m)3−k3−l3−m 3. Wskazówka. Liczba −a jest pierwiastkiem wielomianu (X + a + b) 2n+1 − X 2n+1 − a2n+1 − b2n+1. 3.6 Zadania dodatkowe Do rozwiązania poniższych zadań wystarczy w zasadzie teoria wyłożona w tym i poprzednim rozdziale. W paru wyjątkowych przypadkach dobrze jest mieć trochę więcej wiedzy z analizy matematycznej (nierówność między średnimi, proste granice). Coraz ważniejsza staje się też umiejętność posługiwania się liczbami z e s p o l o n y m i (wystarcza teoria z rozdziału 1). 3.6.1 Treści zadań Dla wygody poniższy zbiorek zadań podzieliliśmy na podzbiorki. A. Współczynniki wielomianów. ZADANIE 3.A1 Wielomian (1−X +X 2)5 o współczynnikach całkowitych zapisujemy w postaci∑ j⩾0 ajX j. Wyznaczyć: (1) sumę a0 + a1 + . . . + a10; (2) sumę naprzemienną a1 − a2 + · · · + a9. ZADANIE 3.A2 Dane są wielomiany f (X) = (1 + X − X 2)77 i h(X) = (1 − X + X 2)77 o współczynnikach całkowitych. Która z liczb f20 czy h20 jest większa? (Współczynnik stojący przy X j w danym wielomianie a(X) wygodnie jest oznaczać symbolem aj.) ZADANIE 3.A3 Dane są liczby naturalne k1 < k2 < · · · < km. Niech N = 2k1 + 2k2 + · · · + 2km. Wyznaczyć liczbę nieparzystych współczynników wielomianu f (X) = (1 + X)N . ZADANIE 3.A4 Liczby a, b ∈ R są różne. Wyznaczyć współczynnik f17 w wielomianie: (1) f (X) = ∑100 j=0 (a + X)100−j(b + X)j = (a + X)100 + (a + X)99(b + X) + . . . + (b + X)100; (2) f (X) = ∑N k=1 k(1 + X)k = (1 + X) + 2(1 + X)2 + . . . + N (1 + X)N . 3.6. Zadania dodatkowe 113 ZADANIE 3.A5 Udowodnić tożsamość (x + 1)(x 2 + 1)(x22 + 1) · . . . · (x2n−1 + 1) = x2n−1 + . . . + x 2 + x + 1. ZADANIE 3.A6 Wyznaczyć wielomian (tzn., jego współczynniki) dany przez f (X) = (X 2 − X + 1)(X 4 − X 2 + 1)(X 8 − X 4 + 1) · . . . · (X 2n − X 2n−1 + 1). ZADANIE 3.A7 Niech n ∈ N. Obliczyć sumę S(n) = (n 0)2 − (n 1)2 + (n 2)2 − . . . + (−1)n(n n )2. B. Zadania z arytmetyką liczb całkowitych w tle ZADANIE 3.B1 Liczba trzycyfrowa (abc)10 jest liczbą pierwszą. Udowodnić, że liczba b2 − 4ac n i e jest kwadratem (liczby całkowitej). ZADANIE 3.B2 Udowodnić, że jeżeli wielomian f (X) ∈ Z[X] przyjmuje wartość 1 dla czterech argumentów całkowitych, to f (x) ̸= −1 dla każdego x ∈ Z. ZADANIE 3.B3 Uzasadnić, że jeżeli f (X) ∈ Z[X] i f (20)f (13) = 2013, to f (X) nie ma pierwiastków całkowitych. ZADANIE 3.B4 Udowodnić, że jeżeli f (X) ∈ Z[X] i |f (a)| = |f (b)| = |f (c)| = 1 dla liczb całkowitych a < b < c, to f (X) n i e ma pierwiastków całkowitych. ZADANIE 3.B5 Udowodnić, że jeżeli f (X) ∈ Z[X] i f (ci) jest liczbą podzielną przez daną liczbę naturalną m dla pewnych m k o l e j n y c h liczb całkowitych c1, c2, . . . , cm, to wartości f (x), dla w s z y s t k i c h x ∈ Z, są podzielne przez m. ZADANIE 3.B6 Dany jest n i e s t a ł y wielomian f (X) ∈ Z[X]. Udowodnić, że istnieje co najmniej jedna liczba naturalna m, dla której wartość f (m) n i e jest potęgą liczby 2 o wykładniku całkowitym. ZADANIE 3.B7 Dane są liczby całkowite a, b, c. Udowodnić, że istnieje taka liczba naturalna n, że liczba f (n) := n3 + an2 + bn + c nie jest kwadratem liczby całkowitej. ZADANIE 3.B8 Ciąg (ak) o wyrazach całkowitych spełnia warunki: (1) (k − l)|(ak − al) dla dowolnych liczb naturalnych k, l, (2) istnieje taki wielomian f (X) ∈ Z[X], że |ak| ⩽ |f (k)| dla każdego k ∈ N. Dowieść, że istnieje taki wielomian g(X) ∈ R[X], że am = g(m) dla każdego m ∈ N. ZADANIE 3.B9 Wielomian f (X) ∈ Z[X] spełnia warunek f (m) > m dla każdej liczby natu- ralnej m. Deﬁniujemy ciąg (an) indukcyjnie: a1 = 1 i an+1 = f (an) dla każdego n ∈ N. Załóżmy, że dla każdej liczby d ∈ N istnieje taki indeks n, że d|an. Udowodnić, że f (X) = 1 + X. ZADANIE 3.B10 Wielomian f (X) = X 2 + aX + b ∈ Z[X] spełnia warunek: dla każdej liczby pierwszej p istnieje taka liczba całkowita k, że p|f (k) i p|f (k + 1). Udowodnić, że istnieje taka liczba m ∈ Z, że f (m) = f (m + 1) = 0. C. Wielomiany przyjmujące na Z wartości całkowite ZADANIE 3.C1 Wielomian n-tego stopnia (X n ) ∈ Q[X] zdeﬁniowany jest, dla n ∈ N, wzorem (X n ) := 1 n! X(X − 1) · . . . · (X − n + 1). (3.72) Ponadto kładziemy (X 0 ) = 1. Udowodnić, że: (1) Wartość (x n ) jest liczbą całkowitą dla każdego x ∈ Z; (2) W pierścieniu Q[X] zachodzi, dla każdego n ∈ N, równość: ( X + 1 n ) = (X n ) + ( X n − 1 ); (3.73) 114 3. Wielomiany (3) Jeżeli f (X) ∈ K[X] (gdzie K = Q, R lub C) jest wielomianem stopnia n, to istnieją takie jednoznacznie wyznaczone elementy α0, α1, . . . , αn ∈ K, że f (X) = α0 + α1 ( X 1 ) + . . . + αn (X n ). (3.74) ZADANIE 3.C2 Dany jest wielomian f (X) ∈ C[X]. Udowodnić: (1) Jeżeli f (a) ∈ Z dla wszystkich a ∈ Z, to (istniejące i jednoznacznie wyznaczone na mocy Z3.C1(3)) liczby α0, . . . , αn są liczbami c a ł k o w i t y m i; (2) Jeżeli deg f (X) = n i f (a), f (a + 1), . . . , f (a + n) są liczbami całkowitymi dla pewnego a ∈ Z, to f (x) ∈ Z dla k a ż d e g o x ∈ Z. ZADANIE 3.C3 Udowodnić, że jeżeli f (X) ∈ Z[X] jest wielomianem pierwotnym stopnia n, to największy wspólny dzielnik wszystkich liczb f (k), przy k ∈ Z, jest dzielnikiem liczby n!. ZADANIE 3.C4 Udowodnić tożsamość (2.36). D. Wielomiany przyjmujące wartości danego typu ZADANIE 3.D1 Trójmian kwadratowy f (X) = X 2 + pX + q dla dwóch kolejnych liczb całko- witych przyjmuje wartości będące kwadratami kolejnych liczb całkowitych. Udowodnić, że f (x) jest kwadratem (liczby całkowitej) dla każdego x ∈ Z. ZADANIE 3.D2 Dany jest trójmian kwadratowy f (X) = aX 2 + bX + c. Udowodnić, że jeżeli dla każdej liczby całkowitej x liczba f (x) jest kwadratem liczby całkowitej, to istnieją takie liczby r, d, że dla każdego x zachodzi równość f (x) = (rx + d)2. ZADANIE 3.D3 Udowodnić, że jeżeli wielomian f (X) = aX 2+bX +c ∈ Z[X] ma taką własność, że f (x) jest czwartą potęgą liczby całkowitej dla każdej liczby całkowitej x, to a = b = 0. ZADANIE 3.D4 Niech f (X) ∈ R[X]. Udowodnić, że jeżeli zbiór A(f ) := {k ∈ Z : f (k) /∈ Z} jest niepusty, to jest zbiorem nieskończonym. ZADANIE 3.D5 Dowieść, że jeżeli dla wielomianu f (X) ∈ R[X] stopnia n, liczby f (k2) są całkowite dla k = 0, 1, . . . , n, to f (x2) ∈ Z dla każdego x ∈ Z. Ale może się zdarzyć, że f (y) /∈ Z dla pewnego y ∈ Z. ZADANIE 3.D6 Wyznaczyć wszystkie takie wielomiany f (X) ∈ Z[X], że każda liczba całkowita y jest wartością f (x) dla pewnego x ∈ Z. E. Pierwiastki wielomianów ZADANIE 3.E1 Jeżeli f (X) = aX 3 + bX 2 + cX + d ∈ Z[X], przy czym bc ∈ 2Z oraz ad /∈ 2Z, to nie wszystkie pierwiastki wielomianu f (X) są liczbami wymiernymi. ZADANIE 3.E2 Dowieść, że jeżeli c, d ∈ Z i c ̸= 0, to równanie x3 − 3cx2 − dx + c = 0 ma nie więcej niż jeden pierwiastek wymierny. ZADANIE 3.E3 Wyznaczyć wszystkie takie liczby wymierne c, dla których trójmian kwadra- towy cX 2 + (2c + 1)X + 2c − 1 ma oba pierwiastki będące liczbami całkowitymi. ZADANIE 3.E4 Udowodnić, że wielomian ∑n j=0 ajX j ∈ R[X], w którym an = 1, an−1 = an−2 = 0 i a0 ̸= 0, ma co najwyżej n − 1 pierwiastków rzeczywistych. ZADANIE 3.E5 Udowodnić, że jeżeli wielomian f (X) = X 3 + aX 2 + bX + c ∈ R[X] ma trzy (parami) różne pierwiastki rzeczywiste, to wielomian g(X) = 8X 3 + 8aX 2 + 2(a2 + b)X + ab − c również ma trzy (parami) różne pierwiastki rzeczywiste. ZADANIE 3.E6 Niech α, β będą (dwoma z czterech) pierwiastkami wielomianu X 4 + X 3 − 1. Udowodnić, że αβ jest pierwiastkiem wielomianu X 6 + X 4 + X 3 − X 2 − 1. ZADANIE 3.E7 Udowodnić, że jeżeli jeden z trzech pierwiastków wielomianu aX 3 + bX + c ∈ Q[X] jest iloczynem dwóch pozostałych pierwiastków, to jest on liczbą wymierną. 3.6. Zadania dodatkowe 115 ZADANIE 3.E8 Wielomian f (X) = X n − X n−1 + an−2X n−2 + · · · + a2X 2 − n2X + 1 ∈ R[X] ma n (n ⩾ 4) dodatnich pierwiastków. Wykazać, że wszystkie one są równe. ZADANIE 3.E9 Wskazać warunki konieczne i dostateczne, jakie powinien spełniać wielomian X 3 + aX 2 + bX + c ∈ R[X], by mieć trzy pierwiastki rzeczywiste tworzące ciąg arytmetyczny. ZADANIE 3.E10 Wielomian postaci c0+c1X +· · ·+cnX n, gdzie każda z liczb c0, c1, . . . , cn jest równa 1 lub −1, nazwiemy (±1)-wielomianem. Wyznaczyć wszystkie (±1)-wielomiany mające same pierwiastki rzeczywiste (tzn. takie, których wszystkie pierwiastki w C mają zerowe części urojone). ZADANIE 3.E11 Uzasadnić, że istnieje taki nieskończony ciąg (ak)k⩾0 o wyrazach rzeczywi- stych, że dla każdego n ⩾ 1 wielomian a0+a1X +· · ·+anX n ma dokładnie n r ó ż n y c h pierwiastków rzeczywistych. ZADANIE 3.E12 Dany jest taki wielomian unormowany f (X) ∈ R[X], że |f (i)| < 1 (i = √−1). Udowodnić, że istnieje taki pierwiastek zespolony b + ci wielomianu f (X), że zachodzi nierówność (b2 + c2 + 1)2 − 4b2 < 1. ZADANIE 3.E13 Niech r(X) = X n − (rn−1X n−1 + · · · + r1X + r0) ∈ R[X], gdzie rj ⩾ 0 dla j = 0, . . . , n − 1. Udowodnić, że wielomian r(X) ma dokładnie jeden pierwiastek nieujemny ϱ0. Ponadto, gdy r(X) ̸= X n (czyli gdy co najmniej jeden współczynnik r0, . . . , rn−1 jest różny od 0), to ϱ0 > 0 oraz r(x) < 0 dla x ∈ ( 0; ϱ0 ) i r(x) > 0 dla x ∈ ( ϱ0; ∞ ). ZADANIE 3.E14 Niech f (X) = X n + an−1X n−1 + · · · + a1X + a0 będzie wielomianem unormo- wanym o współczynnikach zespolonych. Niech r(X) = X n − |an−1|X n−1 − · · · − |a1|X − |a0| będzie tzw. wielomianem Pólya’i wielomianu f (X). Udowodnić, że dla dowolnego pierwiastka λ wielo- mianu f (X) zachodzi nierówność podwójna: |λ| ⩽ ϱ0 ⩽ 2 max { k√ |an−k| : k = 1, . . . , n}, gdzie ϱ0 oznacza (jedyny) nieujemny pierwiastek wielomianu r(X) (zobacz poprzednie zadanie). ZADANIE 3.E15 Dla danego wielomianu f (X) = a0 + a1X + · · · + anX n ∈ C[X] stopnia n oznaczmy M = max{|aj|/|an| : j = 0, . . . , n − 1}. Niech λ ∈ C będzie dowolnym pierwiastkiem wielomianu f (X). Udowodnić, że (1) |λ| ⩽ 1 + M ; (2) jeżeli aj ⩾ 0 dla wszystkich j oraz Re λ ⩾ 0, to |λ| ⩽ 1 + √1 + 4M 2 . F. Pierwiastki wspólne ZADANIE 3.F1 Udowodnić, że jeżeli trójmiany kwadratowe fi(X) = X 2 + aiX + bi ∈ Z[X], dla i = 1, 2, mają wspólny pierwiastek nie będący liczbą całkowitą, to a1 = a2 i b1 = b2. ZADANIE 3.F2 Dowieść, że α ∈ K jest wspólnym pierwiastkiem wielomianów f (X), g(X) ∈ K[X] wtedy i tylko wtedy, gdy α jest pierwiastkiem wielomianu NWD (f, g). ZADANIE 3.F3 Dla danych dwóch unormowanych trójmianów kwadratowych o współczynnikach rzeczywistych f1(X) = X 2 + a1X + b1 i f2(X) = X 2 + a2X + b2 oznaczmy R(f1, f2) := (b2 − b1)2 + (a1 − a2)(a1b2 − a2b1). (3.75) Udowodnić, że (1) Trójmiany f1, f2 mają wspólny pierwiastek (być może zespolony) wtedy i tylko wtedy, gdy R(f1, f2) = 0; (2) Jeżeli R(f1, f2) < 0, to oba trójmiany mają pierwiastki rzeczywiste i to takie, że między dwoma pierwiastkami jednego z nich leży pierwiastek drugiego). ZADANIE 3.F4 Liczba α ∈ R ∖ Q jest wspólnym pierwiastkiem wielomianów trzeciego stopnia f (X), g(X) ∈ Q[X]. Dowieść, że wielomiany f (X), g(X) mają wspólny pierwiastek β ̸= α. ZADANIE 3.F5 Dana jest liczba całkowita c. Udowodnić, że 3√c jest pierwiastkiem trójmianu kwadratowego o współczynnikach całkowitych wtedy i tylko wtedy, gdy c = k3 dla pewnego k ∈ Z. 116 3. Wielomiany G. Zastosowanie wzorów Vi`ete’a ZADANIE 3.G0 Jeżeli X 3 + aX 2 + bX + c ∈ R[X] ma trzy pierwiastki rzeczywiste, to a2 ⩾ 3b. ZADANIE 3.G1 Dowieść, że jeżeli wielomian f (X) = aX 3 −aX 2 +bX +b ∈ R[X] ma dokładnie trzy różne pierwiastki α, β, γ, to zachodzi równość 1 α + 1 β + 1 γ + 1 α+β+γ = 0. ZADANIE 3.G2 Dana jest liczba m ∈ N. Udowodnić, że jeżeli liczby całkowite a, b, c, d spełniają warunki m|a + b + c + d i m|a2 + b2 + c2 + d2, to m|a4 + b4 + c4 + d4 + 4abcd. ZADANIE 3.G3 Jeżeli α, β, γ ∈ R⩾0 i α + β + γ = 1, to 0 ⩽ αβ + βγ + γα − 2αβγ ⩽ 7 27 . ZADANIE 3.G4 Wyznaczyć wszystkie takie pary liczb naturalnych (a, b), że a|b2 +1 i b|a2 +1. ZADANIE 3.G5 Niezerowe liczby całkowite a, b, c są takie, że a b + b c + c a oraz a c + c b + b a są liczbami całkowitymi. Udowodnić, że |a| = |b| = |c|. ZADANIE 3.G6 Liczby α, β, γ ∈ R̸=0 spełniają warunki α + β + γ ̸= 0 i 1 α+β+γ = 1 α + 1 β + 1 γ . Udowodnić, że (α2017 + β2017 + γ2017)−1 = α−2017 + β−2017 + γ−2017. ZADANIE 3.G7 Rozwiązać układ równań  |||| |||| x1 + x2 + . . . + xn = n, x2 1 + x2 2 + . . . + x2 n = n, . . . . . . . . . xn 1 + xn 2 + . . . + xn n = n. ZADANIE 3.G8 Udowodnić, że jeżeli liczby n a t u r a l n e a, b są takie, że (ab − 1)|(a2 + b2), to iloraz (a2 + b2)/(ab − 1) jest równy 5. H. Wielkość wielomianów ZADANIE 3.H1 Wielomian f (X) = X n + an−1X n−1 + · · · + a1X + 1 o nieujemnych współczyn- nikach ma n pierwiastków rzeczywistych. Udowodnić, że f (2) ⩾ 3n. ZADANIE 3.H2 Niech f (X) = X n+an−1X n−1+· · ·+a1X+a0 ∈ R[X] i niech s0 < s1 < · · · < sn będą liczbami całkowitymi. Dowieść, że |f (sk)| ⩾ n!/2n dla pewnego 0 ⩽ k ⩽ n. ZADANIE 3.H3 Wielomian f (X) ∈ R[X] ma stopień 2n. Ponadto |f (a)| ⩽ 1 dla każdej liczby całkowitej a ∈ [ −n; n ]. Udowodnić, że dla każdego x ∈ [ −n; n ] zachodzi nierówność |f (x)| ⩽ 22n. ZADANIE 3.H4 Liczby a, b, c ∈ R są takie, że |ax2 + bx + c| ⩽ 1 dla wszystkich |x| ⩽ 1. Udowodnić, że wówczas |cx2 + bx + a| ⩽ 2 dla wszystkich |x| ⩽ 1. ZADANIE 3.H5 Dowieść, że istnieje taki wielomian f (X) ∈ Z[X] (o współczynnikach całkowi- tych!), że dla każdego x ∈ [ 1/10; 9/10 ] zachodzi nierówność |f (x) − 1 2 | < 10−3. I. Podzielność wielomianów ZADANIE 3.I1 Dowieść, że X 2 + X + 1|(X + 1)2n+1 + X n+2 dla każdej n ∈ N. ZADANIE 3.I2 Udowodnić, że wielomian X 2−2(cos ϕ)X +1 jest w pierścieniu R[X] dzielnikiem wielomianu (sin ϕ)X n − (sin nϕ)X + sin(n − 1)ϕ przy dowolnych ϕ /∈ Zπ i n ⩾ 2. ZADANIE 3.I3 Udowodnić, że dla dowolnych n, k ∈ N wielomian (X − 1)(X 2 − 1) · . . . · (X k − 1) jest dzielnikiem wielomianu (X n+1 − 1)(X n+2 − 1) · . . . · (X n+k − 1) w pierścieniu Q[X]. ZADANIE 3.I4 Dla jakich k, n ∈ N zachodzi 1 + X + X 2 + · · · + X k|1 + X n + X 2n + · · · + X kn ? ZADANIE 3.I5 Wyznaczyć wszystkie wielomiany stopnia 2 należące do Z[X] i będące dzielni- kami (w Z[X]) (±1)-wielomianów (zobacz Z3.E10). 3.6. Zadania dodatkowe 117 J. Wielomiany nierozkładalne ZADANIE 3.J1 Niech f (X) = (X − a1)2(X − a2)2 · . . . · (X − an)2 + 1 ∈ Z[X] dla parami różnych liczb całkowitych a1, . . . , an. Udowodnić, że wielomian f (X) jest nierozkładalny w Q[X]. ZADANIE 3.J2 (1) Niech f (X) = (X − a1)(X − a2) · . . . · (X − an) + 1 ∈ Z[X] dla parami różnych liczb całkowitych a1, . . . , an. Udowodnić, że jeżeli n ̸= 2, 4, to f (X) jest nierozkładalny w Q[X]; (2) Dla jakich a, b ∈ Z wielomian (X − a)(X − b) + 1 jest rozkładalny w Q[X]?; (3) Wyznaczyć takie a, b, c, d ∈ Z, że (X − a)(X − b)(X − c)(X − d) + 1 jest rozkładalny w Q[X]. ZADANIE 3.J3 Niech f (X) ∈ Z[X], deg f (X) = 2n + 1. Załóżmy, że |f (cj)| ∈ {1} ∪ P dla pewnych liczb całkowitych c1 < c2 < · · · < c2n+1. Dowieść, że f (X) jest nierozkładalny w Q[X]. ZADANIE 3.J4 Niech f (X) ∈ Z[X] będzie wielomianem unormowanym stopnia n ⩾ 5. Udo- wodnić, że jeżeli |f (cj)| = 1 dla pewnych liczb całkowitych c1 < c2 < · · · < cn, to f (X) jest nierozkładalny w Q[X]. ZADANIE 3.J5 Niech n ∈ N. Udowodnić, że wielomian X 2n + 1 jest nierozkładalny w Q[X]. ZADANIE 3.J6 Niech p ∈ P>2. Udowodnić, że X p + pX p−1 + p +1 jest nierozkładalny w Q[X]. ZADANIE 3.J7 Udowodnić nierozkładalność wielomianu X 4 + 2X 3 + 3X 2 + 4X + 5 w Q[X]. ZADANIE 3.J8 Udowodnić, że wielomin X n + 4 jest nierozkładalny w Q[X] (równoważnie, w Z[X]) wtedy i tylko wtedy, gdy wykładnik n nie jest podzielny przez 4. ZADANIE 3.J9 Niech p(X) ∈ Z[X] będzie takim unormowanym wielomianem nierozkładalnym w Q[X], że |p(0)| nie jest kwadratem. Udowodnić, że złożenie (superpozycja) f (X) = p(X 2) również jest wielomianem nierozkładalnym w Q[X]. ZADANIE 3.J10 Udowodnić, że wielomian 5X 5 +2X 4 +4X 3 +2X 2 +8X +7 jest nierozkładalny w Q[X]. U w a g a. Liczba 524 287 jest liczbą pierwszą5. ZADANIE 3.J11 Dane są liczby całkowite k1 < k2 < · · · < k2n. Dowieść, że istnieje nieskoń- czenie wiele takich liczb pierwszych p, że wielomian f (X) = (X − k1)(X − k2) · . . . · (X − k2n) + p jest nierozkładalny w pierścieniu Z[X]. ZADANIE 3.J12 Dowieść, że wielomianu X 7Y 7 + 1 nie da się przedstawić w postaci f (X)g(Y ). ZADANIE 3.J13 Zbadać rozkładalność wielomianu X 2 1 + X 2 2 + · · · + X 2 n ∈ K[X1, X2, . . . , Xn]. K. Rozkładanie na czynniki ZADANIE 3.K1 Rozłożyć wielomian X 8 + X 4 + 1 na iloczyn czynników nierozkładalnych w pierścieniach Q[X], R[X] i C[X]. ZADANIE 3.K2 Rozłożyć podobnie jak wyżej wielomian X 5 + X + 1. ZADANIE 3.K3 Rozłożyć wielomian f (X) = X 2n + X 2n−2 + · · · + X 2 + 1 na iloczyn czynników nierozkładalnych w pierścieniach R[X] i C[X]. ZADANIE 3.K4 Rozłożyć podobnie jak wyżej wielomian f (X) = X 2n + X n + 1. ZADANIE 3.K5 Rozłożyć na czynniki nierozkładalne w pierścieniu Z[X, Y ]: (1) (X + Y )3 − X 3 − Y 3; (2) (X + Y )5 − X 5 − Y 5; (3) (X + Y )7 − X 7 − Y 7. ZADANIE 3.K6 Liczby całkowite a, b, c są parami różne, a n ∈ N. Udowodnić, że an (a − b)(a − c) + bn (b − a)(b − c) + cn (c − a)(c − b) ∈ Z. 5jest to liczba M19, której pierwszość została udowodniona przez Cataldi’ego w 1588 roku 118 3. Wielomiany L. Superpozycje ZADANIE 3.L1 Załóżmy, że trójmian kwadratowy f (X) ∈ R[X] jest taki, że f (x) ̸= x dla każdego x ∈ R. Udowodnić, że wtedy również f (f (x)) ̸= x dla każdego x ∈ R. ZADANIE 3.L2 Dla danego wielomianu f (X) ∈ R[X] i liczby n ∈ Z⩾0 deﬁniujemy (indukcyj- nie) iteracje f [n](X) wielomianu f (X). Mianowicie: f [n+1](X) = f (f [n](X)) oraz f [0](X) = X. Udowodnić, że f (X) − X|f [n](X) − X dla dowolnego wielomianu f (X) ∈ R[X] i dowolnej n ∈ N. ZADANIE 3.L3 Dla danego wielomianu f (X) ∈ Z[X] i liczby całkowitej a zachodzi równość f [k](a) = a przy pewnym k ∈ N. Udowodnić, że wówczas f [2](a) = a. ZADANIE 3.L4 Wielomian f (X) ∈ Z[X] ma stopień n ⩾ 2. Udowodnić, że dla danego k ∈ N istnieje co najwyżej n liczb całkowitych a, dla których zachodzi równość f [k](a) = a. ZADANIE 3.L5 Dane są takie wielomiany u n o r m o w a n e f (X), g(X) ∈ K[X], że zachodzi równość f [2](X) = g[2](X). Udowodnić, że f (X) = g(X). ZADANIE 3.L6 Wielomian f (X) ∈ R[X] jest taki, że f (sin x) = f (cos x) dla każdej liczby rzeczywistej x. Udowodnić, że f (X) = l(X 4 − X 2) dla pewnego wielomianu l(X) ∈ R[X]. ZADANIE 3.L7 Dany jest wielomian: f (X) = X 2 − 2 ∈ R[X]. Udowodnić, że dla każdego n wszystkie pierwiastki wielomianu f [n](X) są rzeczywiste i różne. ZADANIE 3.L8 Udowodnić, że n i e da się znaleźć takich trzech trójmianów kwadratowych f (X), g(X), h(X) ∈ R[X], żeby wielomian f (g(h(X))) miał osiem pierwiastków 1, 2, . . . , 8. M. Wielomiany jako funkcje rzeczywiste ZADANIE 3.M1 Udowodnić, że każda funkcja wielomianowa R ∋ x 7−→ f (x) ∈ R jest różnicą dwóch funkcji wielomianowych rosnących. ZADANIE 3.M2 Niech f (X) ∈ R[X]. Załóżmy, że dla wszystkich x ∈ R⩾0 zachodzi nierówność f (x) ⩾ 0. Dowieść, że f (X) = a(X)2 + Xb(X)2 dla pewnych wielomianów a(X), b(X) ∈ R[X]. ZADANIE 3.M3 Czy istnieje taki wielomian f (X, Y ) ∈ R[X, Y ], że zbiór wartości: f (R × R) := {f (x, y) : (x, y) ∈ R × R} jest równy przedziałowi (nieskończonemu) ( 0; ∞ )? N. Wielomiany jako funkcje tworzące ZADANIE 3.N1 Niech (k1, k2, . . . , kn) i (l1, l2, . . . , ln) będą dwoma r ó ż n y m i ciągami o wyrazach ze zbioru N. Oznaczmy przez A zbiór {(i, j) : 1 ⩽ i < j ⩽ n} i zdeﬁniujmy dwie funkcje ϕ, ψ : [ n ] × [ n ] −→ N przez ϕ(i, j) = ki + kj, ψ(i, j) = li + lj. Załóżmy, że istnieje taka bijekcja b : A −→ A, że zachodzi równość ϕ = ψ ◦ b. Udowodnić, że n jest potęgą 2s dla pewnego s ∈ N. 3.6.2 Wskazówki/rozwiązania Stopień szczegółowości poniższych wskazówek/rozwiązań jest dość różny. Niektóre są bardzo szczegółowe (dwa sposoby rozumowania, dodatkowe uwagi, uogólnienia, itp.). Inne są bardziej lakoniczne. Czasami wskazówki brak. To może, ale nie musi oznaczać, że zadanie jest łatwe. Z3.A1 (1) Wystarczy, oczywiście obliczyć: f (1) = (1 − 1 + 12)5 = 1. (2) Ponieważ a0 = f (0) (jak zawsze), więc w naszym przypadku a0 = 1. Również łatwo widzieć, że a10 = 1. Oraz 35 = f (−1) = a0 − a1 + a2 − . . . − a9 + a10. Stąd a1 − a2 + · · · + a9 = 2 − 35. 3.6. Zadania dodatkowe 119 Z3.A2 Rozważ jeszcze dwa wielomiany: ̃f (X) = f (−X) i ̃h(X) = g(−X). Ponieważ (−X)2k = X 2k więc jest jasne, że zachodzą równości f20 = ̃f20 i h20 = ̃h20. Łatwo porównać liczby ̃f20 i ̃h20. Z3.A3 Wiemy z C2.50, że wszystkie, z wyjątkiem wiodącego i zerowego, współczynniki wielomianu (1+X)2k są parzyste. Zatem w wielomianie (1+X)N = (1+X)k1(1+X)k2 ·. . .·(1+X)km nieparzyste mogą być tylko współczynniki przy iloczynie jedynek i przy iloczynach postaci X 2 ks1 ·. . .·X 2 ksj . Takich iloczynów jest tyle ile podzbiorów ma zbiór {k1, k2, . . . , km}, czyli 2m. Trzeba jeszcze sprawdzić, że jednomiany X 2 ks1 · . . . · X 2 ksj są parami różne, co jest równoważne faktowi jednoznaczności zapisu liczb naturalnych w systemie dwójkowym (systemie pozycyjnym o podstawie 2). Z3.A4 (1) Patrz ogólnie: f (X) = ∑N j=0 (a + X)N −j(b + X)j. Pomnóż ten wielomian przez (X + a) − (X + b) i skorzystaj z tożsamości nieśmiertelnej (1.8). Dostaniesz równość (a − b)f (X) = (X + a)N +1 − (X + b)N +1. Stąd równość fk = (a − b)−1(N +1 k )(aN +1−k − bN +1−k). (2) Zobacz 3.4.11 P2. Z3.A5 S p o s ó b 1. Oczywista indukcja względem n. Oznaczmy przez An zbiór wszystkich liczb całkowitych z przedziału [ 0; 2n ]. Potrzebny w dowodzie tożsamości krok indukcyjny jest dokładnie równoważny równości: An ⊔ (An + 2n+1) = An+1, a ta równość jest w gruncie rzeczy tylko innym sposobem powiedzenia, że liczby całkowite nieujemne mają dokładnie jedno przedstawienie w systemie dwójkowym. U w a g a. Oznaczenie A + x wprowadziliśmy w rozwiązaniu zadania Z1.4. S p o s ó b 2. Pomnóż wielomian f (X) = (X +1)(X 2 +1)(X 22 +1)·. . .·(X 2n−1 +1) przez wielomian X − 1. Dzięki oczywistej indukcji dostaniesz równość (X − 1)f (X) = X 2n − 1. Porównaj tę równość z tożsamością nieśmiertelną (X − 1)(X 2n−1 + X 2n−2 + · · · + X + 1) = X 2n − 1. I wykorzystaj istnienie i j e d n o z n a c z n o ś ć ilorazu, zobacz T3.3. Z3.A6 Sztuka polega tu na tym, że łatwo wyznaczyć iloczyn (X 2 + X + 1)f (X). Mamy bowiem (X 2k +X k +1)(X 2k −X k +1) = X 4k +X 2k +1 dla każdego k ∈ N. Przez oczywistą indukcję dostajemy stąd równość (X 2 + X + 1)f (X) = X 2n+1 + X 2n + 1. Dla wyznaczenia wielomianu f (X) trzeba więc podzielić X 2n+1 + X 2n + 1 przez X 2 + X + 1. Wykładniki 2n+1 i 2n dają reszty 1 i 2 (lub 2 i 1) przy dzieleniu przez 3. Dokładniej, reszty 1 i 2, gdy n jest nieparzysta, a reszty 2 i 1, gdy n jest parzysta (sprawdźcie!). Działamy więc o g ó l n i e j: dzielimy X a + X b + 1, przy wykładnikach a i b dających reszty 1 i 2 (lub 2 i 1) przy dzieleniu przez 3. Twierdzenie o strażakach daje równość X a + X b + 1 = (X a − ωa) + (X b − ωb). Korzystając więc z tożsamości nieśmiertelnej, mamy X a + X b + 1 X − ω = a−1∑ j=0 ωa−1−jX j + b−1∑ j=0 ωb−1−jX j. (∗) Dokładnie tak samo, mamy X a + X b + 1 = (X a − ωa) + (X b − ωb), skąd dostaniemy sprzężoną wersję równości (∗): wszystko tak samo z zamianą ω na ω. Mnożąc oczywistą równość (w C(X)) 1 X 2 + X + 1 = 1 (X − ω)(X − ω) = 1 ω − ω · ( 1 X − ω − 1 X − ω ) przez X a + X b + 1 i korzystając z równości (∗), (∗), dostajemy X a + X b + 1 X 2 + X + 1 = a−1∑ j=0 ωa−1−j − ωa−1−j ω − ω X j + b−1∑ j=0 ωb−1−j − ωb−1−j ω − ω X j. Czytelnik może zechcieć dalej upraszczać: zapisać uzyskany wielomian w postaci jednolitej ∑j⩾0 cjX j, podstawić a = 2n+1, b = 2n, itd. Z3.A7 Rozważyć wielomian (1 + X)n(1 − X)n. Por. P1 z paragrafu 3.1. 120 3. Wielomiany Z3.B1 Mamy (abc)10 = 102a + 10b + c = f (10), gdzie f (X) = aX 2 + bX + c ∈ Z[X]. Załóżmy, nie wprost, że ∆ = b2 − 4ac = k2 dla pewnego k ∈ Z⩾0. Wówczas liczby α1 = (−b + k)/2a, α2 = (−b − k)/2a są (wymiernymi!) pierwiastkami trójmianu f (X). Zapiszmy rozkład (3.11) dla X = 10 w postaci 4a(102a + 10b + c) = 4af (10) = 4a2(10 − α1)(10 − α2) = (20a + b − k)(20a + b + k). Wobec tego, liczba pierwsza 102a + 10b + c dzieli co najmniej jeden z czynników z prawej strony. Jest więc niewiększa od większego z nich, zobacz C2.2: 100a + 10b + c ⩽ 20a + b + k. Czyli 80a + 9b + c ⩽ k =√b2 − aac ⩽ √81 = 9 (bo 0 ⩽ a, b, c ⩽ 9). To jest sprzeczne z założeniem a ⩾ 1. Z3.B2 Zobacz rozwiązanie Z3.2. Zauważ, że liczby 2 = 1 − (−1) nie da się przedstawić w postaci iloczynu pięciu czynników całkowitych, z których cztery byłyby (parami) różne. Z3.B3 Ponieważ 2013 jest liczbą nieparzystą, więc jej dzielniki f (20), f (13) są nieparzyste. Jeżeli teraz a ∈ 2Z, to, ponieważ 20 − a|f (20) − f (a), zobacz (3.3), więc f (a) jest liczbą tej samej parzystości co f (20), czyli jest liczbą nieparzystą. Jeżeli zaś a ∈ 2Z + 1 (jest nieparzysta), to, podzielność 13 − a|f (13) − f (a), podobnie jak przed chwilą, pokazuje, że f (a) jest liczbą nieparzystą. Widzimy więc, że wartość f (a), dla w s z y s t k i c h a ∈ Z, jest liczbą nieparzystą. Ostatecznie, f (a) ̸= 0 dla wszystkich a ∈ Z. U w a g a. Podobnie dowodzimy: Jeżeli f (2)f (0)f (1)f (3) = 2013, to f (x) ̸= 2014 dla x ∈ Z. Z3.B4 Załóżmy, nie wprost, że f (n) = 0 dla pewnego n ∈ Z. Wówczas a − n|f (a) − f (n) (zob. C3.4), czyli a − n| ± 1, więc a − n = ±1. Podobnie, b − n = ±1 i c − n = ±1. Przeto a, b, c ∈ {n − 1, n + 1}. Ostatecznie {a, b, c} ⊆ {n − 1, n + 1}. Nonsens! Z3.B5 Dla danej (dowolnej) liczby całkowitej x istnieje (dokładnie jeden) indeks i, dla którego m|x − ci. Jednocześnie x − ci|f (x) − f (ci), na mocy (3.3). Więc m|f (x) − f (ci). Stąd, na mocy Zasady Podstawowej, m|f (x). Z3.B6 Niech f (X) = a0 + a1X + · · · + anX n. Załóżmy, że wszystkie wartości f (m), przy m ∈ N, są postaci 2s, gdzie s ∈ Z⩾0. Pokażemy – na dwa sposoby – że to prowadzi do sprzeczności. Pierwszy sposób będzie a r y t m e t y c z n y (wykorzystujący głównie podzielność w zbiorze Z), a drugi ”w i e l k o ś c i o w y” (wykorzystujący głównie relację ⩽ w Z). S p o s ó b 1. Załóżmy, że a0 ̸= 0 i zapiszmy a0 = 2ka′ 0, gdzie k = v2(a0), 2 ∤ a′ 0, i rozważmy liczby f (2t) dla t > k. Mamy f (2t) = a0 + a1 · 2t + · · · + an · 2tn = 2k(a′ 0 + 2t−k · A(t)). Liczba tej postaci może być potęgą dwójki tylko, gdy a′ 0 + 2t−k · A(t) = 1. To, z kolei, może mieć miejsce tylko, gdy A(t) = a1 + a2 · 2t + · · · + an · 2t(n−1) = 0 dla wszystkich t > k. Co może zajść tylko, gdy a1 + a2X + · · · + anX n−1 = 0. Więc tylko, gdy f (X) = a0. Ale wielomian f (X) miał być niestały! To dowodzi, że a0 = 0. Wtedy jednakże liczba f (3), jako podzielna przez 3, nie może być potęgą dwójki. Uzyskana sprzeczność kończy rozwiązanie. S p o s ó b 2. Intuicja leżąca u podstaw tego sposobu rozwiązania jest natury wielkościowej. Chodzi o to, że (niestały) wielomian traktowany jako funkcja rzeczywista wprawdzie rośnie do nieskończoności ale ”robi” to zdecydowanie w o l n i e j niż funkcja wykładnicza (wzrost wielomianowy jest wolniejszy niż wzrost wykładniczy). Tę obserwację wykorzystujemy tak: Dla danej liczby t ∈ N rozważmy ciąg f (1), f (2), . . . , f (tn + 1). (∗) Każdy wyraz tego ciągu jest (wobec założenia nie wprost) potęgą 2s. Przy tym liczba 2 występuje w nim co najwyżej n razy, liczba 22 występuje co najwyżej n razy, liczba 23 występuje co najwyżej n razy, itd., aż do liczby 2t. Wobec tego w ciągu (∗) w y s t ę p u j e liczba 2t+k dla pewnego k ∈ N. Stąd wynika nierówność f (tn + 1) > 2t dla każdej liczby naturalnej t ⩾ t0. Liczbę t0 wybieramy tak, żeby mieć pewność, że x 7−→ f (x) jest funkcją rosnącą dla x ⩾ t0/n. Stąd łatwo wywieść nierówność f (x) ⩾ ax prawdziwą dla wszystkich dostatecznie dużych x przy pewnej liczbie a > 1 (na przykład a = n√2). To jest właśnie oczekiwana sprzeczność, zobacz RIN . 3.6. Zadania dodatkowe 121 Z3.B7 Mamy prosty L e m a t. Jeżeli różnica kwadratów (liczb całkowitych) jest liczbą parzystą, to jest liczbą podzielną przez 4. D o w ó d. Różnica (kwadratów) liczb całkowitych jest parzysta tylko, gdy te liczby są tej samej parzystości. Mamy więc dwa przypadki: (2k)2 − (2l)2 = 4(k2 − l2) lub (2k + 1)2 − (2l + 1)2 = 4(k2 − l2 + k − l). Q.e.d. Załóżmy teraz, nie wprost, że wszystkie liczby f (n), n ∈ N, są kwadratami (liczb całkowitych). W szczególności, liczby f (1), f (3), f (2) i f (4) są kwadratami. Symbolicznie: 1 + a + b + c = □, 27 + 9a + 3b + c = □, 8 + 4a + 2b + c = □ i 64 + 16a + 4b + c = □. Stąd otrzymujemy f (3) − f (1) = 26 + 8a + 2b = □ − □. Widać, że f (3) − f (1) jest parzystą różnicą kwadratów. Zatem, na mocy lematu, jest podzielna przez 4. Stąd, na mocy Zasady Podstawowej, 4|2 + 2b. Jednocześnie f (4) − f (2) = 56 + 12a + 2b = □ − □. Stąd, podobnie jak wyżej, 4|2b. Uzyskane podzielności 4|2 + 2b i 4|2b pokazują oczywistą s p r z e c z n o ś ć: 4|2. Z3.B8 Udowodnimy najpierw trzy lemaciki. L e m a t 1. Jeżeli f (X) ∈ R[X], deg f (X) = n, to istnieje taka stała C > 0, że dla wszystkich x ∈ N zachodzi nierówność |f (x)| ⩽ Cxn. Ponadto, nierówność |f (x)| ⩽ Cxn−1, przy dowolnej stałej C > 0 zachodzi tylko dla s k o ń c z e n i e wielu x ∈ N. D o w ó d. Niech f (X) = a0 +a1X +· · ·+anX n. Niech M = max{|ai| : 0 ⩽ i ⩽ n}. Wówczas |f (x)| ⩽ |a0| + |a1|x + · · · + |an|xn ⩽ M (1 + x + · · · + xn) (na mocy nierówności trójkąta) dla dowolnego x ∈ N. Wystarczy więc przyjąć C = M (n + 1). Z drugiej strony, gdyby |f (x)| ⩽ Cxn−1 dla nieskończenie wielu x ∈ N, to, zapisując f (x) = a(x)+anxn i korzystając z udowodnionej nierówności | − a(x)| ⩽ C′xn−1, otrzymalibyśmy nierówność |anxn| = |f (x)−a(x)| ⩽ |f (x)|+|−a(x)| ⩽ (C +C′)xn−1. Stąd, po podzieleniu przez x, mamy s p r z e c z n o ś ć: |an|x ⩽ C + C′ dla nieskończenie wielu x ∈ N. Q.e.d. L e m a t 2. Jeżeli r1, . . . , rs ∈ N są dzielnikami liczby m ∈ N, to NWW (r1, . . . , rs)|m. D o w ó d. Najmniejsza wspólna wielokrotność jest dzielnikiem każdej wspólnej wielokrotności, por. D2.6. Teza jest równoważna implikacji ∀iki ⩽ l =⇒ max{k1, . . . , ks} ⩽ l, zob. C2.41 i C2.42. Q.e.d. L e m a t 3. Dla dowolnych liczb naturalnych r1, . . . , rs zachodzi nierówność r1 · r2 · . . . · rs ⩽ NWW (r1, . . . , rs) · ∏1⩽i<j⩽s NWD (ri, rj). D o w ó d. Żądaną nierówność wnioskujemy (na mocy C2.2) z podzielności r1 · . . . · rs|NWW (r1, . . . , rs) · ∏1⩽i<j⩽s NWD (ri, rj). Ta podzielność wyniknie, na mocy C2.41 i C2.42, z nierówności k1 + · · · + ks ⩽ max{k1, . . . , ks} + ∑ 1⩽i<j⩽s min{ki, kj}, gdzie p ∈ P i ki = vp(ri). Łatwy dowód pozostawiamy Czytelnikowi. Q.e.d. Przechodzimy do rozwiązania zadania. Oznaczmy n = deg f (X). Niech g(X) będzie (jedynym) takim wielomianem stopnia ⩽ n, że g(k) = ak dla wszystkich k = 1, 2, . . . , n + 1 (zobacz T3.23 w ustępie 3.4.10, gdzie widzimy, że wielomian g(X) ma współczynniki w y m i e r n e). Pokażemy, że g(X) jest właściwym wyborem (tzn., że g(k) = ak dla k a ż d e g o k ∈ N). Ponieważ g(X) ∈ Q[X], więc istnieje taka liczba naturalna d, że wielomian h(X) := dg(X) ma współczynniki całkowite (tzn., d jest wspólną wielokrotnością mianowników wszystkich współczynników wielomianu g(X)). Rozważmy teraz dowolną liczbę naturalną m > n + 1. Zapiszmy równość d(am − g(m)) = d(am − ak) + (h(k) − h(m)). (∗) Drugi składnik z prawej strony jest, na mocy (3.3), podzielny przez różnicę m − k. Ponieważ pierwszy składnik, na mocy założenia (1), jest też podzielny przez tę różnicę, więc mamy m − k|d(am − g(m)) dla każdego 1 ⩽ k ⩽ n + 1. Oznaczmy dm := NWW (m − 1, m − 2, . . . , m − n − 1). Wykazane podzielności, na mocy lematu 2, dają podzielność dm|d(am − g(m)). Przypomnijmy, że dążymy do wykazania równości am − g(m) = 0 dla każdego m. Załóżmy więc, nie wprost, że am − g(m) ̸= 0 dla pewnego m > n + 1. Wówczas, zobacz C2.2, dm ⩽ |d(am − g(m))|. Ponieważ, jednocześnie, |d(am − g(m))| ⩽ |dam| + |dg(m)| ⩽ d|f (m)| + d|g(m)| ⩽ dC′mn + dC′′mr ⩽ Cmn (na mocy założenia (2) i pierwszej części lematu 1; tu r = deg g(X) ⩽ n), więc dm ⩽ Cmn. Chcemy teraz zastosować lemat 3. Rozważmy w tym celu wielomian t(X) = (X − 1)(X − 2) · . . . · (X − n − 1). Jest to wielomian 122 3. Wielomiany stopnia n + 1. Jego wartość dla X = m, na mocy lematu 3, możemy oszacować t(m) ⩽ dm · ∏ 1⩽i<j⩽n+1 NWD (m − i, m − j) ⩽ CDmn, (∗∗) gdzie przez D oznaczyliśmy iloczyn ∏i<j (j − i) (korzystamy tu z nierówności NWD (a, b) ⩽ |a − b| dla różnych liczb całkowitych a, b; k a ż d y wspólny dzielnik różnych liczb całkowitych jest dzielnikiem różnicy tych liczb). Otrzymana nierówność (∗∗) jest, na mocy drugiej części lematu 1, fałszywa dla dostatecznie dużych m. Wnioskujemy stąd, że dla w s z y s t k i c h m > m0 (przy pewnym m0 ∈ N) zachodzi równość am = g(m). Dla zakończenia rozwiązania musimy jeszcze udowodnić równość am = g(m) dla wszystkich m = n + 2, n + 3, . . . , m0. Dla każdego takiego m, dzięki równości (∗), widzimy, że liczba d(am − g(m)) jest podzielna przez m − k dla w s z y s t k i c h k > m0. To, oczywiście, jest możliwe tylko, gdy am − g(m) = 0. Z3.B9 Będziemy korzystać z następującej własności ciągu (an): ak − al|ak+r − al+r (∗) dla wszystkich k, l ∈ N. Wynika ona z (3.3). Rzeczywiście, mamy ak − al|f (ak) − f (al), czyli ak − al|ak+1 − al+1. Ponieważ, dokładnie tak samo, ak+1 − al+1|ak+2 − al+2, więc (dzielnik dzielnika jest dzielnikiem!) ak − al|ak+2 − al+2. Itd., oczywista indukcja daje więc (∗). Udowodnimy przez indukcję, że f (m) = m+1 dla każdego m ∈ N. Zacznijmy (baza indukcji!) od dowodu równości f (1) = 2. Załóżmy, nie wprost, że f (1) ̸= 2. Wówczas, wobec założenia f (m) > m, mamy f (1) ⩾ 3. Niech d = f (1) − 1. Wtedy d ⩾ 2. Popatrzmy na reszty z dzielenia liczb am przez d. Liczba a1 = 1 daje resztę 1 z dzielenia przez d. Liczba a2 = f (1) = d + 1 też daje resztę 1 z dzielenia przez d. Ponieważ, na mocy (∗) a2 − 1|am − am−1, dla każdego m ⩾ 3, czyli d|am − am−1, więc (trywialna indukcja!) wszystkie liczby am dają tę samą resztę 1 z dzielenia przez d. To, wobec założenia o podzielności któregoś wyrazu ciągu (an) przez d, jest niemożliwe. Zatem a2 = f (1) = 2. Krok indukcyjny wykonujemy analogicznie: jeżeli f (1) = 2, f (2) = 3, . . . , f (m−1) = m, czyli a1 = 1 i a2 = 2, . . . , am = m, ale am+1 = f (am) = f (m) ̸= m+1, to d := f (m)−1 ⩾ m+1. Wówczas żadna z liczb a1, a2, . . . , am nie jest podzielna przez d (bo są mniejsze niż d i dodatnie). Jednocześnie liczba am+1 = f (m) = d + 1, więc daje z dzielenia przez d resztę 1, i ogólnie, dla każdego r ∈ N liczba am+r − ar jest podzielna przez d = am+1 − a1, więc liczby am+r i ar dają tę samą resztę przy dzieleniu przez d. Dostajemy sprzeczność z założeniem d|an dla pewnego n. Ta sprzeczność dowodzi równości f (m) = m + 1 dla każdego m ∈ N. Stąd, zob. W2T3.4, f (X) = X + 1. Z3.B10 (1) Stosując warunek dla p = 2 sprawdzamy, że a jest nieparzysta. Kładziemy więc a = −1 − 2m. (2) Dla dowolnej p ∈ P>2 znajdujemy k ∈ Z, że p dzieli f (k + 1) − f (k) = 2(k − m), czyli p|k − m. (3) Stąd, zobacz (3.3), p|f (k) − f (m), skąd p|f (m), więc p|m2 + am + b, czyli p|−m2−m+b. Skoro więc liczba b−m2−m jest podzielna przez wszystkie p ∈ P>2, to b−m2−m = 0. (4) Mamy więc (X − m)(X − m − 1) = X 2 − (−1 − 2m)X + m2 + m = X 2 + aX + b = f (X), co dowodzi, że f (m) = f (m + 1) = 0. Z3.C1 (1) Całkowitość liczby (x n ) dla wszystkich x ∈ N wynika natychmiast z jej interpretacji kombinatorycznej (zobacz KOM , gdzie przekonujemy się, że (N n ) jest równa l i c z b i e (całkowitej, nieujemnej) n-elementowych podzbiorów zbioru N -elementowego). Możemy to również zobaczyć sposobem arytmetycznym, zob. C2.49. Jeżeli x ∈ Z<0, to −x ∈ N i zachodzi oczywista równość (x n ) = 1 n! x(x − 1) · . . . · (x − n + 1) = (−1)n n! (−x + n − 1) · . . . · (−x) = (−1) n(−x + n − 1 n ) . Stąd (x n ) ∈ Z. (2) Z deﬁnicji (3.72) mamy natychmiast równość pochłaniania (X+1 n ) = X+1 n ( X n−1 ). Wyprowadzenie stąd równości (3.73) jest równie natychmiastowe. (3) Rozumujemy indukcyjnie wzglę- 3.6. Zadania dodatkowe 123 dem stopnia n. Baza indukcji jest jasna: wielomian stopnia 0 jest stałą α0. Rozważmy więc wielo- mian f (X) = a0 + a1X + · · · + anX n stopnia n ⩾ 1. Wówczas różnica f (X) − ann!(X n ) ma stopień ⩽ n − 1 i współczynniki w (tym samym co wielomian f (X)) ciele K. Istnieją więc (dzięki założeniu indukcyjnemu) takie jednoznacznie wyznaczone elementy α0, . . . , αn−1 ∈ K, że f (X) − ann! ( X n ) = α0 + α1 ( X 1 ) + . . . + αn−1 ( X n − 1 ). Widzimy stąd zachodzenie równości (3.74) (przy αn = ann!). Zobaczmy jak ma się rzecz z jednoznacz- nością: Gdyby, oprócz (3.74), zachodziła też równość f (X) = β0 + β1(X 1 ) + · · · + βn(X n ), to kładąc X = 0 (tzn., wyznaczając wartość dla argumentu 0) znajdujemy równość β0 = α0. Stąd, po odjęciu α0, dostajemy równość wielomianów α1(X 1 ) + · · · + αn(X n ) = β1(X n ) + · · · + βn(X n ). Tu kładziemy X = 1 i znajdujemy równość β1 = α1. Postępując tak dalej, kończymy rozwiązanie. U w a g a. (Dla znających język algebry liniowej.) Układ {X 0, X 1, X 2, . . . } jest bazą przestrzeni wektorowej K[X] (to jest tylko inny sposób deﬁnicji zbioru K[X]), zaś inną bazą tej samej przestrzeni jest układ{(X 0 ), (X 1 ), (X 2 ), . . . } . Co więcej, jeżeli przez Kn[X] oznaczymy podprzestrzeń wielomianów stopni ⩽ n, to jej bazą jest zarówno układ {X 0, X 1, . . . , X n} jak i układ {(X 0 ), (X 1 ), . . . , (X n )} . Z3.C2 (1) Zapisujemy (jednoznacznie!) nasz wielomian w postaci (3.74) i kładziemy kolejno X = 0 (to daje α0 ∈ Z), X = 1 (to daje α0+α1 ∈ Z, więc α1 ∈ Z), X = 2 (to daje α0+2α1+α2 ∈ Z, więc α2 ∈ Z), i tak dalej. Oczywista indukcja! (2) Wielomian g(X) := f (X+a) również ma stopień n (i współczynniki zespolone), oraz przyjmuje wartości całkowite dla n+1 argumentów 0, 1, . . . , n. To, jak widać z rozwiązania poprzedniego zadania, wystarcza do stwierdzenia całkowitości współczynników αj w jego zapisie w postaci (3.74). To, z kolei, dowodzi, że g(x) ∈ Z dla wszystkich x ∈ Z. Zatem i f (X) ma tę własność. Z3.C3 Mamy lemacik: L e m a t. Załóżmy, że ai ∈ Z, NWD (a0, a1, . . . , an) = 1 i, dla pewnej liczby wymiernej q ̸= 0, liczby qa0, qa1, . . . , qan są całkowite. Wówczas q ∈ Z. D o w ó d. Zapiszmy q = h/k w postaci nieskracalnej. I niech qai = ci ∈ Z. Czyli hai = kci. Stąd, na mocy ZTA, k|ai dla każdego i = 0, . . . , n. Względna pierwszość liczb ai pokazuje, że k = ±1. Q.e.d. Niech f (X) = a0 +a1X +· · ·+anX n, aj ∈ Z, i załóżmy, że liczba naturalna d ∈ N dzieli wszystkie elementy zbioru {f (k) : k ∈ N}. Wówczas wielomian 1 d f (X) ma współczynniki w y m i e r n e i przyjmuje dla argumentów całkowitych wartości całkowite. Zapiszmy go, zob. Z3.C2(1), w postaci 1 d f (X) = a0 d + a1 d X + . . . + an d X n = b0 + b1 (X 1 ) + · · · + bn ( X n ) , gdzie bi ∈ Z. Mnożąc tę równość przez n!, dostajemy równość n! d a0 + n! d a1X + . . . + n! d anX n = c0 + c1X + c2X(X − 1) + · · · + cnX(X − 1) · . . . · (X − n + 1), gdzie ci = bin! ∈ Z. Widać, że współczynniki stojące przy potęgach X k zmiennej X w wielomia- nie z prawej strony są liczbami całkowitymi. Zatem wszystkie liczby n! d ai są liczbami całkowitymi. Wystarczy teraz zastosować lemacik dla q = n!/d. Z3.C4 Rozważmy wielomian fk(X) := ∑k j=0 (−1)j(k j)(X+j k ) ∈ Q[X]. Pokażemy, że jest on wielo- mianem stałym (to znaczy stopnia ⩽ 0). Badamy w tym celu różnicę fk(X + 1) − fk(X). Mamy fk(X + 1) − fk(X) = k∑ j=0 (−1) j ( k j ) [(X + 1 + j k ) − ( X + j k )] = k∑ j=0 (−1) j ( k j ) ( X + j k − 1 ) . 124 3. Wielomiany Druga równość wynika z (3.73). Korzystając teraz z równości (k j) = (k−1 j ) + (k−1 j−1) konstytuujących trójkąt Pascala (zob. KOM ), które, nawiasem mówiąc, są równoważne równościom (3.73), mamy fk(X + 1) − fk(X) = k∑ j=0 (−1) j( k − 1 j )( X + j k − 1 ) + k∑ j=0 (−1) j( k − 1 j − 1 )(X + j k − 1 ) . Pierwszy składnik otrzymanej sumy jest równy fk−1(X). Drugi jest równy − ∑k−1 i=0 (−1)i(k−1 i )(X+1+i k−1 ), czyli fk−1(X + 1). Mamy więc fk(X + 1) − fk(X) = (−1)(fk−1(X + 1) − fk−1(X)) = . . . = (−1) k(f0(X + 1) − f0(X)) = 0. Udowodniona równość fk(X + 1) − fk(X) = 0 (po podstawieniu kolejno X = 0, 1, . . . , k) daje równości fk(0) = fk(1) = · · · = fk(k), z których, dzięki W1T3.4, wnioskujemy, że deg fk(X) = 0. Wielomian fk(X) jest więc wielomianem stałym. Dla zakończenia rozwiązania wystarczy wyznaczyć wartość fk(0). A ta jest równa (−1)k. Z3.D1 Niech f (k) = m2 i f (k + 1) = (m + 1)2. Wówczas 2m + 1 = f (k + 1) − f (k) = 2k + 1 + p. Stąd p = 2(m − k). Stąd m2 = f (k) = k2 + 2(m − k)k + q, więc q = (m − k)2. Zatem f (x) = x2 + 2(m − k)x + (m − k)2 = (x + m − k)2. Z3.D2 Teza zadania jest wprawdzie czysto teorioliczbowo-algebraiczna, rozwiązanie jednak wy- maga pewnej wiedzy analitycznej. Ponieważ f (n) jest kwadratem dla każdego n ∈ N, więc f (n) ⩾ 0 dla każdego n ∈ N. Zatem możemy określić funkcję g : N −→ Z⩾0 wzorem g(n) = √an2 + bn + c (pierwiastek arytmetyczny, tzn. nieujemny). Liczymy granicę limn→∞ [g(n + 1) − g(n)]. To się robi za pomocą metody standardowej: Zapisujemy g(n + 1) − g(n) = f (n + 1) − f (n) g(n + 1) + g(n) = 2an + a + b g(n + 1) + g(n) . Dzieląc licznik i mianownik przez n√a (uzasadniwszy przedtem, że a > 0) dostajemy równość g(n + 1) − g(n) = 2 √a + a+b n√a √1 + 2a+b an + a+b+c an2 + √ 1 + b an + c an2 , z której widać, że limx→∞ g(n + 1) − g(n) = √a. Ale ciąg liczb c a ł k o w i t y c h jest zbieżny tylko, gdy jest s t a ł y od pewnego miejsca. Mamy więc liczbę naturalną r := √ a ∈ N, dla której zachodzi równość g(n+1)−g(n) = r dla wszystkich n ⩾ n0. To oznacza, że ciąg g(n0), g(n0 +1), g(n0 +2), . . . jest ciągiem arytmetycznym o różnicy r. Zatem g(n0+k) = g(n0)+kr dla każdego k ∈ Z⩾0. Połóżmy x = n0 + k. Wówczas ax2 + bx + c = f (n0 + k) = g(n0 + k)2 = (g(n0) + kr)2 = (rx − rn0 + g(n0))2 dla wszystkich całkowitych x ⩾ n0. Widzimy więc dwa wielomiany: f (X) = aX 2 + bX + c i ̃f (X) = r2X + 2(g(n0) − rn0)rX + (g(n0) − rn0)2, które przyjmują tę samą wartość dla nieskończenie wielu argumentów. Zatem, zobacz W2T3.4, f (X) = ̃f (X), więc też f (x) = (rx + d)2 dla każdego x (gdzie d = g(n0) − rn0). Z3.D3 Jasne jest, że a ⩾ 0 (w przeciwnym przypadku f (x) byłaby liczbą u j e m n ą dla pew- nych x ∈ Z, a bikwadrat nigdy nie jest ujemny). Równie jasne jest, że c ⩾ 0 (bo c = f (0)). Załóżmy, nie wprost, że co najmniej jedna z liczb a, b jest różna od zera. Rozważmy (dużą) liczbę naturalną n i zbiór An = {f (0), f (1), . . . , f (n)}. Ten zbiór ma co najmniej n/2 elementów (dana wartość f (k) może być przyjęta dla jeszcze co najwyżej jednego argumentu, zobacz W1T3.4) i jest podzbiorem zbioru Bn = {0, 1, . . . , an2 + |b|n + c}. Ponadto każdy jego element jest bikwadratem. 3.6. Zadania dodatkowe 125 Ponieważ bikwadratów w zbiorze Bn jest co najwyżej 4√ an2 + |b|n + c + 1, więc mamy nierówność 4√ an2 + |b|n + c + 1 ⩾ n/2. Ta nierówność, równoważna nierówności an2 + |b|n + c ⩾ (n/2 − 1)4, jest niemożliwa dla dostatecznie dużych n. Uzyskana sprzeczność kończy rozwiązanie. Z3.D4 Załóżmy, nie wprost, że A(f ) jest niepusty i skończony. Niech k0 oznacza najmniejszy, a k1 największy element zbioru A(f ). Rozważmy wielomian g(X) = f (X + 1) − f (X). Wówczas g(k1), jako różnica f (k1 + 1) − f (k1) liczby całkowitej i niecałkowitej, jest liczbą niecałkowitą. Zatem k1 ∈ A(g). Jeżeli k > k1, to g(k) = f (k + 1) − f (k), jako różnica liczb całkowitych, jest liczbą całkowitą, więc k /∈ A(g). Podobnie, jeżeli k < k0 − 1, to k /∈ A(g). Podsumowując, mamy taki w n i o s e k: jeżeli A(f ) jest niepusty i skończony, to A(g) też jest niepusty i skończony. Ale deg(g) = deg(f )−1 < deg(f ). W ten sposób, po skończonej liczbie kroków, dojdziemy do wielomianu h stopnia 0, dla którego zbiór A(h) jest niepusty i skończony. Nonsens! U w a g a. Pokazane rozumowanie ma charakter z s t ę p o w a n i a, czyli desantu (nieskończonego). Można je zastąpić (jednocześnie uzasadniając(!) jego poprawność) przez rozumowanie oparte na Zasadzie Minimum. W aktualnym przypadku robimy to tak: skoro (założenie nie wprost) i s t n i e j ą brzydkie wielomiany (takie, dla których zbiór A(f ) jest skończony i niepusty), to istnieje też brzydki wielomian f0 n a j n i ż s z e g o stopnia. Wówczas wielomian f0(X + 1) − f0(X) jest jednocześnie brzydki i ładny. Z3.D5 Rozważ wielomian g(X) = f (X 2). Wielomian ten ma stopień 2n i dla 2n + 1 (kolejnych) argumentów całkowitych x = −n, −n + 1, . . . , n − 1, n przyjmuje wartość całkowitą. Zatem, zobacz Z3.C2(2), f (x2) = g(x) ∈ Z dla wszystkich x ∈ Z. Kontrprzykładów jest dużo, na przykład f (X) = X(X − 1)/12. Z3.D6 Załóżmy, że obraz f (Z) := {f (x) : x ∈ Z} jest, dla danego wielomianu f (X) ∈ Z[X], całym zbiorem Z. Niech, w szczególności, f (a) = 0 i f (b) = 1 dla danych a, b ∈ Z. Wówczas, zob. C3.4, b − a|f (b) − f (a), czyli b − a|1, więc |b − a| = 1. Jeżeli b = a + 1, to dowodzimy przez indukcję, że f (a + k) = k dla każdego k ∈ N. Wtedy, na mocy W2T3.4, f (a + X) = X, więc f (X) = X − a. Jeżeli b = a − 1, to podobnie dowodzimy, że f (X) = −X + a. Z3.E1 Zauważcie, że jeżeli u jest pierwiastkiem wielomianu f (X), to au jest pierwiastkiem wielomianu unormowanego g(X) = X 3 + bX 2 + acX + a2d (wystarczy w tym celu pomnożyć równość au3 + bu2 + cu + d = 0 przez a2 por. rozwiązanie Z3.8). Jeżeli więc wielomian f (X) ma trzy pierwiastki wymierne u1, u2, u3, to wielomian g(X) ma trzy pierwiastki wymierne au1, au2, au3, które w dodatku, zobacz T3.5, są liczbami całkowitymi. Oznaczmy je k1, k2, k3. Wtedy k1k2k3 = −a2d. Więc nieparzysta(!) liczba −a2d jest iloczynem trzech czynników k1, k2, k3. Zatem czynniki te są liczbami nieparzystymi. Przeto k1 +k2 +k3 = −b jest liczbą nieparzystą i k1k2 +k2k3 +k3k1 = ac jest liczbą nieparzystą. Więc i bac jest liczbą nieparzystą. To jest sprzeczne z założeniem bc ∈ 2Z. Z3.E2 S p o s ó b 1. Jeżeli α1, α2, α3 są pierwiastkami wielomianu f (X) = X 3 − 3X 2 − dX + c i dwa z nich są liczbami wymiernymi, to i trzeci jest liczbą wymierną (bo α1 + α2 + α3 = 3c ∈ Q), w dodatku są one wszystkie liczbami całkowitymi, zob. T3.5. Z tego wynika, że możemy przyjąć następujące założenie nie wprost: układ równań x + y + z = 3c, xy + yz + zx = −d, xyz = −c, gdzie c ̸= 0, ma rozwiązania w liczbach całkowitych, i szukać sprzeczności. Ponieważ druga z tych równości mówi tylko, że suma iloczynów liczb całkowitych jest liczbą całkowitą, więc sprzeczności musimy szukać w założeniach x, y, z ∈ Z, x + y + z = 3c, xyz = −c i c ̸= 0. Mamy 3|c| = |x + y + z| ⩽ |x| + |y| + |z| ⩽ |xyz| + |xyz| + |xyz| = 3|xyz| = 3|c|. Pierwsza nierówność jest nierównością trójkąta, a druga wynika z faktu, że |yz|, |xz|, |xy| ⩾ 1 (bo- wiem, na mocy xyz = −c ̸= 0, x, y, z ̸= 0). Stąd wynika, że obie nierówności są w rzeczywi- stości równościami. Pierwsza jest równością tylko w przypadku, gdy x, y, z są tego samego znaku (sprawdzić!), zaś druga jest równością tylko w przypadku, gdy |yz| = |xz| = |xy| = 1, czyli gdy |x| = |y| = |z| = 1. Może więc być tylko, albo x = y = z = −1, albo x = y = z = 1. 126 3. Wielomiany Obie możliwości prowadzą do sprzeczności ∓1 = c = ±1. S p o s ó b 2. Z Z2.4 wiemy, że wy- mierne pierwiastki (jeżeli istnieją) są w rzeczywistości liczbami c a ł k o w i t y m i będącymi dziel- nikami liczby c. Załóżmy (nie wprost), że liczby całkowite m ̸= n są pierwiastkami. Wówczas w(X) := X 3 − 3cX 2 − dX + c = (X − m)(X − n)(aX + b) (zobacz (3.5)). Stąd wynika, że a = 1, oraz że −b jest (całkowitym) pierwiastkiem wielomianu w(X). Ponadto −b|c (bo każdy całkowity pierwiastek tak czyni). Równość Vi`ete’a m + n − b = 3c i, wynikające z podzielności, nierówności |m| ⩽ |c|, |n| ⩽ |c|, | − b| ⩽ |c|, dowodzą, że m = n = −b = c. To jest sprzeczne z równością mn(−b) = −c (trzecią równością Vi`ete’a), bo c3 ̸= −c dla całkowitego, niezerowego c. Z3.E3 Wyróżnik (2c + 1)2 − 4c(2c − 1) = 4c2 + 4c + 1 − 8c2 + 4c = −4c2 + 8c + 1 jest nieujemny wtedy i tylko wtedy, gdy (2 − √5)/2 ⩽ c ⩽ (2 + √5)/2. Jeżeli c spełnia powyższe nierówności i c ̸= 0 (co oznacza ten warunek?), to pierwiastki x1, x2 są liczbami rzeczywistymi. Ze wzorów Vi`ete’a mamy wówczas: x1 + x2 = −(2c + 1)/c, x1 · x2 = (2c − 1)/c. Stąd (x1 − 1)(x2 − 1) = x1x2 − x1 − x2 + 1 = 2c − 1 c + 2c + 1 c + 1 = 5. Szukamy c a ł k o w i t y c h x1, x2. Jednoznaczność rozkładu (liczb całkowitych na iloczyn liczb pierw- szych, zobacz T2.16) i powyższa równość dają więc jedną z możliwości: { x1 − 1 = 1, x2 − 1 = 5, { x1 − 1 = 5, x2 − 1 = 1, { x1 − 1 = −1, x2 − 1 = −5, { x1 − 1 = −5, x2 − 1 = −1. Przeto, (x1, x2) = (2, 6), (6, 2), (0, −4) lub (−4, 0). Pierwsze dwie możliwości dają c = −1/10, a kolejne dwie, c = 1/2. Sprawdzenie, że te wartości c są dobre, opuszczamy. Z3.E4 Załóżmy, nie wprost, że α1, α2, . . . , αn są pierwiastkami (rzeczywistymi). Założenia an−1 = an−2 = 0, czyli (zobacz wzory Vi`ete’a) dają α2 1 + α2 2 + · · · + α2 n =   n∑ j=1 αj   2 − 2 ∑ i<j aiaj = (−an−1)2 − 2an−2 = 0. Zatem (pamiętamy o założeniu rzeczywistości liczb αj), wszystkie αj są równe 0. Stąd a0 = ±α1 · . . . · αn. Sprzeczność. Z3.E5 Sztuczka polega na zauważeniu, że jeżeli α1 < α2 < α3 są pierwiastkami wielomianu X 3 + aX 2 + bX + c, to średnie arytmetyczne β1 = (α1 + α2)/2, β2 = (α1 + α3)/2 i β3 = (α2 + α3)/2 są pierwiastkami wielomianu 8X 3 + 8aX 2 + 2(a2 + b)X + ab − c. Ponadto, oczywiście, β1, β2, β3 ∈ R i β1 < β2 < β3. Z3.E6 Niech f (X) = X 4 + X 3 − 1 = (X − α)(X − β)(X − γ)(X − δ). Równości f (α) = f (β) = 0 dają α3 = 1/(α + 1) i β3 = 1/(β + 1). Stąd (αβ)3 = 1/(α + 1)(β + 1) = (γ + 1)(δ + 1)/f (−1) = −(γ + 1)(δ + 1). Analogicznie (γδ)3 = −(α + 1)(β + 1). Wobec tego suma (αβ)3 + (γδ)3 + αβ + γδ + 1 jest równa −(γ + 1)(δ + 1) − (α + 1)(β + 1) + αβ + γδ + 1 = −1 − α − β − γ − δ = 0, ponieważ, zgodnie ze wzorem Vi`ete’a, α + β + γ + δ = −1. Stąd (αβ) 6 + (αβ)4 + (αβ) 3 − (αβ)2 − 1 = (αβ) 3 · ( (αβ)3 − ( 1 αβ )3 + αβ − 1 αβ + 1 ) = 0, ponieważ (toujour ce Fran¸cois Vi`ete!) αβγδ = −1. Z3.E7 Załóżmy, że α, β i αβ są pierwiastkami. Dzięki wzorom Vi`ete’a, mamy α+β+αβ = 0 oraz αβ +α2β +αβ2 = b/a i α2β2 = −c/a. Suma drugiej i trzeciej z tych równości dają αβ(1+α)(1+β) = (b − c)/a. Zaś pierwsza daje (1 + α)(1 + β) = 1. Stąd αβ = (b − c)/a ∈ Q. 3.6. Zadania dodatkowe 127 Z3.E8 Niech α1, . . . , αn będą pierwiastkami. Na mocy wzorów Vi`ete’a, α1 + · · · + αn = 1 oraz 1 α1 + · · · + 1 αn = ∑ 1⩽i1<···<in−1⩽n αi1 · . . . · αin−1 α1α1 · . . . · αn = (−1)n−1(−n2) (−1)n = n2. Dwukrotne zastosowanie nierówności AGH daje więc n2 = 1 · n2 = (α1 + · · · + αn) ( 1 α1 + · · · + 1 αn ) ⩾ n n√α1 · . . . · αn · n n √ 1 α1 · . . . · 1 αn = n2. W obu nierównościach AGH zachodzi więc r ó w n o ś ć. Stąd, jak wiadomo, mamy α1 = α2 = · · · = αn. Z3.E9 Pierwiastki α1, α2, α3 tworzą ciąg arytmetyczny wtedy i tylko wtedy, gdy jeden z nich jest średnią arytmetyczną dwóch pozostałych. Np. 2α3 = α1 + α2. Wówczas 3α3 = α1 + α2 + α3 = −a (zobacz wzory Vi`ete’a). I odwrotnie. Widzimy więc, że pierwiastki wielomianu f (X) tworzą ciąg arytmetyczny wtedy i tylko wtedy, gdy f ((−1/3)a) = 0. Czyli wtedy i tylko wtedy, gdy zachodzi równość (∗) 2a3−9ab+27c = 0. Musimy jeszcze dołożyć warunek gwarantujący rzeczywistość (należenie do R) pierwiastków. Otóż równości Vi`ete’a α1 +α2 +α3 = a i α1α2 +α2α3 +α3α1 = b, po podstawieniu α3 = −a/3 i uproszczeniu, dają równości α1 + α2 = −2a/3 i α2α3 = b − 2a2/9, które pokazują, zob. T3.9, że α1, α2 są pierwiastkami trójmianu kwadratowego X 2 + 2a 3 X +(b − 2a2 9 ). Ten trójmian ma wyróżnik ∆ = 4a2/9 − 4(b − 2a2/9) = (4/3)(a2 − 3b). Drugim poszukiwanym warunkiem jest więc nierówność (∗∗) a2 ⩾ 3b. Z3.E10 Załóżmy, że X n + cn−1X n−1 + · · · + c1X + c0 jest unormowanym (±1)-wielomianem i że α1, . . . , αn są jego pierwiastkami rzeczywistymi. Wówczas, przy n ⩾ 2, 1 − 2cn−2 = c 2 n−1 − 2cn−2 = α2 1 + · · · + α2 n ⩾ n n √ α2 1 · . . . · α2 n = nc 2/n 0 = n. Druga i trzecia równość wynikają ze wzorów Vi`ete’a, nierówność jest nierównością AG, a pierwsza i czwarta równość wynika z założenia ci = ±1. Otrzymana nierówność 1 − 2cn−2 ⩾ n implikuje równość cn−2 = −1 i nierówność n ⩽ 3. Wystarczy teraz sprawdzić, że wielomiany X − 1, X + 1, X 2 − X − 1, X 2 + X − 1 oraz X 3 − X 2 − X + 1 i X 3 + X 2 − X − 1 są dobre. Dalszych sześć dobrych wielomianów dostaniemy biorąc wielomiany przeciwne do wypisanych. Z3.E11 Żądany ciąg budujemy i n d u k c y j n i e. Niech a0 = −1, a1 = 1. Ponieważ wielomian a0 + a1X = −1 + X ma pierwiastek rzeczywisty, więc początek (indukcji) jest zrobiony. Dla zrobienia kroku indukcyjnego załóżmy, że mamy wielomian fn(X) := a0 + a1X + · · · + anX n mający n różnych pierwiastków rzeczywistych λ1 < λ2 < · · · < λn i spełniający (dodatkowo) warunek (−1)n−1an > 0. Ustalamy takie liczby c0, c1, . . . , cn, że c0 < λ1 < c1 < λ2 < · · · < cn−1 < λn < cn. Wówczas, oczywiście, fn(c0) < 0, fn(c1) > 0, fn(c2) < 0, itd (ciąg oscylujący wokół zera). Oznaczmy M = max{|fn(c0)|, |fn(c1)|, . . . , |fn(cn)|}. Dobieramy taką liczbę an+1, by: (1) anan+1 < 0, (2) |an+1| < M/(2|c n+1 k |) dla każdego k = 0, 1, . . . , n. To jest możliwe! Wówczas wielomian fn+1(X) := fn(X) + an+1X n+1 dla argumentów ck przyjmuje wartości tych samych znaków co wielomian fn(X) (ma więc pierwiastki w każdym przedziale ( ck; ck+1 ), zob. 3.2.6 U2). Łatwo też uzasadnić istnienie jeszcze jednego pierwiastka na prawo od cn. Z3.E12 Piszemy rozkład (3.34) (pamiętamy, że C = 1). Kładziemy X = i i liczymy moduł: 1 > |f (i)| = |i − a1|e1 · . . . · |i − ar| er · |(i − b1) 2 + c 2 1|d1 · . . . · |(i − bs) 2 + c 2 s|ds. 128 3. Wielomiany Ponieważ czynniki |i − ak|ek są ⩾ 1 (moduł |i − ak| jest odległością liczby r z e c z y w i s t e j ak od liczby i = √ −1), więc co najmniej jeden z czynników |(i − bl)2 + c2 l | musi być < 1. Liczba zespolona b + ic = bl + icl jest pierwiastkiem czynnika (X − bl)2 + c2 l wielomianu f (X), więc jest też, oczywiście, pierwiastkiem tego wielomianu. Mamy więc 1 > |(i − b)2 + c2|2 = [(i − b)2 + c2] · [(−i − b)2 + c2] = [c2 + b2 + 1 − 2bi] · [c2 + b2 + 1 + 2bi], co jest dowodzoną nierównością. Z3.E13 Z założeń wynika istnienie takiego 1 ⩽ k < n, że rn−k > 0. Wówczas xn − r(x) xn = rn−1 x + rn−2 x2 + · · · + r1 xn−1 + r0 xn ⩾ rn−k xk > 1 dla dowolnego 0 < x < k√rn−k. Stąd wynika, że r(x) < 0 dla wszystkich tych x. Z drugiej strony, dla x > max{nrn−1, 2√nrn−2, . . . , n−1√nr1, n√nr0} mamy xn = xk xn−k > nrn−kxn−k przy każdym k = 1, . . . , n, skąd, po zsumowaniu, nxn > n ∑n k=1 rn−kxn−k. Więc r(x) > 0 dla tych x. Przysługująca wielomianom rzeczywistym własność Darboux pokazuje więc istnienie pierwiastka do- datniego ϱ. Ponadto, jeżeli x > ϱ, to r(x) xn = r(x) xn − r(ϱ) ϱn = [1 − n∑ k=1 rn−kx−k] − [1 − n∑ k=1 rn−k ϱ −k] = n∑ k=1 rn−k ( 1 ϱk − 1 xk ) > 0, czyli r(x) > 0 dla wszystkich takich x. Jasne, że to kończy rozwiązanie. Z3.E14 (Nierówność lewa) Równość f (λ) = 0 zapisujemy tak: −λn = an−1λn−1 + · · · + a1λ + a0. Stąd, na mocy C1.23, |λ|n = | − λn| = |an−1λn−1 + · · · + a1λ + a0| ⩽ |an−1| · |λ| n−1 + · · · + |a1| · |λ| + |a0|. Otrzymaną nierówność zapiszmy w postaci r(x) = xn − (rn−1xn−1 + · · · + r1x + r0) ⩽ 0, gdzie położyliśmy x = |λ| i rs = |as| dla s = 0, . . . , n − 1. Dowodzona nierówność jest oczywista, gdy λ = 0. Załóżmy więc, że λ ̸= 0, czyli f (X) ̸= X n. Wówczas, jak wiemy z Z3.E13, nierówność r(x) ⩽ 0 może zachodzić tylko, gdy x ⩽ ϱ0. Mamy więc nierówność |λ| ⩽ ϱ0 dla każdego niezerowego pierwiastka wielomianu f (X). (Nierówność prawa) Niech b = 2 max { k√ |an−k| : k = 1, . . . , n}. Wówczas b ⩾ 2 k√ |an−k| dla każdego k = 1, . . . , n, czyli |an−k| ⩽ bk/2k. Stąd r(b) = b n − |an−1|b n−1 − · · · − |a1|b − |a0| ⩾ b n ( 1 − 1 2 − 1 22 − · · · − 1 2n ) = bn 2n . Więc r(b) > 0, gdy b > 0 (zauważmy, że równość b = 0 może zachodzić tylko, gdy f (X) = X n, a wtedy wszystko jest oczywiste). Wobec tezy Z3.E13, oznacza to, że b > ϱ0. Z3.E15 Niech Ak := ak an dla 0 ⩽ k < n. Wielomian g(X) = A0 + A1X + · · · + An−1X n−1 + X n ma oczywiście te same pierwiastki co f (X). Poza tym M = max {|A0|, . . . , |An−1|}. (1) Jeżeli |λ| ⩽ 1, to teza jest prawdziwa. Załóżmy więc, że dla pewnego pierwiastka λ wielomianu f (X) zachodzi |λ| > 1. Równość −λn = A0 + A1λ + · · · + An−1λn−1 jest inaczej zapisaną równością g(λ) = 0. Stąd, na mocy C1.23 i tożsamości nieśmiertelnej, |λ| n = \f \fA0 + · · · + An−1λn−1\f \f ⩽ M (1 + |λ| + · · · + |λ|n−1) = M |λ|n − 1 |λ| − 1 < M |λ|n |λ| − 1 . Przeto |λ| − 1 < M . (2) Niech λ ̸= 0 będzie pierwiastkiem g(X). Równość g(λ) = 0 zapisujemy tak: 1 + An−1 λ = −An−2 λ2 + −An−3 λ3 + . . . + −A0 λn . 3.6. Zadania dodatkowe 129 Stąd, na mocy nierówności trójkąta z C1.23 i nierówności | − Ak| ⩽ M , \f \f \f \f1 + An−1 λ \f \f \f \f ⩽ | − A0| |λn| + | − A1| |λn−1| + . . . + | − An−2| |λ2| ⩽ M |λ|2 ( 1 |λ|n−2 + 1 |λ|n−3 + . . . + 1) . Załóżmy teraz, że |λ| > 1. Wówczas suma w nawiasie z prawej strony jest (ściśle) mniejsza niż suma 1/(1−q) zbieżnego szeregu geometrycznego ∑ k⩾0 qk o ilorazie q = 1/|λ| < 1. Mamy więc nierówność |1+An−1/λ| < M/(|λ|2−|λ|). Z drugiej strony mamy (geometrycznie) oczywistą nierówność Re z ⩽ |z| dla każdej liczby zespolonej (algebraicznie jest ona oczywistą nierównością a ⩽ √ a2 + b2). To daje 1 + Re An−1 λ = Re ( 1 + An−1 λ ) ⩽ \f \f \f \f1 + An−1 λ \f \f \f \f < M |λ|2 − |λ| . Teraz wykorzystamy założenie Re λ ⩾ 0. Wówczas Re (An−1/λ) ⩾ 0 (bo An−1 ⩾ 0). Dostajemy więc nierówność 1 < M/(|λ|2 − |λ|), czyli nierówność |λ|2 − |λ| − M < 0, która oznacza, że liczba |λ| leży między pierwiastkami 1−√1+4M 2 i 1+ √1+4M 2 trójmianu kwadratowego x2 − x − M . Z3.F1 Jeżeli α /∈ Z i fi(α) = 0, to α /∈ Q, zob. T3.5. Równość α2+a1α+b1 = α2+a2α+b2 (= 0) daje (a1−a2)α = b2−b1. Stąd, w przypadku a1−a2 ̸= 0, dostalibyśmy równość α = (b2−b1)/(a1−a2). Ale ona jest niemożliwa, bo α /∈ Q. Więc a1 = a2. Stąd też b1 = b2. Z3.F2 Niech f (α) = g(α) = 0 i niech d(X) = NWD (f (X), g(X)). Wtedy, zobacz T3.11, d(X) = f (X)s(X) + g(X)t(X). Zatem d(α) = f (α)s(α) + g(α)t(α) = 0, zob. Z1.6. Odwrotnie, jeżeli d(α) = 0, to, ponieważ d(X)|f (X), czyli f (X) = d(X)k(X), więc f (α) = d(α)k(α) = 0. I, podobnie, g(α) = 0. Z3.F3 (1) W rozwiązaniu zadania Z3.9 widzieliśmy, że R(f1, f2) = f1(ϕ2)f1(ψ2), gdzie ϕ2, ψ2 oznaczają pierwiastki trójmianu f2(X). Tak samo sprawdzamy, że R(f1, f2) = f2(ϕ1)f2(ψ1). To kończy dowód tezy (1). Przechodzimy do tezy (2). Warunek R(f1, f2) < 0 oznacza, w szczególności, że a1 ̸= a2. Liczymy wartości f1(ξ), f2(ξ) przy ξ = (b2 − b1)/(a1 − a2): f1(ξ) = ( b2 − b1 a1 − a2 )2 + a1 b2 − b1 a1 − a2 + b1 = R(f1, f2) (a1 − a2)2 = ( b2 − b1 a1 − a2 )2 + a2 b2 − b1 a1 − a2 + b2 = f2(ξ). Zatem f1(ξ) = R(f1, f2)/(a1 − a2)2 < 0. To dowodzi, że f(X) ma d w a pierwiastki rzeczywiste (leżące po różnych stronach ξ). Również f2(X) ma dwa różne pierwiastki. Ponadto, nierówność f1(ϕ2)f1(ψ2) < 0 dowodzi, na mocy T3.7(3), że jeden pierwiastek trójmianu f1(X) leży gdzieś między ϕ2 a ψ2. I wzajemnie. Z3.F4 Niech d(X) ∈ Q[X] oznacza największy wspólny dzielnik wielomianów f (X) i g(X). Wówczas, zobacz Z3.F2, d(α) = 0. Podkreślamy wyraźnie i mocno, że d(X) ma współczynniki wymierne! Wielomian stopnia ⩽ 1 o współczynnikach wymiernych n i e ma pierwiastków niewymier- nych! Zatem deg d(X) ⩾ 2. Jeżeli deg d(X) = 2, to drugi pierwiastek β wielomianu d(X) jest wspólnym pierwiastkiem wielomianów f (X), g(X). Ponadto, β ̸= α (gdyby β = α, to, ponieważ α + β jest, na mocy wzoru Vi`ete’a, liczbą wymierną, więc i α byłaby liczbą wymierną, wbrew zało- żeniu). Pozostał nam do rozważenia przypadek, gdy deg d(X) = 3. Wówczas f (X) ∼ g(X) ∼ d(X), więc k a ż d y pierwiastek wielomianu f (X) jest też pierwiastkiem wielomianu g(X). Mamy więc rozkłady f (X) = a(X − α)(X − β)(X − γ) i g(X) = b(X − α)(X − β)(X − γ) dla pewnych liczb wymiernych a, b i pewnych liczb z e s p o l o n y c h β, γ. Gdyby β = α = γ, to, na mocy wzoru Vi`ete’a, byłoby 3α = α + β + γ ∈ Q, więc i α ∈ Q, co nie ma miejsca. Musi być więc β ̸= α lub γ ̸= α. To p r a w i e kończy rozwiązanie zadania. Z3.F5 Jeżeli c = k3, to f (k) = 0 dla f (X) = X(X − k) = X 2 − kX. Dla dowodu wynikania odwrotnego, załóżmy, że f ( 3√c) = 0, gdzie f (X) ∈ Z[X] i deg f (X) = 2. Wówczas 3√ c jest 130 3. Wielomiany wspólnym pierwiastkiem wielomianu f (X) i wielomianu X 3 − c. Dzieląc (z resztą) X 3 − c przez f (X), dostajemy równość X 3 − c = q(X)f (X) + r(X), gdzie r(X) jest wielomianem stopnia ⩽ 1 o współczynnikach wymiernych. Obliczając wartość wielomianów z obu stron tej równości dla argumentu 3√ c, dostajemy równość r( 3√c) = 0. Czyli, ponieważ r(X) = aX + b ∈ Q[X], 3√c = −b/a ∈ Q. Wystarczy się teraz powołać na C2.19. Z3.G0 (−α − β − γ)2 ⩾ 3(αβ + βγ + γα) ⇐⇒ 1 2 (α − β)2 + 1 2 (β − γ)2 + 1 2 (γ − α)2 ⩾ 0. Z3.G1 Zauważmy najpierw, że a ̸= 0 (gdy a = 0, to wielomian f (X) = bX + b ma trzy pierwiastki tylko, gdy jest wielomianem zerowym (b = 0), ale wówczas ma więcej niż trzy pierwiastki). Zauważmy teraz, że żaden z pierwiastków α, β, γ nie jest równy 0. W przeciwnym razie, na mocy wzoru Vi`ete’a b = −aαβγ = 0 i wtedy f (X) = aX 3 − aX 2 wprawdzie ma trzy pierwiastki, ale n i e są one różne (pierwiastek 0 jest podwójny). Reszta rozwiązania jest natychmiastowa: Ze wzorów Vi`ete’a wiemy, że α + β + γ = 1, αβ + βγ + γα = b a i αβγ = − b a . Stąd: 1 α + 1 β + 1 γ = βγ+γα+αβ αβγ = −1. Z3.G2 Niech, jak zwykle, f (X) = (X − a)(X − b)(X − c)(X − d) = X 4 − σ1X 3 + σ2X 2 − σ3X + σ4. Równość f (a) = 0 zapisujemy tak: a4 = σ1a3 − σ2a2 + σ3a − σ4. Podobnie zapisujemy równości f (b) = 0, f (c) = 0 i f (d) = 0. Dodając otrzymane cztery równości stronami dostajemy: a 4 + b 4 + c 4 + d 4 = σ1(a 3 + b 3 + c 3 + d 3) − σ2(a 2 + b 2 + c 2 + d 2) + σ3(a + b + c + d) − 4σ4. Stąd, i z założeń m|σ1, m|a2 + b2 + c2 + d2, natychmiast mamy tezę. U w a g a. Podobnie dowodzimy, że jeżeli liczba naturalna m dzieli sumę pięciu liczb całkowitych i sumę ich kwadratów, to suma piątych potęg tych liczb daje tę samą resztę co pięciokrotność ich iloczynu przy dzieleniu przez m. Z3.G3 Nierówność lewa jest oczywista: 2αβγ ⩽ 3αβγ ⩽ αβγ + αβγ + αβγ ⩽ αβ + βγ + γα. Dla dowodu prawej badamy wielomian f (X) = (X − α)(X − β)(X − γ) = X 3 − X 2 + qX + r. Mamy udowodnić, że q + 2r ⩽ 7 27 , lub, co jest równoważne, że ( 1 2 − α)( 1 2 − β)( 1 2 − γ) = f ( 1 2 ) ⩽ 1 216 . Otóż, gdy któryś (co najwyżej jeden(!)) z pierwiastków jest ⩾ 1 2 , mamy f ( 1 2 ) ⩽ 0 ⩽ 1 216 , gdy zaś wszystkie są < 1/2, to, stosując nierówność AG, mamy 3√ f (1/2) ⩽ 1 3 (( 1 2 − α) + ( 1 2 − β) + ( 1 2 − γ)) = 1 6 . Z3.G4 Założenia a|b2 + 1 i b|a2 + 1 dają podzielność ab|(a2 + 1)(b2 + 1) czyli ab|a2b2 + a2 + b2 + 1, więc (zob. Zasada Podstawowa) ab|a2 + b2 + 1. Teraz patrz C3.17. Z3.G5 Niech α = a b , β = b c i γ = c a . Wówczas α + β + γ ∈ Z, αβγ = 1 ∈ Z. A także αβ + βγ + γα = a c + b a + c b jest liczbą całkowitą. Zatem wielomian (X − α)(X − β)(X − γ) ma współczynniki całkowite, jest unormowany i ma pierwiastki wymierne α, β, γ. Zatem, zobacz T3.5, α, β, γ są liczbami całkowitymi. Czyli b|a, c|b i a|c. Więc |b| ⩽ |a| ⩽ |c| ⩽ |b|. Stąd teza. Z3.G6 Udowodnimy twierdzenie ogólniejsze: Jeżeli m, n ∈ N są liczbami nieparzystymi, a α, β, γ są takimi liczbami, że wszystkie napisane ułamki mają sens (tzn., mianowniki są różne 0), to 1 αm + βm + γm = 1 αm + 1 βm + 1 γm ⇐⇒ 1 αn + βn + γn = 1 αn + 1 βn + 1 γn . (∗) Niech f (X) = (X − αm)(X − βm)(X − γm) = X 3 − pX 2 + qX − r będzie wielomianem, którego pier- wiastkami są αm, βm, γm. Załóżmy, że zachodzi równość 1 αm+βm+γm = 1 αm + 1 βm + 1 γm . Zapisujemy ją w postaci 1 −p = q −r , czyli r = pq. Stąd f (X) = X 3 − pX 2 + qX − pq = X 2(X − p) + q(X − p) = (X − p)(X 2 + q). Widać, że p = αm + βm + γm jest pierwiastkiem wielomianu f (X). Ale jedy- nymi pierwiastkami wielomianu f (X) są αm, βm, γm, więc suma αm + βm + γm jest równa jednej z liczb αm, βm, γm. Zatem suma pewnych dwóch z liczb αm, βm, γm jest równa 0, na przykład αm + βm = 0. Więc (tu korzystamy z założenia nieparzystości m) α = −β. Wówczas, oczywiście, zachodzi równość z lewej strony (∗). 3.6. Zadania dodatkowe 131 Z3.G7 Znowu ﬁlozoﬁa Vi`ete’ a! Niech (x1, . . . , xn) będzie rozwiązaniem i niech f (X) będzie odpowiednim wielomianem: f (X) = (X − x1) · . . . · (X − x1) = X n + an−1X n−1 + · · · + a1X + a0. Mnożąc k-tą równość przez ak−1 (pamiętamy, że an = 1) i dodając, dostajemy równość 0 = f (x1) + f (x2) + · · · + f (xn) = na0 + na1 + · · · + nan−1 + n = nf (1). Stąd widzimy, że liczba 1 jest pierwiastkiem wielomianu f (X). Czyli: k t ó r e ś xj jest równe 1. Oczywista indukcja pokazuje więc, że (x1, . . . , xn) = (1, . . . , 1). Z3.G8 Niech B(k) := {(x, y) ∈ N × N : x2 + y2 = k(xy − 1)}. (1) Pokaż, że B(1) = B(2) = ∅. Załóż więc, że k ⩾ 3 i że B(k) ̸= ∅. (2) Ze wszystkich par (x, y) należących do B(k) wybierz (Zasada Minimum!) parę o najmniejszym y. Niech (a, b0) będzie taką parą. (3) Wykaż, że a ̸= b0, więc a > b0. (4) Rozważ trójmian f (X) = X 2 − kb0X + b2 0 + k i wykonaj skok Vi`ete’ a a 7→ ̃a. (5) Wykaż, że ̃a ̸= a (wyróżnik trójmianu f (X) jest niezerowy!). Załóż (b.s.o.), że b0 < a < ̃a. (6) Z równości Vi`ete’a (a + ̃a = kb0, ãa = b2 0 + k) wywnioskuj, że b2 0 + k − kb0 = (a − 1)(̃a − 1) − 1 ⩾ b0(b0 + 1) − 1. Dostaniesz stąd nierówność (b0 − 1)(k + 1) ⩽ 0, z której łatwo zobaczyć, że b0 = 1. (7) Więc a + ̃a = k, ãa = k + 1, skąd natychmiast dostaniesz a = 2, ̃a = 3, k = 5. U w a g a. (321, 67) ∈ B(5). Z3.H1 Nieujemność współczynników implikuje ujemność (ścisłą, bo a0 = 1) pierwiastków. Niech −αi, przy i = 1, . . . , n, będą tymi pierwiastkami. Wówczas f (x) = (x + α1) · . . . · (x + αn) dla każdego x ∈ R. Zatem f (2) = (2 + α1) · . . . · (2 + αn). Ale 2 + αi = 1 + 1 + αi ⩾ 3 3√1 · 1 · αi (nierówność AG). To, po wymnożeniu i wykorzystaniu równości Vi`ete’a α1 · . . . · αn = 1, daje tezę. Z3.H2 Napiszmy wielomian interpolacyjny dla argumentów αk = sk i wartości βk = f (sk), zob. T3.23. Wówczas gk(X) = (X − s0)(X − s1) · . . . · (X − sn) (sk − s0)(sk − s1) · . . . · (sk − sn) =: ∏ j̸=k X − sj sk − sj , gdzie w liczniku jest opuszczony czynnik (X − sk), a w mianowniku czynnik (sk − sk). Widać stąd, że wielomian (n-tego stopnia) gk(X) ma współczynnik (gk)n przy X n równy ∏j̸=k (sk − sj)−1. Oszacujemy wartość tego współczynnika. Łatwo widać, że założenia s0 < s1 < · · · < sn i sk ∈ Z, implikują nierówności |sk − sj| ⩾ |k − j|. Stąd |(gk)n| = ∏ j̸=k 1 |sk − sj| = ∏ j<k 1 |sk − sj| · ∏ j>k 1 |sk − sj| ⩽ ∏ j<k 1 |k − j| · ∏ j>k 1 |k − j| = 1 k!(n − k)! . Jak zwykle, iloczyn pusty (bez czynników) uznajemy za równy 1 (por. równość 0! = 1). Załóżmy teraz, nie wprost, że dla każdego k = 0, . . . , n zachodzi nierówność |f (sk)| < n!/2n. Wówczas, ponieważ zachodzi równość f (X) = ∑n k=0 f (sk)gk(X), zobacz tezę o jednoznaczności w T3.23, z której wynika równość 1 = ∑n k=0 f (sk)(gk)n (bo f (X) jest unormowany), mamy 1 = | n∑ k=0 f (sk)(gk)n| ⩽ n∑ k=0 |f (sk)| · |(gk)n| < n∑ k=0 n! 2n · 1 k!(n − k)! = 1 2n · n∑ k=0 ( n k ) = 2n 2n = 1. Uzyskana sprzeczność kończy rozwiązanie. Z3.H3 Wykorzystamy twierdzenie T3.23. Dzięki niemu (wybierając αk = k − n, βk = f (k), przy 0 ⩽ k ⩽ 2n) zapisujemy wielomian f (X) w postaci f (X) = ∑n k=−n f (k)gk(X), gdzie gk(X) = ∏ j̸=k X − j k − j = ∏k−1 j=−n (X − j) · ∏n j=k+1 (X − j) ∏k−1 j=−n (k − j) · ∏n j=k+1 (k − j) = ∏k−1 j=−n (X − j) · ∏n j=k+1 (X − j) (n + k)! · (−1)n−k(n − k)! . 132 3. Wielomiany Weźmy teraz dowolną liczbę x ∈ [ −n; n ] i oszacujmy licznik ułamka gk(x). Jego wartość bez- względna jest równa iloczynowi 2n czynników ∏k−1 j=−n |x − j| · ∏n j=k+1 |x − j|, które można ustawić według ”wzrostu”. W ten sposób łatwo widzieć, że jest on ⩽ (2n)!. Podsumowując otrzymamy: |f (x)| ⩽ n∑ k=−n |f (k)| · |gk(x)| ⩽ n∑ k=−n (2n)! (n + k)!(n − k)! = 2n∑ l=0 (2n l ) = (1 + 1)2n = 2 2n. Z3.H4 B.s.o. zakładamy, że a ⩾ 0 (gdy a < 0 możemy zamiast wielomianu f (X) := aX 2+bX +c patrzeć na wielomian −f (X)). Również możemy założyć, że b ⩾ 0 (gdy b < 0 możemy patrzeć na wielomian f (−X)). Mamy |f (−1)| ⩽ 1, |f (0)| ⩽ 1 i |f (1)| ⩽ 1, czyli |a − b + c| ⩽ 1, |c| ⩽ 1 i |a + b + c| ⩽ 1. Stąd wyprowadzamy dwie nierówności: (i ) |a + b| ⩽ 2, (ii ) |a − b| ⩽ 2. Rzeczywiście: |a + b| = |a + b + c − c| ⩽ |a + b + c| + | − c| ⩽ 2 i |a − b| = |a − b + c − c| ⩽ |a − b + c| + | − c| ⩽ 2. Załóżmy teraz, że c ⩾ 0. Wówczas 0 ⩽ cx2 ⩽ c dla |x| ⩽ 1. I mamy: −2 ⩽ a − b = 0 − b + c ⩽ cx 2 + bx + a ⩽ c + b + a = f (1) ⩽ 1 ⩽ 2, gdzie pierwsza nierówność wynika z (ii ), a druga z oczywistej (przy |x| ⩽ 1) nierówności −b ⩽ bx ⩽ b. Podobnie działamy w przypadku c ⩽ 0 (wtedy c ⩽ cx2 ⩽ 0): −2 ⩽ −1 ⩽ f (−1) = a − b + c ⩽ a + bx + cx 2 ⩽ a + b + 0 ⩽ 2. Koniec! U w a g a. Nierówności |cX 2 + bx + a| ⩽ 2 nie da się polepszyć. Przykład: f (X) = 2X 2 − 1. Z3.H5 Wielomian f (X) = 1 2 [(2X − 1)n + 1] przy dostatecznie dużych n, j e s t dobry. Z3.I1 Oznaczmy fn(X) = (X + 1)2n+1 + X n+2 i Φ3(X) = X 2 + X + 1. S p o s ó b 1. Indukcja względem n. Wygodnie ją zacząć od n = 0. Wtedy baza indukcji jest oczywista. Załóżmy więc, że Φ3(X)|fn(X) i zapiszmy fn(X) = g(X)Φ3(X). Wówczas fn+1(X) = (X + 1)2[fn(X) − X n+2] + X n+3 = (X + 1)2g(X)Φ3(X) + X n+2[X − (X + 1)2]. Ponieważ X − (X + 1)2 = −Φ3(X), więc koniec. S p o s ó b 2. Sprawdzamy, że ω = ω3 jest pier- wiastkiem wielomianu fn(X). Korzystamy z twierdzenia o strażakach. Mamy więc ω + 1 = −ω2. Stąd fn(ω) = (ω + 1)2n+1 + ωn+2 = (−ω2)2n+1 + ωn+2 = −ω4n+2 + ωn+2 = −ω3nωn+2 + ωn+2 = −ωn+2 + ωn+2 = 0. Równie łatwo widać, że fn(ω2) = 0. Zatem (X − ω)(X − ω2) = Φ3(X) dzieli fn(X). Zobacz też Z3.20. Z3.I2 Rozkładamy wielomian d(X) = X 2 − 2(cos ϕ)X + 1 na czynniki nierozkładalne. Ponieważ ∆ = 4 cos2 ϕ − 4 = −4 sin 2 ϕ, więc √∆ = 2i sin ϕ. Wobec tego pierwiastkiem wielomianu d(X) jest liczba α = cos ϕ + i sin ϕ i, zobacz też 3.4.4 L3.2, liczba sprzężona α = cos ϕ − i sin ϕ. Mamy więc d(X) = (X − α)(X − α). Ponieważ α ̸= α (bo, przy narzuconych założeniach, α nie jest liczbą rzeczywistą), więc wielomiany X − α i X − α są względnie pierwsze. Dla wykazania podzielności d(X)|f (X), gdzie f (X) = (sin ϕ)X n − (sin nϕ)X + sin(n − 1)ϕ, wystarczy więc sprawdzić, że zarówno X − α|f (X) jak i X − α|f (X). Czyli, że zarówno f (α) = 0 jak i f (α) = 0, zobacz T3.2. Ponieważ, zobacz 3.4.4 L3.2, druga równość jest wnioskiem z pierwszej, więc sprawdzamy tylko tę pierwszą. Korzystamy przy tym ze wzoru de Moivre’a, zobacz (1.14). Mamy f (α) = sin ϕ(cos nϕ + i sin nϕ) − sin nϕ(cos ϕ + i sin ϕ) + sin(n − 1)ϕ = 0, co jest równoważne równości sin(n − 1)ϕ = sin nϕ cos ϕ − sin ϕ cos nϕ. Z3.I3 Rozkładamy, zgodnie z C3.50, wszystkie występujące wielomiany X a − 1 na czynniki cy- klotomiczne. Wówczas dostaniemy I(a; k) := (X a+1 − 1)(X a+2 − 1) · . . . · (X a+k − 1) = k∏ j=1 ∏ d|a+j Φd(X) 3.6. Zadania dodatkowe 133 dla dowolnej liczby naturalnej a. Zastanawiamy się ile razy dany wielomian Φd(X) występuje jako czynnik w iloczynie z prawej strony tej równości. Odpowiedź jest jasna: tyle razy ile jest wyrazów podzielnych przez d w ciągu (a+1, a+2, . . . , a+k). Ponieważ wyrazów podzielnych przez d w ciągu (1, 2, . . . , a + k) jest, oczywiście, dokładnie ⌊(a + k)/d⌋, a wyrazów podzielnych przez d w ciągu (1, 2, . . . , a) jest ⌊a/d⌋, więc w ciągu (a+1, a+2, . . . , a+k) występuje dokładnie ⌊(a+k)/d⌋−⌊a/d⌋ wyrazów podzielnych przez d. Dla dowodu naszej tezy, czyli podzielności I(0; k)|I(n; k), wystarczy zatem udowodnić, że dla każdej liczby naturalnej d zachodzi nierówność ⌊(n + k)/d⌋ − ⌊n/d⌋ ⩾ ⌊k/d⌋ − ⌊0/d⌋. Ta nierówność jest przypadkiem szczególnym nierówności ⌊x + y⌋ ⩾ ⌊x⌋ + ⌊y⌋ prawdziwej dla dowol- nych liczb rzeczywistych x, y, zobacz też C12.1.5. Z3.I4 Dzielna jest równa X (k+1)n−1 X n−1 , a dzielnik X k+1−1 X−1 . Chcemy wyznaczyć takie liczby naturalne k, n, dla których funkcja wymierna (zobacz C3.51) (X − 1)(X (k+1)n − 1) (X n − 1)(X k+1 − 1) = Φ1(X) · ∏d|(k+1)n Φd(X) ∏d|n Φd(X) · ∏d|k+1 Φd(X) jest w istocie równa wielomianowi. To z pewnością będzie miało miejsce, gdy każdemu wystąpieniu czynnika Φd(X) w mianowniku towarzyszy wystąpienie tego czynnika w liczniku. Twierdzimy, że tak jest na pewno, gdy NWD (k + 1, n) = 1 (to jest jasne, bo wtedy dany czynnik Φd(X), dla d ̸= 1, z mianownika występuje dokładnie raz: albo w pierwszym, albo w drugim z napisanych tam iloczynów). I tak na pewno n i e jest, gdy istnieje wspólny (różny od 1) dzielnik liczb n i k + 1 (niech bowiem p ∈ P będzie takim wspólnym dzielnikiem, wtedy n i e r o z k ł a d a l n y czynnik Φp(X) występuje dwukrotnie w mianowniku i tylko jednokrotnie w liczniku). Z3.I5 Załóżmy, że f (X) = c + bX + X 2 ∈ Z jest dzielnikiem (±1)-wielomianu, czyli że zachodzi równość (c + bX + X 2)h(X) = c0 + c1X + . . . + cnX n dla pewnego wielomianu h(X) ∈ Z[X]. Z równości tej wynika, oczywiście, równość c = ±1. Korzystamy teraz z tezy Z3.E14(1). Dzięki niej wiemy, że wszystkie pierwiastki u (zespolone, w szczególności rzeczywiste!) (±1)-wielomianu spełniają warunek |u| < 2. Wobec tego również jego dzielnik f (X) może mieć tylko pierwiastki spełniające ten warunek. Stąd widzimy, że f (−2) > 0, f (2) > 0 (w przeciwnym wypadku w przedziale [ −2; 2 ] znalazłby się pierwiastek, zob. T3.7). Wyznaczamy więc pary (b, c) liczb całkowitych, dla których c = ±1 i zachodzą nierówności 4 − 2b + c > 0 oraz 4 + 2b + c > 0. Takich par jest osiem. Równości (1−2X +X 2)(1+X) = 1−X −X 2+X 3, (1+2X +X 2)(−1+X) = −1−X +X 2+X 3, (1+X 2)(1+X) = 1 + X + X 2 + X 3, (−1 + X 2)(1 + X) = −1 − X + X 2 + X 3 pokazują cztery unormowane trójmiany kwadratowe-dzielniki (±1)-wielomianów. Ponadto (±1)-trójmiany kwadratowe 1 + X + X 2, −1 + X + X 2, −1 − X + X 2 i 1 − X + X 2 są własnymi dzielnikami. Mamy więc osiem u n o r m o w a n y c h trójmianów f (X) dzielników (±1)-wielomianów. Do listy należy oczywiście dołączyć jeszcze osiem trójmianów −f (X). Z3.J1 Załóżmy, że f (X) = g(X)h(X). Tu g(X), h(X) ∈ Z[X] są unormowane, oraz deg g(X) = n − k, deg h(X) = n + k, gdzie 0 ⩽ k < n. Licząc wartości dla argumentów aj, dostajemy n równości g(aj)h(aj) = 1. To znaczy (jesteśmy w świecie liczb całkowitych!), że g(aj) = h(aj) = ±1 dla wszystkich aj. Zauważmy teraz, że ani g(X) ani h(X) nie mają pierwiastków rzeczywistych. Więc, ponieważ oba są unormowane, przyjmują wyłącznie wartości d o d a t n i e. To wynika z własno- ści Darboux (wielomian rzeczywisty przyjmujący wartości dodatnie i ujemne, przyjmuje też wartość 0). Zatem g(aj) = h(aj) = 1 dla każdego j. Gdyby k ̸= 0, to wielomian g(X) (stopnia < n) przyj- mujący n razy wartość 1, byłby s t a ł ą. Jedyną więc możliwość rozkładalności wielomianu f (X) daje przypadek k = 0. Wtedy oba wielomiany g(X), h(X) są stopnia n i na zbiorze {a1, . . . , an} przyjmują oba wartość 1. Wówczas ich różnica g(X) − h(X) jest wielomianem stopnia < n (bo 134 3. Wielomiany oba są unormowane) i ma n miejsc zerowych. Jest więc g(X) − h(X) = 0. Założona równość f (X) = g(X)h(X) ma zatem postać (X − a1)2 · . . . · (X − an)2 + 1 = g(X)2. Jednakowoż ta rów- ność również n i e może mieć miejsca (przy n ∈ N). Dawałaby bowiem równość u2 + 1 = w2 dla nieskończenie wielu liczb całkowitych u, w. Z3.J2 (1) Załóżmy, że f (X) = g(X)h(X), gdzie g(X), h(X) ∈ Z[X] są wielomianami unormo- wanymi stopni ⩽ n − 1. Kładąc tu X = aj widzimy, że g(aj)h(aj) = 1 dla każdego j = 1, . . . , n. Czyli g(aj) = h(aj)(= ±1). Zatem g(x) − h(x) = 0 dla n różnych argumentów, więc, zobacz W1T3.4, g(X) − h(X) = 0, czyli g(X) = h(X). Równość f (X) = g(X)h(X) może więc być przepisana tak: (X − a1)(X − a2) · . . . · (X − a2k) = (g(X) − 1)(g(X) + 1), gdzie n = 2k i, oczy- wiście, k = deg g(X). Widzimy już teraz, że gdy n jest liczbą n i e p a r z y s t ą, to f (X) jest n i e r o z k ł a d a l n y. Gdy zaś n = 2k, to, dzięki jednoznaczności rozkładu (zobacz T3.14), możemy uznać, że h1(X) := (X −a1)·. . .·(X −ak) = g(X)−1 i h2(X) := (X −ak+1)·. . .·(X −a2k) = g(X)+1. Stąd mamy równość h1(X) − h2(X) = 2. Kładąc w tej równości X = a2k znajdujemy rozkład (a2k − a1)(a2k − a2) · . . . · (a2k − ak) = 2 liczby (pierwszej!) 2 na iloczyn k r ó ż n y c h czynników całkowitych. To jest możliwe tylko, gdy k = 1 lub k = 2. Przechodzimy więc do części (2). Z po- wyższej analizy wynika, że wielomian (X − a)(X − b) + 1 może być rozkładalny tylko, gdy |b − a| = 2. Wtedy m a m y rozkład postaci (X − c − 1)(X − c + 1) + 1 = (X − c)2. (3). W tym przypadku mamy (X − a − 2)(X − a − 1)(X − a)(X − a + 1) + 1 = [X 2 − (2a − 1)X + a2 + a − 1]2, zob. rozw. Z2.D6. Z3.J3 (Zobacz też C3.38.) Załóżmy nie wprost, że f (X) = g(X)h(X) jest rozkładem w Z[X]. Niech deg g(X) = k, deg h(X) = l. Zbiór {c ∈ Z : |g(c)| = 1} = {c ∈ Z : g(c)2 = 1} jest zbiorem pierwiastków wielomianu g(X)2 − 1 i, jako taki, ma co najwyżej 2k elementów (zob. T3.4 i C3.6). Z tych samych powodów zbiór {c ∈ Z : |h(c)| = 1} ma co najwyżej 2l elementów. Ponieważ |f (cj)| = |g(cj)| · |h(cj)| ∈ P ∪ {1} dla każdego j = 1, . . . , 2n + 1, więc każda z liczb cj należy do {c ∈ Z : |g(c)| = 1} lub do {c ∈ Z : |h(c)| = 1}. Stąd mamy s p r z e c z n o ś ć: 2n + 1 = card{c1, . . . , c2n+1} ⩽ card({c ∈ Z : |g(c)| = 1} ∪ {c ∈ Z : |h(c)| = 1}) ⩽ 2(k + l) = 2n. Z3.J4 Udowodnimy L e m a t. Jeżeli f (X) ∈ Z[X] i |f (cj)| = 1 dla pięciu różnych liczb cał- kowitych c1, c2, . . . , c5, to f (c1) = f (c2) = · · · = f (c5). D o w ó d. Pokazujemy najpierw, że n i e może być f (c1) = f (c2) = f (c3) = f (c4) = 1 i f (c5) = −1. Rzeczywiście, wówczas mie- libyśmy rozkład f (X) − 1 = (X − c1)(X − c2)(X − c3)(X − c4)g(X), gdzie g(X) ∈ Z[X], zob. WT3.2. Wtedy −2 = f (c5) − 1 = (c5 − c1)(c5 − c2)(c5 − c3)(c5 − c4)g(c5), co, wobec różno- ści czterech czynników c5 − cj, jest niemożliwe. Zamieniając ewentualnie f (X) na −f (X), wi- dzimy, że jeżeli cztery z pięciu liczb f (cj) są równe, to wszystkie są równe. Pokazujemy teraz, że n i e m o ż l i w y jest przypadek f (c1) = f (c2) = f (c3) = 1 i f (c4) = f (c5) = −1. Mamy wtedy bo- wiem f (X) − 1 = (X − c1)(X − c2)(X − c3)h(X). Kładąc w tej równości X = c4 i X = c5 dostajemy dwa różne rozkłady liczby −2 na iloczyn liczb całkowitych: −2 = (c4 − c1)(c4 − c2)(c4 − c3)h(c4) = (c5 − c1)(c5 − c2)(c5 − c3)h(c5). Aby zobaczyć, że takie równości nie mogą zachodzić, załóżmy (b.s.o), że c1 < c2 < c3 i c4 < c5. Wówczas te dwa rozkłady są wyznaczone jednoznacznie: −2 = 1 · (−1) · (−2) · (−1) = 2 · 1 · (−1) · 1. Stąd (c5 − c1) − (c4 − c1) = 2 − 1 = 1 i (c5 − c2) − (c4 − c2) = 1 − (−1) = 2. Sprzeczność! Q.e.d. Przechodzimy do rozwiązania zadania: Ponieważ n ⩾ 5, więc, na mocy lematu, możemy (b.s.o.) założyć, że f (cj) = 1 dla wszystkich j. Mamy więc rozkład f (X)−1 = a(X −c1)(X −c2)·. . .·(X −cn) dla pewnej liczby całkowitej a. Założenie unormowania daje równość a = 1. Teraz powołujemy się na Z3.17. Z3.J5 Połóżmy Y = X − 1. Wtedy Fn(X) = Fn(Y + 1) = Y 2n + · · · + 2. Wystarczy teraz zastosować kryterium Eisensteina. Dla sprawdzenia zachodzenia warunków tego kryterium, czyli po- 3.6. Zadania dodatkowe 135 dzielności 2|(2n k ) dla każdego 1 ⩽ k ⩽ 2n − 1, można skorzystać z formuły Legendre’a T2.17, zobacz też Z12.11. Z3.J6 Podobnie jak przed chwilą połóżmy X = Y − 1. Z3.J7 Oznaczmy, ogólniej f (X) = ∑p−1 j=0 (p−j)X j (przy p ∈ P). Jeżeli α ∈ C jest pierwiastkiem (zespolonym) wielomianu f (X), to mamy 0 = (α−1)f (α) = αp+αp−1+ . . . +α−p. Stąd wnosimy, że |α| > 1. Gdyby bowiem było |α| ⩽ 1, to, na podstawie nierówności trójkąta, p = |αp+αp−1+· · ·+α| ⩽ |α|p + |α|p−1 + · · · + |α| ⩽ 1 + 1 + · · · + 1 = p. To jest możliwe tylko, gdy |α| = 1. Co więcej, równość |β1 + β2 + · · · + βn| = n, dla liczb zespolonych βj o modułach równych 1, jest możliwa t y l k o, gdy β1 = β2 = · · · = βn (gdy, na przykład β1 ̸= β2, to (nierówność trójkąta!) |β1 + β2| < 2, więc |β1 + β2 + · · · + βn| ⩽ |β1 + β2| + |β3| + · · · + |βn| < 2 + (n − 2) = n). Zatem α = α2, co dowodzi, że α = 1. Ale f (1) ̸= 0, więc α = 1 nie jest pierwiastkiem f (X). Widzimy, że wszystkie pierwiastki wielomianu f (X) mają moduł ściśle większy niż 1. Załóżmy teraz, że f (X) = g(X)h(X) jest (nietrywialnym) rozkładem na czynniki w Z[X]. Wówczas g0h0 = p, więc |g0| = 1 lub |h0| = 1, niech, b.s.o., |g0| = 1. To jest niemożliwe, bo g0 jest, na mocy wzoru Vi`ete’a, równy iloczynowi niektórych p i e r w i a s t k ó w wielomianu f (X), a one wszystkie mają moduły > 1. Z3.J8 Rozkład wielomianu X 4k + 4 w Z[X] otrzymujemy natychmiast z tożsamości Sophie Ger- main (3.66): X 4k + 4 = (X 2k + 2X k + 2)(X 2k − 2X k + 2). Załóżmy więc, nie wprost, że 4 ∤ n i X n + 4 = f (X)g(X), gdzie f (X), g(X) ∈ Z[X]. Niech 1 ⩽ k := deg f (X) < n. Zauważmy, że każdy pierwiastek (rzeczywisty czy zespolony) wielomianu X n + 4 ma moduł (wartość bezwzględną) równy 22/n (równość αn + 4 = 0 implikuje równość |α|n = 22, skąd |α| = 22/n). Ponieważ k a ż d y pier- wiastek wielomianu f (X) jest jednocześnie pierwiastkiem wielomianu X n + 4, więc (wzory Vi`ete’a!) wyraz wolny f (0) wielomianu f (X) jest iloczynem k liczb zespolonych o module 22/n. Zatem |f (0)| = 22k/n. Ale f (0) ∈ Z. Wnioskujemy stąd, n = 2k. Gdyby k było liczbą nieparzystą, to wielomian f (X) miałby pierwiastek rzeczywisty (zobacz T3.8) i wtedy również wielomian X n + 4 miałby pierwiastek rzeczywisty. Sprzeczność, bo λ2k + 4 > 0 dla każdej liczby λ ∈ R. Z3.J9 Oto przydatne lematy dotyczące wielomianów o współczynnikach wymiernych: L e m a t 1. Jeżeli a(X) = b(X)c(X), to a(f (X)) = b(f (X))c(f (X)) dla dowolnego wielomianu f (X). Odwrotnie, jeżeli dla pewnego n i e s t a ł e g o (tzn., stopnia ⩾ 1) wielomianu f (X) zachodzi równość a(f (X)) = b(f (X))c(f (X)), to a(X) = b(X)c(X). D o w ó d. Wynikanie ⇒ jest (dość?) jasne. Wynikanie ⇐ sprowadza się do implikacji a(f (X)) = b(f (X)) =⇒ a(X) = b(X). Dla jej dowodu powołujemy się na twierdzenie o jednoznaczności (zob. W2T3.4): ponieważ a(f (x)) = b(f (x)), więc wystarczy zauważyć, że elementów postaci f (x) jest dowolnie d u ż o (więcej niż mak- simum stopni wielomianów a(X), b(X)), a to wynika z założenia niestałości wielomianu f (X) i n i e s k o ń c z o n o ś c i ciała liczb wymiernych. Q.e.d. L e m a t 2. Dla wielomianu a(X) ∈ Q[X] zachodzi równość a(−X) = a(X) wtedy i tylko wtedy, gdy wszystkie nieparzyste współczynniki a2l+1 są równe 0, i wtedy i tylko wtedy, gdy istnieje taki wielomian b(X), że zachodzi równość a(X) = b(X 2). D o w ó d pozostawiamy Czytelnikowi. L e m a t 3. Dla wielomianu a(X) ∈ Q[X] zachodzi równość a(−X) = −a(X) wtedy i tylko wtedy, gdy wszystkie parzyste współczynniki a2l są równe 0, i wtedy i tylko wtedy, gdy istnieje taki wielomian b(X), że zachodzi równość a(X) = Xb(X 2). D o w ó d pozostawiamy Czytelnikowi. Przechodzimy do rozwiązania zadania. Niech n = deg p(X). Wówczas deg f (X) = 2n. Za- łóżmy, nie wprost, że istnieje rozkład f (X) = q(X)h(X) w Z[X]. Możemy przy tym założyć, że czynniki q(X), h(X) są unormowanymi wielomianami o współczynnikach całkowitych, q(X) jest n i e r o z k ł a d a l n y, a 0 < deg h(X) < 2n. Ponieważ f (X) = p(X 2), więc, dzięki lematom 2, 1, mamy q(−X)h(−X) = f (−X) = f (X) = q(X)h(X) (potrzebna tu część dowodu lematu 2 wygląda tak: f (−X) = p((−X)2) = p(X 2) = f (X)). Korzystając z lematu 1 łatwo wywnioskować, że wie- lomian q(−X) również (tak jak q(X)) jest nierozkładalny. Rozważmy więc dwa przypadki (jedyne 136 3. Wielomiany możliwe!): (1) q(X) ∼ q(−X), (2) q(X) ⊥ q(−X). Przypadek (1) zajść nie może. Rzeczywiście, w takim razie q(−X) = ±q(X). Mamy dwa pod- przypadki: (1a) q(−X) = q(X), (1b) q(−X) = −q(X). W podprzypadku (1a) mamy q(X) = t(X 2) (zob. lemat 2), więc t(X 2)|p(X 2), więc t(X)|p(X) (zob. lemat 1), więc t(X) = ±1 (bo deg t(X) < deg p(X), a p(X) jest nierozkładalny), więc q(X) = ±1, co jest niemożliwe, bo wielo- mian nierozkładalny ma stopień > 0. W podprzypadku (1b) mamy q(X) = Xs(X 2) (zob. lemat 3), więc q(X) = ±X (bo q(X) jest nierozkładalny), więc f (X) = ±Xh(X), więc wyraz wolny f0 = p0 = 0, co jest kwadratem. Sprzeczność. Również przypadek (2) prowadzi do sprzeczności. Rzeczywiście, wówczas równość q(X)h(X) = q(−X)h(−X) i ZTA w K[X], zob. T3.12, daje rów- ność h(X) = q(−X)l(X) i, wynikającą z niej (na mocy lematu 1), równość h(−X) = q(X)l(−X). Stąd q(X)q(−X)l(X) = q(−X)q(X)l(−X), czyli l(X) = l(−X), więc (lemat 1!) l(X) = k(X 2). Ale l(X)|f (X), czyli k(X 2)|p(X 2), więc (zob. część ⇐ lematu 1 przy t(X) = X 2) k(X)|p(X), co, wobec nierozkładalności p(X), daje k(X) = ±1, więc i l(X) = ±1. Dostajemy wtedy rów- ność f (X) = q(X)q(−X)l(X) = ±q(X)q(−X), z której wynika równość p(0) = p0 = f0 = ±q2 0. To jest sprzeczne z założeniem niekwadratowości |p(0)|. U w a g a. Założenie, że |p(0)| nie jest kwadratem, jest istotne. Na przykład p(X) = X 2 + X + 1 jest nierozkładalny (w Q[X]), ale p(X 2) = X 4 + X 2 + 1 = (X 2 + 1)2 − X 2 = (X 2 − X + 1)(X 2 + X + 1). Ogólniej: patrzmy na wielomian p(X) = X 2 + X + (2c2 + 2c + 1)2 przy dowolnym c ∈ Z. Z3.J10 Domyślamy się, że prawdziwa jest teza ogólniejsza: Jeżeli an10n + · · · + a110 + a0 jest za- pisem liczby pierwszej p w systemie o podstawie 10, to wielomian f (X) = anX n + · · · + a1X + a0 jest nierozkładalny w Q[X]. D o w ó d. Załóżmy, nie wprost, że istnieje rozkład f (X) = g(X)h(X) w pier- ścieniu Z[X] (równoważnie, zobacz T3.15, w pierścieniu Q[X]). Wówczas p = f (10) = g(10)h(10). Więc, ponieważ g(10), h(10) ∈ Z, możemy (b.s.o) założyć, że |g(10)| = 1. Napiszmy rozkład (3.30) dla wielomianu g(X): g(X) = C(X − α1)(X − α2) · . . . · (X − αk). Ponieważ każdy pierwiastek αj wielomianu g(X) jest też pierwiastkiem wielomianu f (X), więc (zobacz Z3.E14(2)) |αj| < 4 lub Re αj < 0 (liczba M w naszym przypadku jest bowiem ⩽ 9). Stąd, oczywiście, |10 − αj| > 6 dla każdego j. I ostatecznie, 1 = |g(10)| = |C| · |10 − α1| · . . . · |10 − αk| > 6k. Sprzeczność. Z3.J11 Zauważmy najpierw, że jeżeli p jest d o s t a t e c z n i e duża, to f (x) > 0 dla wszystkich x ∈ Z. To jest oczywiście prawda przy x < k1 lub x > k2n (dla dowolnej liczby pierwszej p). Dla pozostałych x wystarczy wybrać p spełniające warunek p > (k2n − k1)2n. Wówczas |x − kj| < 2n√p dla każdego j, więc |f (x) − p| = |x − k1| · . . . · |x − k2n| < p, skąd −p < f (x) − p < p, czyli 0 < f (x). Załóżmy teraz, że istnieje rozkład f (X) = g(X)h(X) na iloczyn unormowanych wielomianów (w Z[X]) stopni < 2n. Wówczas g(x) > 0 i h(x) > 0 dla wszystkich x ∈ Z, oraz g(kj)h(kj) = p dla każdego j. Czyli g(kj) = p i h(kj) = 1 lub g(kj) = 1 i h(kj) = p dla każdego j = 1, 2, . . . , 2n. Zatem wielomian s(X) = g(X) + h(X) stopnia < 2n (zob. C3.3(1)) dla wszystkich argumentów kj przyjmuje wartość p + 1. Więc, zobacz W1T3.4, g(x) + h(x) − p − 1 = 0 dla każdego x ∈ Z. To jest jednak n i e m o ż l i w e dla wielomianów niestałych i przyjmujących wartości dodatnie. Rozwiązanie kończy uwaga, że opisanych liczb pierwszych jest nieskończenie wiele. Z3.J12 Równość X 7Y 7 + 1 = f (X)g(Y ), po podstawieniu X = 0 daje 1 = f (0)g(Y ), co oznacza, że g(Y ) jest wielomianem stałym (stopnia 0). Podobnie, f (X) jest wielomianem stopnia 0. Jasne, że iloczyn takich dwóch n i e jest równy X 7Y 7 + 1. U w a g a. Wielomian X 7Y 7 + 1 jest r o z k ł a d a l n y w pierścieniu Q[X, Y ]: X 7Y 7 + 1 = (XY + 1)(X 6Y 6 − X 5Y 5 + · · · − XY + 1). Podobnie można rozłożyć wielomian X aY b + 1 w przypadku, gdy istnieje nieparzysty i > 1 wspólny dzielnik wykładników a, b. Z3.J13 Odpowiedź zależy od n. Dla n = 1 rzecz jest oczywista: mamy rozkład X 2 1 = X1 · X1. 3.6. Zadania dodatkowe 137 Dla n = 2 znamy (bardzo ważny i/bo często używany) rozkład X 2 1 + X 2 2 = (X1 + iX2)(X1 − iX2) (3.76) w pierścieniu C[X1, X2]. Aliści X 2 1 + X 2 2 jest n i e r o z k ł a d a l n y w pierścieniu R[X1, X2] (tym bardziej więc w pierścieniu Q[X1, X2]). Rzeczywiście, gdyby X 2 1 + X 2 2 = f (X1, X2)g(X1, X2), to kładąc X2 = 1 dostalibyśmy rozkład X 2 1 + 1 = ̃f (X1)̃g(X1) w pierścieniu R[X1]. Taki rozkład n i e jest możliwy gdy deg ̃f (X1) = deg ̃g(X1) = 1 (bo wyróżnik dwumianu k w a d r a t o w e g o X 2 1 + 1 jest ujemny). B.s.o. załóżmy więc, że deg ̃f (X1) = 2 i deg ̃g(X1) = 0. To znaczy, że wielomian g(X1, X2) n i e zależy od X1. Kładąc teraz X2 = 1 w równości X 2 1 + X 2 2 = f (X1, X2)g(X1, X2) i rozumując podobnie, widzimy, że (tym razem) wielomian f (X1, X2) n i e zależy od X2 (gdyby to wielomian g(X1, X2) nie zależał od X2, to byłby s t a ł ą, czyli wielomianem stopnia 0, i rozkład X 2 1 + X 2 2 = f (X1, X2)g(X1, X2) nie byłby ”prawdziwym” rozkładem!). Widzimy więc, że jedyną szansę na istnienie ”prawdziwego” rozkładu daje równość X 2 1 + X 2 2 = k(X1)l(X2) dla wielomianów k(X1) ∈ R[X1], l(X2) ∈ R[X2]. Kładąc w tej równości X2 = 0 dostajemy równość X 2 1 = c · k(X1) gdzie c = l(0) ∈ R̸=0. Podobnie X 2 2 = d·l(X2). Stąd dostajemy sprzeczność (cd)−1X 2 1 X 2 2 = X 2 1 +X 2 2 . Przechodzimy do przypadku n ⩾ 3. Załóżmy, że X 2 1 + X 2 2 + . . . + X 2 n = f (X1, X2, . . . , Xn)g(X1, X2, . . . , Xn) (∗) jest rozkładem w pierścieniu C[X1, X2, . . . , Xn]. A priori możliwe są dwa przypadki: (1) istnieje taki indeks j = 1, . . . , n, że degXj f = degXj g = 1 (przez degXj h oznaczamy oczywiście stopień wielomianu h względem zmiennej Xj), (2) dla każdego j wielomian f ma względem zmiennej Xj stopień 1 ± 1, a wielomian g ma względem tej zmiennej stopień 1 ∓ 1. Zaczniemy od zbadania przypadku (2). W tym przypadku możemy (b.s.o.) uważać, że iloczyn z prawej strony równości (∗) ma postać k(X1, . . . , Xs)l(Xs+1, . . . , Xn), gdzie wielomian k(X1, . . . , Xs) jest postaci cX 2 1 + . . . , a wielomian l(Xs+1, . . . , Xn) jest postaci dX 2 s+1 + . . . , przy czym cd ̸= 0 (kropkami oznaczamy pozostałe wyrazy). Jasne, że wówczas równość (∗) nie może zachodzić, bo po jej prawej stronie występuje wyraz cdX 2 1 X 2 s+1, którego nie ma po stronie lewej. W przypadku (1) załóżmy (b.s.o.), że degX1 f = degX1 g = 1. Wówczas rozkład (∗) ma postać X 2 1 + X 2 2 + . . . + X 2 n = (cX1 + k(X2, . . . , Xn))(dX1 + l(X2, . . . , Xn)), z której wnioskujemy, że cd = 1. ”Przerzucając” w razie potrzeby stałą c z pierwszego nawiasu do drugiego, możemy od razu założyć, że c = d = 1. Wymnażając dostajemy wówczas X 2 1 + X 2 2 + · · · + X 2 n = X 2 1 + (k + l)X1 + k · l. Stąd otrzymamy równość k(X2, . . . , Xn) = −l(X2, . . . , Xn) i rozkład X 2 2 + · · · + X 2 n = k(X2, . . . , Xn)l(X2, . . . , Xn) w pierścieniu C[X2, . . . , Xn]. Ponieważ czynniki z prawej strony tego rozkładu różnią się tylko zna- kiem, więc oba muszą być stopnia 1 względem każdej swojej zmiennej. Mamy więc równość X 2 2 + · · · + X 2 n = −(a1 + a2X2 + · · · + anXn)(a1 + a2X2 + · · · + anXn). Stąd dostajemy a2 2 = a2 3 = · · · = a2 n = −1 oraz 2aiaj = 0 dla wszystkich 2 ⩽ i < j ⩽ n. Jasne, że (przy n ⩾ 3) takie równości n i e mogą zachodzić! Mamy zatem odpowiedź : wielomian ∑n j=1 X 2 j jest nierozkładalny w C[X1, . . . , Xn] przy n ⩾ 3 i jest rozkładalny przy n = 2 (zobacz rozkład (3.76)). 138 3. Wielomiany Z3.K1 Wielomian X 4k + X 2k + 1, dla k ∈ Z⩾0, łatwo przedstawić w postaci różnicy kwadratów: X 4k + X 2k + 1 = X 4k + 2X 2k + 1 − X 2k = (X 2k + 1)2 − (X k)2. Stosując tę sztuczkę dla k = 2, a potem dla k = 1, znajdujemy rozkład w Q[X]: X 8 + X 4 + 1 = (X 4 − X 2 + 1)(X 2 − X + 1)(X 2 + X + 1). (Q) Pokazujemy, że występujące tu trzy czynniki są nierozkładalne w Q[X]. Drugi i trzeci czynnik są nierozkładalne nawet w R[X] (bo ∆ = −3 < 0). Nierozkładalność w Q[X] (równoważnie, w Z[X]) czynnika X 4 − X 2 + 1 pokazujemy ”na piechotę” (tak jak w rozwiązaniu zadania Z3.19, tylko łatwiej). Rozkład (Q) jest więc rozkładem wielomianu X 8 + X 4 + 1 na czynniki nierozkładalne w Q[X]. [Przy okazji zauważmy, że nasz dobry druh X 2 + X + 1 jest wielomianem cyklotomicznym Φ3(X), a jego kompan X 2 − X + 1 = Φ3(−X) jest wielomianem cyklotomicznym Φ6(X), zobacz 3.4.6 P.] Czynnik X 4 − X 2 + 1 rozkładu (Q) jest różnicą kwadratów (X 2 + 1)2 − (√3X)2 w pierścieniu R[X]. W tym pierścieniu mamy więc rozkład: X 8 + X 4 + 1 = (X 2 − √3X + 1)(X 2 + √3X + 1)(X 2 − X + 1)(X 2 + X + 1) (R) na iloczyn czynników nierozkładalnych w R[X] (wszystkie cztery wyróżniki są ujemne!). Przechodzimy do pierścienia C[X]. Tu, jak wiemy z T3.18, wszystkie czynniki w rozkładzie wielomianu f (X) na iloczyn czynników nierozkładalnych, są postaci X −α, gdzie α jest pierwiastkiem f (X). Pierwiastki trzeciego i czwar- tego czynnika z rozkładu (R) znamy dobrze, zobacz Z3.20. Są to ω3 i ω2 3 dla wielomianu X 2 + X + 1 i −ω3 i −ω2 3 dla wielomianu X 2 − X + 1. Na rysunku 3.3 widzimy wszystkie osiem pierwiastków wielomianu X 8 + X 4 + 1. Wszystkie są pierwiastkami 12-ego stopnia z 1 i, jako takie, są potęgami liczby ω = ω12 = cos π/6 + i sin π/6, por. C1.36. Przy tym: ω4 = ω3, ω8 = ω2 3 są pierwiastkami czynnika X 2 + X + 1, ω2 = −ω2 3, ω10 = −ω3 są pierwiastkami czynika X 2 −X +1, Rys. 3.3 a b bw aw bw 2 wa 2 ab Rys. 3.2b aw bw 2 wa 2 bw w 2w 4 w 5 w 7 w 8 w 10 w 11 w=w12 ω5, ω7 są pierwiastkami czynnika X 2 − √3X + 1, a ω, ω11 są pierwiastkami czynnika X 2 + √3X + 1. Mamy więc rozkład wielomianu X 8 + X 4 + 1 na czynniki nierozkładalne w C[X]: X 8 + X 4 + 1 = (X − ω5)(X − ω7)(X − ω)(X − ω11)(X − ω2)(X − ω10)(X − ω4)(X − ω8) (C) Z3.K2 Z zadania Z3.20 wiemy, że f (X) := X 5 + X + 1 dzieli się przez Φ3(X) = X 2 + X + 1. Rzeczywiście, X 5 + X + 1 = X 2(X 3 − 1) + X 2 + X + 1 = X 2(X − 1)(X 2 + X + 1) + X 2 + X + 1, skąd X 5 + X + 1 = (X 3 − X 2 + 1)(X 2 + X + 1). (Q) To jest rozkład na czynniki nierozkładalne w Q[X] (wielomian X 3 − X 2 + 1 jest nierozkładalny w Q[X], bo nie ma pierwiastka wymiernego, zobacz C3.34 i Z2.4). Czynnik X 2 + X + 1 jest nieroz- kładalny w R[X]. Natomiast czynnik X 3 − X 2 + 1 m a pierwiastek rzeczywisty. Znajdujemy go za pomocą metody opisanej w ustępie 3.4.7. Najpierw, za pomocą podstawienia X = Y + 1 3 , pozbywamy się wyrazu kwadratowego. Dostaniemy równość X 3 − X 2 + 1 = Y 3 − 1 3 Y + 25 27 = 1 27 (Z3 − 3Z + 25), gdzie, dla ułatwienia, położyliśmy dodatkowo Z = 3Y . Zgodnie z 3.4.7 U1, szukamy pierwiastków równania z3 − 3z + 25 = 0 w postaci z = λ + µ. W aktualnym przypadku układ (3.52) wygląda tak: λ3 + µ3 = −25, λ3µ3 = 1. Wybieramy r z e c z y w i s t e λ = 3 √ −25 − 3√ 69 2 , µ = 3 √ −25 + 3√69 2 . 3.6. Zadania dodatkowe 139 Dostajemy rozkład badanego wielomianu w R[X]: f (X) = ( X − λ + µ + 1 3 ) ( X 2 + λ + µ − 2 3 X + λ2 + µ2 − λ − µ 9 ) (X 2 + X + 1), (R) gdzie drugi i trzeci czynnik są nierozkładalne (w pierścieniu R[X]). Ich rozkłady na czynniki liniowe w pierścieniu C[X] pozostawiamy Czytelnikowi. Z3.K3 Z tożsamości nieśmiertelnej (1.8) widzimy, że (X 2 − 1)f (X) = X 2n+2 − 1. Wystarczy teraz zastosować (3.39) przy m = n + 1 i skorzystać z jednoznaczności rozkładu w R[X]. Dostaniemy rozkład w R[X]: f (X) = n∏ k=1 (X 2 − (2 cos 2kπ 2n+2 )X + 1) . Trzeba jeszcze, zobacz T3.19, zauważyć ujemność wyróżników: ∆ = 4 cos2 2kπ 2n+2 − 4 < 0. Z3.K4 Rozważmy g(X) = X 2 + X + 1 = (X − ω)(X − ω), gdzie ω = ω3, zob. (3.35), jest pierwiastkiem stopnia 3 z jedynki o argumencie 2π/3. Badany wielomian f (X) jest superpozycją g(X n) = (X n − ω)(X n − ω). Aby znaleźć jego rozkład na czynniki liniowe (tzn., stopnia pierwszego) w C[X] wystarczy znaleźć pierwiastki wielomianu X n − ω i wielomianu X n − ω. Z3.K5 Sprawdzenie równości (X + Y )3 − X 3 − Y 3 = 3XY (X + Y ), (3.77) (X + Y )5 − X 5 − Y 5 = 5XY (X + Y )(X 2 + XY + Y 2), (3.78) (X + Y )7 − X 7 − Y 7 = 7XY (X + Y )(X 2 + XY + Y 2) 2 (3.79) jest prostym rachunkiem. Nierozkładalność występujących tu czynników jest jasna dla 3, 5, 7, X, Y i X + Y . Gdyby wielomian F (X, Y ) = X 2 + XY + Y 2 dał się rozłożyć na iloczyn G(X, Y )H(X, Y ) w pierścieniu Z[X, Y ], to mielibyśmy rozkład X 2 + X + 1 = F (X, 1) = G(X, 1)H(X, 1) w Z[X]. Z3.K6 Rozważmy wielomian f (X, Y, Z) = X n(Y − Z) + Y n(Z − X) + Zn(X − Y ) ∈ Z[X, Y, Z]. Gdy popatrzymy na niego jak na wielomian zmiennej X o współczynnikach w pierścieniu Z[Y, Z], to widzimy, że Y ∈ Z[Y, Z] jest jego pierwiastkiem. Z T3.2 wynika więc równość f (X, Y, Z) = (X − Y )g1(X, Y, Z) dla pewnego wielomianu g1 ∈ Z[X, Y, Z] (na marginesie dodajmy, że stopniem wielomianu g1 względem zmiennej X jest n − 1). Podobnie sprawdzamy, że zachodzą równości f (X, Y, Z) = (Y − Z)g2(X, Y, Z) i f (X, Y, Z) = (Z − X)g3(X, Y, Z). Elementy X − Y, Y − Z i Z − X pierścienia Z[X, Y, Z] są nierozkładalne i niestowarzyszone (sprawdzić!) i każdy z nich jest dzielnikiem wielomianu f . Zatem i ich iloczyn jest dzielnikiem tego wielomianu. Istnieje więc równość X n(Y − Z) + Y n(Z − X) + Zn(X − Y ) = (X − Y )(Y − Z)(Z − X)g(X, Y, Z) dla pewnego wielomianu g(X, Y, Z) ∈ Z[X, Y, Z]. Z3.L1 Niech f (X) = aX 2 + bX + c. Fakt nieistnienia rozwiązań równania ax2 + bx + c = x oznacza (jest równoważny), że trójmian kwadratowy aX 2 + (b − 1)X + c n i e ma pierwiastków rzeczywistych. W szczególności, funkcja wielomianowa R ∋ x 7−→ ax2 + (b − 1)x + c przyjmuje wyłącznie wartości j e d n e g o z n a k u (tego samego co znak a). Załóżmy (na przykład), że a < 0. Wówczas ax2 + (b − 1)x + c < 0, czyli f (x) < x dla każdego x ∈ R. Zakładamy teraz, nie wprost, że α ∈ R jest pierwiastkiem superpozycji f (f (X)), tzn. że f (f (α)) = 0. Ponieważ f (f (α)) < f (α), więc otrzymujemy sprzeczność 0 < f (α) < 0. Podobnie badamy przypadek, gdy a > 0. 140 3. Wielomiany Z3.L2 Oto zadanie ogólniejsze: Wielomiany f (X), g(X) ∈ R[X] są różne, ale komutujące w tym sensie, że superpozycje f (g(X)) i g(f (X)) są równe. Udowodnić, że dla dowolnej liczby naturalnej n wielomian f [n](X) − g[n](X) jest podzielny przez wielomian f (X) − g(X). L e m a t 1. Jeżeli wielomiany a(X), b(X) są różne, to dla dowolnego wielomianu h(X) wielomian h(a(X)) − h(b(X)) jest podzielny przez wielomian a(X) − b(X). D o w ó d jest natychmiastowy. Rzeczywiście, jeżeli h(X) = ∑ k⩾0 hkX k, to h(a(X)) − h(b(X)) = ∑ k⩾1 hk(a(X)k − b(X) k) = ∑ k⩾1 hk(a(X) − b(X))(a(X)k−1 + · · · + b(X) k−1), na mocy tożsamości nieśmiertelnej (prawdziwej w k a ż d y m pierścieniu przemiennym). Q.e.d. L e m a t 2. Jeżeli wielomiany a(X), b(X) komutują, to dla dowolnego n ∈ Z⩾0 zachodzi równość superpozycji a[n](b(X)) = b(a[n](X)). D o w ó d jest natychmiastowym (rzetelnie patrząc, indukcyj- nym!) uogólnieniem równości a(a(b(X))) = a(b(a(X))) = b(a(a(X))). Q.e.d. Zadanie rozwiązujemy przez indukcję względem n. Baza indukcji (przypadek n = 1) jest oczywi- sta. Załóżmy prawdziwość tezy dla danego n ∈ N. Piszemy (dzięki lematowi 2) równość: f [n+1](X) − g[n+1](X) = [f [n](f (X)) − f [n](g(X))] + [f [n](g(X)) − g[n](g(X))] = [f [n](f (X)) − f [n](g(X))] + [g(f [n](X)) − g(g[n](X))]. Wielomian z pierwszego nawiasu kwadratowego jest podzielny przez f (X) − g(X) (na mocy lematu 1), a wielomian z drugiego nawiasu kwadratowego jest podzielny przez f [n](X) − g[n](X), więc też, na mocy założenia indukcyjnego, przez f (X) − g(X). Jasne jest, że zadanie wyjściowe sprowadza się do ogólniejszego w przypadku, gdy g(X) = X. Z3.L3 Teza jest oczywista, gdy k = 1. Załóżmy więc, że k ⩾ 2. Deﬁniujemy indukcyjnie ciąg (an): a0 = a i an+1 = f (an) dla n ∈ Z⩾0. Oznaczmy też rn = an+1 − an dla n = 0, 1, . . . . Wówczas dla każdego n ∈ Z⩾0 zachodzi warunek rn|rn+1, zobacz C3.4. Założenie f [k](a) = a, czyli ak = a0 implikuje równość rk = r0. Ta równość i podzielności r0|r1| . . . |rk−1|rk, na mocy C2.2, dają s t a ł o ś ć ciągu (|rn|): |rn| = r dla każdego n ⩾ 0. Załóżmy teraz, że r0 = r (rozumujemy podobnie, z zamianą maksimum na minimum, gdy r0 = −r) i niech as = max{a0, a1, . . . , ak−1}. Wówczas as−1 = as − r = as+1. Stąd as+2 = f (as+1) = f (as−1) = as, as+3 = f (as+2) = f (as) = as+1, itd., przez oczywistą indukcję, as+2j = as oraz as+2j−1 = as+1 dla każdego j ∈ N. Jedyną więc szansę na zachodzenie równości ak = a0 daje przypadek s = 1. Z3.L4 Oznaczmy Fix(f [k]) := {x ∈ Z : f [k](x) = x}. Mamy wykazać, że card (Fix(f [k])) ⩽ n. Dla k = 1 rzecz jest oczywista: zbiór Fix(f ) = {x ∈ Z : f (x) = x} jest zbiorem pierwiastków wielomianu f (X) − X (stopnia n), zobacz T3.4. Gdy zaś k ⩾ 2, to, jak wiemy z poprzedniego zadania, zachodzi inkluzja Fix(f [k]) ⊆ {x ∈ Z : f [2](x) = x}. Wystarczy więc wykazać, że zbiór Fix(f [2]) ma co najwyżej n elementów. Zbiór Fix(f [2]) jest sumą (teoriomnogościową) co najwyżej n-elementowego zbioru Fix(f ) := {x ∈ Z : f (x) = x} i reszty. Jeżeli ta reszta jest zbiorem pustym, to koniec. Załóżmy więc, że a ∈ Fix(f [2]) ∖ Fix(f ). Wówczas f (a) = b ̸= a i f (b) = a. Zamieniając ewentualnie a z b, możemy założyć, że a < b. Jeżeli {a, b} = Fix(f [2]), to koniec (bo 2 ⩽ n). Niech więc x ∈ Fix(f [2]) ∖ {a, b}. Oznaczmy y = f (x) i załóżmy (po ewentualnej zamianie miejscami jest to możliwe), że x ⩽ y. Wówczas a − x|f (a) − f (x), czyli a − x|b − y, oraz b − y|f (b) − f (y), więc b − y|a − x. Zatem |a − x| = |b − y|. Podobnie, |a − y| = |b − x|. Łatwo stąd wywnioskować, że środek przedziału [ a; b ] pokrywa się ze środkiem przedziału [ x; y ]. Czyli a + b = x + y, więc r := a + b = x + f (x). To oznacza, że k a ż d a liczba x ∈ Fix(f [2]) jest pierwiastkiem wielomianu f (X) + X − r i kończy rozwiązanie. Z3.L5 Łatwo widzieć, że deg a(b(X)) = deg a(X) deg b(X) dla dowolnych niezerowych wielomia- nów w pierścieniu K[X] wielomianów o współczynnikach w c i e l e. W szczególności, deg a[2](X) = n2 3.6. Zadania dodatkowe 141 jeżeli deg a(X) = n. Równość f [2](X) = g[2](X) implikuje więc równość deg g(X) = deg f (X). Za- łóżmy, nie wprost, że f (X) ̸= g(X) i oznaczmy r(X) = f (X) − g(X). Wówczas f [2](X) − g[2](X) = [g(f (X)) − g(g(X))] + r(f (X)). Różnicę g(f (X)) − g(g(X)), tak samo jak w dowodzie T3.1, przedstawiamy w postaci iloczynu (f (X) − g(X))h(X) = r(X)h(X) i znajdujemy sprzeczność z założeniem, że k := deg r(X) jest ̸= −∞. Osobno rozważamy przypadek k = 0 i 1 ⩽ k < n (!). U w a g a. Unormowanie jest ważne. Przykład: g(X) = f (−X) ̸= f (X). Z3.L6 Mamy f (− sin x) = f (sin(−x)) = f (cos(−x)) = f (cos x) = f (sin x) dla każdego x ∈ R. Stąd widzimy, że f (−u) = f (u) dla nieskończenie wielu u ∈ R (mianowicie dla wszystkich u ∈ [ −1; 1 ]). Więc, zobacz W2T3.4, f (−X) = f (X). Łatwo uzasadnić (zob. Lemat 2 w rozwiązaniu Z3.J9), że wówczas f (X) = g(X 2) dla pewnego wielomianu g(X) ∈ R[X]. Mamy wtedy g(sin 2 x) = f (sin x) = f (cos x) = g(cos2 x) = g(1 − sin 2 x). Więc g(u) = g(1 − u) dla nieskończenie wielu u ∈ R. Więc, podobnie jak przed chwilą, g(X) = g(1−X). Rozważmy wielomian h(X) = g(X + 1 2 ). Wówczas h(−X) = g(−X + 1 2 ) = g(1 − (−X + 1 2 )) = g(X + 1 2 ) = h(X). Zatem h(X) = k(X 2) dla pewnego wielomianu k(X) ∈ R[X]. Ostatecznie f (X) = g(X 2) = h(X 2 − 1 2 ) = k(X 4 − X 2 + 1 4 ) = l(X 4 − X 2). Z3.L7 Wielomian f (X) ma stopień 2 i d w a pierwiastki: √2 = 2 cos π 4 i − √2 = 2 cos 3π 4 . To nasuwa myśl podstawienia X = 2 cos u. Sprawdzamy (indukcyjnie), że f [n](2 cos u) = 2 cos 2 nu. Wobec tego f [n](x) = 0 (dla x ∈ [ −2; 2 ]) zachodzi, gdy 2 cos 2nu = 0 (dla u ∈ [ 0; π ]). Łatwo wskazać 2n różnych wartości u ∈ [ 0; π ], dla których zachodzi równość cos 2nu = 0. U w a g a. Podobnie można wskazać 2n pierwiastków rzeczywistych wielomianu f [n](X) − X. Z3.L8 Załóżmy, nie wprost, że istnieją trójmiany kwadratowe f (X), g(X), h(X). Wówczas liczby h(1), h(2), . . . , h(8) są pierwiastkami wielomianu stopnia czwartego f (g(X)). Ponieważ h(a) = h(b) przy a ̸= b wtedy i tylko wtedy, gdy liczby a, b leżą symetrycznie względem odciętej wierzchołka paraboli y = h(x), więc musi być h(1) = h(8), h(2) = h(7), h(3) = h(6) i h(4) = h(5), a wierzchołek paraboli y = h(x) ma odciętą równą 9/2. Ponadto, h(1) < h(2) < h(3) < h(4) lub h(1) > h(2) > h(3) > h(4). Wobec tego liczby g(h(1)), g(h(2)), g(h(3)), g(h(4)) są pierwiastkami trójmianu kwadratowego f (X). Zatem g(h(1)) = g(h(4)) i g(h(2)) = g(h(3)). Więc liczby h(2) i h(3) leżą izotomicznie w przedziale [ h(1); h(4) ] (są równo odległe od środka tego przedziału), skąd h(1) + h(4) = h(2) + h(3). Kładąc h(X) = pX 2 + qX + r dostajemy równość 17p + 5q + 2r = 13p + 5q + 2r. Mamy więc sprzeczność, bo p ̸= 0. Z3.M1 Oznaczymy przez M zbiór wszystkich wielomianów f (X) ∈ R[X] postaci g(X) − h(X), gdzie g(X), h(X) ∈ R[X] są takie, że funkcje x 7−→ g(x), x 7−→ h(x) są (ściśle) rosnące. Pokażemy, że M = R[X]. Rozumujemy przez indukcję względem stopnia. Równość a = (a + X) − X pokazuje, że każdy wielomian stały (tzn., stopnia ⩽ 0) należy do M. Załóżmy więc teraz, że wszystkie wielomiany stopnia ⩽ n należą do M i rozważmy wielomian f (X) stopnia n + 1. Jest on równy sumie aX n+1 + f1(X), gdzie deg f1(X) ⩽ n. Rozpatrzymy dwa przypadki: (1) n = 2k i (2) n = 2k − 1. W przypadku (1) wybieramy dowolną taką liczbę b > 0, że a + b > 0 i takie wielomiany g(X), h(X), że f1(X) = g(X) − h(X), a funkcje x 7−→ g(x) i x 7−→ h(x) są rosnące. Wówczas równość f (X) = [(a + b)X 2k+1 + g(X)] − [bX 2k+1 + h(X)] pokazuje, że f (X) ∈ M. W przypadku (2) napiszmy najpierw równość 1 2k+1 [(X +a)2k+1−X 2k+1] = aX n+1+k(X) (zob. wzór dwumienny), gdzie deg k(X) ⩽ n. Wtedy f (X) = 1 2k+1 [(X + a)2k+1 − X 2k+1] − k(X) + f1(X). Wielomian f1(X) − k(X) 142 3. Wielomiany ma stopień ⩽ n (zob. C3.3(1)), więc należy do M. Pisząc go w odpowiedniej postaci g(X) − h(X) mamy równość f (X) = [ 1 2k+1 (X + a)2k+1 + g(X)] − [ 1 2k+1 X 2k+1 + h(X)] pokazującą, że f (X) ∈ M. Z3.M2 Rozwiążemy najpierw C3.44. Po pierwsze łatwo widzieć, że współczynnik C w rozkładzie (3.34) jest ⩾ 0. Rzeczywiście, gdy C < 0 i i s t n i e j ą pierwiastki rzeczywiste aj, to dla x > max{a1, . . . , ar} mamy f (x) < 0. Gdy zaś C < 0 i n i e ma pierwiastków rzeczywistych, to f (x) < 0 dla wszystkich x ∈ R. Po drugie łatwo widzieć, że wszystkie wykładniki ei są parzyste. Załóżmy bowiem (b.s.o.), że a1 < a2 < · · · < ar i ej = 2k + 1. Wówczas dla aj−1 < x1 < aj < x2 < aj+1 mamy f (x1)f (x2) < 0, co jest niemożliwe. Wobec tego pierwszą część iloczynu (3.34) zapisujemy w postaci c(X)2, gdzie c(X) = √C(X −a1)e1/2 ·. . .·(X −ar)er/2. Ponieważ wszystkie pozostałe czynniki w rozkładzie (3.34) są postaci g(X)2 + h(X)2, więc, korzystając wielokrotnie z tożsamości podanej we wskazówce, możemy ich iloczyn zapisać w postaci sumy a1(X)2 + b1(X)2. Kładąc wreszcie a(X) = a1(X)c(X) i b(X) = b1(X)c(X) mamy tezę. Przechodzimy do rozwiązania zadania. Nierówność f (x) ⩾ 0 dla x ⩾ 0, jak widać z powyższej analizy, oznacza parzystość wykładników ei dla tych i, dla których ai ⩾ 0. Wykorzystujemy taką wersję tożsamości (8.1): (α2 + Xβ2)(γ2 + Xδ2) = (αγ + Xβδ) 2 + X(αδ − βγ) 2. Czynnik postaci (X − b)2 + c2 łatwo zapisać w postaci g(X)2 + Xh(X)2: Niech d = √b2 + c2 > |b|. Wtedy (X − b)2 + c2 = (X − d)2 + X( √2d − 2b)2. Dalej wszystko powinno być jasne. Z3.M3 Odpowiedź : t a k. Oto przykład: f (X, Y ) = X 2Y 4 + X 2Y 2 + 2XY 2 + X 2 + X + 1. Zapiszmy bowiem f (x, y) = a(y)x2 + b(y)x + c(y) = (y4 + y2 + 1)x2 + (2y2 + 1)x + 1. Przy każdym ustalonym y = y0 ∈ R widzimy tu trójmian kwadratowy o współczynniku a = a(y0) > 0 i ujemnym wyróżniku ∆ = ∆(y0) = b(y0)2 − 4a(y0)c(y0) = (2y2 0 + 1)2 − 4(y4 0 + y2 0 + 1) = −3. Dzięki T3.7 widzimy, że zbiór {f (x, y0) : x ∈ R} jest równy zbiorowi A(y0) = [ 3 4y4 0+4y2 0+4 ; ∞) . Ponieważ ⋃y∈R A(y) = ( 0; ∞ ), więc mamy tezę. Z3.N1 Rozważmy dwa (różne!) wielomiany f (X) = ∑n j=1 X kj i g(X) = ∑n j=1 X lj . Wówczas f (X) 2 = n∑ j=1 X 2kj + 2 ∑ (i, j)∈A X ki+kj = f (X 2) + 2 ∑ (i, j)∈A X ki+kj . Podobna równość dla wielomianu g(X)2 pokazuje, że f (X) 2 − f (X 2) = 2 ∑ (i, j)∈A X ϕ(i, j) = 2 ∑ (i, j)∈A X b(ψ(i, j)) = g(X) 2 − g(X 2). Mamy więc równość f (X)2 − g(X)2 = f (X 2) − g(X 2). Jednocześnie, ponieważ f (1) = g(1) = n, więc wielomian f (X) − g(X) ma pierwiastek α = 1. Zatem f (X) − g(X) = (X − 1)k h(X) dla pewnego k ∈ N i pewnego wielomianu h(X), przy czym h(1) ̸= 0. Stąd f (X) + g(X) = f (X)2 − g(X)2 f (X) − g(X) = f (X 2) − g(X 2) f (X) − g(X) = (X 2 − 1)k h(X 2) (X − 1)k h(X) = (X + 1)k h(X 2) h(X) . Kładąc tu X = 1 dostajemy równość 2n = 2k. Rozdział 4 Funkcje arytmetyczne Lisez Euler, c’est notre ma ˆιtre `a tous. (Pierre Simon de Laplace) W tym krótkim rozdziale zdeﬁniujemy kilka prostych ale użytecznych funkcji arytmetycz- nych. Najważniejszą z nich jest funkcja Eulera ϕ. Przypomnijmy, że (dla nas) zbiór liczb naturalnych to N = {x ∈ Z : x ⩾ 1}. Deﬁnicja 4.1 Dowolną funkcję f : N −→ C nazywamy funkcją arytmetyczną. Funkcje arytmetyczne rozważane w dalszym ciągu, przyjmują zazwyczaj wartości całkowite (w Z). Szczególnie ważne są funkcje arytmetyczne multyplikatywne. Deﬁnicja 4.2 Funkcję arytmetyczną f nazywamy multyplikatywną, gdy nie jest równa tożsamościowo 0 i dla dowolnych w z g l ę d n i e p i e r w s z y c h m, n ∈ N zachodzi równość f (mn) = f (m)f (n). (4.1) Ćwiczenie 4.1 Jeżeli f jest multyplikatywną funkcją arytmetyczną, to f (1) = 1. 4.1 Sumy potęg dzielników W tym paragraﬁe pokażemy parę ćwiczeń na temat ilości, sumy i, ogólniej, sumy potęg dziel- ników dodatnich danej liczby naturalnej. Deﬁnicja 4.3 Niech α ∈ R. Dla danej liczby naturalnej n oznaczamy σα(n) = ∑ d|n dα. Sumowanie rozciąga się na wszystkie dodatnie dzielniki liczby n. Ćwiczenie 4.2 Udowodnić, że funkcja σα, dla dowolnego α ∈ R, jest funkcją multyplika- tywną. Wskazówka. Jeżeli m ⊥ n, to d|mn wtedy i tylko wtedy, gdy istnieje dokładnie jedna taka para dzielników (dodatnich) d1|m, d2|n, że d = d1d2. U w a g a. Jasne, że funkcja multyplikatywna jest jednoznacznie wyznaczona przez swoje wartości na potęgach liczb pierwszych. 144 4. Funkcje arytmetyczne 4.1.1 Funkcja τ Liczbę σ0(n) wyrażającą, zgodnie ze wzorem (4.1), liczbę (dodatnich) dzielników liczby natu- ralnej n oznacza się prościej τ (n). Ćwiczenie 4.3 Udowodnić, że jeżeli n = pe1 1 pe2 2 ·. . .·pes s jest kanonicznym rozkładem liczby naturalnej n na czynniki pierwsze, to τ (n) = (e1 + 1)(e2 + 1) · . . . · (es + 1). (4.2) Ćwiczenie 4.4 Udowodnić, że τ (n) jest liczbą nieparzystą wtedy i tylko wtedy, gdy n jest kwadratem (liczby naturalnej). U w a g a. Teza tego ćwiczenia wynika natychmiast z równości (4.2). Warto jednak przepro- wadzić niezależne rozumowanie następująco: Jeżeli d < √n jest dzielnikiem n, to n/d jest dzielnikiem n spełniającym (oczywiście) nierówność n/d > √ n. Dla danej liczby n zachodzi więc jedna z dwóch możliwości: (1) √n /∈ N i wtedy dzielniki n występują w parach {d, n d }, więc 2|τ (n), albo (2) √n ∈ N i wtedy √n jest jedynym dzielnikiem bez pary. W tym przypadku 2 ∤ τ (n). Ćwiczenie 4.5 Udowodnić nierówność τ (n) ⩽ 2 √n. Ćwiczenie 4.6 Rozwiązać zadanie o znudzonych uczniach: W pewnej szkole każdy z 456 uczniów ma swój kod będący jedną z liczb 1, 2, . . . , 456 i swoją szafkę oznaczoną tym kodem. W dniu wagarowicza (tego dnia nie było nieobecnych) bawili się oni następująco: uczeń mający kod n, przyszedłszy do szkoły przechodził wzdłuż korytarza z szafkami i zmieniał stan (zamknięte otwierał, a otwarte zamykał) wszystkich szafek, których numer był podzielny przez n. Przed rozpoczęciem zabawy wszystkie szafki były zamknięte. Udowodnić, że po zakończeniu zabawy pan woźny znalazł dokładnie 21 otwartych szafek. Rozwiązać też zadanie o woźnym matematyku: Ponieważ otwieranie i zamykanie szafek bardzo się im spodobało, uczniowie tej szkoły postanowili bawić się w to co ranka. Pan woźny twierdzi, że potraﬁ – tylko na podstawie stanu szafek – wskazać kody uczniów nieobecnych danego dnia w szkole. Udowodnić, że pan woźny ma podstawy do takiego twierdzenia. Ćwiczenie 4.7 Udowodnić równość ∏ d|n d = nτ (n)/2. Ćwiczenie 4.8 Oznaczamy T (n) := τ (1)+τ (2)+ . . . +τ (n). Udowodnić, że dla dowolnego n ∈ N zachodzi równość T (n) = ⌊n 1 ⌋ + ⌊n 2 ⌋ + . . . + ⌊n n ⌋ . Ćwiczenie 4.9 Udowodnić, że dla dowolnej liczby naturalnej n zachodzi równość ∑ d|n τ (d)3 = ( ∑ d|n τ (d) ) 2. (4.3) 4.1. Sumy potęg dzielników 145 4.1.2 Funkcja σ Liczbę σ1(n) oznacza się prościej σ(n). Ćwiczenie 4.10 Udowodnić, że jeżeli n = pe1 1 pe2 2 · . . . · pes s jest kanonicznym rozkładem liczby naturalnej n na czynniki pierwsze, to σ(n) = pe1+1 1 − 1 p1 − 1 · pe2+1 2 − 1 p2 − 1 · . . . · pes+1 s − 1 ps − 1 . ZADANIE 4.1 Udowodnić, że dla dowolnej liczby naturalnej n zachodzą nierówności 1 2 n(n − 1) ⩽ σ(1) + σ(2) + . . . + σ(n) ⩽ n2. (4.4) R o z w i ą z a n i e. Liczba d ⩽ n występuje jako składnik sumy ∑ k⩽n σ(k) dokładnie ⌊n/d⌋ razy. Zatem ∑n k=1 σ(k) = ⌊ n 1 ⌋ · 1 + ⌊ n 2 ⌋ · 2 + . . . + ⌊ n n ⌋ · n. Stąd (wobec x − 1 < ⌊x⌋ ⩽ x) n2 − n(n + 1) 2 = n∑ k=1 (n k − 1 ) · k < n∑ k=1 σ(k) ⩽ n∑ k=1 n k · k = n2. ♦ Ćwiczenie 4.11 Udowodnić, że dla dowolnej liczby naturalnej n zachodzi nierówność σ(1) 1 + σ(2) 2 + . . . + σ(n) n ⩽ 2n. Ćwiczenie 4.12 Udowodnić, że σ(n) jest liczbą nieparzystą wtedy i tylko wtedy, gdy n jest kwadratem lub podwojonym kwadratem. Liczbę naturalną n nazywamy liczbą doskonałą, gdy równa jest sumie swoich właściwych (tzn., różnych od n) dzielników naturalnych. Czyli, gdy σ(n) = 2n. ZADANIE 4.2 Udowodnić dwa twierdzenia o liczbach doskonałych: (1) (Twierdzenie Euklidesa) Jeżeli Mp jest liczbą pierwszą Mersenne’a, to liczba 2 p−1Mp jest liczbą doskonałą; (2) (Twierdzenie Eulera) Jeżeli n jest p a r z y s t ą liczbą doskonałą, to istnieje taka liczba pierwsza Mersenne’a Mp, że n = 2 p−1Mp. R o z w i ą z a n i e. (1) Na mocy C4.10 mamy σ(2 p−1Mp) = (2 p − 1) · (M 2 p − 1)/(Mp − 1) = Mp(Mp + 1) = 2 pMp = 2n. (2) Niech n = 2 e−1m, gdzie e > 1 i m ≡ 1 (mod 2). Zatem, zobacz C4.2, 2 em = 2n = σ(2e−1m) = σ(2 e−1)σ(m) = (2e − 1)σ(m). Stąd, ponieważ 2 e ⊥ 2 e − 1, na mocy ZTA, σ(m) = 2e · a i jednocześnie m = (2 e − 1)a przy pewnym a ∈ N. Ostatnią równość zapisujemy w postaci m = 2 e · a − a. Stąd m + a = 2 e · a = σ(m). Ponieważ m|m i a|m, więc m i a są j e d y n y m i dzielnikami liczby m. Zatem m jest liczbą pierwszą, a a = 1. Czyli m = Me i e = p jest też liczbą pierwszą (zobacz 2.3.3 P3). ♦ U w a g a. Liczby 6 = 22−1(2 2 − 1), 28 = 23−1(2 3 − 1), 496 = 25−1(2 5 − 1) są pierwszymi trzema liczbami doskonałymi. Dotychczas nie znaleziono żadnej nieparzystej liczby doskonałej. 146 4. Funkcje arytmetyczne 4.2 Funkcja ϕ Eulera Najczęściej spotykaną w teorii liczb funkcją arytmetyczną jest funkcja ϕ Eulera. Deﬁnicja 4.4 Symbolem ϕ(n) oznaczmy moc zbioru liczb naturalnych mniejszych lub równych n i względnie pierwszych z n. Tzn., ϕ(n) = card {k ∈ N : k ⩽ n, k ⊥ n}. TWIERDZENIE 4.1 Funkcja ϕ Eulera jest funkcją multyplikatywną. D O W Ó D. Niech NWD (m, n) = 1. Chcemy wskazać te spośród liczb 1, 2, . . . , mn, które są względnie pierwsze z mn. W tym celu ustawmy te liczby w tablicę: 1 2 . . . k . . . m m + 1 m + 2 . . . m + k . . . m + m ... ... ... ... ... ... (n − 1)m + 1 (n − 1)m + 2 . . . (n − 1)m + k . . . (n − 1)m + m W tablicy tej występują dwa typy kolumn: kolumnę nazwiemy dobrą, gdy jej nagłówek k jest względnie pierwszy z m, pozostałe kolumny nazwiemy złymi. Prawdziwe są tezy: (1) Kolumn dobrych jest ϕ(m). (2) Każdy wyraz złej kolumny ma wspólny, większy od 1, dzielnik z m, więc tym bardziej z mn. Liczby względnie pierwsze z mn występują więc w y ł ą c z n i e w kolumnach dobrych. (3) Każda kolumna ma n wyrazów, z których każdy daje i n n ą resztę z dzielenia przez n. Wobec tego dokładnie ϕ(n) z nich jest względnie pierwszych z n. Dowód dwóch pierwszych tez pozostawiamy Czytelnikowi. Trzecią uzasadniamy tak: Za- łóżmy, że wyrazy k + sm, k + tm (0 ⩽ s ⩽ t < n) k-tej kolumny dają przy dzieleniu przez n tę samą resztę r. Czyli że k + sm = qn + r i k + tm = q′n + r. Odejmując dostaje- my (t − s)m = (q′ − q)n. Wówczas, na mocy ZTA, n|(t − s), co pokazuje, że t − s = 0, bo 0 ⩽ t − s < n. Wobec tego (przestawiając) możemy zapisać wyrazy danej kolumny: q0n, q1n + 1, . . . , qn−1n + n − 1. Jasne, że wśród nich jest ϕ(n) względnie pierwszych z n. Ponieważ dana liczba naturalna jest względnie pierwsza z mn wtedy i tylko wtedy, gdy jest względnie pierwsza zarówno z m jak i z n, więc znaleźliśmy ϕ(m)ϕ(n) liczb względnie pierwszych z mn w naszej tablicy. To kończy dowód. □ Z kolejnej własności funkcji ϕ Eulera będziemy korzystać w rozdziale 5: TWIERDZENIE 4.2 (Gauss) Dla każdej liczby naturalnej n zachodzi równość n = ∑ d|n ϕ(d). (4.5) D O W Ó D. Wypiszmy kolejno wszystkie ułamki (właściwe) o mianowniku n: 1 n , 2 n , 3 n , . . . , n n i sprowadźmy je do postaci nieskracalnej: 1 n , . . . , k d , . . . , 1 1. Typowy ułamek z tego (n-wyrazowego) ciągu ma postać k d , gdzie d jest dzielnikiem n, a k jest jedną z ϕ(d) liczb naturalnych ⩽ d i względnie pierwszych z d. To kończy dowód. □ 4.3. Splot Dirichlet’a i odwracanie M¨obiusa 147 TWIERDZENIE 4.3 Jeżeli n > 1 jest liczbą naturalną oraz n = pe1 1 pe2 2 · . . . · pes s jest kanonicznym rozkładem n na czynniki pierwsze, to ϕ(n) = n ( 1 − 1 p1 ) ( 1 − 1 p2 ) · . . . · ( 1 − 1 ps ) . (4.6) D O W Ó D. Jasna(?!) równość ϕ(pk) = pk −pk−1 = pk (1 − 1 p ) i multyplikatywność funkcji ϕ kończą dowód. Dobrze jednak przeprowadzić rozumowanie niezależne (dowodzące zresztą, że ϕ jest multyplikatywna). Korzystamy przy tym z Zasady Włączeń-Wyłączeń, zob. KOM . Dla każdego dzielnika pierwszego pi|n oznaczmy przez Ai zbiór takich wszystkich liczb naturalnych k, że k ⩽ n i pi|k. Jasne, że |Ai| = n pi , i, ogólnie |Ai1 ∩ Ai2 ∩ . . . ∩ Ait| = n pi1pi2 · . . . · pit dla różnych 1 ⩽ i1 < i2 < . . . < it ⩽ s. Ponadto, suma A1 ∪ A2 ∪ . . . ∪ As składa sie z tych wszystkich liczb k ∈ [ n ], dla których NWD (k, n) ̸= 1. Zatem ϕ(n) = n−|A1 ∪A2 ∪ . . . ∪As|. To, po wykorzystaniu równości włączeń-wyłączeń, łatwo daje (4.6). □ P r z y k ł a d. Korzystając z multyplikatywności funkcji ϕ możemy (za Eulerem) pokazać nasz P I Ą T Y D O W Ó D TE: Zakładając, że p1 = 2, . . . , pr są liczbami pierwszymi, wybie- ramy liczbę 1 < m < p1 · . . . · pr względnie pierwszą z p1 · . . . · pr (taka liczba m istnieje, bo ϕ(p1 · . . . · pr) = ϕ(p1) · . . . · ϕ(pr) = (p1 − 1) · . . . · (pr − 1) ⩾ 2). Wybierając dowolny pierwszy dzielnik p|m, zob. T2.14, znajdujemy n o w ą, tzn. różną od p1, . . . , pr, liczbę pierwszą. ♦ Ćwiczenie 4.13 Udowodnić, że ϕ(n) jest liczbą parzystą dla każdego n ⩾ 3. Ćwiczenie 4.14 Udowodnić, że jeżeli m|n, to ϕ(m)|ϕ(n). Ćwiczenie 4.15 Udowodnić, że ϕ(d)ϕ(mn) = dϕ(m)ϕ(n), gdzie d = NWD (m, n). 4.3 Splot Dirichlet’a i odwracanie M¨obiusa Niech A oznacza zbiór wszystkich funkcji arytmetycznych. W zbiorze tym, poza oczywistym działaniem + dodawania funkcji, można wprowadzić pewne działanie mnożenia. Mnożenie to nazywa się splotem Dirichlet’a i oznacza ∗. Układ (A, +, ∗) okaże się być pierścieniem przemiennym z jedynką, zobacz D1.7. 4.3.1 Splot Dirichlet’a Mnożenie splotowe ma wiele zastosowań w teorii liczb. Deﬁnicja 4.5 Niech dane będą dwie funkcje arytmetyczne f i g. Splotem Dirichlet’a tych funkcji nazywamy funkcję arytmetyczną f ∗ g daną wzorem (f ∗ g)(n) = ∑ d|n f (d) · g (n d ) . 148 4. Funkcje arytmetyczne Ćwiczenie 4.16 Udowodnić, że splot jest działaniem łącznym i przemiennym. Ćwiczenie 4.17 Splot funkcji multyplikatywnych jest funkcją multyplikatywną. Ćwiczenie 4.18 Uzasadnić, że funkcja arytmetyczna ε dana przez ε(n) = { 1, gdy n = 1, 0, gdy n > 1, (4.7) jest elementem neutralnym względem splotu. 4.3.2 Twierdzenie M¨obiusa o odwracaniu Dziwnie wyglądająca (na pierwszy rzut oka) funkcja µ M¨obiusa jest niezwykle przydatna. Deﬁnicja 4.6 (Funkcja µ M¨obiusa) Jeżeli n = pe1 1 pe2 2 · . . . · pes s jest kanonicznym roz- kładem liczby naturalnej n na czynniki pierwsze, to kładziemy µ(n) =  | | 1, gdy n = 1, (−1) s, gdy wszystkie ei są równe 1, 0, gdy przynajmniej jeden z wykładników ei jest ⩾ 2. (4.8) TWIERDZENIE 4.4 Funkcja µ M¨obiusa jest funkcją multyplikatywną. D O W Ó D. Dowód jest natychmiastowy: jeżeli n = pe1 1 pe2 2 · . . . · pes s , m = qf1 1 qf2 2 · . . . · qft t są względnie pierwsze, to żadne pi nie jest równe żadnemu qj. Przypadek, gdy któreś ei lub któreś fj jest ⩾ 2, jest oczywisty. Przypadek, gdy wszystkie ei = 1 i wszystkie fj = 1, jest równie oczywisty i sprowadza się do równości (−1) s+t = (−1) s · (−1) t. □ Określimy teraz jeszcze jedną arcyprostą funkcję arytmetyczną wzorem 1(n) = 1 dla każdego n ∈ N. (4.9) P r z y k ł a d 1. Mamy (1 ∗ 1)(n) = ∑ d|n 1(d) · 1 ( n d ) = ∑ d|n 1 = τ (n). ♦ ZADANIE 4.3 Udowodnić, że funkcje µ i 1 są wzajemnie swoimi odwrotnościami wzglę- dem splotu. Czyli, że µ ∗ 1 = ε R o z w i ą z a n i e. Ponieważ µ i 1 są funkcjami multyplikatywnymi więc ich splot też jest multyplikatywny. Zatem, zobacz 4.1 U, wystarczy sprawdzić, że (µ ∗ 1)(pk) = 0 dla każdego p ∈ P i każdego k ∈ N. A to jest jasne. ♦ P r z y k ł a d 2. Dla każdej liczby naturalnej n zachodzi równość ∑ d|n τ (d)µ ( n d ) = 1. (4.10) Rzeczywiście, wobec P1, τ ∗ µ = (1 ∗ 1) ∗ µ = 1 ∗ (1 ∗ µ) = 1 ∗ ε = 1 (zobacz C4.18). ♦ 4.3. Splot Dirichlet’a i odwracanie M¨obiusa 149 P r z y k ł a d 3. Niech ι(n) = n dla każdego n. Równość (4.5) może być zapisana tak: ϕ ∗ 1 = ι. Wobec tego, dla każdego n ∈ N, ϕ(n) = n ∑ d|n µ(d) d , (4.11) co jest tylko innym zapisem równości ϕ = ϕ ∗ (1 ∗ µ) = (ϕ ∗ 1) ∗ µ = ι ∗ µ. ♦ TWIERDZENIE 4.5 (Twierdzenie M¨obiusa o odwracaniu) Jeżeli dana jest funkcja arytmetyczna f , a funkcja arytmetyczna g zadana jest wzorem g(n) = ∑ d|n f (d), (4.12) to dla każdego n ∈ N f (n) = ∑ d|n µ(d)g (n d ) . (4.12’) D O W Ó D. Zauważmy, że równość (4.12) może być zapisana jako g = 1 ∗ f . Reszta, tak jak w P2 i P3, wynika z łączności splotu i ze wzajemnej odwrotności funkcji µ i 1. □ Ćwiczenie 4.19 Udowodnić, że obie równości (4.12) i (4.12’) są równoważne równości n∑ k=1 g(k) = n∑ d=1 ⌊n d ⌋ f (d). (4.12”) Multyplikatywna (dotycząca mnożenia) wersja wynikania (4.12) ⇒ (4.12’) opisana jest w C4.20. Przez C∗ oznaczamy zbiór niezerowych liczb zespolonych. Ćwiczenie 4.20 Dana jest funkcja arytmetyczna f : N −→ C ∗. Oznaczymy przez h funkcję arytmetyczną daną wzorem h(n) = ∏ d|n f (d) dla każdego n. Udowodnić, że wówczas f (n) = ∏ d|n h ( n d )µ(d) . Wskazówka. ∏ d|n h( n d ) µ(d) = ∏ d|n ∏ e| n d f (e)µ(d) = ∏ ed|n f (e) µ(d) = ∏ e|n f (e) ∑d| n e µ(d) = f (n). Zastosujemy powyższe do wzbogacenia wiedzy o wielomianach cyklotomicznych, zob. 3.4.6. Ćwiczenie 4.21 Udowodnić, że n-ty wielomian cyklotomiczny wyraża się formułą Φn(X) = ∏ d|n (X d − 1)µ( n d ). (4.13) Ćwiczenie 4.22 Udowodnić, że wielomian cyklotomiczny Φn(X) ma współczynniki cał- kowite. Wskazówka. Wielomiany stojące w liczniku i mianowniku ilorazu z prawej strony równości (4.13) są unormowane i należą do Z[X]. Zobacz też dowód T3.3. Ćwiczenie 4.23 Uzasadnić, że deg Φn(X) = ϕ(n). Uzasadnić też, że wyraz wolny Φn(0) jest równy ±1. Wskazówka. Zobacz (3.46). 150 4. Funkcje arytmetyczne 4.4 Piętnaście zadań dodatkowych Warto rozwiązać jeszcze kilka zadań. 4.4.1 Treści zadań Do rozwiązania poniższych zadań wystarczy teoria wyłożona w poprzednich rozdziałach. W jednym miejscu korzystamy z tak zwanego Postulatu Bertrand’a, zob. T12.11. A. Zadania o funkcjach τ , σ i ϕ ZADANIE 4.A1 Uzasadnić, że zbiór {n ∈ N : τ (n)|n} jest nieskończony. ZADANIE 4.A2 Dowieść, że jeżeli ϕ(n)|n, to n jest postaci 2a3b. ZADANIE 4.A3 Udowodnić: (1) σ(n) > τ (n) √n dla dowolnego n ∈ N̸=1; (2) ϕ(n) ⩾ √n dla wszystkich n ̸= 2, 6; (3) ϕ(n) ⩽ n − √ n dla z ł o ż o n y c h n ∈ N. ZADANIE 4.A4 Obliczyć w ciągu 10 minut sumę ∑100 k=1 τ (k). ZADANIE 4.A5 Rozwiązać w liczbach naturalnych równanie τ (n) + ϕ(n) = n. ZADANIE 4.A6 Udowodnić, że istnieje nieskończenie wiele takich liczb naturalnych n ⩾ 2, dla których spełniona jest nierówność σ(n) n > max{ σ(1) 1 , σ(2) 2 , . . . , σ(n−1) n−1 }. ZADANIE 4.A7 Udowodnić, że jeżeli σ(n) jest potęgą (o wykładniku naturalnym) liczby 2, to również τ (n) jest potęgą (o wykładniku naturalnym) liczby 2. ZADANIE 4.A8 Udowodnić, że dla każdej liczby n ∈ N zachodzi równość ⌊ n 1 ⌋ ϕ(1) + ⌊ n 2 ⌋ ϕ(2) + . . . + ⌊ n n ⌋ ϕ(n) = n(n + 1) 2 . (4.14) B. Inne funkcje arytmetyczne ZADANIE 4.B1 Dla n = pe1 1 pe2 2 ·. . .·pes s ∈ N kładziemy λ(n) = (−1)e1+e2+···+es, w szczególności λ(1) = 1. Udowodnić, że λ ∗ 1 jest funkcją charakterystyczną podzbioru kwadratów w N. ZADANIE 4.B2 Przez σ+(n) oznaczamy sumę tych naturalnych dzielników k liczby n, dla których λ(k) = +1 (zob. Z4.B1), przez σ−(n) oznaczamy sumę pozostałych dzielników naturalnych liczby n. Udowodnić, że n 7−→ σ+(n) − σ−(n) jest funkcją arytmetyczną m u l t y p l i k a t y w n ą. ZADANIE 4.B3 Przez i(n) oznaczmy iloczyn wszystkich (naturalnych) dzielników liczby natu- ralnej n. Rozstrzygnąć, czy istnieją różne liczby m, n, dla których i(m) = i(n). C. Funkcja arytmetyczna π ZADANIE 4.C1 Przez π(n) oznaczamy moc zbioru P ∩ {1, 2, . . . , n}, czyli liczbę liczb pierw- szych ⩽ n. Udowodnić Twierdzenie Eulera: limn→∞ π(n) n = 0. ZADANIE 4.C2 Udowodnić, że zbiór {n ∈ N : π(n)|n} jest nieskończony. D. Drugie twierdzenie M¨obiusa o odwracaniu ZADANIE 4.D1 Niech f : ( 0; ∞ ) −→ C będzie dowolną funkcją spełniającą warunek f (x) = 0 dla wszystkich x ∈ ( 0; 1 ). Oznaczmy przez F funkcję F (x) = ∑ k∈N f ( x k ) (suma pusta jest z deﬁnicji równa 0). Udowodnić, że wówczas f (x) = ∑k∈N µ(k)F ( x k ) dla każdego x > 0. ZADANIE 4.D2 Udowodnić równość ϕ(1) + ϕ(2) + · · · + ϕ(n) = 1 2 + 1 2 n∑ k=1 µ(k) ⌊ n k ⌋2 . (4.15) 4.4. Piętnaście zadań dodatkowych 151 4.4.2 Rozwiązania wybranych ćwiczeń i zadań dodatkowych Pokazujemy też rozwiązania wybranych ćwiczeń z tego rozdziału. C4.6 (ZZU) Zauważmy, że (po zakończonej zabawie) szafka o numerze k będzie otwarta iﬀ zmie- niano jej stan nieparzystą liczbę razy. Ponieważ jej stan zmieniali ci (i tylko ci) uczniowie, których kod jest dzielnikiem numeru k, więc szafka o numerze k będzie otwarta iﬀ τ (k) jest liczbą nieparzystą, czyli, zob. C4.4, iﬀ k jest kwadratem. Kwadratów ⩽ 456 jest dokładnie 21. (ZWM) Absencją (danego dnia) nazwiemy podzbiór zbioru [ n ] = {1, 2, . . . , n} składający się z numerów uczniów nieobecnych (tego dnia) w szkole. Zbiór A wszystkich absencji utożsamiamy więc ze zbiorem potęgowym P([ n ]), zob. KOM . Zbiór S możliwych stanów szafek (utożsamialny ze zbiorem ciągów binarnych długości n, zob. KOM ) równie łatwo utożsamiamy ze zbiorem potęgowym P([ n ]). Wymyślona przez uczniów zabawa wyznacza f u n k c j ę Z : A −→ S. Pan woźny twierdzi, że Z jest b i j e k c j ą. Dla uzasadnienia jego tezy wystarczy udowodnić, że Z jest i n j e k c j ą (zobacz KOM C1.12). Niech więc A1 będzie absencją pewnego dnia (powiedzmy we wtorek), A2 absencją innego dnia (powiedzmy w środę) i załóżmy, że A1 ̸= A2. Wówczas co najmniej jeden ze zbiorów A1 ∖ A2, A2 ∖ A1 jest niepusty (A1 ∖ A2 = A2 ∖ A1 = ∅ iﬀ A1 = A2). Załóżmy (b.s.o.), że A1 ∖ A2 ̸= ∅ i że k jest najmniejszą liczbą zbioru A1 ∖ A2. To znaczy, że uczeń o kodzie k był nieobecny we wtorek i obecny w środę, a każdy uczeń o kodzie mniejszym niż k albo był obecny we wtorek i w środę, albo był nieobecny i we wtorek i w środę. Jasnym być powinno, że pan woźny zobaczy inny stan szafki o numerze k we wtorek a inny w środę. Zatem Z(A1) ̸= Z(A2). C4.8 Wyobraźmy sobie tablicę kwadratową (szachownicę) wymiaru n × n. W pole (k, l) (czyli l-te pole k-tego wiersza) wpisujemy krzyżyk wtedy i tylko wtedy, gdy l|k. Należy teraz zauważyć, że obie strony dowodzonej równości wyrażają liczbę wszystkich krzyżyków : lewa strona ”zlicza” krzyżyki wierszami, a prawa ”zlicza” krzyżyki kolumnami. (Zasada podwójnego zliczania!) C4.9 Korzystamy z (łatwej do udowodnienia przez indukcję) równości N∑ k=1 k3 = ( N∑ k=1 k) 2. (4.16) Dzięki niej widzimy, że równość (4.3) jest prawdziwa, gdy n jest potęgą pe liczby pierwszej. Przypadek dowolnego n najprościej jest sprawdzić dowodząc, że funkcje n 7−→ ∑ d|n τ (d)3 i n 7−→ ( ∑ d|n τ (d) )2 są funkcjami arytmetycznymi multyplikatywnymi. Zobacz 4.1 U i C4.17. C4.11 Oznaczmy Σ(n) = σ(1) + σ(2) + . . . + σ(n) dla n ∈ N. Z Z4.1 mamy Σ(n) ⩽ n2. Stosujmy metodę sumowania przez części (transformację Abela): n∑ k=1 σ(k) k = Σ(1) 1 + Σ(2) − Σ(1) 2 + · · · + Σ(n) − Σ(n − 1) n = = (1 − 1 2 ) Σ(1) + ( 1 2 − 1 3 ) Σ(2) + ( 1 3 − 1 4 ) Σ(3) + · · · + ( 1 n−1 − 1 n ) Σ(n − 1) + 1 n Σ(n) ⩽ ⩽ (1 − 1 2 ) · 12 + ( 1 2 − 1 3 ) · 2 2 + ( 1 3 − 1 4 ) · 32 + · · · + ( 1 n−1 − 1 n ) · (n − 1) 2 + 1 n · n2 = = n−1∑ k=1 1 k(k+1) · k2 + n = n−1∑ k=1 k k+1 + n. Sprawdzenie, że ∑n−1 k=1 k k+1 ⩽ n, jest natychmiastowe. Z4.A1 Do tego zbioru należą wszystkie liczby n = pp−1 dla p ∈ P. 152 4. Funkcje arytmetyczne Z4.A2 Korzystając z (4.6), łatwo uzasadnić, że jeżeli liczba n ma (co najmniej) dwa różne niepa- rzyste dzielniki pierwsze, to ϕ(n) ∤ n. Rzeczywiście, pisząc n = 2apbqcm, gdzie 2 < p < q są liczbami pierwszymi, 2 ⊥ m, p ⊥ m, q ⊥ m, oraz b, c ⩾ 1, mamy ϕ(n) = 2a−1pb−1(p−1)qc−1(q −1)ϕ(m), gdy a ⩾ 1, oraz ϕ(n) = pb−1(p − 1)qc−1(q − 1)ϕ(m), gdy a = 0. W każdym z tych dwóch przypadków v2(ϕ(n)) > v2(n), patrz teraz C2.41. Zbadanie liczb postaci 2apb pozostawiamy Czytelnikowi. Z4.A3(1) Niech D+(n) = {d1, . . . , ds} (s = τ (n)). Korzystając z nierówności AG mamy σ(n) τ (n) = d1 + · · · + ds s > s√ d1 · . . . · ds. Nierówność jest ostra, bo di są różne. Wystarczy więc uzasadnić, że s√d1 · . . . · ds = √n. A to jest natychmiastowym wnioskiem z 4.1.1 U. (2) Gdy n = 2k, to ϕ(n) = 2k−1, co, przy k ⩾ 2, jest ⩾ 2k/2 = √n. Gdy n = pk, gdzie p ∈ P ∖ {2}, to ϕ(n) = pk−1(p − 1) ⩾ √pk = √n, itd. (3) Niech p1 będzie najmniejszym dzielnikiem pierwszym liczby złożonej n ∈ N. Wówczas, zob. C2.35, p1 ⩽ √n, skąd, zob. (4.6), ϕ(n) = n (1 − 1 p1 ) ( 1 − 1 p2 ) · . . . · ( 1 − 1 ps ) ⩽ n ( 1 − 1 p1 ) ⩽ n ( 1 − 1 √n ) = n − √n. Z4.A4 W ciągu pierwszej minuty przypominamy sobie C4.8 i przekonujemy się, że łatwiej jest obliczyć sumę ∑100 k=1 ⌊ 100 k ⌋. Ale to również jest nieco deprymujące. Warto więc poświęcić osiem minut na dowód następującego wzoru Dirichlet’a: T (n) = 2 (⌊ n 1 ⌋ + ⌊ n 2 ⌋ + · · · + ⌊ n ⌊√n⌋ ⌋) − ⌊√n⌋2. (4.17) Liczba τ (k) przedstawia, oczywiście, liczbę roz- wiązań w N równania xy = k (każdy dzielnik na- turalny d liczby k daje parę (x, y) = (d, k d ) i odwrotnie). Wobec tego liczba T (n) = ∑n k=1 τ (k) przedstawia liczbę rozwiązań w liczbach natural- nych nierówności xy ⩽ n. Warto popatrzeć na to g e o m e t r y c z n i e. Wszystko zobaczyć można na rysunku obok przedstawiającym przypadek n = 12. Liczba T (n) jest liczbą punktów kratowych (x, y) ∈ N × N leżących pod wykresem funkcji f (x) = n x i na samym wykresie. Tzn., wewnątrz i na brzegu ”trójkąta” HEB. Mamy B = (1, n), E = (n, 1), G = (√n, √n). Całość jest symetryczna wzglę- dem prostej OG (dwusiecznej pierwszej ćwiartki układu współrzędnych). Łatwo dzięki temu właści- wie zinterpretować wyrażenie z prawej strony rów- ności (4.17): składnik ⌊ n k ⌋ sumy ∑⌊√n⌋ k=1 ⌊ n k ⌋ wy- F2F1 A1 A2 2K 1L a bc K1 L 2 O Rys. 5.21 O A BC D E F G H Rys. 4.1. raża liczbę badanych punktów kratowych na prostej x = k, więc ta suma jest równa liczbie badanych punktów kratowych w ”pięciokącie” OAGBC. Ta liczba jest równa liczbie badanych punktów kra- towych w (symetrycznym) ”pięciokącie” ODGEF . Dwukrotność tej sumy jest więc liczbą badanych punktów kratowych w ”pięciokącie” OF EBC, przy czym punkty kratowe leżące w kwadracie OAGD liczymy dwukrotnie. Dlatego trzeba odjąć ⌊√n⌋2. 4.4. Piętnaście zadań dodatkowych 153 Ostatnia minuta powinna wystarczyć do wyliczenia ⌊ 100 1 ⌋ + ⌊ 100 2 ⌋ + ⌊ 100 3 ⌋ + ⌊ 100 4 ⌋ + ⌊ 100 5 ⌋ + ⌊ 100 6 ⌋ + ⌊ 100 7 ⌋ + ⌊ 100 8 ⌋ + ⌊ 100 9 ⌋ + ⌊ 100 10 ⌋ . Dostajemy 291. Ostatecznie T (100) = 2 · 291 − 100 = 482. Z4.A5 W zbiorze [ n ] = {1, . . . , n} mamy dwa podzbiory: Φn = {k ∈ [ n ] : NWD (k, n) = 1} i D+(n) = {k ∈ [ n ] : k|n} = {k ∈ [ n ] : NWD (k, n) = k}. Jasne, że Φn ∩ D+(n) = {1}. Oznaczmy Rn = [ n ] ∖ (Φn ∪ D+(n)). Rn składa się z tych liczb k ∈ [ n ], które nie są dzielnikami n i nie są względnie pierwsze z n. Czyli Rn = {k ∈ [ n ] : 1 < NWD (k, n) < k}. Mamy więc rozbicie [ n ] = (Φn ∖ {1}) ⊔ D+(n) ⊔ Rn. Skąd n = |Φn ∖ {1}| + |D+(n)| + |Rn| = ϕ(n) − 1 + τ (n) + |Rn|. W ten sposób uzasadniliśmy kryterium: L e m a t. Równość ϕ(n) + τ (n) = n zachodzi wtedy i tylko wtedy, gdy |Rn| = 1. □ (1) Pokażemy, że jeżeli |Supp(n)| ⩾ 3, to ϕ(n) + τ (n) ̸= n. Rzeczywiście, załóżmy, że n = cpqr, gdzie c ∈ N, a p < q < r są liczbami pierwszymi, przy czym r jest n a j w i ę k s z y m dzielnikiem pierwszym liczby n. Wybierzmy liczbę pierwszą l spełniającą nierówności r < l < 2r. Taka liczba istnieje na mocy Postulatu Bertrand’a, zob. T12.11. Wówczas pl, ql ∈ Rn. Rzeczywiście, pl < ql < 2qr ⩽ n oraz NWD (pl, n) = NWD (ql, n) = l < pl < ql. Zatem |Rn| ⩾ 2, więc, na mocy kryterium, ϕ(n) + τ (n) ̸= n. (2) Załóżmy teraz, że n = cpq, gdzie p < q są liczbami pierwszymi, oraz c ∈ N i c ⩾ 4. Wybierzmy wówczas liczby pierwsze l1, l2 spełniające nierówności q < l1 < 2q < l2 < 4q. Wtedy l1p, l2p ∈ Rn. Więc |Rn| ⩾ 2, skąd ϕ(n) + τ (n) ̸= n dla takich n. Pozostały nam do rozpatrzenia następujące przypadki: (3) n = 3pq, p < q. Wówczas, jeżeli p ̸= 3 i q ̸= 3, to |Supp(n)| ⩾ 3, więc jesteśmy w przypadku (1). Jeżeli zaś p = 3, to n = 9q i wtedy τ (n) + ϕ(n) = 3 · 2 + 6(q − 1) = 6q ̸= n. Jeżeli wreszcie q = 3, to n = 18 i wtedy τ (n) + ϕ(n) = 6 + 6 = 12 ̸= n. (4) n = 2pq, p < q. Wówczas, jeżeli 2 < p, to |Supp(n)| ⩾ 3. Jeżeli zaś p = 2, to n = 4q i wtedy τ (n) + ϕ(n) = 3 · 2 + 2(q − 1) = 4 + 2q co, dla q > 2, jest ̸= n. (5) n = pq, p < q. W tej sytuacji τ (n) + ϕ(n) = 4 + (p − 1)(q − 1), więc równość τ (n) + ϕ(n) = n zachodzi tylko, gdy p + q = 5. Stąd p = 2, q = 3, więc n = 6. (6) n = pe, e ⩾ 1. Wtedy τ (n) + ϕ(n) = e + 1 + pe − pe−1 i równość τ (n) + ϕ(n) = n zachodzi tylko, gdy e + 1 = pe−1. Taka równość może zajść co najwyżej dla e = 1, 2, 3. Rzeczywiście, pe−1 ⩾ 2e−1, a e + 1 < 2e−1 dla wszystkich e ⩾ 4 (łatwe sprawdzenie przez indukcję pozostawiamy Czytelnikowi). W podprzypadku e = 1 mamy τ (n) + ϕ(n) = 2 + p − 1 ̸= n. W podprzypadku e = 2 mamy τ (n) + ϕ(n) = 3 + p2 − p, co jest równe n tylko dla p = 3. Stąd dostajemy rozwiązanie n = 9. W podprzypadku e = 3 mamy τ (n) + ϕ(n) = 4 + p3 − p2, co jest równe n tylko dla p = 2. Stąd dostajemy rozwiązanie n = 8. (7) Ten przypadek dotyczy tylko liczby n = 1, dla której τ (n) + ϕ(n) ̸= n. Z4.A6 Wyraz an ciągu o wyrazach rzeczywistych (an), który jest ściśle większy od wszystkich wyrazów poprzednich (tzn., an > ak dla wszystkich k = 1, . . . , n − 1), nazwijmy wyrazem górującym ciągu. Udowodnimy lemat: L e m a t. Jeżeli ciąg (an) ma skończenie wiele wyrazów górujących, to jest ciągiem ograniczonym z góry. D o w ó d. Niech N będzie największym indeksem, dla którego aN jest wyrazem górującym. Twierdzimy, że wówczas aN ⩾ an dla wszystkich n. Nierówność ta jest prawdziwa dla n ⩽ N (bo aN jest górujący). Gdyby zaś istniały takie j ∈ N, że aN +j > aN , to wybierając j = j0, najmniejsze takie j (Zasada Minimum!), dostaniemy ”nowy” wyraz górujący aN +j0. Sprzeczność. Q.e.d. 154 4. Funkcje arytmetyczne Mając ten lemat można rozwiązać zadanie dowodząc, że ciąg ( σ(n) n ) n i e jest ciągiem ograniczo- nym. Na przykład tak: ponieważ każda z liczb n! 1 , n! 2 , . . . , n! n jest dzielnikiem liczby N = n!, więc liczba σ(N ) N = σ(n!) n! jest większa niż 1 + 1 2 + · · · + 1 n , czyli, zobacz T12.5, dowolnie duża. Ci którzy nie znają jeszcze szeregu harmonicznego mogą rozumować następująco. Zauważyć naj- pierw, że pokazany dowód lematu dowodzi więcej niż tylko ograniczoność ciągu (an). Pokazuje miano- wicie, że (an) jest ograniczony z góry przez najstarszy (tzn., o największym indeksie) wyraz górujący. Gdyby więc σ(N ) N był najstarszym wyrazem górującym ciągu ( σ(n) n ), to wybierając dowolną liczbę pierwszą p ∤ N znaleźlibyśmy sprzeczność: σ(pN ) pN = σ(p) p · σ(N ) N = p+1 p · σ(N ) N > σ(N ) N . Z4.A7 Korzystając z równości (4.2) i (4.3) sprowadzamy rozwiązanie do następującego lematu: L e m a t. Jeżeli p ∈ P i e ∈ N, a liczba (pe+1 − 1)/(p − 1) jest potęgą dwójki, to również liczba e + 1 jest potęgą dwójki. Dowód lematu i jego wykorzystanie pozostawiamy Czytelnikowi. Z4.A8 Możemy to zrobić przez indukcję względem n. Mamy mianowicie n+1∑ k=1 ⌊ n+1 k ⌋ϕ(k) = n+1∑ k=1 (⌊ n+1 k ⌋ − ⌊ n k ⌋) ϕ(k) + n+1∑ k=1 ⌊ n k ⌋ϕ(k). Łatwo uzasadnić, że ⌊ n+1 k ⌋ − ⌊ n k ⌋ = { 1, gdy k|n + 1, 0, gdy k ∤ n. dla k, n ∈ N. Wobec tego n+1∑ k=1 ⌊ n+1 k ⌋ϕ(k) = ∑ k|n+1 ϕ(k) + n∑ k=1 ⌊ n k ⌋ϕ(k) = n + 1 + n(n + 1) 2 , na mocy T4.2 i założenia indukcyjnego. Z4.B1 Funkcja λ jest oczywiście funkcją multyplikatywną (nawet silnie multyplikatywną, to znaczy że równość (4.1) zachodzi dla wszystkich, a nie tylko dla względnie pierwszych, liczb natu- ralnych m, n). Zatem, zobacz C4.17, funkcja n 7−→ ∑d|n λ(d), czyli funkcja 1 ∗ λ, jest również funkcją multyplikatywną. Wobec tego wystarczy uzasadnić, że dla dowolnej liczby pierwszej p, suma∑ k⩽e λ(pk) jest równa 1 iﬀ 2|e i jest równa 0 iﬀ 2 ∤ e. A to jest jasne. Z4.B2 Wykazujemy, że dla dowolnych względnie pierwszych m, n ∈ N: σ+(mn) = σ+(m) · σ+(n) + σ−(m) · σ−(n), σ−(mn) = σ+(m) · σ−(n) + σ−(m) · σ+(n). Stąd natychmiast widzimy multyplikatywność funkcji n 7−→ σ+(n) − σ−(n). Z4.B3 Z C4.7 wiemy, że i(n) = nτ (n)/2. Załóżmy, że dla pewnych m, n ∈ N zachodzi równość i(m) = i(n), czyli równość mτ (m) = nτ (n). Wówczas, oczywiście, Supp(m) = Supp(n). Zapiszmy więc m = pd1 1 pd2 2 · . . . · pdr r i n = pe1 1 pe2 2 · . . . · per r . Równość i(m) = i(n) i jednoznaczność rozkładu dają więc równości d1τ (m) = e1τ (n), d2τ (m) = e2τ (n), . . . , drτ (m) = erτ (n), czyli, ei = dix dla i ∈ [r], gdzie x = τ (m)/τ (n). Korzystając teraz z (4.2) możemy więc napisać x = τ (m) τ (n) = (d1 + 1) · . . . · (dr + 1) (d1x + 1) · . . . · (drx + 1) . Stąd wnioskujemy, że x = 1 (gdy x > 1, to prawa strona jest < 1 i odwrotnie). Zatem m = n. Z4.C1 W trzech krokach udowodnimy więcej. 4.4. Piętnaście zadań dodatkowych 155 F a k t 1. Dla dowolnej liczby naturalnej k ⩾ 2 zachodzi nierówność π(2k) − π(k) ⩽ 2k log 2 log k . (4.18) D o w ó d. Pomysł polega na przyjrzeniu się współczynnikowi dwumiennemu (2k k ): Każda liczba pierwsza p ∈ ( k; 2k ] dzieli licznik ułamka 2k(2k−1)·...·(k+1) n! = (2k k ) i, oczywiście, n i e dzieli mia- nownika tego ułamka. Zatem p| (2k k ). Jeżeli więc p1, . . . , ps są wszystkimi liczbami pierwszymi z przedziału ( k; 2k ], to ich iloczyn p1 · . . . · ps jest dzielnikiem (2k k ), zobacz C2.17. W szczególności, zobacz C2.2, p1 · . . . · ps ⩽ (2k k ). Wobec tego kπ(2k)−π(k) = ks ⩽ p1p2 · . . . · ps ⩽ (2k k ) ⩽ (1 + 1)2k = 2 2k. Lewa nierówność wynika z nierówności k ⩽ p1 < · · · < ps. Prawa nierówność jest jasna, bo (2k k ) jest tylko jednym (środkowym!) wyrazem sumy ∑2k j=0 (2k j ) = 22k, zob. (1.7). Po zlogarytmowaniu dostajemy (4.18). Q.e.d. F a k t 2. Dla dowolnej liczby naturalnej m ⩾ 1 zachodzi nierówność π(22m) ⩽ 3 · 22m 2m . D o w ó d. Kładąc w (4.18) kolejno k = 22m−1, 22m−2, . . . , 2m i dodając stronami dostajemy π(2 2m) − π(2 m) ⩽ 22m 2m − 1 + 22m−1 2m − 2 + · · · + 2m+1 m . Stąd π(22m)−π(2m) ⩽ 2m+1 m (1+2+· · ·+2m−1) < 22m m . To, wraz z nierównością oczywistą π(2m) ⩽ 2m i nierównością łatwą 2m ⩽ 22m 2m , daje żądaną nierówność. Q.e.d. F a k t 3. Dla dowolnej liczby naturalnej n zachodzi nierówność: π(n) < 6 log 2 · n log n . (4.19) D o w ó d. Weźmy taką (oczywiście jedyną) liczbę m ∈ N, że 22m−1 ⩽ n < 22m. Wówczas π(n) ⩽ π(2 2m) ⩽ 3 · 22m 2m ⩽ 6n 2m < 6 log 2 · n log n , bo 22m ⩽ 2n i log n < 2m log 2. Q.e.d. Nierówność (4.19) daje więcej niż chcieliśmy: widzimy z niej, że ciąg π(n) n zbiega do 0 co najmniej tak szybko jak odwrotność logarytmu (pomnożona przez pewną stałą). Z4.C2 Ustalmy liczbę naturalną m ⩾ 2 i rozważmy zbiór A = {k ∈ N : π(km) ⩾ k}. Zbiór ten jest niepusty (bo 1 ∈ A) i skończony (bo, jak wiemy z poprzedniego zadania, π(km) km < 1 m dla wszystkich dostatecznie dużych k). Niech więc k0 będzie największym elementem tego zbioru. Twierdzimy, że wówczas π(k0m) = k0. Gdyby bowiem π(k0m) > k0, to mielibyśmy π((k0 + 1)m) ⩾ π(k0m) ⩾ k0 + 1 (pierwsza nierówność wynika z niemalejącości ciągu (π(n)), a druga z Zasady Skwantowania), co jest sprzeczne z maksymalnością k0. Mamy więc równość mπ(k0m) = k0m. Liczba n = k0m jest zatem takim argumentem, dla którego zachodzi podzielność π(n)|n. Co więcej, iloraz n/π(n) jest równy m. Uzasadniliśmy w ten sposób, że dla każdej liczby naturalnej m istnieje taka liczba naturalna nm, że π(nm)|nm. Liczby nm są różne (gdy ni = nj, to i = ni/π(ni) = nj/π(nj) = j). Przeto zbiór {n ∈ N : π(n)|n} jest zbiorem nieskończonym. U w a g a. Okazuje się, że to jest zadanie z analizy! Udowodniliśmy(?!) przecież następujący: 156 4. Funkcje arytmetyczne L e m a t. Jeżeli ciąg (an) liczb naturalnych jest ciągiem niemalejącym i rośnie do ∞, a jednocze- śnie limn→∞ an n = 0, to k a ż d y ułamek egipski 1 m jest wartością ciągu ( an n ). Z4.D1 Ustalmy liczbę rzeczywistą x > 0 i liczbę naturalną n. Zastanówmy się ile razy i z jakim znakiem występuje w sumie ∑ k∈N µ(k)F ( x k ) wyraz f ( x n ). Otóż, występuje on (ze znakiem µ(k)) w tych (i tylko tych) składnikach µ(k)F ( x k ), dla których k|n. Wobec tego ∑ k∈N µ(k)F ( x k ) = ∑ n∈N ( ∑ k|n µ(k))f ( x n ) = f (x), bo ∑ k|n µ(k) = 0 dla wszystkich n > 1, zobacz Z4.3. Z4.D2 Oznaczmy, dla danego d ⩽ n, Id(n) = {(k, l) ∈ N × N : 1 ⩽ k, l ⩽ n, NWD (k, l) = d}. Zauważmy, że zbiór I1(n) składa się z tych i tylko tych punktów kratowych o współrzędnych naturalnych ⩽ n, które widać z punktu (0, 0). To znaczy tych, których nie ”zasłania” inny punkt kratowy. Na ry- sunku 4.2 pokazujemy przypadek n = 12. Łatwo wi- dzieć, że: (1) odbicie (x, y) 7−→ (y, x) (czyli odbicie w dwu- siecznej I ćwiartki układu współrzędnych) daje bijek- cję zbioru T tych punktów (x, y) ∈ I1(n), dla któ- rych 0 < y ⩽ x ⩽ n na zbiór tych punktów zbioru I1(n), dla których 0 < x ⩽ y ⩽ n, (2) card (I1(n) ∩ T ) = ϕ(1) + ϕ(2) + · · · + ϕ(n). Rzeczywiście, punkty zbioru I1(n) leżące w trójkącie T na prostej x = k to dokładnie te punkty (k, l), dla których 1 ⩽ l ⩽ k i NWD (k, l) = 1. Wobec tego mamy równość: F2F1 A1 A2 2K 1L a bc K1 L 2 O Rys. 5.21 O A BC D E F G H O A D E F G H Rys. 4.2 ϕ(1) + ϕ(2) + ϕ(3) + · · · + ϕ(n) = 1 + card I1(n) 2 . Dla zakończenia rozwiązania wystarczy więc udowodnić równość card I1(n) = ∑ k∈N µ(k) ⌊ n k ⌋2 . (4.20) Równość tę wyprowadzamy z Z4.D1 i dwóch obserwacji: (A) funkcja (k, l) 7−→ ( k d , l d ) jest bijekcją zbioru Id(n) na zbiór I1(⌊ n d ⌋). Zob. C2.12. (B) zbiory Id(n) dla d ⩽ n są parami rozłączne. Ich sumą jest zbiór [ n ] × [ n ], skąd n2 = card {(k, l) : 1 ⩽ k, l ⩽ n} = card I1(n) + card I2(n) + . . . card In(n). Jeżeli więc oznaczymy f (x) = card I1(⌊x⌋) dla dowolnego x > 0, to F (x) := ∑ k∈N f ( x k ) = ⌊x⌋2. Stąd i z Z4.D1 dostajemy równość (4.20). U w a g a. Korzystając z równości ∑k∈N µ(k) k2 = 1 ζ(2) = 6 π2 , zob. T12.7, i równości (4.20), można wykazać, że zachodzi następująca równość card I1(n) = 6n2 π2 + C(n)n log n (4.21) dla pewnej funkcji o g r a n i c z o n e j C. Można z niej wywnioskować, że losowo wybrany ułamek k l , dla 1 ⩽ k, l ⩽ n, jest nieskracalny z prawdopodobieństwem bliskim 6 π2 ≈ 0, 6079. Rozdział 5 Arytmetyka modularna Man weiß, das alle Bem¨uhungen der gr¨oßten Mathematiker vor Gauß an dieser steilen Klippe gescheitert sind, bis es endlich diesem Einzigen gelang, den verborgenen Pfad zu entdecken und bis zum Ziele vorzudringen. (Gotthold Eisenstein) Arytmetyka modularna jest sztuką wykonywania operacji algebraicznych d o d a w a n i a, m n o ż e n i a i, gdy się uda, d z i e l e n i a, a nawet r o z w i ą z y w a n i a r ó w n a ń algebraicz- nych, nie na liczbach, ale na r e s z t a c h z dzielenia liczb całkowitych przez ustaloną liczbę naturalną m > 1 zwaną modułem (łac. modulus – miara). Startując od wstępnych deﬁ- nicji, poprzez twierdzenia Eulera, Fermat’a i Wilsona dochodzimy do twierdzenia chińskiego o resztach. Następnie uczymy się pojęć rzędu elementu grupy, pierwiastków pierwotnych i reszt kwadratowych. Kulminacyjnym twierdzeniem rozdziału jest prawo wzajemności dla reszt kwadratowych. O tym właśnie twierdzeniu mówi przytoczone wyżej zdanie Eisensteina. 5.1 Wstęp do teorii kongruencji Wprowadzimy pojęcie kongruencji. Pokażemy podstawowe motywacje uzasadniające przydat- ność i potrzebę takiego wprowadzenia. I zaczniemy się uczyć rozwiązywania równań wielomia- nowych w arytmetyce modularnej. 5.1.1 Deﬁnicja i cechy podzielności Poznajemy teraz (pochodzącą od Gaussa) notację. Nauczymy się elementarnych reguł mani- pulacji z kongruencjami i zastosujemy je w dowodzie (najprostszych) cech podzielności. Deﬁnicja 5.1 Niech m > 1 będzie ustaloną liczbą naturalną. Mówimy, że liczba całkowita a przystaje do liczby całkowitej b modulo m, gdy m|a − b. Zapisujemy to tak: a ≡ b (mod m). Relację · ≡ · (mod m) nazywamy kongruencją modulo m (lub według modułu m). Jasnym jest (być powinno!), że relacja a ≡ b (mod m) zachodzi wtedy i tylko wtedy, gdy liczby a i b dają tę samą resztę z dzielenia przez m. 158 5. Arytmetyka modularna TWIERDZENIE 5.1 Ustalmy liczbę naturalną m > 1. Wówczas dla dowolnych liczb całkowitych a, b, c, d zachodzą związki: (1) a ≡ a (mod m), (2) jeżeli a ≡ b (mod m), to b ≡ a (mod m), (3) jeżeli a ≡ b (mod m) i b ≡ c (mod m), to a ≡ c (mod m), (4) jeżeli a ≡ b (mod m) i c ≡ d (mod m), to a ± c ≡ b ± d (mod m), (5) jeżeli a ≡ b (mod m) i c ≡ d (mod m), to ac ≡ bd (mod m). D O W Ó D. Uzasadnimy jedynie punkt (5). Czytelnik zechce się przekonać, że pozostałe są dla niego oczywiste. Niech c − d = ms i a − b = mt. Wówczas ac − bd = ac − ad + ad − bd = a(c − d) + (a − b)d = ams + mtd = m(as + td), co pokazuje, że m|ac − bd, i kończy dowód. □ Tezy (1), (2) i (3) mówią, że relacja kongruencji modulo m jest relacją równoważności, zob. KOM . Tezy (4) i (5) mówią, że relacja ta jest zgodna z dodawaniem (odejmowaniem) i mnożeniem. To oznacza, że kongruencje wolno d o d a w a ć, (o d e j m o w a ć) i m n o ż y ć stronami. Również p o t ę g o w a ć. Oto kilka przykładów wykorzystania tych własności: P r z y k ł a d 1. Dwiema ostatnimi cyframi (dziesiętnymi) liczby Fermat’a F10 są 1, 7. Rzeczywiście: 2 12 = 4096, czyli 2 12 ≡ −4 (mod 100). Wobec tego 2 72 ≡ (212) 6 ≡ (−4) 6 ≡ 2 12 ≡ −4 (mod 100). Stąd 2 432 ≡ (2 72) 6 ≡ (−4)6 ≡ −4 (mod 100). Zatem 2 1024 = (2 432)2 · (272) 2 · 2 12 · 2 4 ≡ (−4) 2 · (−4)2 · (−4) · 2 4 ≡ −2 14 ≡ −(−4) · 2 2 ≡ 16 (mod 100). Wobec tego F10 ≡ 17 (mod 100). Q.e.d. Podobne (nieco żmudniejsze) rachunki pokazują, że trzema ostatnimi cyframi dziesiętnymi liczby F10 są 2, 1, 7. Q.e.d. ♦ P r z y k ł a d 2. Liczba Ln = 2 n+2 + 32n+1 jest, dla każdego n ∈ N, podzielna przez 7. Rzeczywiście: 2 n+2 ≡ 4 · 2 n (mod 7) oraz 3 2n+1 ≡ 3 · (3 2) n ≡ 3 · 2 n (mod 7). Stąd, po dodaniu stronami, Ln ≡ 7 · 2 n ≡ 0 (mod 7). Q.e.d. ♦ P r z y k ł a d 3. Liczba Ln = 3n + 4n nie jest, dla żadnego n ∈ N, podzielna przez 11. Rzeczywiście: (3, 3 2, 3 3, 3 4, 3 5) ≡ (3, 9, 5, 4, 1) (mod 11) (taki zapis oznacza, oczywiście, że kolejne wyrazy ciągu z lewej strony przystają modulo 11 do odpowiednich wyrazów ze strony prawej) oraz (4, 4 2, 4 3, 4 4, 4 5) ≡ (4, 5, 9, 3, 1) (mod 11). Wobec tego (L5k+1, L5k+2, L5k+3, L5k+4, L5k+5) ≡ (7, 4, 4, 7, 2) (mod 11) dla każdego k ∈ N, co oznacza, że żadna liczba Ln nie przystaje do 0 modulo 11. Q.e.d. ♦ Prostym ale bardzo ważnym wnioskiem1 z T5.1 jest: TWIERDZENIE 5.2 Niech f (X) ∈ Z[X] będzie wielomianem o współczynnikach całko- witych. Wówczas dla dowolnych liczb całkowitych a, b: a ≡ b (mod m) =⇒ f (a) ≡ f (b) (mod m). 1Jest to również wniosek z podzielności (3.3), z której korzystaliśmy już wielokrotnie. 5.1. Wstęp do teorii kongruencji 159 D O W Ó D. Niech f (X) = c0 +c1X +c2X 2 + . . . +cnX n. Wiemy, że kongruencje można do- dawać, odejmować i mnożyć stronami. W szczególności, jeżeli a ≡ b (mod m), to dla dowolnego k ⩾ 0, ak ≡ bk (mod m). Mnożąc stronami tę kongruencję przez kongruencję ck ≡ ck (mod m), dostajemy ckak ≡ ckbk (mod m) dla każdego k. Wystarczy teraz dodać te kongruencje. □ U w a g a. Kongruencji n i e w o l n o dzielić stronami nawet jeżeli (co zdarza się rzadko) dzielenie jest wykonalne w zbiorze liczb całkowitych. Na przykład, mimo że 96 ≡ 36 (mod 20) i 24 ≡ 4 (mod 20), to 96 24 ̸≡ 36 4 (mod 20). Wszelako prawdziwe jest (należy zauważyć, że jest to tylko inna postać ZTA!) następujące: PRAWO SKRACANIA Jeżeli NWD (c, m) = 1 i ac ≡ bc (mod m), to a ≡ b (mod m). Oto kilka przykładowych zastosowań twierdzenia T5.2: ZADANIE 5.1 Wielomian f (X) = X 3 − 4X 2 + X + 13 nie ma pierwiastków całkowitych. R o z w i ą z a n i e. Jeżeli a ≡ 0 (mod 3), to f (a) ≡ f (0) ≡ 13 ≡ 1 (mod 3). Jeżeli a ≡ 1 (mod 3), to f (a) ≡ f (1) ≡ 11 ≡ 2 (mod 3). Jeżeli zaś a ≡ −1 (mod 3), to f (a) ≡ −13 ≡ 1 (mod 3). Te trzy proste fakty pokazują, że wartość wielomianu f (X) dla argumentu całkowitego n i g d y nie jest liczbą podzielną przez 3, w szczególności, nigdy nie jest równa 0. Wielomian f (X) n i e m a więc pierwiastków całkowitych. ♦ Ćwiczenie 5.1 Dany jest wielomian f (X) ∈ Z[X]. Udowodnić, że jeżeli f (2) jest liczbą podzielną przez 5, a f (5) jest liczbą podzielną przez 2, to 10|f (7). Proste zastosowanie twierdzenia T5.2 zobaczyć można w dowodach cech podzielności : ZADANIE 5.2 Niech A = a0 + a1 · 10 + a2 · 10 2 + . . . + an10 n będzie zapisem liczby naturalnej w systemie dziesiętnym. Wówczas (1) A ≡ a0 + a1 + . . . + an (mod 3), (2) A ≡ a0 + a1 + . . . + an (mod 9), (3) A ≡ a0 − a1 + a2 − . . . + (−1)nan (mod 11). R o z w i ą z a n i e. Niech f (X) = a0 + a1X + a2X 2 + . . . + anX n. Wtedy A = f (10). Ponieważ 10 ≡ 1 (mod 9), więc, na mocy T5.2, A ≡ f (1) (mod 9). Podobnie sprawdzamy pozostałe przystawania. Zauważmy, że dostaliśmy więcej niż w szkole. Mianowicie: liczba naturalna i suma jej cyfr dziesiętnych dają tę samą resztę z dzielenia przez 9 (i przez 3). Liczba naturalna i naprzemienna suma jej cyfr dają tę samą resztę z dzielenia przez 11. ♦ Ćwiczenie 5.2 Nie wykonując mnożenia uzasadnić, że 1234 · 2345 ̸= 2881730. Wska- zówka. Wymyślić, uzasadnić i zastosować dziewiątkowy test poprawności mnożenia. Jaką odpowiedź dałby tu test trójkowy? A test jedenastkowy? ZADANIE 5.3 Udowodnić, że jeżeli f (X) ∈ Z[X] jest wielomianem stopnia n ⩾ 1, to istnieje taka liczba naturalna x, że |f (x)| jest liczbą złożoną. R o z w i ą z a n i e. Wybierzmy taką liczbę naturalną c, że |f (c)| > 1. (Czytelnik powinien sam uzasadnić, że taka liczba c istnieje.) Jeżeli |f (c)| jest liczbą złożoną, to x = c jest dobra. Jeżeli zaś |f (c)| = p jest liczbą pierwszą, to rozważmy liczby naturalne ck = c + kp, 160 5. Arytmetyka modularna dla k = 0, 1, . . . , s, gdzie s = 3n (n = deg f (X)). Wówczas, ponieważ ck ≡ c (mod p) dla wszystkich k, więc f (ck) ≡ f (c) ≡ 0 (mod p). Czyli p|f (ck) dla wszystkich k. Gdyby żadna z liczb |f (ck)| nie była liczbą złożoną, to liczby f (ck) (jako podzielne przez p) byłyby równe 0, p lub −p. Ale równość f (ck) = 0 może zachodzić dla co najwyżej n liczb ck, zobacz twierdzenie T3.4. Podobnie, równość f (ck) = p może zachodzić dla co najwyżej n liczb ck (aby to zobaczyć wystarczy zastosować T3.4 do wielomianu f (X) − p) i, podobnie, równość f (ck) = −p może zachodzić dla co najwyżej n liczb ck. Ponieważ mamy 3n + 1 liczb ck, więc widzimy, że co najmniej jedna z liczb |f (ck)| j e s t l i c z b ą z ł o ż o n ą. ♦ Ćwiczenie 5.3 Uzasadnić, że, w sytuacji z powyższego zadania, istnieje n i e s k o ń c z e n i e wiele takich x ∈ N, że |f (x)| ma więcej niż 2017 dzielników będących liczbami pierwszymi. 5.1.2 Motywacja: równania diofantyczne Ważnym tematem teorii liczb są równania diofantyczne, czyli równania postaci f (x1, x2, . . . , xn) = 0 (5.1) gdzie f (X1, X2, . . . , Xn) jest wielomianem n zmiennych o współczynnikach c a ł k o w i t y c h. Chodzi o rozstrzygnięcie, czy równanie takie ma rozwiązania całkowite i, jeżeli tak, to o wyzna- czenie takowych. Chwilowo o wielomianach n zmiennych wystarczy wiedzieć tylko tyle, że są to wyrażenia zbudowane z liczb całkowitych i zmiennych X1, X2, . . . , Xn za pomocą działań dodawania, odejmowania i mnożenia, na przykład 15X 2 1 − 7X 2 2 − 9 czy 5X 2 1 + 11X 2 2 + 13X 2 3 . Zobacz też ustęp 6.5.1. Zaczniemy od przykładowych zadań. ZADANIE 5.4 Udowodnić, że równanie 15x2 − 7y2 − 9 = 0 nie ma rozwiązań w Z. R o z w i ą z a n i e. Załóżmy, nie wprost, że para (x, y) ∈ Z × Z jest rozwiązaniem naszego równania i weźmy moduł m = 5. Wówczas 3y2 ≡ 4 (mod 5), bo 15 ≡ 0 (mod 5), −7 ≡ 3 (mod 5) i 9 ≡ 4 (mod 5). Mnożąc kongruencję 3y2 ≡ 4 (mod 5) stronami przez 2 (mnożenie obustronne przez a to to samo, co mnożenie stronami przez kongruencję a ≡ a (mod m)) otrzymamy y2 ≡ 3 (mod 5). Ale to jest niemożliwe, bowiem: 0 2 ≡ 0 (mod 5), 1 2 ≡ (−1) 2 ≡ 4 2 ≡ 1 (mod 5) i 2 2 ≡ (−2) 2 ≡ 3 2 ≡ 4 (mod 5). To znaczy, że kwadrat (liczby całkowitej) daje resztę 0, 1 lub 4 z dzielenia przez 5. Więc nie daje reszty 3. Sprzeczność. ♦ ZADANIE 5.5 Udowodnić, że równanie 5x3 + 11y3 + 13z3 = 0 nie ma innych rozwiązań w liczbach całkowitych oprócz x = 0, y = 0, z = 0. R o z w i ą z a n i e. Załóżmy, że trójka (x, y, z) jest rozwiązaniem i weźmy moduł m = 13. Wówczas, z jasnych powodów, 5x3 − 2y3 ≡ 0 (mod 13), czyli 5x3 ≡ 2y3 (mod 13), lub, po pomnożeniu przez 7, 9x3 ≡ y3 (mod 13). Zobaczmy teraz jak wyglądają sześciany modulo 13, lub, równoważnie, jakie reszty z dzielenia przez 13 dają sześciany liczb całkowitych. Łatwo sprawdzamy, że modulo 13: 1 3, 3 3, 9 3 ≡ 1, 2 3, 5 3, 6 3 ≡ 8, 4 3, 10 3, 12 3 ≡ 12, 7 3, 8 3, 11 3 ≡ 5 i, oczywiście, 0 3 ≡ 0. Stąd, 9x3 ≡ 9, 7, 4, 6, 0 (mod 13). Widzimy, że jedyną szansę na zachodzenie kongruencji 9x3 ≡ y3 (mod 13) daje x ≡ y ≡ 0 (mod 13). Teraz przechodzimy do ofensywy: wykorzystamy desant nieskończony. Niech x = 13u, y = 13v. Wstawiając to do badanego równania widzimy, że 13|z. Niech więc z = 13w. Wstawiając raz jeszcze i upraszczając przez 13 3 otrzymujemy 5u3 + 11v3 + 13w3 = 0. Widzimy więc, że trójka 5.1. Wstęp do teorii kongruencji 161 (u, v, w) jest r ó w n i e ż r o z w i ą z a n i e m naszego równania. Badając tę trójkę dokładnie tak samo jak przed chwilą badaliśmy trójkę (x, y, z), znajdujemy, że 13|u, 13|v, 13|w. Więc 13 2|x, 13 2|y, 13 2|z. Postępując tak dalej widzimy, że x ≡ y ≡ z ≡ 0 (mod 13n) dla każdego n ∈ N. To dowodzi, że x = y = z = 0 i kończy rozwiązanie zadania. ♦ Ćwiczenie 5.4 Rozwiąż w liczbach naturalnych k, n równanie 1! + 2! + . . . + n! = k3. Wskazówka. Zredukować modulo 7. Zauważmy, że to równanie (w świetle wyżej przyjętej deﬁnicji) nie jest równaniem diofantycznym – lewa strona n i e j e s t wielomianem zmiennej n. Ćwiczenie 5.5 Udowodnić uogólnienie twierdzenia T5.2: Jeżeli f (X1, X2, . . . , Xn) jest wielomianem o współczynnikach całkowitych, oraz ak ≡ bk (mod m) dla k = 1, 2, . . . , n, to f (a1, a2, . . . , an) ≡ f (b1, b2, . . . , bn) (mod m). Deﬁnicja 5.2 Niech f (X1, X2, . . . , Xn) będzie wielomianem o współczynnikach całkowi- tych. Rozwiązaniem kongruencji (wielomianowej) f (x1, x2, . . . , xn) ≡ 0 (mod m) (5.2) nazywamy taką n-kę (c1, c2, . . . , cn) liczb całkowitych, że f (c1, c2, . . . , cn) ≡ 0 (mod m). Mó- wimy, że rozwiązania (c1, c2, . . . , cn) i (c′ 1, c′ 2, . . . , c ′ n) są równoważne (modulo m), gdy dla każdego k = 1, 2, . . . , n zachodzi przystawanie ck ≡ c′ k (mod m). Liczbą rozwiązań kongruencji (5.2) nazywamy liczbę rozwiązań n i e r ó w n o w a ż n y c h. Zbiór wszystkich nie- równoważnych rozwiązań kongruencji (5.2) oznaczamy symbolem N (f ; m). Liczbę elementów tego zbioru oznaczamy symbolem N (f ; m). P r z y k ł a d. Niech f (X, Y ) = X 2 + Y 2. Tezę Z2.A3 zapisujemy tak: N (f ; 11) = 1, a mianowicie: N (f ; 11) = {(0, 0)} (zbiór jednoelementowy, którego jedynym elementem jest para uporządkowana (0, 0)). ♦ Oczywistym jest, że jeżeli n-ka (c1, c2, . . . , cn) jest rozwiązaniem równania (5.1) w licz- bach całkowitych, to jest ona rozwiązaniem kongruencji (5.2) dla d o w o l n e g o modułu m. W n i o s k u j e m y stąd, że jeżeli dla choćby jednego modułu m kongruencja (5.2) nie ma roz- wiązań, to i równanie (5.1) nie ma rozwiązań całkowitych. Inaczej mówiąc, istnienie rozwiązań kongruencji (5.2) jest w a r u n k i e m k o n i e c z n y m istnienia rozwiązań równania (5.1) w licz- bach całkowitych. Podkreślić tu trzeba, że ten warunek (nawet spełniony dla wszystkich modu- łów m) n i e j e s t w y s t a r c z a j ą c y. Istnieją takie wielomiany f (X), że zbiory N (f ; m) są niepuste przy dowolnym module m, ale równanie f (x) = 0 nie ma rozwiązań w zbiorze liczb całkowitych. Stosowne przykłady zobaczymy w dalszym ciągu, na przykład w ustępie 5.8.3. 5.1.3 Twierdzenie Schura Pokażemy teraz, że jeżeli wielomian f (o współczynnikach całkowitych jednej lub wielu zmien- nych) o współczynnikach całkowitych nie jest wielomianem stałym (tzn., jeżeli deg(f ) ⩾ 1), to istnieje nieskończenie wiele modułów m, dla których zbiór N (f ; m) jest n i e p u s t y. Deﬁnicja 5.3 Dany jest wielomian f o współczynnikach całkowitych. Liczbę naturalną m nazwiemy f -wyróżnioną, gdy kongruencja f (x) ≡ 0 (mod m) ma rozwiązania, czyli gdy zbiór N (f ; m) jest niepusty. Innymi słowy, liczba f -wyróżniona jest dzielnikiem liczby f (k1, . . . , kn) dla pewnych całkowitych (równoważnie(!): naturalnych) k1, . . . , kn. 162 5. Arytmetyka modularna TWIERDZENIE 5.3 (Twierdzenie Schura) Dla dowolnego wielomianu f (X) ∈ Z[X] stopnia ⩾ 1 istnieje nieskończenie wiele liczb pierwszych f -wyróżnionych. D O W Ó D. Niech f (X) = a0 + a1X + · · · + anX n. Jasne, że każdy dzielnik pierwszy liczby a0 jest f -wyróżniony. Wobec tego, w przypadku, gdy a0 = 0, k a ż d a liczba pierwsza jest f -wyróżniona. Załóżmy więc teraz, że a0 ̸= 0. Naśladując Euklidesa (zobacz pierwszy dowód TE), załóżmy, że {p1, . . . , pr} jest skończonym zbiorem liczb pierwszych f -wyróżnionych i rozważmy wielomian g(X) dany przez g(X) = 1 a0 f (p1 · . . . · pra0X) = 1 + p1 · . . . · pra1X + · · · + (p1 · . . . · pr) nan−1 0 anX n. Jasne, że deg(g) = deg(f ). Jasne też, że g(X) ∈ Z[X]. Na mocy Z5.3 istnieje taka liczba naturalna c, że |g(c)| jest liczbą złożoną. Niech p będzie d o w o l n y m dzielnikiem pierw- szym liczby g(c). Wówczas f (p1 · . . . · pra0c) = a0g(c) ≡ 0 (mod p). Mamy więc rozwiązanie x0 = p1 · . . . · pra0c kongruencji f (x) ≡ 0 (mod p), więc p jest liczbą pierwszą f -wyróżnioną. Jednocześnie, jak widać z postaci wielomianu g(X), zachodzi kongruencja g(c) ≡ 1 (mod pi) dla każdego i = 1, . . . , r. To dowodzi, że p ̸= pi dla każdego i. W ten sposób znajdujemy n o w ą liczbę pierwszą f -wyróżnioną. To, oczywiście, kończy dowód. □ Ćwiczenie 5.6 Uogólnić powyższy dowód na przypadek wielomianu wielu zmiennych. U w a g a. Inny dowód twierdzenia Schura (w duchu tak zwanej analitycznej teorii liczb) pokazujemy w ustępie 12.3.2. 5.1.4 Kongruencje liniowe Zaczynamy nasze badania zbiorów N (f ; m) rozwiązań kongruencji wielomianowych postaci (5.2) od n a j p r o s t s z e g o przypadku, gdy wielomian f jest wielomianem jednej zmiennej stopnia 1. Czyli, zajmiemy się rozwiązywaniem kongruencji postaci ax ≡ b (mod m). Nazy- wamy je kongruencjami stopnia pierwszego lub kongruencjami liniowymi. TWIERDZENIE 5.4 (O kongruencji liniowej ) Niech a, b i m ⩾ 1 będą danymi licz- bami całkowitymi i niech d = NWD (a, m). Wówczas kongruencja liniowa ax + b ≡ 0 (mod m) (5.3) ma rozwiązania wtedy i tylko wtedy, gdy d|b. Gdy ten warunek jest spełniony, to kongruencja (5.3) ma dokładnie d (nierównoważnych!) rozwiązań. Ponadto, gdy c jest rozwiązaniem, a m ′ = m/d, to w s z y s t k i e (parami nierównoważne) rozwiązania zadane są przez: c, c + m′, c + 2m ′, . . . , c + (d − 1)m′. (5.4) D O W Ó D. To twierdzenie jest w istocie jedynie innym sformułowaniem twierdzenia T2.12. Rzeczywiście, kongruencja (5.3) jest tylko innym zapisem faktu, że m|ax + b co z kolei jest tym samym co równość ax − my = −b dla pewnego y ∈ Z. Czytelnik zechce z pewnością uzupełnić wszystkie szczegóły. □ 5.1. Wstęp do teorii kongruencji 163 U w a g a. Ani wzorów (5.4) ani (równoważnych im) wzorów (2.11) nie musimy zapamię- tywać. Obowiązkowe jest natomiast z r o z u m i e n i e opisanej powyżej (i w dowodzie twier- dzenia T2.12) metody badania równania ax − my = −b i, równoważnej mu, kongruencji ax + b ≡ 0 (mod m). Rzecz jest prosta, co widać w poniższym przykładzie: P r z y k ł a d. Mamy ciąg równoważności: 6x ≡ 15 (mod 21) ⇔ 21|6x − 15 ⇔ 7|2x − 5 ⇔ 2x − 5 = 7y ⇔ 2x − 7y = 5. Widzimy więc, że kongruencja 6x ≡ 15 (mod 21) jest równoważna kolejno: 2x − 7y = 2 · 20 − 7 · 5 ⇔ 2(x − 20) = 7(y − 5) ⇔ x ≡ 20 ≡ 6 (mod 7). Kongruencja 6x ≡ 15 (mod 21) ma więc t r z y rozwiązania: 6, 13 i 20. ♦ Twierdzenie T5.4 formułujemy też następująco: TWIERDZENIE 5.4bis Jeżeli f (X) = aX + b ∈ Z[X] jest dwumianem o współczynnikach całkowitych (a ̸= 0), oraz NWD (a, m) = d, to: N (f ; m) = { d, gdy d|b, 0, gdy d ∤ b. (5.5) Ponadto, jeżeli c ∈ N (f ; m), a m′ = m/d, to N (f ; m) = {c, c + m ′, . . . , c + (d − 1)m′}. 5.1.5 Odwracanie modulo m Kongruencje umiemy dodawać (odejmować) i mnożyć stronami. Teraz zajmiemy się przez chwilę możliwością obustronnego dzielenia przez daną liczbę całkowitą. Ponieważ d z i e l e n i e j e s t m n o ż e n i e m p r z e z o d w r o t n o ś ć, więc wystarczy się za- stanowić nad problemem istnienia odwrotności. Przyjmiemy następującą deﬁnicję: Deﬁnicja 5.4 Mówimy, że liczba całkowita a jest odwracalna modulo m, gdy istnieje taka liczba całkowita x, że zachodzi kongruencja ax ≡ 1 (mod m). W takiej sytuacji mówimy, że (liczba) x jest odwrotnością (liczby) a modulo m. P r z y k ł a d. Ponieważ 4 · 11 ≡ 1 (mod 43), więc odwrotnością liczby 4 modulo 43 jest każda liczba postaci 11 + 43a. Łatwo sprawdzić, że kongruencja 4x ≡ 1 (mod 54) n i e m a rozwiązań. Zatem, liczba 4 n i e m a odwrotności modulo 54. ♦ Prostego kryterium odwracalności modulo m dostarcza twierdzenie: TWIERDZENIE 5.5 Liczba a ma odwrotność modulo m wtedy i tylko wtedy, gdy liczby a i m są względnie pierwsze. Co więcej, jeżeli x1 i x2 są odwrotnościami liczby a modulo m, to x1 ≡ x2 (mod m). D O W Ó D. Jest natychmiastowym wnioskiem z twierdzenia T5.4. W rzeczy samej, od- wrotność liczby a modulo m jest po prostu rozwiązaniem kongruencji ax ≡ 1 (mod m), która ma dokładnie jedno (mod m) rozwiązanie wtedy i tylko wtedy, gdy NWD (a, m)|1. □ 164 5. Arytmetyka modularna U w a g a 1. Odwrotność a modulo m oznaczamy a−1 (mod m) lub (gdy wiemy o jaki mo- duł chodzi) po prostu a−1. Może być ona e f e k t y w n i e w y z n a c z o n a za pomocą algorytmu Euklidesa: istotnie, algorytm Euklidesa pozwala na efektywne wyznaczenie liczb całkowitych x, y, spełniających równość 1 = NWD (a, m) = ax + my. Wówczas x ≡ a−1 (mod m). U w a g a 2. Zauważmy również, że jeżeli liczba a jest odwracalna modulo m, to kongru- encja ax ≡ b (mod m) jest r ó w n o w a ż n a kongruencji x ≡ ba−1 (mod m). Ćwiczenie 5.7 Udowodnić, że iloczyn liczb odwracalnych modulo m jest liczbą odwra- calną modulo m. Ponadto, iloczyn odwrotności jest odwrotnością iloczynu, czyli: (a · b) −1 ≡ a−1 · b−1 (mod m). 5.2 Twierdzenie Eulera, Fermat’a i Wilsona Nazwane w tytule twierdzenia należą do absolutnie niezbędnego minimum teorioliczbowego ”uzbrojenia” każdego olimpijczyka. 5.2.1 Zupełne i zredukowane układy reszt Przyjrzyjmy się przez chwilę układom reszt modulo m ∈ N. Deﬁnicja 5.5 (1) Zbiór {0, 1, . . . , m − 1} nazywamy standardowym zupełnym ukła- dem reszt modulo m. (2) Zbiór {b1, b2, . . . , bm}, gdzie każda z liczb bk daje i n n ą resztę z dzielenia przez m, nazywamy zupełnym układem reszt modulo m. (3) Zbiór Φ(m) = {k ∈ N : 1 ⩽ k ⩽ m, NWD (k, m) = 1} (5.6) nazywamy standardowym zredukowanym układem reszt modulo m. (4) Zbiór liczb całkowitych {r1, r2, . . . , rϕ(m)}, z których każda daje i n n ą resztę z dzielenia przez m i każda jest w z g l ę d n i e p i e r w s z a z m, nazywamy zredukowanym układem reszt modulo m. [Pamiętamy, zobacz D4.4, że przez ϕ(m) oznaczyliśmy moc zbioru Φ(m).] P r z y k ł a d. Niech m = 10. Wówczas zbiór {0, 1, 2, 3, 4, 5, 6, 7, 8, 9} jest standardo- wym zupełnym układem reszt, zbiór {20, −9, 22, −27, 44, −45, 66, −63, 88, −81} jest zu- pełnym układem reszt, Φ(10) = {1, 3, 7, 9}, a zbiór {−9, 13, −13, 39} jest zredukowanym układem reszt modulo 10. ♦ Ćwiczenie 5.8 Udowodnić, że zbiór {c + ta : 0 ⩽ t < m} jest zupełnym układem reszt modulo m wtedy i tylko wtedy, gdy NWD (a, m) = 1. Gdy c = 0, a = 1, dostaniemy standardowy zupełny układ reszt modulo m. Ćwiczenie 5.9 Załóżmy, że {b1, b2, . . . , bm} jest zupełnym układem reszt modulo m. Udowodnić, że jeżeli a, c ∈ N oraz NWD (a, m) = 1, to zachodzi równość m∑ j=1 { abj + c m } = m − 1 2 , gdzie {x} oznacza część ułamkową liczby rzeczywistej x, zobacz D12.1. 5.2. Twierdzenie Eulera, Fermat’a i Wilsona 165 LEMAT 5.1 Jeżeli {r1, r2, . . . , rs}, gdzie s = ϕ(m), jest zredukowanym układem reszt modulo m, i a jest liczbą względnie pierwszą z m, to zbiór {ar1, ar2, . . . , ars} jest również zredukowanym układem reszt modulo m. D O W Ó D. Liczba ari jest względnie pierwsza z m. Ponadto, liczby ari są różne modulo m (to znaczy, że ari ̸≡ arj (mod m) dla i ̸= j. Sprawdźcie!). Jest ich ϕ(m), więc stanowią one zredukowany układ reszt modulo m. □ 5.2.2 Twierdzenie Eulera Najważniejszym twierdzeniem dotyczącym kongruencji jest twierdzenie Eulera. TWIERDZENIE 5.6 (Twierdzenie Eulera – 1763) Jeżeli NWD (a, m) = 1, to aϕ(m) ≡ 1 (mod m). (5.7) D O W Ó D. Oznaczmy s = ϕ(m). Niech {r1, r2, . . . , rs} będzie dowolnym zredukowanym układem reszt modulo m. Dzięki lematowi L5.1 wiemy, że {ar1, ar2, . . . , ars} jest również zredukowanym układem reszt modulo m. Stąd r1r2 · . . . · rs ≡ (ar1) · (ar2) · . . . · (ars) (mod m). Oznaczając c = r1r2 · . . . · rs otrzymujemy więc c ≡ asc (mod m). Wystarczy teraz uprościć przez c, czyli pomnożyć obie strony tej kongruencji przez c−1 (mod m). Ćwiczenie C5.7 poucza nas, że iloczyn elementów odwracalnych modulo m sam jest elementem odwracalnym modulo m. Więc odwrotność c−1 (mod m) i s t n i e j e! □ P r z y k ł a d 1. W jednym z zadań OM’54 należało udowodnić, że liczba 53 53 − 33 33 jest podzielna przez 10. Należało więc sprawdzić, że 53 53 ≡ 33 33 (mod 10). Robimy to tak: po- nieważ ϕ(10) = 4 i 10 ⊥ 53, więc, na mocy T5.6, 53 53 = 53 · (53 4) 13 ≡ 3 · 1 13 ≡ 3 (mod 10). Podobnie, 33 33 ≡ 3 (mod 10). Stąd teza. ♦ P r z y k ł a d 2. Załóżmy, że a, b ∈ N i a ⊥ b. Kładąc x = ϕ(b) i y = ϕ(a) znajdujemy rozwiązanie kongruencji ax + by ≡ 1 (mod ab). Rzeczywiście: ax ≡ 1 (mod b) i by ≡ 0 (mod b), co, po dodaniu stronami, daje ax + by ≡ 1 (mod b). Podobnie, ax + by ≡ 1 (mod a). Wspo- mnijmy teraz raz jeszcze założenie a ⊥ b i wykorzystajmy C2.17. ♦ ZADANIE 5.6 Udowodnić, że jeżeli n ∈ N⩾2, to n ∤ 2 n − 1. R o z w i ą z a n i e. Załóżmy nie wprost, że istnieją liczby naturalne n > 1, dla których n|2 n − 1 i niech m > 1 będzie n a j m n i e j s z ą taką liczbą. Wtedy 2 m ≡ 1 (mod m). (5.8) Jasne, że m jest liczbą nieparzystą, więc, na mocy twierdzenia Eulera, 2 ϕ(m) ≡ 1 (mod m). (5.9) Oznaczmy d = NWD (m, ϕ(m)). Wówczas, na mocy T2.6, ma + ϕ(m)b = d dla pewnych a, b ∈ Z. Jasne, że dokładnie jedna z liczb a, b jest ujemna. Załóżmy, że a < 0 (przypadek, gdy b < 0, bada się podobnie). Wówczas, na mocy kongruencji (5.8) i (5.9), mamy 2 d ≡ 2 d · (2 m) −a = 2 d−ma ≡ 2 ϕ(m)b ≡ (2 ϕ(m)) b ≡ 1 b ≡ 1 (mod m). (5.10) Czyli m|2 d − 1. Ale d jest dzielnikiem m, więc d|2 d − 1, co, wobec minimalności m i nierówności d ⩽ ϕ(m) < m, daje równość d = 1. To jednakże jest niemożliwe, bo wtedy, na mocy (5.10), byłoby 2 ≡ 1 (mod m), czyli m = 1. Ta sprzeczność kończy rozwiązanie. ♦ 166 5. Arytmetyka modularna 5.2.3 Małe twierdzenie Fermat’a Prawdopodobnie najczęściej stosowanym w OM twierdzeniem teorioliczbowym jest tak zwane Małe Twierdzenie Fermat’a. Jest ono przypadkiem szczególnym twierdzenia Eulera. WNIOSEK (Małe Twierdzenie Fermat’ a, MTF) Jeżeli p jest liczbą pierwszą i p nie jest dzielnikiem liczby całkowitej a, to ap−1 ≡ 1 (mod p). (5.11) D O W Ó D. S p o s ó b 1. Jeżeli m jest liczbą pierwszą, to ϕ(m) = m − 1. Wobec tego, kongruencja (5.11) jest natychmiastowym wnioskiem z twierdzenia Eulera. S p o s ó b 2. Udowodnimy (niezależnie od T5.6) często używaną, ogólniejszą kongruencję: ap ≡ a (mod p) (5.12) dla d o w o l n e j liczby całkowitej a. Gdy p = 2, rzecz jest oczywista(!). Załóżmy więc, że p > 2. Kongruencję ap ≡ a (mod p) udowodnimy najpierw dla a = n ∈ N przez indukcję względem n. Dla n = 1 sprawa jest jasna. Założenie indukcyjne p|n p − n, wzór dwumienny i wniosek z formuły Legendre’a (patrz C2.50) pozwalają napisać (n + 1)p = n p + (p 1 ) np−1 + (p 2 ) np−2 + . . . + ( p p − 1 ) n + 1 ≡ n p + 1 ≡ n + 1 (mod p) i skończyć dowód dla liczb naturalnych n. Gdy a jest ujemną liczbą całkowitą, to, wobec nieparzystości p, mamy ap ≡ −(−a) p ≡ −(−a) ≡ a (mod p). Mając (5.12), czyli p|a(ap−1 −1), po wykorzystaniu założenia p ∤ a i ZTA, dostajemy podzielność p|ap−1 − 1, czyli (5.11). □ U w a g a. Jeszcze co najmniej dwa sposoby dowodu MTF znaleźć można w KOM . Pokażemy parę przykładów stosowania Małego Twierdzenia Fermat’a: P r z y k ł a d 1. Dla liczb a1, . . . , an ∈ Z i liczby p ∈ P zachodzi równoważność: p|(ap 1 + ap 2 + . . . + ap n) ⇐⇒ p|(a1 + a2 + . . . + an). Rzeczywiście, dodajmy stronami kongruencje ap i ≡ ai (mod p), zob. (5.12). Widzimy wtedy, że liczby ∑n i=1 ap i i ∑n i=1 ai dają t ę s a m ą resztę z dzielenia przez p. Q.e.d. ♦ P r z y k ł a d 2. Jeżeli 7|(a6 + b6 + c6) dla pewnych liczb całkowitych a, b, c, to 343|abc. Rzeczywiście, gdy k spośród liczb a, b, c dzieli się przez 7 (pozostałe 3−k jest niepodzielnych przez 7), to a6 + b6 + c6 ≡ 3 − k (mod 7). Podzielność 7|(a6 + b6 + c6) zachodzi więc tylko w przypadku, gdy k = 3. Wtedy 7|a, 7|b, 7|c. Q.e.d. ♦ P r z y k ł a d 3. Zachodzi podzielność 547|2 224 − 2 222 . Rzeczywiście, 547 jest liczbą pierw- szą, a badana liczba jest równa 2 K(2 N −K −1), gdzie K = 2 22, a N = 2 24. Wystarczy zobaczyć, że 546|N − K; wtedy bowiem 2 N −K − 1 = 2546a − 1 = (2546)a − 1 ≡ 1 a − 1 ≡ 0 (mod 547) na mocy MTF. Ponieważ 546 = 2 · 3 · 7 · 13, a N − K = 24(2 12 − 1) = 24(46 − 1) = 24(64 2 − 1), więc potrzebne podzielności 13|N − K, 7|N − K i 3|N − K wynikają z MTF. Q.e.d. ♦ 5.2. Twierdzenie Eulera, Fermat’a i Wilsona 167 P r z y k ł a d 4. Jeżeli p ∈ P i q = 2p − 1 ∈ P, to p|aq − a dla a ∈ Z. Rzeczywiście, mnożąc kongruencję ap ≡ a (mod p) przez ap−1, dostajemy aq ≡ ap ≡ a (mod p). Q.e.d. ♦ Należy koniecznie rozwiązać poniższe dwa ćwiczenia (z ich tez korzysta się bardzo często): Ćwiczenie 5.10 Dana jest liczba pierwsza p i liczba całkowita a. Udowodnić, że jeżeli a2 ≡ 1 (mod p), to a ≡ 1 (mod p) lub a ≡ −1 (mod p) (piszemy w skrócie a ≡ ±1 (mod p)). Ćwiczenie 5.11 Niech p będzie nieparzystą liczbą pierwszą i niech s = p−1 2 . Udowodnić, że jeżeli p ∤ a, to as ≡ ±1 (mod p). W rozwiązaniu poniższego zadania wykorzystamy tezy ćwiczeń C5.10 i C5.11: ZADANIE 5.7 Dla danych liczb całkowitych b i a1, a2, . . . , a20 zachodzi równość b11 = a11 1 + a11 2 + . . . + a11 20. Udowodnić, że iloczyn ba1a2 · . . . · a20 jest liczbą podzielną przez 23. R o z w i ą z a n i e. Jeżeli jedna z liczb ai jest podzielna przez 23, to koniec. Załóżmy więc, że liczby a1, a2, . . . , a20 nie są podzielne przez 23. Wówczas dla każdego 1 ⩽ i ⩽ 20, a11 i jest liczbą całkowitą, której kwadrat a22 i daje resztę 1 przy dzieleniu przez 23: a22 i ≡ 1 (mod 23). Wobec tego a11 i ≡ ±1 (mod 23) dla każdego 1 ⩽ i ⩽ 20, patrz C5.10. Jeżeli k składników sumy a11 1 + a11 2 + . . . + a11 20 przystaje do 1 modulo 23, a 20 − k pozostałych przystaje do −1 modulo 23, to b11 = a11 1 + a11 2 + . . . + a11 20 ≡ k − (20 − k) ≡ 2k − 20 (mod 23). Zatem b11 ̸≡ ±1 (mod 23) co, wobec C5.11, jest niemożliwe, gdy 23 ∤ b. ♦ Ćwiczenie 5.12 Udowodnić, że 2 16 − 2 4|n 16 − n 4 dla każdej liczby naturalnej n. Ćwiczenie 5.13 Niech Ln = nnn4 − n nn2 . Udowodnić, że 547|Ln dla każdego n ∈ N. 5.2.4 Twierdzenie Wilsona Trzecim twierdzeniem z tej serii jest twierdzenie Wilsona. TWIERDZENIE 5.7 (Twierdzenie Wilsona) Dla każdej liczby pierwszej p zachodzi (p − 1)! ≡ −1 (mod p). (5.13) D O W Ó D. Dla p = 2, 3 rzecz jest oczywista. Załóżmy więc, że p jest liczbą pierwszą ⩾ 5 i rozważmy zbiór T := {2, 3, . . . , p−2}. Elementy zbioru T można pogrupować w pary postaci {a, ̃a}, gdzie ̃a ≡ a−1 (mod p). Rzeczywiście, ponieważ wszystkie liczby a ∈ T są względnie pierwsze z p, więc, na mocy T5.5, mają odwrotności modulo p. Ponadto, ̃a ̸= 1, ̸= −1, ̸= a. Gdyby bowiem ̃a = 1, to a · 1 ≡ 1 (mod p), co nie ma miejsca. Podobnie ̃a ̸= −1. Wreszcie, gdyby ̃a = a, to a · a ≡ 1 (mod p), co też nie może zajść, patrz C5.10. Zatem iloczyn I = 2 · 3 · . . . · (p − 2) jest równy iloczynowi iloczynów postaci a · ̃a, z których każdy jest 168 5. Arytmetyka modularna ≡ 1 (mod p). Więc I ≡ 1 (mod p). Wystarczy teraz pomnożyć tę kongruencję stronami przez kongruencję 1 · (p − 1) ≡ −1 (mod p). □ P r z y k ł a d 1. Zachodzi kongruencja 61! + 1 ≡ 0 (mod 71). Rzeczywiście, z twierdzenia Wilsona mamy −1 ≡ 70! ≡ 61! · (−9)(−8) · . . . · (−1) (mod 71). Wystarczy teraz pomnożyć stronami kongruencje (−9) · (−8) ≡ 1 (mod 71) i −7! = −5040 ≡ 1 (mod 71). Q.e.d. ♦ P r z y k ł a d 2. Jeżeli dla n ∈ N⩾2 zachodzi kongruencja (n − 1)! ≡ −1 (mod n) to n ∈ P. Istotnie, jeżeli a|n, gdzie 1 < a < n, to w iloczynie 1·2·. . .·(n−1) występuje czynnik a, więc a|(n − 1)!. Jednocześnie, przechodniość (zob. T2.1(2)) relacji podzielności daje a|(n − 1)! + 1, więc też (zob. T2.1(4)), a|1, sprzeczność. Q.e.d. ♦ P r z y k ł a d 3. Dla a ∈ Z i p ∈ P zachodzi ap(p − 1)! + a ≡ 0 (mod p). Rzeczywiście, wystarczy pomnożyć stronami kongruencje ap ≡ a (mod p) i (p − 1)! ≡ −1 (mod p). Q.e.d. ♦ Ćwiczenie 5.14 Niech p > 2 będzie liczbą pierwszą. Udowodnić, że jeżeli a1, a2, . . . , ap i b1, b2, . . . , bp są permutacjami liczb 1, 2, . . . , p, to wśród iloczynów a1b1, a2b2, . . . , apbp są dwa dające tę samą resztę z dzielenia przez p. U w a g a. Twierdzenie Wilsona można sformułować też tak: Jeżeli r1, r2, . . . , rp−1 jest dowolnym z r e d u k o w a n y m układem reszt modulo p, to r1 · r2 · . . . · rp−1 ≡ −1 (mod p). (5.14) Twierdzenie Wilsona zostało przez Gaussa uogólnione następująco: Jeżeli r1, r2, . . . , rϕ(m) jest dowolnym zredukowanym układem reszt modulo m > 1, to r1 · r2 · . . . · rϕ(m) ≡ { −1 (mod m), gdy m = 2, 4, pe, 2pe, 1 (mod m), w pozostałych przypadkach. (5.15) Tu p oznacza dowolną nieparzystą liczbę pierwszą. Zobacz też ćwiczenie C5.62. 5.3 Układy kongruencji liniowych Będziemy się teraz zajmowali problemem rozwiązalności i wyznaczenia struktury rozwiązań układów kongruencji liniowych postaci:  ||| ||| x ≡ b1 (mod m1) x ≡ b2 (mod m2) . . . x ≡ br (mod mr) (5.16) gdzie bi są dowolnymi liczbami całkowitymi, a mi ⩾ 2 są liczbami naturalnymi. 5.3. Układy kongruencji liniowych 169 5.3.1 Twierdzenie chińskie o resztach Prawdziwość poniższego twierdzenia została odkryta dawno temu w Chinach. TWIERDZENIE 5.8 (Twierdzenie chińskie o resztach) Jeżeli m1, m2, . . . , mr ⩾ 2 są parami względnie pierwszymi liczbami naturalnymi, zaś b1, b2, . . . , br są dowolnymi liczbami całkowitymi i M = m1 · . . . · mr, to w zbiorze {0, 1, . . . , M − 1} istnieje dokładnie jedno rozwiązanie układu (5.16). D O W Ó D. Niech Mk = M/mk, dla k = 1, 2, . . . , r. Jasne, że NWD (Mk, mk) = 1 dla każdego k. Wobec tego, zobacz T5.5 istnieją odwrotności M −1 k liczb Mk modulo mk dla każdego k. To znaczy, że zachodzą kongruencje: MkM −1 k ≡ 1 (mod mk) (5.17) dla każdego k. Twierdzimy, że liczba x0 = b1M1M −1 1 + b2M2M −1 2 + . . . + brMrM −1 r jest rozwiązaniem układu (5.16). Istotnie, dla l ̸= k mamy blMlM −1 l ≡ 0 (mod mk). Stąd x0 ≡ bkMkM −1 k (mod mk), co, wobec (5.17), daje x0 ≡ bk (mod mk) dla każdego k. Załóżmy teraz, że x1 również jest rozwiązaniem układu (5.16). Wówczas x1 ≡ bk ≡ x0 (mod mk) dla każdego k. Zatem, parami względnie pierwsze, liczby mk dzielą liczbę x1−x0. Więc ich iloczyn M również dzieli x1 − x0, zobacz C2.17. To oznacza, że x1 ≡ x0 (mod M ). Sprawdzenie, że jest również odwrotnie, to znaczy, że x ≡ x0 (mod M ) =⇒ x jest rozwiązaniem układu (5.16), nie przedstawia żadnych trudności. Jasne więc, że dokładnie jedno rozwiązanie spełnia nierów- ność 0 ⩽ x < M . □ U w a g a 1. Twierdzenie chińskie o resztach mówi, że układ kongruencji (5.16), przy zało- żeniu mi ⊥ mj dla i ̸= j, jest r ó w n o w a ż n y jednej kongruencji liniowej x ≡ b1M1M −1 1 + b2M2M −1 2 + . . . + brMrM −1 r (mod m1m2 · . . . · mr). (5.18) P r z y k ł a d 1. Wyznaczymy rozwiązania układu kongruencji  | | 5x ≡ 13 (mod 8) 14x ≡ 21 (mod 49) 3x ≡ 4 (mod 11) Ponieważ 5 jest odwrotnością 5 modulo 8, więc mnożąc obustronnie pierwszą kongruencję przez 5, dostajemy kongruencję równoważną x ≡ 1 (mod 8). Podobnie, mnożąc trzecią kongru- encję stronami przez 4, dostajemy kongruencję równoważną x ≡ 5 (mod 11). Druga kongruen- cja jest równoważna relacji 49|14x − 21 czyli relacji 7|2x − 3, więc kongruencji 2x ≡ 3 (mod 7), 170 5. Arytmetyka modularna którą mnożymy obustronnie przez 4, bo 4 jest odwrotnością 2 modulo 7. Wobec tego badany układ kongruencji jest r ó w n o w a ż n y układowi typu (5.16):  | | x ≡ 1 (mod 8) x ≡ 5 (mod 7) x ≡ 5 (mod 11) Teraz możemy zastosować wzór (5.18). Mamy: m1 = 8, m2 = 7, m3 = 11 oraz M1 = 77, M2 = 88, M3 = 56. Zatem M −1 1 = 5, M −1 2 = 2 i M −1 3 = 1. I ostatecznie: x ≡ 1 · 77 · 5 + 5 · 88 · 2 + 5 · 56 · 1 ≡ 1545 ≡ 313 (mod 616). ♦ Legendarne ”zastosowanie” twierdzenia chińskiego znaleźć można w ćwiczeniu: Ćwiczenie 5.15 Aby wyznaczyć liczbę żołnierzy w swojej armii cesarz rozkazywał ustawiać się im w szyku dwójkowym, trójkowym, 5-kowym, 7-kowym, 11-kowym, 13-kowym i 17-kowym, za każdym razem polecając pisarzowi notować liczbę żołnierzy ”zbywających”. Udowodnić, że znając tylko te siedem liczb, cesarz mógł jednoznacznie wyznaczyć liczebność swojej armii, przy założeniu, że nie była ona większa niż pół miliona. Typowe zastosowanie twierdzenia chińskiego możemy zobaczyć w poniższych zadaniach: Ćwiczenie 5.16 Udowodnić, że: (1) istnieje ciąg kolejnych 2011 liczb naturalnych, z których każda dzieli się przez co najmniej 2011 różnych liczb pierwszych, (2) istnieją dowolnie długie ciągi arytmetyczne o takich wyrazach całkowitych, że każdy z nich jest podzielny przez sześcian innej liczby naturalnej. ZADANIE 5.8 Udowodnić, że istnieje ciąg kolejnych 2011 liczb naturalnych, z których żadna nie jest potęgą liczby naturalnej o wykładniku ⩾ 2. R o z w i ą z a n i e. Zauważmy, że jeżeli dla danej liczby pierwszej p zachodzi kongruencja a ≡ p (mod p2), to vp(a) = 1 co, oczywiście, oznacza, że a n i e j e s t potęgą liczby naturalnej o wykładniku ⩾ 2. Weźmy teraz r = 2011 różnych liczb pierwszych p1, p2, . . . , pr i rozwiążmy układ kongruencji  ||||| ||||| x ≡ p1 − 1 (mod p2 1), x ≡ p2 − 2 (mod p2 2), ... x ≡ pr − r (mod p2 r). Dzięki twierdzeniu chińskiemu wiemy, że układ ten ma rozwiązanie x ∈ N, a dzięki uwadze uczynionej na początku rozwiązania wiemy, że żadna z kolejnych 2011 liczb x + 1, x + 2, . . . , x + r nie jest potęgą liczby naturalnej o wykładniku ⩾ 2. ♦ ZADANIE 5.9 Udowodnić, że istnieje nieskończenie wiele takich liczb naturalnych a, dla których liczba a2 + 1 ma co najmniej 2011 różnych dzielników pierwszych. 5.3. Układy kongruencji liniowych 171 R o z w i ą z a n i e. Rozważmy wielomian f (X) = X 2 + 1. Z twierdzenia Schura T5.3 wiemy, że istnieje r := 2011 liczb pierwszych f -wyróżnionych p1, p2, . . . , pr. Dla każdej z nich istnieje liczba naturalna nk ∈ N (f ; pk). Zachodzą więc kongruencje f (nk) ≡ 0 (mod pk) dla k = 1, . . . , r. Dzięki twierdzeniu chińskiemu o resztach wiemy, że istnieje taka liczba naturalna a, dla której a ≡ nk (mod pk) dla wszystkich k = 1, . . . , r. Wówczas f (a) ≡ f (nk) ≡ 0 (mod pk) dla każdego k ⩽ r, zobacz T5.2. Zatem liczba f (a) = a2 + 1 ma r różnych dzielników pierwszych p1, p2, . . . , pr. Liczby at = a + tp1p2 · . . . · pr, dla t ∈ N, również spełniają(!) kongruencje at ≡ nk (mod pk) dla każdego k, są więc też dla nas dobre. ♦ Oto jeszcze dwa ćwiczenia w podobnym duchu: Ćwiczenie 5.17 Udowodnić, że dla każdej liczby naturalnej n istnieje taka liczba całko- wita M , że 2 2n − 1|M 2 + 9. Wskazówka. 2 2n − 1 = Fn−1 · . . . · F1 · 3. Zobacz Z2.2. Ćwiczenie 5.18 Udowodnić, że istnieją takie różne i parami względnie pierwsze liczby n1, . . . , n11 ∈ N, że liczba n1n2 · . . . · n11 − 1 jest iloczynem dwóch kolejnych liczb naturalnych. 5.3.2 Zadanie o długiej igle Pokażemy teraz jedno interesujące zadanie, w rozwiązaniu którego istotnym elementem jest chińskie twierdzenie o resztach. W trakcie rozwiązywania korzystać będziemy z paru faktów, które udowodnimy później. ZADANIE 5.10 W każdym punkcie kra- towym płaszczyzny wbita jest pionowo szpilka. Ponadto na płaszczyźnie tej leży igła o długo- ści 2011 w położeniu pokrywającym się z od- cinkiem KL, gdzie K = (0, 1 2), L = (2011, 1 2). Udowodnić, że można tę igłę tak przesunąć b e z z a h a c z a n i a o szpilki, by zajęła ona położe- nie pokrywające się z odcinkiem M N , gdzie M = (0, 3 2), N = (2011, 3 2). R o z w i ą z a n i e. Oto pomysł na przesuwa- nie igły: należy znaleźć takie dwa okręgi współ- środkowe o promieniach R1 i R2, i wspólnym środku w punkcie kratowym O, by w pierście- niu kołowym {X : R1 < |OX| < R2}, zobacz rysunek 5.1, n i e było ani jednego punktu kra- A O B R y s . 5 . 1 towego i by w tym pierścieniu dało się umieścić cięciwę większego okręgu o długości 2011 + ε leżącą całkowicie na zewnątrz okręgu mniejszego. Na rysunku 5.1 pokazujemy jak można (nie zahaczając o punkty kratowe) obrócić o dowolny kąt igłę o długości nieznacznie krótszej niż 2 √5. Dowcip polega na tym, że mniejszy okrąg ma promień √20, większy ma promień √25, a żadna z liczb 21, 22, 23, 24 n i e j e s t sumą dwóch kwadratów (liczb całkowitych), więc w pierścieniu kołowym P( √20, √25) nie ma a n i j e d n e g o punktu kratowego. Można więc w nim przesuwać odcinek nieznacznie krótszy niż 2 √ 5. 172 5. Arytmetyka modularna LEMAT 5.2 Dla dowolnej liczby naturalnej s istnieje ciąg kolejnych liczb naturalnych c + 1, c + 2, . . . , c + s, z których żadna nie jest sumą dwóch kwadratów liczb całkowitych. D O W Ó D. Niech p1, p2, . . . , ps będzie dowolnym układem różnych liczb pierwszych po- staci 4x + 3. Nietrudno udowodnić istnienie takiego układu, zobacz 5.5.5 P2. Niech k > 0 będzie dowolnym rozwiązaniem układu  ||||| ||||| x ≡ p1 − 1 (mod p2 1) x ≡ p2 − 2 (mod p2 2) ... x ≡ ps − s (mod p2 s) Wówczas liczba k + j dzieli się przez pj ale nie dzieli się przez p2 j , n i e j e s t więc sumą dwóch kwadratów, zobacz twierdzenie T8.2. Q.e.d. Dzięki temu lematowi możemy rozważyć ciąg k +1, k +2, . . . , k +s kolejnych liczb natural- nych nie będących sumami dwóch kwadratów. I niech R1 = √ k + 1/2, R2 = √k + s + 1/2. Twierdzimy, że w pierścieniu P(R1, R2) o środku O = (0, 0) nie ma ani jednego punktu kratowego. Gdyby bowiem Z × Z ∋ (a, b) ∈ P(R1, R2), to R1 < √ a2 + b2 < R2 =⇒ k + 1 2 < a 2 + b2 < k + s + 1 2. Ale to jest niemożliwe, bo żadna liczba całkowita z przedziału [ k + 1; k + s ] n i e j e s t sumą dwóch kwadratów. Oszacujemy teraz długość cięciwy okręgu K(O, R2) leżącej na zewnątrz okręgu K(O, R1). Z twierdzenia Pitagorasa zastosowanego do trójkąta prostokątnego △OAM , gdzie M jest środkiem boku AB, patrz rysunek 5.1, mamy |AB| = 2 √R2 2 − R2 1 = 2 √s. Zatem, aby zapewnić sobie możliwość bezkolizyjnego obrócenia igły o kąt prosty, wystarczy wybrać liczbę naturalną s ⩾ 1006 2. Resztę rozwiązania zadania opuszczamy. ♦ 5.3.3 Uogólnione twierdzenie chińskie o resztach W tym ustępie powiemy o uogólnionym twierdzeniu chińskim o resztach. Mówi ono o możliwości rozwiązania układu (5.16) bez założenia względnej pierwszości par mi, mj. Pokażemy również jedną interesującą interpretację takiego uogólnionego twierdzenia chińskiego. LEMAT 5.3 Niech m1 ̸= m2 (⩾ 2) będą dowolnymi modułami, niech d = NWD (m1, m2) oraz m = NWW (m1, m2). Wówczas układ kongruencji { x ≡ b1 (mod m1) x ≡ b2 (mod m2) (5.19) ma rozwiązanie wtedy i tylko wtedy, gdy d|b1 − b2. Ponadto, jeżeli ten warunek jest spełniony, to istnieje taka liczba całkowita b, że układ ten jest r ó w n o w a ż n y jednej kongruencji x ≡ b (mod m). (5.20) 5.3. Układy kongruencji liniowych 173 D O W Ó D. Załóżmy, że x0 jest rozwiązaniem układu (5.19). Wówczas x0 = b1 + m1u1 dla pewnego u1 ∈ Z i jednocześnie x0 = b2 + m2u2 dla pewnego u2 ∈ Z. Zatem m1u1 − m2u2 = b2 − b1, co oznacza, że równanie m1x − m2y = b2 − b1 (5.21) ma rozwiązanie (u1, u2) w liczbach całkowitych. Odwrotnie, jeżeli równanie (5.21) ma rozwią- zanie (x, y) w liczbach całkowitych, to x0 = b1 + m1x (= b2 + m2y) jest rozwiązaniem układu (5.19). Z twierdzenia Bachet’a T2.12 wiemy, że warunkiem koniecznym i wystarczającym roz- wiązalności równania (5.21) w liczbach całkowitych jest zachodzenie podzielności d|b2 − b1. Wobec tego pierwsza część lematu jest udowodniona. Załóżmy teraz, że spełniony jest warunek d|b1 − b2. Niech d = m1u0 + m2v0. (5.22) Taka równość zachodzi dla pewnych u0, v0 ∈ Z, zobacz twierdzenie Gaussa-B´ezout’a T2.6. Twierdzimy, że wówczas b = b1 + m1u0 d (b2 − b1) (5.23) jest szukaną liczbą. Aby się o tym przekonać musimy sprawdzić, że x − b ∈ (m) ⇐⇒ x − b1 ∈ (m1) i x − b2 ∈ (m2) dla dowolnej liczby całkowitej x. (Przypomnijmy, że (a) oznacza zbiór (wszystkich) całkowi- toliczbowych wielokrotności liczby a ∈ Z i że zachodzi równość: m1m2 = dm, zobacz T2.9.) Ta równoważność łatwo wynika z równości (5.23) i z, wynikającej z niej (dzięki równości (5.22)), równości b = b2 + m2v0 d (b1 − b2). Sprawdzenie pozostawiamy Czytelnikowi. □ Lemat L5.3 stanowi bazę rozumowania indukcyjnego, za pomocą którego udowodnimy uogólnione twierdzenie chińskie o resztach: TWIERDZENIE 5.9 (Uogólnione twierdzenie chińskie o resztach) Układ (5.16) ma rozwiązania wtedy i tylko wtedy, gdy dla wszystkich 1 ⩽ i < j ⩽ r zachodzi bi ≡ bj (mod NWD (mi, mj)). (5.24) Ponadto, gdy te warunki są spełnione, to istnieje taka liczba B ∈ Z, że układ (5.16) jest równoważny jednej kongruencji x ≡ B (mod M ), (5.25) gdzie M = NWW (m1, m2, . . . , mr). D O W Ó D. Załóżmy, że x0 ∈ Z jest rozwiązaniem układu (5.16). Wówczas x0 = bi + mit i jednocześnie x0 = bj +mjs dla pewnych liczb całkowitych t, s. Stąd (odejmując) otrzymujemy równość bi − bj = mjs − mit, z której na mocy T2.12, dostajemy: NWD (mi, mj)|bi − bj, czyli bi ≡ bj (mod NWD (mi, mj)). To dowodzi k o n i e c z n o ś c i zachodzenia warunków (5.24) dla rozwiązalności układu (5.16). 174 5. Arytmetyka modularna Pokażemy teraz, że zachodzenie kongruencji (5.24) jest w a r u n k i e m w y s t a r c z a j ą c y m istnienia rozwiązania układu (5.16). Zrobimy to za pomocą indukcji względem r. Załóżmy w tym celu, że warunki typu (5.24) implikują istnienie rozwiązań układów typu (5.16) mają- cych r − 1 kongruencji i rozważmy układ (5.16) spełniający (5.24). W szczególności, mamy b1 ≡ b2 (mod NWD (m1, m2)). Warunek ten, jak wiemy z lematu, implikuje, że układ (5.16) równoważny jest z układem r − 1 kongruencji:  ||| ||| x ≡ b (mod m) x ≡ b3 (mod m3) . . . x ≡ br (mod mr) (5.26) gdzie b zadane jest przez (5.23), a m = NWW (m1, m2). Jeżeli uda się nam sprawdzić, że b ≡ bk (mod NWD (m, mk)) (5.27) dla każdego k = 3, . . . , r, to korzystając z założenia indukcyjnego, udowodnimy istnienie rozwiązania układu (5.26), czyli również (równoważnego mu) układu (5.16). Niech p będzie dowolną liczbą pierwszą. Oznaczmy przez α = vp(m1), β = vp(m2), γ = vp(mk) odpowiednie wykładniki p-adyczne. Czytelnik, który dotychczas nie rozwiązał ćwiczeń C2.41, C2.42 i C2.43 powinien teraz to zrobić. Kongruencja (5.27) jest, na mocy C2.41, równoważna nierównościom vp(NWD (m, mk)) ⩽ vp(b−bk) dla każdego p. Te nierówności są, wobec C2.42, równoważne nierównościom min {max {vp(m1), vp(m2)}, vp(mk)} ⩽ vp(b − bk), czyli min {max {α, β}, γ} ⩽ vp(b − bk). Ponieważ dla dowolnych liczb rzeczywistych α, β, γ zachodzi równość (dowód pozostawiamy Czytelnikowi w charakterze ćwiczenia) min {max {α, β}, γ} = max {min {α, γ}, min {β, γ}}, (5.28) więc ostatnią nierówność można przepisać do postaci: max {min {α, γ}, min {β, γ)}} ⩽ vp(b − bk). Jasne, że nierówność ta wynika z dwóch nierówności: min {α, γ} ⩽ vp(b − bk), min {β, γ} ⩽ vp(b − bk). (5.29) Aby wykazać pierwszą z tych nierówności zauważmy, że, na mocy (5.23), zachodzi równość b − bk = (b − b1) + (b1 − bk) = m1u0 · b2 − b1 d + (b1 − bk). Pierwszy składnik sumy stojącej po prawej stronie jest podzielny przez m1 (bowiem d|b1 − b2) a drugi jest podzielny przez pmin {α, γ}. Ponieważ pα|m1, więc oba składniki są podzielne przez pmin {α, γ}. Zatem pierwsza nierówność (5.29) jest prawdziwa. Analogicznie, korzystając 5.4. Pierścień klas reszt modulo m 175 z równości b = b2 + m2v0 b1−b2 d , dowodzimy drugiej nierówności (5.29). To kończy dowód kongruencji (5.27). Załóżmy wreszcie, że x0 jest dowolnym rozwiązaniem spełniającego warunki (5.24) układu (5.16). Niech B będzie resztą z dzielenia x0 przez M = NWW (m1, m2, . . . , mr). Wówczas x0 ≡ B (mod M ). Twierdzimy, że k a ż d e rozwiązanie x układu (5.16) spełnia (5.25). Mamy bowiem x ≡ bk ≡ x0 (mod mk), czyli mk|x − x0 dla każdego k = 1, 2, . . . , r. Stąd, wobec podstawowej własności najmniejszej wspólnej wielokrotności, M |x − x0, czyli x ≡ x0 ≡ B (mod M ). Równie łatwo sprawdzić, że kongruencja x ≡ B (mod M ) pociąga warunki x ≡ bk (mod mk) dla każdego k. To kończy dowód twierdzenia. □ W poniższym zadaniu możemy zobaczyć ładną interpretację uogólnionego twierdzenia chiń- skiego o resztach: ZADANIE 5.11 Danych jest r ciągów arytmetycznych (bk + mkt)t∈Z nieskończonych w obie strony. Załóżmy, że każde dwa z nich mają wspólny wyraz. Udowodnić, że wszystkie te ciągi arytmetyczne mają wspólny wyraz. R o z w i ą z a n i e. Co to znaczy, że ciągi arytmetyczne (bi + mit) i (bj + mjt) mają wspólny wyraz? Jeżeli c = bi + mit1 = bj + mjt2 jest takim wspólnym wyrazem, to c jest rozwiązaniem układu kongruencji { x ≡ bi (mod mi) x ≡ bj (mod mj) Z lematu L5.3 wiemy, że układ ten ma rozwiązania wtedy i tylko wtedy, gdy NWD (mi, mj)|bi − bj, czyli, gdy bi ≡ bj (mod NWD (mi, mj)). Jeżeli więc każda para (bi + mit), (bj + mjt) z badanych ciągów ma wyraz wspólny, to dla wszystkich 1 ⩽ i < j ⩽ r zachodzą kongruencje (5.24), więc, na mocy T5.9, układ (5.16) ma rozwiązania i tworzą one c i ą g a r y t m e t y c z n y (B + M t), gdzie M oznacza najmniejszą wspólną wielokrotność liczb m1, m2, . . . , mr a B jest pewną liczbą całkowitą. Wyrazami tego ciągu arytmetycznego są wyrazy wspólne wszystkich badanych ciągów. ♦ 5.4 Pierścień klas reszt modulo m Każdy zna i umie stosować algebrę parzystości, to znaczy wie, że suma i iloczyn liczb pa- rzystych jest liczbą parzystą, że suma liczb nieparzystych jest liczbą parzystą, a iloczyn liczb nieparzystych jest liczbą nieparzystą itd. Jeżeli umówimy się oznaczać parzysty literą P , a nieparzysty literą N , to ta algebra jest wyznaczona przez tabelki: + P N P P N N N P · P N P P P N P N (5.30) 176 5. Arytmetyka modularna Parzysty od nieparzystego różni się resztą z dzielenia przez 2: parzysty to taki, który daje resztę 0, a nieparzysty to taki, który daje resztę 1. Możemy więc oznaczać P = 0 (mod 2) i N = 1 (mod 2). 5.4.1 Działania na warstwach modulo m Nauczymy się teraz dodawać i mnożyć warstwy modulo m. Zbiór warstw modulo m wraz z tym dodawaniem i mnożeniem j e s t p i e r ś c i e n i e m p r z e m i e n n y m z jedynką, zob. D1.7. Deﬁnicja 5.6 Niech dana będzie ustalona liczba naturalna m > 1. Dla danej liczby całkowitej a oznaczamy a (mod m) := {a + tm : t ∈ Z} = { . . . , a − 2m, a − m, a, a + m, a + 2m, . . . }. Podzbiór a (mod m) ⊆ Z, który jest nieskończonym (w obie strony) ciągiem arytmetycznym o różnicy m, nazywamy warstwą modulo m lub klasą reszt (liczb całkowitych) modulo m wyznaczoną przez a ∈ Z. Ponieważ oznaczenie a (mod m) jest (jakkolwiek jednoznaczne) dość ”ciężkie”, więc często stosujemy prostsze oznaczenia, takie jak a lub [a]. Oczywiście tylko w przypadku, gdy wiemy o jaki moduł m chodzi. Jasne jest, że a (mod m) składa się z wszystkich tych (i tylko tych) liczb całkowitych, które dają tę samą resztę z dzielenia przez m co liczba a. Zatem, a (mod m) = b (mod m) wtedy i tylko wtedy, gdy a ≡ b (mod m). Zbiór wszystkich warstw modulo m oznaczamy symbolem Z/m: Z/m := {a (mod m) : a ∈ Z}. (5.31) Ćwiczenie 5.19 Uzasadnić, że |Z/m| = m. W zbiorze Z/m wprowadzamy działania dodawania i mnożenia modulo m: a (mod m) + b (mod m) : = (a + b) (mod m), (5.32) a (mod m) · b (mod m) : = (a · b) (mod m). (5.33) P r z y k ł a d 1. Napiszemy tabelki dodawania i mnożenia modulo 6. Dla uproszczenia piszemy k = k (mod m). Zgodnie ze wzorami (5.32) (odp. (5.33)), k + l = r (odp. k · l = r), gdzie r jest resztą z dzielenia sumy k + l (odp. iloczynu kl) przez m. + 0 1 2 3 4 5 0 0 1 2 3 4 5 1 1 2 3 4 5 0 2 2 3 4 5 0 1 3 3 4 5 0 1 2 4 4 5 0 1 2 3 5 5 0 1 2 3 4 · 0 1 2 3 4 5 0 0 0 0 0 0 0 1 0 1 2 3 4 5 2 0 2 4 0 2 4 3 0 3 0 3 0 3 4 0 4 2 0 4 2 5 0 5 4 3 2 1 ♦ P r z y k ł a d 2. Napiszemy jeszcze tabelki dodawania i mnożenia modulo 7. Należy zwrócić uwagę na istotną różnicę w tabelkach mnożenia: w ”niezerowej” części tabelki mnożenia modulo 5.4. Pierścień klas reszt modulo m 177 7 n i e występuje 0. Tymczasem w ”niezerowej” części tabelki mnożenia modulo 6 warstwa 0 występuje. Czy już teraz potraﬁcie wyjaśnić to zjawisko? W związku z tym należy zajrzeć do ćwiczenia C1.19. Rozwiązanie zagadki pokażemy w T5.11. + 0 1 2 3 4 5 6 0 0 1 2 3 4 5 6 1 1 2 3 4 5 6 0 2 2 3 4 5 6 0 1 3 3 4 5 6 0 1 2 4 4 5 6 0 1 2 3 5 5 6 0 1 2 3 4 6 6 0 1 2 3 4 5 · 0 1 2 3 4 5 6 0 0 0 0 0 0 0 0 1 0 1 2 3 4 5 6 2 0 2 4 6 1 3 5 3 0 3 6 2 5 1 4 4 0 4 1 5 2 6 3 5 0 5 3 1 6 4 2 6 0 6 5 4 3 2 1 ♦ Dwa kolejne ćwiczenia są bardzo proste, bardzo nudne i bardzo ważne. Rzetelny Czytelnik powinien bezwzględnie je rozwiązać: Ćwiczenie 5.20 Udowodnić, że określenia (5.32) i (5.33) są sensowne. Ćwiczenie 5.21 Udowodnić, że zbiór Z/m wszystkich warstw modulo m, wraz ze zdeﬁ- niowanymi przez równości (5.32) i (5.33) działaniami, jest pierścieniem przemiennym z jedynką, zobacz D1.7. Z e r e m jest warstwa 0 = 0 (mod m), a j e d y n k ą jest warstwa 1 = 1 (mod m). Deﬁnicja 5.7 Zbiór Z/m wraz z wyżej określonymi działaniami dodawania i mnożenia modulo m nazywa się pierścieniem klas reszt (liczb całkowitych) modulo m. 5.4.2 Grupa (Z/m) ∗ warstw odwracalnych Jedną z pierwszych czynności jaką musimy wykonać, dostawszy do rąk pierścień R, jest wyzna- czenie zbioru (grupy) jego elementów odwracalnych R ∗, zobacz D1.8. Wiemy, że Z ∗ = {1, −1} oraz K[X]∗ = K∗ = K ∖ {0}. Obecnie chcemy wyznaczyć grupę (Z/m) ∗ elementów odwracal- nych pierścienia Z/m. Ćwiczenie 5.22 Udowodnić, że elementem odwrotnym do warstwy odwracalnej a (mod m) w pierścieniu Z/m jest warstwa a−1 (mod m), gdzie a−1 jest odwrotnością a modulo m. Wywnioskować stąd, że (Z/m) ∗ := {a (mod m) : NWD (a, m) = 1}, (5.34) i że |(Z/m) ∗| = ϕ(m), zobacz D4.4. TWIERDZENIE 5.10 (Z/m) ∗ z działaniem mnożenia modulo m jest grupą abelową. D O W Ó D. Elementem neutralnym jest 1 (mod m). Elementem odwrotnym do danej war- stwy a (mod m) jest warstwa a−1 (mod m). Pozostałe postulaty są oczywiste(!). □ 178 5. Arytmetyka modularna P r z y k ł a d. Oto tabelka mnożenia modulo 30 w grupie (Z/30) ∗: · 1 7 11 13 17 19 23 29 1 1 7 11 13 17 19 23 29 7 7 19 17 1 29 13 11 23 11 11 17 1 23 7 29 13 19 13 13 1 23 19 11 7 29 17 17 17 29 7 11 19 23 1 13 19 19 13 29 7 23 1 17 11 23 23 11 13 29 1 17 19 7 29 29 23 19 17 13 11 7 1 Warto się przyglądać tej tabelce i jej podobnym. Zauważmy na przykład, że w każdym wierszu (i w każdej kolumnie) występuje permutacja nagłówków – dlaczego? Ostatni wiersz (odpowiednio: ostatnia kolumna) jest odwróceniem pierwszego wiersza (odpowiednio: pierwszej kolumny) – dlaczego? W grupie (Z/30) ∗ występują dwa kwadraty: 1 i 19. Itd. ♦ Ćwiczenie 5.23 Napisać tabelki mnożenia grup (Z/6) ∗, (Z/5) ∗ i (Z/8) ∗. Warto porów- nać grupy (Z/5) ∗ i (Z/8)∗: obie są czteroelementowe, ale istotnie różne! 5.4.3 Ciało Z/p Grupa (Z/m) ∗ jest grupą elementów odwracalnych (jedności) pierścienia Z/m. Pamiętamy, że pierścień jest ciałem, gdy w s z y s t k i e jego niezerowe elementy są odwracalne, zob. D1.10. Dla jakiego modułu m, pierścień Z/m jest ciałem? Odpowiedź na to pytanie zawarta jest w następującym b a r d z o w a ż n y m twierdzeniu: TWIERDZENIE 5.11 Pierścień Z/m (z dodawaniem i mnożeniem modulo m) jest ciałem wtedy i tylko wtedy, gdy m jest liczbą pierwszą. D O W Ó D. Gdy m jest liczbą złożoną, na przykład m = ab, to a (mod m) i b (mod m) są dzielnikami zera: a (mod m) · b (mod m) = m (mod m) = 0 (mod m). Więc Z/m w takim przypadku n i e jest ciałem (zob. C1.19). Gdy m jest liczbą pierwszą, to wszystkie niezerowe warstwy modulo m są odwracalne. Mamy więc w tym przypadku do czynienia z ciałem. □ U w a g a. Jeżeli p jest liczbą pierwszą, to ciało Z/p oznaczamy również symbolem Fp. W angielszczyźnie matematycznej ciało nazywa się ﬁeld. 5.4.4 Pierwiastki kongruencji wielomianowych Wygodnie będzie nieco inaczej spojrzeć na kongruencje wielomianowe (5.2) i na zbiory roz- wiązań takich kongruencji. Opowiemy o tym w przypadku wielomianów jednej zmiennej, choć równie dobrze moglibyśmy to robić w przypadku ogólnym. 5.4. Pierścień klas reszt modulo m 179 Zaczniemy od wprowadzenia wygodnego skrótu. Mianowicie, gdy h(X) = ∑ k⩾0 akX k i g(X) = ∑ k⩾0 bkX k są dwoma wielomianami o współczynnikach całkowitych, to piszemy h(X) ≡ g(X) (mod m), (5.35) gdy ak ≡ bk (mod m) dla każdego k. Ćwiczenie 5.24 Udowodnić, że relacja (5.35) jest relacją równoważności. Ponadto, udo- wodnić, że jest to relacja zgodna z dodawaniem i mnożeniem wielomianów, co oznacza, że jeżeli h(X) ≡ g(X) (mod m) i k(X) ≡ l(X) (mod m), to h(X) + k(X) ≡ g(X) + l(X) (mod m) i h(X) · k(X) ≡ g(X) · l(X) (mod m). Jeżeli h(X) = a0 + a1X + . . . + anX n jest dowolnym wielomianem o współczynnikach całkowitych, a m jest dowolnym modułem, to wielomian h(X) (mod m) := [h](X) = [a0] + [a1]X + . . . + [an]X n, (5.36) gdzie [ak] = ak (mod m) jest warstwą modulo m wyznaczoną przez ak, nazywamy redukcją wielomianu h(X) modulo m. Wielomian h(X) (mod m) (oznaczany w skrócie [h](X)) j e s t wielomianem o współczynnikach w p i e r ś c i e n i u Z/m. Jasne, że h(X) ≡ k(X) (mod m) wtedy i tylko wtedy, gdy [h](X) = [k](X). Istnieje mała (i mało ważna) różnica między rozwiązaniem kongruencji h(x) ≡ 0 (mod m) a pierwiastkiem redukcji h(X) (mod m). Możemy powiedzieć, że rozwiązania kongruencji h(x) ≡ 0 (mod m) (jeśli istnieją) t w o r z ą w a r s t w y modulo m, a pierwiastki wielomianu [h](X) s ą w a r s t w a m i. Pierwiastek redukcji [h](X) = h(X) (mod m) wielomianu nazywa się też pierwiastkiem kongruencji wielomianowej h(x) ≡ 0 (mod m). OZNACZENIE Dla danego wielomianu h(X) ∈ R[X] o współczynnikach w danym pier- ścieniu R, symbolem N (h; R) oznaczamy zbiór n a l e ż ą c y c h d o R p i e r w i a s t k ó w wie- lomianu h(X), czyli takich elementów α należących do R, że h(α) = 0, gdzie 0 oznacza z e r o pierścienia R. Gdy R jest pierścieniem Z/m klas reszt liczb całkowitych (czyli warstw) modulo m, a h(X) jest wielomianem o współczynnikach całkowitych, to, oczywiście, mamy utożsamienie N (h; m) = N ([h]; Z/m), (5.37) gdzie [h] = h(X) (mod m) jest redukcją modulo m. Zbiór N (h; m) jest więc zbiorem pier- wiastków redukcji h(X) (mod m) wielomianu h(X) modulo m. Czyli zbiorem nierównoważ- nych rozwiązań kongruencji h(x) ≡ 0 (mod m), zobacz D5.2. P r z y k ł a d 1. Niech f (X) = X 2 − 1, g(X) = X 4 − 1. Wówczas N (f ; 8) = N (g; 8) = {1 (mod 8), 3 (mod 8), 5 (mod 8), 7 (mod 8)}. Podczas gdy N (f ; 5) = {1 (mod 5), 4 (mod 5)}, a N (g; 5) = (Z/5) ∗. ♦ Ćwiczenie 5.25 Przekonać się, że małe twierdzenie Fermat’a może być zapisane nastę- pująco: Jeżeli p jest liczbą pierwszą, a h(X) = X p−1 − 1, to N (h; p) = (Z/p) ∗. Lub, równoważnie: Jeżeli p jest liczbą pierwszą, a f (X) = X p − X, to N (f ; p) = Z/p. 180 5. Arytmetyka modularna Ćwiczenie 5.26 Rozważmy wielomian h(X) = X 2 −1. Udowodnić, że dla dowolnej liczby pierwszej p > 2 i dowolnego wykładnika e ∈ N zachodzi równość N (h; pe) = 2. Czyli, że warstwy 1 (mod pe) i (−1) (mod pe) są jedynymi pierwiastkami kongruencji x2 ≡ 1 (mod pe). Ćwiczenie 5.27 Rozważmy wielomian h(X) = X 2 − 1. Dowieść, że zachodzą równości N (h; 2) = 1, N (h; 4) = 2 oraz N (h; 2e) = 4 dla dowolnego wykładnika e ⩾ 3. Ćwiczenie 5.28 Niech h(X) = X 8 − 1. Uzasadnić, że N (h; 15) = 8. Uogólnić! Zbiór N (h; m), jako podzbiór zbioru skończonego Z/m, sam jest zbiorem skończonym (być może – pustym). Istnieje więc łatwa (tym łatwiejsza im mniejszy jest moduł m) procedura w y z n a c z a n i a tego zbioru. W szczególności, istnieje procedura sprawdzania czy zbiór ten jest niepusty. Jasne jest też (była już o tym mowa w ustępie 5.1.2), że jeżeli dany jest wielomian h(X) o współczynnikach całkowitych, to niepustość zbiorów N (h; m) dla każdego m jest w a r u n k i e m k o n i e c z n y m i s t n i e n i a pierwiastków c a ł k o w i t y c h wielomianu h(X): a ∈ N (h; Z) =⇒ a (mod m) ∈ N (h; m) dla każdego m. Ten warunek konieczny na ogół n i e j e s t w a r u n k i e m w y s t a r c z a j ą c y m: P r z y k ł a d 2. Dany jest wielomian h(X) = 6X 2 − X − 1. Łatwo sprawdzić, że nie ma on pierwiastków całkowitych. Pokażemy, że N (h; m) jest zbiorem n i e p u s t y m przy dowolnym module m. Przedstawmy bowiem dowolny moduł w postaci iloczynu m = 2kn, gdzie k = v2(m). Wówczas NWD (n, 2 k) = 1, więc, zobacz twierdzenie chińskie, układ { 3x + 1 ≡ 0 (mod 2k), 2x − 1 ≡ 0 (mod n) ⇐⇒ { x ≡ (−1) · 3 −1 (mod 2 k), x ≡ 2 −1 (mod n) ma rozwiązanie c. Wtedy 6c2 − c − 1 = (3c + 1)(2c − 1) = 2ka · nb = mab ≡ 0 (mod m), czyli c (mod m) ∈ Zh(m). Widzimy, że N (h; m) ̸= ∅ dla każdego m, ale N (h; Z) = ∅. ♦ Stosując twierdzenie B´ezout’a T3.1 rozwiązujemy: Ćwiczenie 5.29 Udowodnić, że jeżeli h(X) ∈ Z[X] i a ∈ Z jest rozwiązaniem kongruencji h(x) ≡ 0 (mod m), to istnieje taki wielomian g(X) ∈ Z[X], że h(X) ≡ (X − a)g(X) (mod m). (5.38) Relacja (5.38) może być równoważnie zapisana tak: [h](X) = (X − [a])[g](X), gdzie = jest równością wielomianów o współczynnikach w Z/m, [h] i [g] oznaczają redukcje od- powiednich wielomianów modulo m, a [a] = a (mod m). Załóżmy, że [a] jest pierwiast- kiem kongruencji wielomianowej h(x) ≡ 0 (mod m). Wówczas, wobec powyższego, mamy (x − a)g(x) ≡ 0 (mod m). Należy wyraźnie podkreślić, że z tego n i e wynika, że każde roz- wiązanie kongruencji h(x) ≡ 0 (mod m) jest rozwiązaniem kongruencji x − a ≡ 0 (mod m) lub kongruencji g(x) ≡ 0 (mod m). Jest to związane z możliwością istnienia d z i e l n i k ó w z e r a w pierścieniu Z/m. P r z y k ł a d 3. Rozważmy jeszcze raz redukcję wielomianu X 2 − 1 modulo 8. Wiemy, że 1 jest rozwiązaniem kongruencji x2 − 1 ≡ 0 (mod 8). Odpowiedni rozkład (5.38) wygląda tak: X 2 − 1 ≡ (X − 1)(X + 1) (mod 8). Ale 3 jest również rozwiązaniem, przeto otrzymujemy X 2 − 1 ≡ (X − 3)(X + 3) (mod 8). Zwróćmy uwagę na (gwałcącą nadzieje na jednoznaczność rozkładu!) równość (X + [7])(X + [1]) = (X + [5])(X + [3]) w Z/8[X]. ♦ 5.4. Pierścień klas reszt modulo m 181 5.4.5 Kongruencje wielomianowe modulo p Twierdzenie Lagrange’a 2 T3.4 ma jeden, bardzo ważny w teorii liczb, wniosek. Dla stałych odwołań formułujemy go w postaci osobnego twierdzenia: TWIERDZENIE 5.12 Jeżeli h(X) ∈ Z[X] jest wielomianem stopnia n ⩾ 1, a p jest liczbą pierwszą, to kongruencja h(x) ≡ 0 (mod p) ma co najwyżej n rozwiązań. D O W Ó D. Rozwiązania kongruencji h(x) ≡ 0 (mod p) utożsamiamy z pierwiastkami wie- lomianu [h](X) ∈ Z/p [X], a ten wielomian ma stopień3 ⩽ n. Wobec ”ciałowości” pierścienia współczynników Z/p mamy więc tezę na mocy T3.4. □ U w a g a. Podkreślmy mocno wagę założenia pierwszości modułu p. Na przykład wielomian X 2 − [1] ∈ Z/8 [X] ma stopień 2 i c z t e r y pierwiastki w Z/8, zob. 5.4.4 P3. Oczywiście jest to związane z faktem, że pierścień Z/8 n i e jest ciałem. Ćwiczenie 5.30 Udowodnić, że jeżeli p jest liczbą pierwszą, to wielomian X p−1 − [1] o współczynnikach w ciele Fp rozkłada się na czynniki liniowe (= pierwszego stopnia) X p−1 − [1] = (X − [1])(X − [2]) · . . . · (X − [p − 1]) w pierścieniu Fp[X]. Ta równość jest równoważna z MTF. Dlaczego? Ćwiczenie 5.31 Korzystając z C5.30 udowodnić raz jeszcze twierdzenie Wilsona. Ćwiczenie 5.32 Dana jest liczba pierwsza p i wielomian h(X) ∈ Z[X]. Udowodnić, że p|h(c) dla każdego c ∈ Z wtedy i tylko wtedy, gdy istnieje taki wielomian g(X) ∈ Z[X], że h(X) ≡ (X p − X)g(X) (mod p). 5.4.6 Ważne zastosowanie twierdzenia chińskiego Najważniejszym zastosowaniem twierdzenia chińskiego są poniższe T5.13 i WT5.13. Mówią one, że problem i s t n i e n i a i wyznaczenia l i c z b y rozwiązań kongruencji h(x) ≡ 0 (mod m) dla dowolnego modułu m, jest sprowadzalny do problemów istnienia i wyznaczania liczby roz- wiązań kongruencji h(x) ≡ 0 (mod pvp(m)) dla dzielników pierwszych p ∈ Supp(m). Mówimy w takiej sytuacji o lokalizacji problemu w liczbie (dla liczby) pierwszej p. TWIERDZENIE 5.13 Niech h(X) ∈ Z[X] i niech m = m1m2 · . . . · ms będzie rozkładem na czynniki parami względnie pierwsze. Wówczas, istnieje bijekcja: ψ : N (h; m1) × N (h; m2) × . . . × N (h; ms) ←→ N (h; m). 2Z historycznego punktu widzenia ta nazwa jest pewnym nadużyciem: zazwyczaj, zobacz na przykład [ 11 ], to tylko twierdzenie T5.12 przypisuje się Lagrange’owi. 3Zauważmy, że ten stopień może być m n i e j s z y niż n. Na przykład redukcja wielomianu 3X 2 + X + 1 modulo 3 jest wielomianem stopnia 1 w Z/3[X]. 182 5. Arytmetyka modularna D O W Ó D. Zauważmy najpierw, że jeżeli N (h; mi) jest zbiorem pustym dla pewnego 1 ⩽ i ⩽ s, to i N (h; m) jest zbiorem pustym. Istotnie, jeżeli c (mod m) ∈ N (h; m), czyli m|h(c), to mi|h(c), więc c (mod mi) ∈ N (h; mi). Załóżmy więc, że zbiory N (h; mi) są niepuste dla wszystkich 1 ⩽ i ⩽ s. Niech (c1 (mod m1), c2 (mod m2), . . . , cs (mod ms)) ∈ N (h; m1) × N (h; m2) × . . . × N (h; ms) i niech c będzie (istniejącym na mocy twierdzenia chińskiego) rozwiązaniem układu  ||| ||| x ≡ c1 (mod m1), x ≡ c2 (mod m2), . . . x ≡ cs (mod ms). (5.39) Kładziemy ψ(c1 (mod m1), c2 (mod m2), . . . , cs (mod ms)) = c (mod m). Sprawdzenie, że to jest p o p r a w n i e o k r e ś l o n a b i j e k c j a pozostawiamy Czytelnikowi. □ Z tego twierdzenia mamy natychmiastowy wniosek: WNIOSEK Niech m = pe1 1 pe2 2 · . . . ·pes s będzie kanonicznym rozkładem liczby naturalnej na czynniki pierwsze i niech h(X) będzie wielomianem o współczynnikach całkowitych. Wówczas kongruencja h(x) ≡ 0 (mod m) ma rozwiązanie wtedy i tylko wtedy, gdy mają rozwiązania kongruencje h(x) ≡ 0 (mod pek k ) dla wszystkich k. Co więcej, zachodzi równość N (h; m) = N (h; pe1 1 ) · N (h; pe2 2 ) · . . . · N (h; pes s ). □ P r z y k ł a d 1. Niech f (X) = X 2 + 4X + 5 ∈ Z[X]. Wyznaczymy zbiór N (f ; 65) pier- wiastków kongruencji f (x) ≡ 0 (mod 65). Znajdziemy w tym celu zbiory N (f ; 5) i N (f ; 13). Kongruencje kwadratowe będziemy wprawdzie systemowo rozwiązywać dopiero w paragraﬁe 5.7, ale już teraz możemy łatwo sprawdzić, że kongruencja f (x) ≡ 0 (mod 5) ma dwa roz- wiązania 0 (mod 5) i 1 (mod 5), a kongruencja f (x) ≡ 0 (mod 13) również ma dwa rozwią- zania 3 (mod 13) i 6 (mod 13). Na mocy WT5.13 widzimy więc, że N (f ; 65) jest zbiorem 4-elementowym. Dla wyznaczenia tego zbioru, czyli zbioru wszystkich pierwiastków kongruen- cji x2 + 4x + 5 ≡ 0 (mod 65), musimy rozwiązać układy typu (5.39). W tym przypadku: { x ≡ 0 (mod 5), x ≡ 3 (mod 13), { x ≡ 0 (mod 5), x ≡ 6 (mod 13), { x ≡ 1 (mod 5), x ≡ 3 (mod 13), { x ≡ 1 (mod 5), x ≡ 6 (mod 13). Oto rozwiązania: x1 ≡ 55 (mod 65), x2 ≡ 45 (mod 65), x3 ≡ 16 (mod 65), x4 ≡ 6 (mod 65). ♦ P r z y k ł a d 2. Niech g(X) = X 2 + 3X + 16 ∈ Z[X]. Wyznaczymy zbiór N (g; 85) pierwiastków (= rozwiązań) kongruencji g(x) ≡ 0 (mod 85). Kongruencja g(x) ≡ 0 (mod 5) ma tylko jedno rozwiązanie 1 (mod 5) (przekonanie się o tym przez sprawdzenie pięciu możliwości, jest natychmiastowe, a poza tym g(x) ≡ (x − 1)2 (mod 5)). Jednocześnie, ponieważ g(x) ≡ x2 + 3x + 16 ≡ x2 + 20x − 1 ≡ x2 + 2 · 10x + 100 − 100 − 1 ≡ (x + 10)2 + 1 (mod 17), więc kongruencja g(x) ≡ 0 (mod 17) ma dwa rozwiązania x ≡ ±4 − 10, czyli 3 (mod 17) oraz 11 (mod 17). Rozwiązując odpowiednie układy typu (5.39) znajdujemy wszystkie(!) dwa rozwiązania x1 ≡ 71 (mod 85) i x2 ≡ 11 (mod 85). ♦ P r z y k ł a d 3. Niech h(X) = X 2 − 3X − 5 ∈ Z[X]. Zbiór N (h; 55) jest pusty, bo kongruencja h(x) ≡ 0 (mod 11) nie ma rozwiązań (sprawdźcie!). ♦ 5.5. Rząd elementu grupy w teorii liczb 183 Ćwiczenie 5.33 Wyznaczyć N (X 2 − 1; m) w zależności od modułu m. Wskazówka. Jeżeli kanonicznym rozkładem m na czynniki pierwsze jest m = 2 epe1 1 · . . . · pes s , przy czym e1 · . . . · es ̸= 0, to powinniśmy dostać N (X 2 − 1; m) = 2 s+ε(e), gdzie ε(e) = 0, gdy e ⩽ 1, ε(e) = 1, gdy e = 2 i ε(e) = 2, gdy e ⩾ 2. Ćwiczenie 5.34 Wielomian h(X) ∈ Z[X] wyznacza funkcję N ∋ m 7−→ N (h; m) ∈ Z. Udowodnić, że ta funkcja jest funkcją arytmetyczną multyplikatywną, zobacz D4.2. 5.5 Rząd elementu grupy w teorii liczb Grupy są najbardziej fundamentalnymi strukturami całej matematyki. Występują w różnych jej działach. Grają też bardzo ważną rolę w teorii liczb. Ten paragraf poświęcamy na w s t ę p n e wyjaśnienie tej roli. Pierwsze dwa ustępy mają charakter ogólny. Czytanie można zacząć od ustępu 5.5.4. Ostatnie dwa ustępy pokazują zastosowania nieco bardziej wysublimowane. 5.5.1 Podgrupy i twierdzenie Lagrange’a Zdeﬁniujemy teraz pojęcie podgrupy i udowodnimy podstawowe twierdzenie Lagrange’a. Niech (Γ, ∗) będzie grupą z działaniem ∗ i elementem neutralnym ε. Jasne, że k-ta potęga αk elementu α ∈ Γ oznacza k-krotny iloczyn α ∗ α ∗ . . . ∗ α. Oczywistym jest, że prawidłowo należy to określić i n d u k c y j n i e: α1 = α i αk+1 = αk ∗ α dla k ∈ N. Będziemy również uważać, że α0 = ε oraz α−k = (α−1) k. Wtedy: Ćwiczenie 5.35 Udowodnić, że dla dowolnego elementu α danej grupy z działaniem ∗ i dowolnych liczb c a ł k o w i t y c h m, n mamy: αm+n = αm ∗ αn i (αm) n = (αn)m = αmn. U w a g a. Jasne jest również, że w przypadku addytywnym (to znaczy, w przypadku dzia- łania dodawania zapisywanego za pomocą znaku +) k-tą potęgę elementu α nazywamy k-tą wielokrotnością i oznaczamy symbolem kα (czasem k·α). Przy czym −α = (−1)·α oznacza element przeciwny do α. Równości z ćwiczenia C5.35 mają w takim przypadku postać: (m + n)α = mα + nα, n(mα) = m(nα) = (mn)α. Deﬁnicja 5.8 Niech (Γ, ∗) będzie grupą. Niepusty podzbiór Λ zbioru Γ nazywamy podgrupą grupy Γ , gdy dla dowolnych dwóch elementów α, β ∈ Λ zarówno α ∗ β jak i α−1 należą do zbioru Λ. (Mówimy, że Λ jest zamknięty względem działania ∗ i brania odwrotności.) P r z y k ł a d y. (1) Każdy ideał w pierścieniu Z jest podgrupą grupy (Z, +). (2) Zbiór T = {z ∈ C : |z| = 1} (5.40) liczb zespolonych o module równym 1 jest grupą względem mnożenia liczb zespolonych. (3) Dla dowolnej liczby naturalnej n podzbiór µn(C) pierwiastków n-tego stopnia z 1 jest podgrupą grupy T , zobacz C1.35 i C1.36. (4) Sama grupa T jest podgrupą grupy (C∗, ·) niezerowych liczb zespolonych z mnożeniem jako działaniem. (5) Z jest podgrupą w grupie (Q, +) liczb wymiernych z dodawaniem. (6) Jeżeli (Γ, ∗) jest d o w o l n ą grupą, α jest dowolnym jej elementem, to zbiór (α) := {αk : k ∈ Z} wszystkich potęg elementu α jest podgrupą grupy Γ . Nazywamy ją podgrupą generowaną przez α. ♦ 184 5. Arytmetyka modularna Ćwiczenie 5.36 Uzasadnić wszystkie tezy powiedziane w powyższych przykładach. Udowodnimy teraz kolejne (nie ostatnie w tym skrypcie!) twierdzenie Lagrange’a: LEMAT 5.4 (Twierdzenie Lagrange’ a) Załóżmy, że Γ jest grupą skończoną, a Λ jest jej podgrupą. Jeżeli card (Γ ) = n i card (Λ) = r, to r|n. D O W Ó D. Niech Λ = {λ1, λ2, . . . , λr}. Dla dowolnego elementu α ∈ Γ oznaczmy: αΛ := {α ∗ λ1, α ∗ λ2, . . . , α ∗ λr}. Sprawdzamy najpierw, że zbiory postaci αΛ są albo r o z ł ą c z n e albo się p o k r y w a j ą. Rzeczywiście, jeżeli αΛ ∩ βΛ ̸= ∅ i γ ∈ αΛ ∩ βΛ, to γ = α ∗ λi = β ∗ λj dla pewnych 1 ⩽ i, j ⩽ m. Stąd: d o w o l n y element α ∗ λk zbioru αΛ może być zapisany jako α ∗ λk = (γ ∗ λ−1 i ) ∗ λk = γ ∗ (λ−1 i ∗ λk) = (β ∗ λj) ∗ (λ −1 i ∗ λk) = β ∗ [λj ∗ (λ −1 i ∗ λk)]. Ponieważ Λ jest podgrupą, więc λj ∗ (λ −1 i ∗ λk) ∈ Λ. Wobec tego α ∗ λk ∈ βΛ. W ten sposób wykazaliśmy, że αΛ ⊆ βΛ. Tak samo sprawdzamy, że βΛ ⊆ αΛ. Zatem αΛ = βΛ. Łatwo też sprawdzić, że każdy ze zbiorów αΛ ma dokładnie r elementów. Istotnie, jeżeli α ∗ λi = α ∗ λj, to mnożąc tę równość z lewej strony przez α−1 dostajemy równość λi = λj. Z powyższego wynika, że zbiór Γ jest s u m ą r o z ł ą c z n ą pewnej liczby (oznaczmy ją k) zbiorów αΛ, z których każdy ma r elementów. Stąd n = r · k, czyli r|n. □ 5.5.2 Podstawowe własności rzędu elementu Każdemu elementowi grupy skończonej przyporządkowujemy tak zwany rząd, który jest naj- mniejszym ⩾ 1 wykładnikiem potęgi, do jakiej należy podnieść ten element, aby otrzymać element neutralny. Udowodnimy trzy podstawowe twierdzenia o rzędzie. Deﬁnicja 5.9 Dana jest grupa Γ i jej element α. Rzędem elementu α ∈ Γ nazywamy n a j m n i e j s z ą taką liczbę naturalną r, że αr = ε. Rząd elementu α, jeżeli istnieje, ozna- czamy symbolem rz (α). Jeżeli αk ̸= ε dla każdego k ∈ N, to mówimy, że α jest elementem rzędu nieskończonego. P r z y k ł a d. Warstwa 4 (mod 11) jako element grupy Z/11 z dodawaniem (mod 11) ma rząd równy 11. Ta sama warstwa, jako element grupy (Z/11) ∗ z mnożeniem (mod 11), ma rząd równy 5. Liczba −1 jako element grupy (Z, +) jest elementem rzędu nieskończonego, a liczba 0 ma w tej samej grupie rząd 1. Czytelnik zechce samodzielnie to sprawdzić. ♦ Udowodnimy teraz trzy podstawowe twierdzenia o rzędzie elementów grup: TWIERDZENIE 5.14 Każdy element grupy skończonej ma rząd (skończony!) i rząd ten jest dzielnikiem liczby elementów grupy. D O W Ó D. Niech Γ będzie grupą skończoną, card (Γ ) = n. Niech α ∈ Γ będzie dowol- nym jej elementem. Wypiszmy ciąg k o l e j n y c h p o t ę g elementu α: α0, α1, α2, α3, . . . αn, . . . (5.41) 5.5. Rząd elementu grupy w teorii liczb 185 i rozważmy n + 1 początkowych wyrazów tego ciągu. Ponieważ tych wyrazów jest więcej niż elementów w grupie Γ , więc co najmniej dwa z tych wyrazów są równe. Niech αk = αl, dla pewnych 0 ⩽ k < l ⩽ n. Mnożąc tę równość lewostronnie przez α−k = (αk)−1 dostajemy: ε = α0 = α−k ∗ αk = α−k ∗ αl = αl−k. Kładąc t = l − k mamy αt = ε. Widzimy więc, że istnieją d o d a t n i e wykładniki t, dla których αt = ε. Dzięki Zasadzie Minimum możemy wybrać n a j m n i e j s z y taki wykładnik. Oznaczmy go r. Uzasadniliśmy w ten sposób, że element α m a r z ą d. Zauważmy, że elementy α, α2, . . . , αr = ε są p a r a m i r ó ż n e. (Gdyby αk = αl dla 1 ⩽ k < l ⩽ d, to, tak jak wyżej, dostalibyśmy równość αl−k = ε, co jest niemożliwe, bo 0 < l − k < r.) Ponadto, jeżeli m ∈ Z jest dowolną liczbą całkowitą, m = qr + s, 0 ⩽ s < r, jest wynikiem dzielenia z resztą m przez r, to αm = αqr+s = (αr)q ∗ αs = εq ∗ αs = ε ∗ αs = αs. Widzimy stąd, że podgrupa (α) generowana przez α jest równa Λ := {ε, α, α2, . . . , αr−1}. (5.42) Dla zakończenia dowodu wystarczy się powołać na twierdzenie Lagrange’a L5.4. □ TWIERDZENIE 5.15 Jeżeli dla elementu α pewnej grupy zachodzi równość αs = ε, gdzie s ∈ N, to istnieje rz (α) i zachodzi podzielność rz (α)|s. D O W Ó D. Z równości αs = ε wynika, że rz (α) i s t n i e j e. Oznaczając go r, dzielimy z resztą: s = qr + t, gdzie 0 ⩽ t < r. Wówczas ε = αs = αqr+t = (αr) q ∗ αt = εq ∗ αt = αt, co, wobec minimalności r, daje t = 0, czyli r|s. □ TWIERDZENIE 5.16 Niech α, β ∈ Γ będą takimi elementami grupy a b e l o w e j (Γ, ∗), że NWD (rz (α), rz (β)) = 1. Wówczas rząd iloczynu równy jest iloczynowi rzędów: rz (α ∗ β) = rz (α) · rz (β). (5.43) D O W Ó D. Niech rz (α) = a, rz (β) = b. Wówczas (α ∗ β)ab = (αa)b ∗ (βb) a = εb ∗ εa = ε. Stąd i z twierdzenia T5.15 wynika, że rz (α ∗ β) jest dzielnikiem iloczynu ab dwóch względnie pierwszych czynników. Możemy więc napisać rz (α ∗ β) = cd, (5.44) gdzie c|a i d|b. (Opieramy się tu na prostym lemacie, na którym opieraliśmy się również rozwiązując ćwiczenie C4.2.) Piszemy więc a = ck, b = dl dla pewnych liczb naturalnych k, l. Podnieśmy obie strony, wynikającej z (5.44), równości ε = (α ∗ β) cd, do potęgi k. Dostaniemy ε = εk = ((α ∗ β)cd) k = (α ∗ β) ad = (αa) d ∗ βad = εd ∗ βad = βad. Stąd, znów dzięki T5.15, b|ad. Założenie a ⊥ b i ZTA (zob. T2.7) dają więc b|d. Ale d|b. Zatem d = b. Podobnie sprawdzamy, że c = a. To kończy dowód. □ U w a g a. W dowodzie twierdzenia T5.16 założenie abelowości (przemienności) grupy nie było wykorzystane in extenso. Jedynie ważnym jest to, że elementy α, β k o m u t u j ą, czyli że zachodzi równość α ∗ β = β ∗ α, zobacz poniższe ćwiczenie. Ćwiczenie 5.37 Udowodnić, że jeżeli elementy α, β danej grupy komutują, to dla dowol- nego wykładnika k ∈ Z zachodzi równość (α ∗ β)k = αk ∗ βk. Ćwiczenie 5.38 Niech α ∈ Γ będzie elementem grupy Γ . I niech rz (α) = r. Niech k ∈ Z. Udowodnić, że rz (αk) = r wtedy i tylko wtedy, gdy NWD (k, r) = 1. Wskazówka. Czy widzicie, że to jest wnioskiem z poniższego T5.17 ? 186 5. Arytmetyka modularna 5.5.3 Rząd elementu w grupie (Z/m, +) W tym ustępie przyglądniemy się grupie (Z/m, +) klas reszt liczb całkowitych (mod m) z działaniem dodawania (mod m). Mówimy więc teraz o przypadku a d d y t y w n y m, czyli o grupie (Z/m, +) klas reszt liczb całkowitych modulo m z dodawaniem modulo m określonym przez (5.32): (Γ, ∗) = (Z/m, +), ε := 0 = 0 = 0 (mod m). Łatwo wyrazić rząd elementu k (mod m) grupy Z/m (z dodawaniem modulo m) za pomocą najprostszych operacji teorioliczbowych. P r z y k ł a d. Weźmy grupę Z/15 z dodawaniem modulo 15. Wypiszmy ciąg (5.41) dla trzech wyborów elementu s: s = 6 : (6, 12, 3, 9, 0), 6, 12, 3, 9, . . . , s = 8 : (8, 1, 9, 2, 10, 3, 11, 4, 12, 5, 13, 6, 14, 7, 0), 8, . . . , s = 10 : (10, 5, 0), 10, 5, . . . . ♦ Po takich i temu podobnych przykładach łatwo postawić hipotezę i następnie ją udowodnić: TWIERDZENIE 5.17 Rząd elementu k (mod m) ∈ (Z/m, +) wynosi rz k (mod m) = m NWD (k, m). (5.45) D O W Ó D. Wypisujmy ciąg (5.41) dla elementu α = k (mod m) grupy (Z/m, +) aż do momentu pojawienia się elementu neutralnego, czyli 0 (mod m): k (mod m), 2k (mod m), . . . , rk (mod m) = 0 (mod m). Ostatnia równość jest równoważna z podzielnością m|rk. (5.46) Szukamy więc najmniejszej dodatniej liczby całkowitej r, dla której zachodzi taka podzielność. Jeżeli oznaczymy d = NWD (k, m) i k = dk′, m = dm ′, to (5.46) daje podzielność m ′|rk′. Względna pierwszość liczb m ′ i k′ daje więc, na mocy ZTA, m′|r. Ponieważ r = m′ spełnia wymagania (bo m ′k = m ′dk′ = mk′), więc m′ = m d jest poszukiwanym rzędem. □ 5.5.4 Rząd elementu w grupie ((Z/m) ∗, ·) W tym ustępie wykorzystujemy rząd elementu w grupie (Z/m) ∗ elementów odwracalnych pierścienia Z/m klas reszt liczb całkowitych (mod m) z działaniem mnożenia (mod m). Mówimy więc teraz o przypadku m u l t y p l i k a t y w n y m, czyli o grupie (Γ, ∗) = ((Z/m) ∗, ·), ε = 1 = 1 = 1 (mod m), 5.5. Rząd elementu grupy w teorii liczb 187 względnie pierwszych z m klas reszt liczb całkowitych (mod m). Działaniem jest tu oczywiście m n o ż e n i e m o d u l o m, zobacz (5.33). Grupa (Z/m) ∗ jedności (elementów odwracalnych) pierścienia Z/m ma ϕ(m) elementów, które utożsamiamy zazwyczaj z elementami zreduko- wanego układu reszt modulo m. Rząd elementu a (mod m) w grupie (Z/m)∗ oznaczamy (dla odróżnienia od przypadku addytywnego) symbolem 4 rzm(a). Przypominamy, że r = rzm(a), gdy (i tylko gdy) r jest n a j m n i e j s z ą liczbą naturalną, dla której ar ≡ 1 (mod m). Wiemy, że dla dowolnego a ∈ Z, jeżeli a ⊥ m, to: (R1) taka liczba r istnieje (zob. T5.14); (R2) r jest dzielnikiem każdej liczby s, dla której as ≡ 1 (mod m) (zob. T5.15); (R3) r|ϕ(m), w szczególności, r|p − 1, gdy m = p ∈ P (zob. T5.5, w szczególności, MTF). W przeciwieństwie do rozpatrzonego w poprzednim ustępie przypadku addytywnego, w przypadku multyplikatywnym n i e i s t n i e j ą żadne proste sposoby wyrażenia rzm(a). W za- sadzie dysponujemy tylko jedną metodą wyznaczania tej liczby: wypisujemy tak długo wyrazy ciągu typu (5.41), aż natraﬁmy na wyraz równy elementowi neutralnemu 1 (mod m). P r z y k ł a d. Weźmy 6 (mod 13) ∈ (Z/13) ∗. Ciąg (5.41) dla tego elementu wygląda nastę- pująco: 6, 10, 8, 9, 2, 12, 7, 3, 5, 4, 11, 1, . . . . Widzimy stąd, że rz13(6) = 12. ♦ Pokażemy kilka typowych zadań, w których wykorzystuje się własności rzędu rzm. ZADANIE 5.12 Dowieść, że jeżeli n > 1 jest nieparzystą liczbą naturalną, to n ∤ 3 n − 1. R o z w i ą z a n i e. Załóżmy (nie wprost), że n|3 n − 1 dla n ≡ 1 (mod 2), n > 1. Niech p będzie n a j m n i e j s z y m dzielnikiem pierwszym liczby n, zobacz T2.14. Wówczas p|3 n − 1, czyli 3 n ≡ 1 (mod p). Stąd p ̸= 3. Niech r = rzp(3). Wtedy, na mocy (R2), r|n. Zauważmy, że r ̸= 1 (gdy r = 1, to 3 1 ≡ 1 (mod p), co jest możliwe tylko dla p = 2, ale 2 ∤ n). Więc p ⩽ r, bo p jest najmniejszym, różnym od 1, dzielnikiem n. Jednocześnie, na mocy (R3), r|p − 1. Stąd r ⩽ p − 1 < p. Dostajemy niedorzeczność: r < p ⩽ r. ♦ ZADANIE 5.13 Dowieść, że jeżeli n ⩾ 2 jest liczbą naturalną i n|11 n − 2 n, to 3|n. R o z w i ą z a n i e. Załóżmy, że dla pewnego n ⩾ 2 zachodzi n|11 n − 2 n. Niech p będzie najmniejszą liczbą pierwszą dzielącą n. Wówczas 11 n ≡ 2 n (mod p). Oraz p ̸= 2 (dlaczego?). Niech b będzie odwrotnością 2 modulo p. Mamy więc (11b) n ≡ 1 (mod p). Oznaczmy r = rzp(11b). Wtedy, na mocy (R2), r|n. Stąd r = 1 albo r ⩾ p, bo p jest najmniejszym, różnym od 1, dzielnikiem n. W przypadku r = 1 mamy 11b ≡ 1 (mod p), skąd 11 ≡ 2 (mod p), więc p|9, czyli p = 3. W przypadku zaś r ⩾ p dostajemy s p r z e c z n o ś ć, bo r|p − 1. ♦ Przed rozwiązaniem następnego zadania udowodnimy użyteczny lemat: LEMAT 5.5 Dany jest moduł m > 2 i względnie pierwsza z nim liczba całkowita a. Załóżmy, że s ⩾ 1 jest n a j m n i e j s z y m takim wykładnikiem, że as ≡ −1 (mod m). (5.47) Wówczas rzm(a) = 2s. Ponadto: at ≡ −1 (mod m) ⇐⇒ t = (2k − 1)s, k ∈ N. 4”Uczciwe” matematycznie oznaczenia rz(Z/m)∗ (a), czy, proponowane w poprzednich wydaniach skryptu, rz a (mod ∗m), są zbyt ”ciężkie”. U w a g a. W literaturze olimpijskiej używa się symbolu ordm(a). Nie zdecydowaliśmy się na jego wprowadzenie, ponieważ w literaturze matematycznej, zobacz na przykład [2], symbol ordp(a) oznacza wykładnik p-adyczny liczby a ∈ Z, czyli nasze vp(a). 188 5. Arytmetyka modularna D O W Ó D. Niech α = a (mod m) ∈ Z/m. Kongruencja (5.47) pokazuje, że α ∈ (Z/m) ∗ (odwrotnością α jest warstwa −αs−1). Niech r = rzm(a) = rz (α). Rozważmy ciąg α, α2, . . . , αr. Z dowodu T5.14 wiemy, że w tym ciągu występują wszystkie potęgi αt elementu α ∈ (Z/m)∗. W szczególności element (−1) (mod m) = αs. To, wobec minimalności s, oznacza, że s ⩽ r. Ponadto s ̸= r. Gdyby bowiem r = s, to byłoby −1 ≡ as ≡ ar ≡ 1 (mod m), czyli m|2, co, wobec założenia m > 2, jest niemożliwe. Zatem s < r. Podnosząc kongruencję (5.47) obustronnie do kwadratu, dostaniemy a2s ≡ 1 (mod m), skąd, na mocy (R2), r|2s. To, wobec nierówności s < r, jest możliwe tylko, gdy r = 2s. Załóżmy teraz, że at ≡ −1 (mod m). Podnosząc do kwadratu mamy a2t ≡ 1 (mod m), skąd r|2t. Czyli 2s|2t, więc s|t. Sprawdzenie, że t/s ≡ 1 (mod 2), pozostawiamy Czytelnikowi. □ U w a g a 1. Wykładnik s spełniający (5.47) może n i e i s t n i e ć. Przykładów jest na to mnóstwo: a = 2, m = 7 lub a = 3, m = 3 2011 −1 itp. To oznacza, że w ciągu [a], [a]2, [a] 3, . . . kolejnych potęg warstwy a (mod m), może nie występować warstwa (−1) (mod m). Lemat mówi, że jeżeli występuje, to ”robi” to dokładnie w połowie ”dystansu” między [a] a [a] r (w szczególności r musi być parzyste) i potem na co r-tym miejscu. ZADANIE 5.14 Udowodnić, że każda liczba Nov´aka jest podzielna przez 3. R o z w i ą z a n i e. Załóżmy, że n|2 n + 1. Niech p będzie n a j m n i e j s z y m dzielnikiem pierwszym liczby n. Wtedy 2 n + 1 ≡ 0 (mod p). Stąd 2 n ≡ −1 (mod p). Niech s będzie najmniejszym wykładnikiem, dla którego 2 s ≡ −1 (mod p). Wówczas na mocy lematu L5.5, n = (2k − 1)s dla pewnego k ∈ N i 2s = r, gdzie r := rzp(2). Ponieważ r ⩽ p − 1 < p, więc s < 2s = r < p. Stąd wynika, że s = 1; w przeciwnym razie s byłoby mniejszym niż p właściwym dzielnikiem n. Przeto 2 1 ≡ −1 (mod p). Skąd: p = 3. ♦ ZADANIE 5.15 Dowieść, że jeżeli liczba pierwsza p dzieli liczbę Fermat’a Fn = 2 2n + 1, to p = 2 n+1a + 1 dla pewnej liczby naturalnej a. R o z w i ą z a n i e. Niech r = rzp(2). Ponieważ p|Fn, więc 2 2n ≡ −1 (mod p). Z lematu L5.5 wiemy więc, że 2 n = (2k − 1)s, gdzie s oznacza najmniejszy taki dodatni wykładnik, że 2 s ≡ −1 (mod p). Stąd k = 1 i, wobec tego, s = 2 n. Zatem 2 n+1 = 2s = r. Jednocześnie, na mocy (R3), r|p − 1. Więc p − 1 = ar dla pewnego naturalnego a. ♦ Ćwiczenie 5.39 Niech a ∈ N>1 i q ∈ P>2. Udowodnić, że każdy nieparzysty dzielnik pierwszy liczby aq − 1 jest dzielnikiem liczby a − 1 lub jest postaci 2qx + 1, gdzie x ∈ N. Ćwiczenie 5.40 Udowodnić, że jeżeli n ∈ N⩾2 i n|5 n + 8n, to 13|n. Ćwiczenie 5.41 Dowieść, że jeżeli n, a ∈ N i n < a, to n|ϕ(an − 1). Ćwiczenie 5.42 Załóżmy, że 2 n ≡ 1 (mod p) i 2 n ̸≡ 1 (mod p2) dla pewnej liczby pierwszej p > 2 i pewnego n ∈ N. Niech r = rzp(2). Udowodnić, że 2 r ̸≡ 1 (mod p2). Ćwiczenie 5.43 Wyznaczyć wszystkie liczby pierwsze p, q, dla których pq|2 p + 2q. Ćwiczenie 5.44 Jeżeli p ∈ P, to liczba pp − 1 ma dzielnik pierwszy postaci px + 1. 5.5. Rząd elementu grupy w teorii liczb 189 5.5.5 O liczbach pierwszych w ciągach arytmetycznych W tym ustępie wykorzystamy własności funkcji rzędu rzp : (Z/p) ∗ −→ N w dowodzie jed- nego przypadku szczególnego słynnego Twierdzenia Dirichlet’ a o liczbach pierwszych w postępach arytmetycznych: TWIERDZENIE 5.18 (Dirichlet – 1837) Jeżeli liczby naturalne r i a są względnie pierwsze, to nieskończony ciąg arytmetyczny (rx + a)x∈N zawiera nieskończenie wiele wyrazów będących liczbami pierwszymi. □ Dowód twierdzenia Dirichlet’a jest dla nas za trudny.5 Dla niektórych konkretnych wartości r i a rzecz jest bardziej elementarna: już Euklides pokazał prawdziwość twierdzenia T5.18 dla r = 2 i a = 1, ogólniej, dla r = 2 i dowolnego(!) a ≡ 1 (mod 2). Niewielkie modyﬁkacje ory- ginalnego rozumowania Euklidesa z ustępu 2.3.1 pozwalają udowodnić niektóre inne przypadki szczególne 6 twierdzenia Dirichlet’a. P r z y k ł a d 1. Liczb pierwszych postaci 3x+2, x ∈ N, jest nieskończenie wiele. Rzeczywi- ście, załóżmy nie wprost, że takich liczb jest tylko skończenie wiele i że p1 = 5, p2 = 11, . . . , pr są wszystkimi takimi liczbami. Niech N = 3p1p2 · . . . · pr + 2. Liczba N jest postaci 3x + 2, ale, jak łatwo widzieć, nie dzieli się przez żadną z liczb p1, p2, . . . , pr. Więc w jej rozkładzie na czynniki pierwsze występują tylko czynniki postaci 3x + 1 (bo ani czynnik 2 ani czynnik 3 nie występuje!). Z drugiej strony, łatwo sprawdzić, że iloczyn liczb postaci 3x + 1 jest liczbą tej samej postaci. Liczba N , będąc postaci 3x + 2, musiałaby być jednocześnie liczbą postaci 3x + 1. Ta sprzeczność kończy dowód. Q.e.d. ♦ P r z y k ł a d 2. Liczb pierwszych postaci 4x+3, x ∈ N, jest nieskończenie wiele. Rzeczywi- ście, załóżmy nie wprost, że takich liczb jest tylko skończenie wiele i że p1 = 7, p2 = 11, . . . , pr są wszystkimi takimi liczbami. Rozważmy liczbę N = 4p1p2 · . . . · pr + 3. Liczba N jest postaci 4x + 3, ale nie dzieli się przez żadną z wypisanych liczb pierwszych postaci 4x + 3, więc w jej rozkładzie na czynniki pierwsze występują tylko czynniki postaci 4x + 1 (bo ani czynnik 2 ani czynnik 3 nie występuje!). Z drugiej strony, łatwo sprawdzić, że iloczyn liczb postaci 4x + 1 jest liczbą tej samej postaci. Liczba N , będąc postaci 4x + 3, musiałaby być jednocześnie liczbą postaci 4x + 1. Uzyskana sprzeczność kończy dowód. Q.e.d. ♦ Ćwiczenie 5.45 Udowodnić, że liczb pierwszych postaci 6x + 5 jest nieskończenie wiele. Ćwiczenie 5.46 Niech q będzie nieparzystą liczbą pierwszą. Udowodnić, że istnieje nie- skończenie wiele liczb pierwszych postaci 2qx + 1. Wskazówka. (1) Liczby takiej postaci ist- nieją: weź dowolny dzielnik pierwszy liczby Mersenne’a Mq, zob. C5.39; (2) Jeżeli p1, . . . , pr są liczbami pierwszymi postaci 2qx + 1, to rozważ a = p1 · . . . · pr w C5.39. Chcemy teraz dowieść jeszcze więcej, mianowicie prawdziwości twierdzenia Dirichlet’a w przypadku a = 1 (z dowolnym r). Pomysł dowodu jest taki: szukamy takiej liczby pierwszej p i takiej liczby całkowitej c, że rzp(c) = r (wówczas r|p − 1, czyli p jest postaci rx + 1). Przedtem nauczymy się inaczej wyznaczać rzp(c). Mówi o tym ważny lemat L5.6. 5Powiemy tylko, że Dirichlet, za pomocą genialnego (łączącego elementy algebry z elementami analizy ma- tematycznej) rozumowania potraﬁł udowodnić rozbieżność szeregu ∑ p≡a (mod r) 1 p . Zob. [2], [7]. 6Kilka elementarnych przypadków twierdzenia Dirichlet’a (nie objętych przez T5.19) pokażemy w 5.7.6. 190 5. Arytmetyka modularna Przypomnijmy, że Φn(X) oznacza n-ty wielomian cyklotomiczny, zobacz (3.44). O wielo- mianach Φn(X) wiemy, że są one unormowane, mają współczynniki całkowite, a ich wyrazy wolne są równe ±1, zobacz C4.22 i C4.23. Ponadto, w C3.51 i C4.21 pokazujemy dwa wza- jemnie m¨obiusowsko odwrotne rozkłady (1) X n − 1 = ∏ k|n Φk(X), (2) Φn(X) = ∏ k|n (X k − 1) µ(n/k). (5.48) W dowodzie L5.6 wykorzystamy tezę zadania: ZADANIE 5.16 Niech p ∈ P i n = pαr, gdzie α = vp(n) ⩾ 1. Dowieść, że Φn(X) = Φr(X pα) Φr(X pα−1). (5.49) R o z w i ą z a n i e. Pokażemy to w przypadku α = 1 (ogólny przypadek rozpatruje się analogicznie). Korzystamy z (5.48(2)). Zbiór D+(n) (dodatnich) dzielników n jest sumą rozłączną D+(r) ⊔ pD+(r) dzielników d|r i dzielników postaci pd, gdzie d|r. Mamy więc Φn(X) = ∏ d|r (X d − 1)µ(n/d) · ∏ pd|n (X pd − 1)µ(n/pd) = ∏ d|r (X d − 1) µ(p)µ(r/d) · ∏ d|r ((X p) d − 1) µ(r/d). Stąd, ponieważ µ(p) = −1, mamy równość (5.49) (dla α = 1). ♦ LEMAT 5.6 Niech p ∈ P. Wówczas, jeżeli dla pewnego n ∈ N i pewnego c ∈ Z zachodzi kongruencja Φn(c) ≡ 0 (mod p), to p ∤ c i zachodzi równość rzp(c) = np−vp(n). D O W Ó D. Gdyby p|c, czyli c ≡ 0 (mod p), to, zob. T5.2, byłoby Φn(c) ≡ Φn(0) (mod p), więc 0 ≡ ±1 (mod p), zobacz C4.23. Otrzymany nonsens dowodzi, że p ∤ c. Zatem rzp(c) istnieje. Oznaczmy s := rzp (c). Oznaczmy też n = pαr, gdzie α = vp(n). Mamy wykazać, że s = r. Zaczniemy od przypadku, gdy α = 0. Najpierw dowodzimy, że s|r. Kładąc n = r i X = c w (5.48(1)), dostajemy równość cr − 1 = ∏ k|r Φk(c). Stąd Φr(c)|cr − 1, więc p|cr − 1, czyli cr ≡ 1 (mod p). Stąd, na mocy T5.15, s|r. Załóżmy więc, nie wprost, że s < r. Wówczas, znowu dzięki rozkładowi typu (5.48(1)), ∏ l|s Φl(c) = cs − 1 ≡ 0 (mod p). Ponieważ p jest liczbą pierwszą, więc widzimy stąd, że Φl(c) ≡ 0 (mod p) dla pewnego l|s. Ta liczba l jest właściwym dzielnikiem r (bo l|s|r i s < r). Zatem, w iloczynie ∏ k|r Φk(c) znajdują się dwa (różne!) czynniki: Φr(c) i Φl(c), oba podzielne przez p. Przeto cr − 1 = ∏ k|r Φk(c) ≡ 0 (mod p2). (5.50) Rozważmy teraz liczbę b = c + p. Ponieważ b ≡ c (mod p), więc Φr(b) ≡ Φr(c) (mod p) oraz Φl(b) ≡ Φl(c) (mod p), zobacz T5.2. Zatem również w iloczynie ∏ k|r Φk(b) występują dwa czynniki podzielne przez p. Wobec tego br − 1 = ∏ k|r Φk(b) ≡ 0 (mod p2). (5.51) 5.5. Rząd elementu grupy w teorii liczb 191 Odejmując stronami (5.50) i (5.51) widzimy, że p2|cr − br, czyli vp(cr − br) ⩾ 2. Jednocześnie vp(cr −br) = vp(c−b) = vp(−p) = 1, na mocy Z2.8 (którego założenia vp(cb) = 0 i vp(c−b) ⩾ 1 są oczywiście spełnione). Znaleziona sprzeczność kończy dowód równości rzp(c) = np−vp(n) w przypadku, gdy vp(n) = 0. Gdy vp(n) = α ⩾ 1 (i n = rpα), wystarczy, na mocy już udowodnionego, uzasadnić, że Φr(c) ≡ 0 (mod p). Otóż, dzięki (5.49) mamy równość Φn(c)Φr(cpα−1) = Φr(cpα). Założenie Φn(c) ≡ 0 (mod p) daje więc Φr(cpα) ≡ 0 (mod p). MTF (w wersji (5.12)) daje kongruencje c ≡ cp ≡ · · · ≡ cpα (mod p). Stąd (zob. T5.2) Φr(c) ≡ Φr(cpα) ≡ 0 (mod p). □ Możemy teraz udowodnić zapowiedziany przypadek szczególny twierdzenia Dirichlet’a: TWIERDZENIE 5.19 Niech r będzie ustaloną liczbą naturalną. Wówczas istnieje nie- skończenie wiele liczb pierwszych postaci rx + 1, gdzie x ∈ N. D O W Ó D. Załóżmy, że liczby p1, p2, . . . , pk są liczbami pierwszymi postaci rx + 1. Do- puszczamy możliwość k = 0. Rozważmy liczbę naturalną a = rp1p2 · . . . · pk. Gdy k = 0 kładziemy a = r. Wybierzmy taką liczbę naturalną b, że liczba N := |Φr(ab)| jest liczbą złożoną (to jest możliwe na mocy Z5.3) i połóżmy c = ab. Niech p będzie dowolnym dziel- nikiem pierwszym liczby N , czyli niech Φr(c) ≡ 0 (mod p). Na mocy L5.6 mamy zatem rzp(c) = rp−vp(r) = r, bo p ∤ c więc też p ∤ r. Stąd, na mocy T5.15 i MTF, r|p − 1, czyli p − 1 = rx. Znaleźliśmy zatem liczbę pierwszą p = rx + 1. Ponadto, ponieważ p ∤ ab, więc p ̸= pi dla i = 1, . . . , k. Mamy przeto n o w ą liczbę pierwszą postaci rx + 1! □ ZADANIE 5.17 Liczbę naturalną bezkwadratową nazwiemy k-krotną, gdy jest iloczynem k (oczywiście różnych) liczb pierwszych. Udowodnić, że dla dowolnej ustalonej liczby r ∈ N istnieje nieskończenie wiele liczb k-krotnych postaci rx + 1. R o z w i ą z a n i e. Rozumujemy przez indukcję względem k. Baza indukcji jest po prostu naszym T5.19. Dla wykonania kroku indukcyjnego załóżmy, że ry0 + 1 = p1p2 · . . . · pk dla pewnego y0 ∈ N (gdzie pi są różnymi liczbami pierwszymi). Wybierzmy taki ciąg nieskończony y1 < y2 < . . . liczb naturalnych, że liczby qi := ryi + 1 są liczbami pierwszymi większymi niż max{p1, . . . , pk} (jest to możliwe dzięki T5.20). Mając to, wybieramy liczby naturalne xi = p1 · . . . · pkyi + y0 dla i ∈ N i liczymy: rxi + 1 = r(p1 · . . . · pkyi + y0) + 1 = p1 · . . . · pkqi. W ten sposób widzimy nieskończony, rosnący ciąg liczb (k + 1)-krotnych postaci rx + 1. ♦ 5.5.6 Twierdzenie Zsigmondy’ego Chcemy teraz udowodnić ciekawe twierdzenie o dzielnikach wyrazów ciągów (an ± bn). Zaczniemy od ”ujednorodnienia” wielomianów cyklotomicznych. Jednorodne wielomiany cyklotomiczne pozwalają otrzymywać systemowe 7 rozkłady liczb postaci an − bn uogólnia- jące rozkłady postaci (5.48(1)) dla liczb an − 1. Pisząc mianowicie an − bn = bn[(a/b) n − 1] i rozkładając czynnik (a/b)n − 1 zgodnie z równością (5.48(1)), dostajemy an − bn = bn · ∏ k|n Φk(a/b). 7Ponieważ a n −bn = f (a, b), gdzie f (X, Y ) = X n −Y n ∈ Z[X, Y ], więc każdy rozkład wielomianu f (X, Y ) na czynniki w Z[X, Y ] daje rozkład liczby a n − b n na iloczyn w Z. 192 5. Arytmetyka modularna Oznaczmy Φk(a, b) := bϕ(k)Φk(a/b). To pozwala napisać jednorodne wersje (5.48) i (5.49): (1) X n − Y n = ∏ k|n Φk(X, Y ), (2) Φn(X, Y ) = ∏ k|n (X k − Y k) µ(n/k), (5.52) Φn(X, Y ) = Φr(X pα, Y pα) Φr(X pα−1, Y pα−1). (5.53) Ćwiczenie 5.47 Udowodnić, że jeżeli p|m, to zachodzi równość Φpm(X, Y ) = Φm(X p, Y p). (5.54) W dalszym ciągu ustalamy a, b ∈ N spełniające warunki a > b ⩾ 1, a ⊥ b. Badamy ciąg (un) dany przez un = an − bn. Liczbę p i e r w s z ą q nazywamy dzielnikiem pierwotnym wyrazu un tego ciągu, gdy q|un, ale q ∤ uk dla wszystkich 1 ⩽ k < n. Przez Dn = Dn(a, b) oznaczymy zbiór dzielników (pierwszych) pierwotnych wyrazu un. P r z y k ł a d 1. Rozważmy (Mn) = (2n − 1). Widzimy, że D1 = ∅, D2 = {3}, D3 = {7}, D4 = {5}, D5 = {31}, D6 = ∅. Wkrótce udowodnimy, że Dn(2, 1) ̸= ∅ dla n ̸= 1, 6. ♦ Udowodnimy teraz twierdzenie Zsigmondy’ego: TWIERDZENIE 5.20 (Zsigmondy – 1892) Zbiór Dn = Dn(a, b), dla n ⩾ 2, jest n i e p u s t y w każdym, poza wymienionymi, przypadku. Wyjątkami są: (W1) D6(2, 1); (W2) D2(a, b) dla dowolnych a, b, dla których a + b = 2 s. D O W Ó D. Będziemy pisać w skrócie Φk = Φk(a, b). Przypomnijmy też (zobacz rozwią- zanie Z2.C4) oznaczenie Supp(c) := {p ∈ P : p|c}. Zauważmy najpierw, że równość (5.52(1)) daje równość un = ∏ k|n Φk. Przeto Supp(un) = ⋃ k|n Supp(Φk). W pierwszym kroku sprawdzamy, że zbiór Dn jest podzbiorem składnika Supp(Φn) powyższej sumy i, co więcej, jest rozłączny z pozostałymi składnikami tej sumy: K r o k 1. Dn ⊆ Supp(Φn) oraz Dn ∩ Supp(Φk) = ∅, dla k|n i k < n. ◀ Założenie q|un i równość un = ∏ k|n Φk dają podzielność q|Φk dla pewnego k|n. Gdyby k < n, to, ponieważ uk = ∏ l|k Φl, mielibyśmy q|uk, co jest sprzeczne z pierwotnością q. ▶ Zbiór Supp(Φn) dzielników pierwszych liczby Φn jest więc sumą rozłączną Dn ⊔ En zbioru Dn dzielników pierwszych pierwotnych i zbioru En dzielników pierwszych niepierwotnych. Dą- żymy do uzasadnienia, że zbiór Dn jest n i e p u s t y (poza wyjątkowymi przypadkami). Naj- pierw pokażemy, że zbiór En jest ”mały” (pusty lub jednoelementowy!). K r o k 2. Jeżeli p ∈ En, to p|n. ◀ Niepierwotny dzielnik pierwszy wyrazu un jest dzielnikiem wyrazu ud dla pewnego właściwego (tzn. 1 ⩽ d < n) dzielnika d|n. Rzeczywiście, jeżeli p|un i p|um dla pewnego 1 ⩽ m < n, to p|NWD (um, un), czyli, zobacz Z2.B9, p|uNWD (m, n). Niech więc p|un i p|ud 5.5. Rząd elementu grupy w teorii liczb 193 dla pewnego właściwego dzielnika d|n. Zakładając nie wprost, że p ∤ n mamy, tym bardziej, p ∤ n d , skąd, na mocy Z2.8 (przy x = ad, y = bd i k = n/d), vp(un) = vp(ud). Więc p ∤ un ud . Ale, zob. (5.52(1)), un = ∏ k|n Φk i ud = ∏ l|d Φl, skąd Φn| un ud . Sprzeczność, bo p|Φn. ▶ K r o k 3. Jeżeli p ∈ En i n = pαr, gdzie α = vp(n), to p ∤ b i rzp(ab−1) = r. ◀ Na mocy tezy Kroku 2, p|n. Zatem n = pαr, gdzie α := vp(n) ⩾ 1. Dzięki (5.53) mamy Φn · Φr(apα−1, bpα−1) = Φr(apα, bpα), skąd p|Φr(apα, bpα). MTF, podobnie jak w dowodzie L5.6, daje Φr(apα, bpα) ≡ Φr(a, b) (mod p), więc p|Φr(a, b). Zatem p|ur, (bo Φr|ur, zob. (5.52(1))), czyli p|ar − br, skąd wnioskujemy, że p ∤ b (gdyby p|b, to byłoby kolejno p|br, p|(ar − br + br), p|ar, p|a, co jest sprzeczne z założeniem a ⊥ b). Równie łatwo wywnioskować, mnożąc przez (b−1) k (mod p), że jeżeli ∑ csasbk−s ≡ 0 (mod p), to ∑ cs(ab−1) s ≡ 0 (mod p) (przy dowolnych cj ∈ Z). Stąd Φr(ab−1) ≡ 0 (mod p). Zatem, zob. L5.6, rzp(ab−1) = r. ▶ K r o k 4. card(En) ⩽ 1. ◀ Załóżmy, że En ̸= ∅ i że p jest najmniejszym elementem zbioru En. Wówczas n = pαr i r = rzp(ab−1) ⩽ p − 1, zob. Krok 3, 5.5.4 (R3) i C2.2. Gdyby p′ ∈ En była inną liczbą pierwszą, to zachodziłaby podzielność p′|pαr, skąd p′|r. Czyli p′ ⩽ r < p. Sprzeczność. ▶ Widzimy, że zbiór En dzielników pierwszych niepierwotnych jest ”mały”. Wykażemy teraz, że ma miejsce fakt jeszcze bardziej sprzyjający niepustości zbioru Dn: K r o k 5. Jeżeli p > 2 i p ∈ En, to vp(Φn) = 1. ◀ Korzystając z (5.52(2)) mamy równość Φn = ∏ k|n uµ(n/k) k . Stąd, na mocy C2.47.1, vp(Φn) = ∑ k|n µ(n/k)vp(uk) (5.55) dla dowolnej liczby pierwszej p. Pokażemy, że, gdy p ∈ En, w tej sumie występują tylko dwa niezerowe wyrazy. Zobaczmy najpierw, dla jakich k|n zachodzi nierówność vp(uk) > 0, równoważnie, dla jakich k|n zachodzi podzielność p|uk, równoważnie, dla jakich k|n zachodzi (ab−1) k ≡ 1 (mod p). Wiemy, zobacz 5.5.4 (R2), że to zachodzi dla wszystkich k|n, dla których r|k, gdzie r = rzp(ab−1). Z Kroku 3 wiemy, że rzp(ab−1) = np−α, gdzie α = vp(n) ⩾ 1. Zatem suma (5.55) redukuje się do sumy ∑α s=0 µ(n/psr)vp(upsr) = ∑α s=0 µ(pα−s)vp(unps−α). Czyli do różnicy vp(un) − vp(un/p), bo µ(pα−s) = 0 dla α − s ⩾ 2. Mamy więc sprawdzić, że vp(un) − vp(un/p) = 1. Równość ta jest wnioskiem z Z2.9. Czytelnik zechce samodzielnie uzasadnić, że liczby x = an/p, y = bn/p spełniają założenia tego zadania! ▶ K r o k 6. Jeżeli x > y > 0, to (x − y) ϕ(m) ⩽ |Φm(x, y)| ⩽ (x + y)ϕ(m). ◀ Oznaczmy ξ = x y . Okrąg jednostkowy {z ∈ C : |z| = 1}, na którym leżą wszystkie pierwiastki z jedynki, zawarty jest w pierścieniu kołowym P(R1, R2) := {z ∈ C : R1 ⩽ |z| ⩽ R2}, gdzie R1 = ξ − 1, R2 = ξ + 1. Zatem ξ − 1 ⩽ |ξ − ωk| ⩽ ξ + 1 dla każdego k. Mnożąc te nierówności dla 1 ⩽ k ⩽ m, k ⊥ m, dostajemy (ξ − 1)ϕ(m) ⩽ Φm(ξ) ⩽ (ξ + 1)ϕ(m). Wystarczy teraz pomnożyć przez yϕ(m). U w a g a. Należy zauważyć, że nierówność lewa jest nierównością ścisłą dla wszystkich m ⩾ 2, a nierówność prawa jest ścisła dla wszystkich m ̸= 2. ▶ K r o k 7. Jeżeli En = ∅, to Dn ̸= ∅. 194 5. Arytmetyka modularna ◀ Równości En = Dn = ∅ mogą zajść jednocześnie tylko w przypadku, gdy |Φn| = 1, co, wobec Kroku 6, nigdy nie zachodzi. ▶ K r o k 8. Jeżeli En = {2} i Dn = ∅, to n = 2 i a + b = 2 s. ◀ Warunki En = {2}, Dn = ∅ są równoważne warunkom |Φn| = 2 s, s ⩾ 1. Wówczas, zob. Krok 2, 2|n. Niech n = 2 αr, gdzie 2 ∤ r i α ⩾ 1. Krok 3 pokazuje, że r = rz2(ab−1), skąd r = 1, czyli n = 2 α. Równość (5.53) (dla X = a, Y = b, p = 2) daje więc równość Φn = a2α − b2α a2α−1 − b2α−1 , bo Φ1(X, Y ) = X − Y . Mamy stąd 2 s = (a2α − b2α)/(a2α−1 − b2α−1) = a2α−1 + b2α−1. Łatwo stąd widać, że s ⩾ 2, a wówczas musi być α = 1 (wystarczy położyć a = 1 + 2c, b = 1 + 2d, by, przy założeniu α ⩾ 2, dostać absurd 2 s = 2 + 22A). ▶ K r o k 9. Jeżeli En = {p}, p > 2 oraz a − b ⩾ 2, to Dn ̸= ∅. ◀ Warunki En = {p}, p > 2, Dn = ∅ implikują, wobec tezy Kroku 5, równość |Φn| = p. Taka równość, teza Kroku 6 i założenie a − b ⩾ 2 dają nierówność p > 2 ϕ(n). Ponieważ α := vp(n) ⩾ 1, zob. Krok 2, więc ϕ(n) = ϕ(pαr) = ϕ(pα)ϕ(r) ⩾ ϕ(pα) = pα − pα−1 ⩾ p − 1. Stąd dostajemy absurdalną nierówność p > 2 p−1. Więc Dn ̸= ∅. ▶ K r o k 10. Jeżeli En = {p}, p > 2 i Dn = ∅ oraz a − b = 1, to n = 6 i a = 2, b = 1. ◀ Warunki En = {p}, p > 2, Dn = ∅ implikują, wobec tezy Kroku 5, równość |Φn| = p. Dzięki tezie Kroku 2 zapiszmy n = pαr, gdzie vp(n) = α ⩾ 1. Załóżmy najpierw, że α ⩾ 2 i połóżmy m = pα−1r, X = a, Y = b w równości (5.54). Dostajemy p = |Φn| = |Φpm| = |Φm(ap, bp)| ⩾ (ap − bp) ϕ(m) ⩾ (ap − bp) p−1, bo ϕ(m) = ϕ(pα−1r) = ϕ(pα−1)ϕ(r) ⩾ ϕ(pα−1) = pα−1 − pα−2 ⩾ p − 1. Otrzymana nierówność p ⩾ (ap − bp)p−1 jest nonsensowna, ponieważ, przy a − b = 1 i a > b ⩾ 1, (ap − bp)p−1 = (ap−1 + a p−2b + · · · + abp−2 + bp−1) p−1 > p p−1. Zatem α = 1. W takim przypadku dostajemy p = |Φn| = |Φpr| = |Φr(ap, bp)| |Φr(a, b)| ⩾ (ap − bp) ϕ(r) (a + b)ϕ(r) ⩾ ap − bp a + b ⩾ 2 p − 2 3 , (5.56) gdzie trzecia równość wynika z (5.53), a pierwsza nierówność wynika nierówności Kroku 6. Trzecią nierówność wnioskujemy ze wzoru dwumiennego i założenia a − b = 1. Rzeczywiście: ap − bp a + b = (b + 1)p − bp 2b + 1 = b 2b + 1 ( p−1∑ j=0 (p j ) bj−1) ⩾ 1 3 (2 p − 2), bo b 2b+1 ⩾ 1 3 dla b ⩾ 1, a 2 p − 2 = (1 + 1)p − 2 = ∑p−1 i=1 (p i). Nierówność (5.56), 3p ⩾ 2 p − 2, jest możliwa dla jedynej nieparzystej liczby pierwszej p = 3. Zatem n = 3r. Jednocześnie, zob. Krok 3, r = rz3(ab−1), więc r|3 − 1 (zob. 5.5.4 (R3)). Mamy zatem dwie możliwości: n = 3 lub n = 6. Przypadek n = 3 odpada, bo u1 = a − b = 1. W przypadku n = 6 mamy 3 = |Φ6| = |a 2 − ab + b2| = b2 + b + 1. Skąd (b − 1)(b + 2) = 0. Ostatecznie, b = 1 i a = 2. ▶ 5.6. Pierwiastki pierwotne 195 P o d s u m o w a n i e: W Kroku 8 odnaleźliśmy wyjątek (W2). Rzeczywiście, jeżeli a+b = 2 s, to u2 = a2−b2 = (a+b)(a−b) = 2 s(a−b), więc Supp(u2) = Supp(a−b)∪Supp(2 s) = Supp(a − b), bo 2|a − b. W Kroku 10 odnaleźliśmy, znany z przykładu P1, wyjątek (W1). Więcej wyjątków n i e m a. □ ZADANIE 5.18 Udowodnić wersję ”plusową” twierdzenia Zsigmondy’ego: Jeżeli a, b ∈ N i a > b ⩾ 1, a ⊥ b, to każdy wyraz ciągu (wn) = (an + bn) ma dzielnik pierwszy pierwotny. Jedynym w y j ą t k i e m jest wyraz 2 3 + 13 ciągu (2 n + 1n). R o z w i ą z a n i e. Załóżmy, że wyraz wn = an+bn n i e ma dzielnika pierwszego pierwotnego i rozważmy liczbę a 2n − b2n. Jeżeli to nie jest wyjątek (W1) (czyli, jeżeli to nie jest przypadek a = 2, b = 1, n = 3), ani wyjątek (W2) (czyli przypadek a + b = 2 s, n = 1), to istnieje q ∈ D2n. Wówczas q ∤ am − bm przy m < 2n, w szczególności, q ∤ a2k − b2k przy k < n. Zatem q ∤ ak + bk dla takich k. ♦ Pokażemy kilka przykładów ”działania” twierdzenia Zsigmondy’ego. P r z y k ł a d 2. Dysponując tak ostrym narzędziem jak twierdzenie Zsigmondy’ego możemy ”za darmo” rozwiązać Z2.F8. Rzeczywiście, niech p1, p2 i p3 będą p i e r w o t n y m i dzielni- kami pierwszymi wyrazów 2 rs − 1, 2 s − 1 i 2 r − 1 ciągu (un(2, 1))n∈N. Takie dzielniki istnieją, bo 2 < r < s < rs oraz 2 + 1 ̸= 2 u. Mamy więc trzy r ó ż n e dzielniki pierwsze liczby Mrs. ♦ P r z y k ł a d 3. Czy istnieją trzy (różne) liczby postaci 7 n −5 n tworzące ciąg geometryczny? Odpowiedź: n i e. Łatwo to uzasadnić. Gdyby bowiem trójka 7 k − 5 k, 7 l − 5 l, 7 m − 5 m, gdzie k < l < m tworzyła ciąg geometryczny, czyli, gdyby środkowy wyraz 7 l − 5 l był średnią geometryczną wyrazów skrajnych, to zachodziłaby równość (7m − 5 m)(7 k − 5 k) = (7l − 5 l) 2. Ale taka równość nie może zachodzić, bo każdy dzielnik pierwszy wyrazu 7 m − 5 m musiałby dzielić 7 l − 5 l, nie byłby więc dzielnikiem pierwotnym. ♦ Ćwiczenie 5.48 Wyznaczyć wszystkie trójki liczb naturalnych a, m, n ⩾ 2, dla których zachodzi równość am + 1 = (a + 1)n. Ćwiczenie 5.49 Wyznaczyć wszystkie takie liczby pierwsze p i takie liczby naturalne k, że liczba pk + pk−1 + · · · + p + 1 jest potęgą dwójki. 5.6 Pierwiastki pierwotne Dla niektórych modułów m grupa (Z/m) ∗ ma szczególnie przejrzystą budowę. Jest tak zwaną grupą cykliczną, czyli taką, której każdy element jest potęgą jednego ustalonego elementu zwanego generatorem (porównaj C1.36). 5.6.1 Deﬁnicja i uwagi wstępne W interesującym nas przypadku grup (Z/m) ∗ używamy tradycyjnej terminologii: Deﬁnicja 5.10 Niech m ⩾ 2 będzie liczbą naturalną. Liczbę całkowitą g nazywamy pierwiastkiem pierwotnym modulo m, gdy g ⊥ m i rzm(g) = ϕ(m). Inaczej mówiąc, g jest pierwiastkiem pierwotnym modulo m wtedy i tylko wtedy, gdy zbiór {g, g2, . . . , gϕ(m)} jest zredukowanym układem reszt modulo m. 196 5. Arytmetyka modularna P r z y k ł a d 1. Weźmy 2 (mod 37) ∈ (Z/37) ∗. Ciąg potęg zaczyna się następująco: 2, 4, 8, 16, −5, −10, 17, −3, −6, −12, 13, −11, 15, −7, −14, 9, 18, −1 , . . . . (Wypisujemy najmniejsze co do wartości bezwzględnej liczby całkowite reprezentujące war- stwy.) Widzimy, że 2 18 ≡ −1 (mod 37). Wobec tego dalsze potęgi 2 (mod 37) wyglądają tak: 2 18+k ≡ −2 k (mod 37). Jasne więc, że warstwa 1 (mod 37) pojawi się po raz pierwszy dla k = 18. Zatem rz37(2) = 36 = ϕ(37). Zatem: 2 jest pierwiastkiem pierwotnym (mod 37). ♦ Ćwiczenie 5.50 Wyznaczyć zbiór w s z y s t k i c h pierwiastków pierwotnych modulo 13. Wskazówka. W przykładzie z ustępu 5.5.4 widzieliśmy, że 6 jest pierwiastkiem pierwotnym modulo 13. Wypisać potęgi 6 k (mod 13) dla k = 0, 1, . . . , 11, i zauważyć, że m n o ż e n i e tych potęg odpowiada d o d a w a n i u wykładników modulo 12. Teraz zobaczyć T5.17. Ćwiczenie 5.51 Sprawdzić, że 2 jest pierwiastkiem pierwotnym modulo 29, a następnie wyznaczyć wszystkie pierwiastki pierwotne modulo 29. Skorzystać przy tym z C5.38. ZADANIE 5.19 Rozwiązać kongruencję 1 + x + x2 + x3 + x4 + x5 + x6 ≡ 0 (mod 29). (5.57) R o z w i ą z a n i e. Załóżmy, że x ∈ Z jest rozwiązaniem (5.57). Mnożąc obustronnie przez x − 1 mamy x7 − 1 ≡ 0 (mod 29). Wiemy, że 2 jest pierwiastkiem pierwotnym modulo 29. Kładąc x ≡ 2 u (mod 29), znajdujemy 2 7u ≡ 1 (mod 29). Stąd, na mocy T5.15, 28|7u, bo rz29(2) = 28. Zatem 4|u. Więc x ≡ 2 4, 2 8, 2 12, 2 16, 2 20, 2 24 (mod 29). ♦ U w a g a. W tabelce na stronie vi pokazujemy liczby pierwsze 3 ⩽ p ⩽ 2011 i odpowied- nie najmniejsze dodatnie pierwiastki pierwotne g (dla liczb pierwszych ⩽ 167 pokazujemy dodatkowo najmniejsze co do wartości bezwzględnej ujemne pierwiastki pierwotne g′). Ćwiczenie 5.52 Wyjaśnić, dlaczego ż a d e n z pierwiastków pierwotnych g nie jest kwa- dratem (liczby całkowitej), natomiast niektóre liczby pierwsze mają ujemne pierwiastki pier- wotne g′ postaci −a2. Jaką wspólną cechę mają te liczby pierwsze? Ćwiczenie 5.53 Udowodnić, że jeżeli istnieje pierwiastek pierwotny (mod m), to liczba wszystkich (różnych (mod m)) pierwiastków pierwotnych (mod m) jest równa ϕ(ϕ(m)). Ćwiczenie 5.54 Udowodnić, że jeżeli p > 2 jest liczbą pierwszą, to g ∈ Z jest pierwiast- kiem pierwotnym (mod p) wtedy i tylko wtedy, gdy g p−1 2 ≡ −1 (mod p) (5.58) i jednocześnie gk ̸≡ 1 (mod p) dla wszystkich 1 ⩽ k ⩽ p−1 2 . Ćwiczenie 5.55 Dana jest liczba naturalna m ⩾ 2 i względnie pierwsza z nią liczba całkowita g. Załóżmy, że dla każdego dzielnika pierwszego q|ϕ(m), zachodzi g ϕ(m) q ̸≡ 1 (mod m). (5.59) Udowodnić, że g jest pierwiastkiem pierwotnym modulo m. 5.6. Pierwiastki pierwotne 197 Teza tego ćwiczenia oznacza, że dla sprawdzenia, czy dana liczba jest pierwiastkiem pier- wotnym (mod m) nie musimy wypisywać wszystkich ϕ(m) początkowych wyrazów ciągu typu (5.41). W poniższym przykładzie zobaczymy jak to działa: P r z y k ł a d 2. Sprawdzimy czy 2 jest pierwiastkiem pierwotnym modulo 67. Mamy rozkład: ϕ(67) = 66 = 11 · 3 · 2. Zgodnie z C5.54 badamy 2 6, 2 22, 2 33 (mod 67). Liczymy: 2 6 ≡ 64 ≡ −3 ̸≡ 1 (mod 67), 2 22 = (2 6) 3 · 2 4 ≡ (−3)3 · 16 ≡ −432 ≡ 37 ̸≡ 1 (mod 67), 2 33 = (2 6) 5 · 2 3 ≡ (−3)5 · 8 ≡ −27 · 72 ≡ −27 · 5 = −135 ≡ −1 ̸≡ 1 (mod 67). Widzimy stąd, że 2 jest pierwiastkiem pierwotnym (mod 67). ♦ Ćwiczenie 5.56 Udowodnić, że jeżeli g jest pierwiastkiem pierwotnym modulo m, przy czym liczby m i g są nieparzyste, to g jest pierwiastkiem pierwotnym modulo 2m. Ćwiczenie 5.57 Dowieść, że liczba 2 jest pierwiastkiem pierwotnym (mod 27), a (oczy- wiście(!?)) nie jest pierwiastkiem pierwotnym (mod 54), natomiast liczba 5 jest pierwiastkiem pierwotnym zarówno (mod 27) jak i (mod 54). ZADANIE 5.20 Udowodnić, że g = 2 jest pierwiastkiem pierwotnym (mod 3 e). R o z w i ą z a n i e. Mamy pokazać, że najmniejszą liczbą n ∈ N, dla której zachodzi kon- gruencja 2 n ≡ 1 (mod 3e) jest n = ϕ(3 e) = 2 · 3 e−1. Kongruencja 2 n ≡ 1 (mod 3e) implikuje kongruencję 2 n ≡ 1 (mod 3), z której wynika(!) parzystość liczby n. Połóżmy więc n = 2k. Wtedy 3 e|4 k − 1, czyli v3(4 k − 1) ⩾ e. Ale v3(4k − 1) = v3(4 − 1) + v3(k) = 1 + v3(k) na mocy LZW (zob. T2.18). Zatem v3(k) ⩾ e − 1. Najmniejszą liczbą k spełniającą tę nierówność jest k = 3 e−1. Więc najmniejszą liczbą n jest liczba 2 · 3 e−1 = ϕ(3 e) = card (Z/3 e) ∗. ♦ Ćwiczenie 5.58 Udowodnić obserwację młodego Gaussa: 10 jest pierwiastkiem pierwot- nym modulo p ̸= 2, 5 wtedy i tylko wtedy, gdy ciąg cyfr dziesiętnych (po przecinku) liczby 1 p jest ciągiem czysto-okresowym8 o okresie długości p − 1. 5.6.2 Twierdzenie o istnieniu pierwiastków pierwotnych Udowodnimy teraz twierdzenie o istnieniu pierwiastków pierwotnych modulo m. ZADANIE 5.21 Udowodnić, że jeżeli m = m1m2, m1, m2 > 2 i NWD (m1, m2) = 1, to n i e i s t n i e j e pierwiastek pierwotny modulo m. R o z w i ą z a n i e. Skorzystamy z multyplikatywności ϕ-funkcji, zobacz T4.1, i ćwiczenia C4.13. Niech ϕ(m1) = 2u1, ϕ(m2) = 2u2 dla pewnych naturalnych u1, u2. Zatem, dla dowolnej względnie pierwszej z m liczby całkowitej a, dzięki T5.5: a ϕ(m) 2 ≡ (aϕ(m1))u2 ≡ 1 u2 ≡ 1 (mod m1). 8Ciąg (an)n⩾1 nazywa się ciągiem czysto-okresowym, gdy istnieje takie t ∈ N, że an+t = an dla w s z y s t k i c h n ∈ N. 198 5. Arytmetyka modularna Podobnie a ϕ(m) 2 ≡ 1 (mod m2). Stąd a ϕ(m) 2 ≡ 1 (mod m), zobacz C2.17. Więc a nie jest pierwiastkiem pierwotnym modulo m. ♦ W powyższym zadaniu dowiedliśmy, że jedynie względem modułów m postaci m = pe, gdzie p jest liczbą pierwszą, i m = 2qe, gdzie q jest nieparzystą liczbą pierwszą, m o g ą istnieć pierwiastki pierwotne. TWIERDZENIE 5.21 Pierwiastek pierwotny (mod m) istnieje wtedy i tylko wtedy, gdy moduł m jest jednej z następujących postaci m = pe, m = 2pe, m = 2, m = 4, gdzie p oznacza n i e p a r z y s t ą liczbę pierwszą, a e dowolną liczbę naturalną. D O W Ó D. (1) Udowodnimy najpierw, że dla każdej liczby pierwszej p istnieje ϕ(p − 1) parami niekongruentnych (mod p) pierwiastków pierwotnych (mod p). Dla danej liczby naturalnej d oznaczmy R(d) := {¯x ∈ (Z/p) ∗ : rzp(x) = d}. Ponieważ każdy element ¯x ∈ (Z/p) ∗ m a jakiś rząd będący dzielnikiem p − 1, zobacz T5.14, więc (Z/p)∗ = ⊔ d|p−1 R(d) (suma rozłączna = suma składników parami rozłącznych). Stąd p − 1 = ∑ r|p−1 |R(d)|. (5.60) Teza jest, oczywiście, równoważna faktowi, że |R(p − 1)| = ϕ(p − 1). Wykażemy w i ę c e j: Dla każdego dodatniego dzielnika d|p − 1 zachodzi równość |R(d)| = ϕ(d). Załóżmy w tym celu, że R(d) ̸= ∅ dla pewnego d|p − 1 i niech ¯a ∈ R(d). Rozważmy generowaną przez ¯a podgrupę Λ = {¯a, ¯a2, . . . , ¯ad−1, ¯ad}. Zbiór Λ zawiera dokładnie d elementów, z których k a ż d y jest pierwiastkiem kongruencji xd − 1 ≡ 0 (mod p). Ale, zobacz T5.12, kongruencja ta ma co najwyżej d rozwiązań, więc w zbiorze Λ występują w s z y s t k i e jej rozwiązania. Ponieważ każda warstwa rzędu d jest rozwiązaniem naszej kongruencji, więc zbiór R(d) jest podzbiorem zbioru Λ i ma, zobacz C5.38, ϕ(d) elementów. Widzimy stąd, że jeżeli |R(d)| ̸= 0, to |R(d)| = ϕ(d). Jednocześnie, zobacz (4.5), p − 1 = ∑ d|p−1 ϕ(d). (5.61) Porównanie tej sumy z sumą (5.60), po uwzględnieniu nierówności |R(d)| ⩽ ϕ(d), pokazuje, że wszystkie składniki w sumie (5.60) są w istocie równe odpowiednim składnikom w sumie (5.61). W szczególności, |R(p − 1)| = ϕ(p − 1). To kończy rozumowanie. U w a g a. Korzystając z lematu L5.6 można znacznie uprościć przedstawione rozumowanie: Równość X p−1 − 1 = ∏ d|p−1 Φd(X) i C5.30 pokazują, że dla każdego z ϕ(p − 1) = deg Φp−1(X) pierwiastków α wielomianu Φp−1(X) w Fp zachodzi równość rzp(α) = p − 1. (2) Dowodzimy teraz istnienia pierwiastka pierwotnego (mod pe), dla p ∈ P>2. Niech p > 2 będzie liczbą pierwszą i niech g będzie pierwiastkiem pierwotnym modulo p. Wtedy gp−1 ≡ 1 (mod p), czyli vp(gp−1 − 1) ⩾ 1. Pokażemy, że (A) Jeżeli vp(gp−1 − 1) = 1, to rzpe(g) = (p − 1)pe−1 = ϕ(pe) dla każdego e ∈ N. Rzeczywiście, niech d = rzpe(g). Wtedy gd ≡ 1 (mod p) (bowiem gd ≡ 1 (mod pe)), więc p − 1|d (na mocy T5.15, bo rzp(g) = p − 1). Niech d = (p − 1)k. Liczby x = gp−1, y = 1 spełniają założenia LZW (zob. T2.18). Mamy więc e ⩽ vp(gd − 1) = vp(xk − yk) = vp(gp−1 − 1) + vp(k) = 1 + vp(k) 5.6. Pierwiastki pierwotne 199 (początkowa nierówność jest tylko innym zapisem założenia pe|gd − 1). Zatem vp(k) ⩾ e − 1. Więc d ⩾ (p − 1)pe−1 = ϕ(pe) = rz (Z/p e)∗. Jednocześnie, zobacz T5.14, d|ϕ(pe). Przeto d = ϕ(pe), więc g jest pierwiastkiem pierwotnym modulo pe. Pokażemy teraz, że (B) Jeżeli g jest pierwiastkiem pierwotnym modulo p, dla którego vp(gp−1 − 1) ⩾ 2, to dla g1 = g + p zachodzi równość vp(gp−1 1 − 1) = 1. Rzeczywiście, gdyby obie liczby gp−1 − 1 i gp−1 1 − 1 były podzielne przez p2, to ich różnica, równa (dzięki wzorowi dwumiennemu) (gp−1 1 − 1) − (gp−1 − 1) = (g + p) p−1 − gp−1 = ( p − 1 1 )pgp−2 + p2A, gdzie A ∈ Z, byłaby podzielna przez p2. Stąd dostalibyśmy podzielność p2|(p − 1)pgp−2, czyli p|(p − 1)gp−2. Co, wobec NWD (p, p − 1) = 1 i NWD (p, g) = 1, jest niemożliwe. W ten sposób uzasadniliśmy, że dla każdej nieparzystej liczby pierwszej p istnieje pier- wiastek pierwotny modulo pe przy dowolnym e ∈ N. Rzeczywiście, z dwóch liczb g, g + p, gdzie g jest pierwiastkiem pierwotnym (mod p), co najmniej jedna jest pierwiastkiem pierwot- nym (mod pe). (3) Jeżeli g jest pierwiastkiem pierwotnym modulo pe, gdzie p > 2, i g jest liczbą niepa- rzystą, to, na mocy C5.55, g jest również pierwiastkiem pierwotnym modulo 2pe. Jeżeli zaś g jest liczbą parzystą, to g1 = g + pe jest również pierwiastkiem pierwotnym modulo pe, a przy tym jest liczbą nieparzystą. Widzimy więc, że dla wszystkich modułów m = 2pe, gdzie p > 2, istnieją pierwiastki pierwotne. (4) Pierwiastkiem pierwotnym modulo m = 2 jest oczywiście g = 1, zaś pierwiastkiem pierwotnym modulo m = 4 jest oczywiście g = 3. Wobec Z5.21, dla zakończenia dowodu wystarczy się jeszcze przekonać, że dla żadnego modułu postaci m = 2 e, e ⩾ 3, n i e i s t n i e j e pierwiastek pierwotny. To wynika z kongruencji (2k + 1)2e−2 ≡ 1 (mod 2e) (5.62) prawdziwej dla e ∈ N⩾3 i k ∈ Z. Prosty dowód indukcyjny tej kongruencji pozostawiamy Czytelnikowi (byłoby również dobrze dostrzec tu możliwość zastosowania LZW). Kongruencja (5.62) pokazuje, że rz2e(a) ⩽ 2 e−2 < 2 e−1 = ϕ(2 e) dla każdej liczby nieparzystej a przy dowolnym e ⩾ 3. Żadna więc liczba nieparzysta nie może być pierwiastkiem pierwotnym modulo 2 e, e ⩾ 3. Liczby parzyste w ogóle nie wchodzą w rachubę! □ Przypadek m = 2 e, e ⩾ 3, opisuje poniższe ćwiczenie: Ćwiczenie 5.59 Wykazać, że 5 jest ”prawie” pierwiastkiem pierwotnym modulo 2 e, w tym sensie, że dla każdego b ∈ (Z/2 e) ∗ jedna (ale nie obie, w przypadku gdy e ⩾ 3) z kongruencji b ≡ 5 x (mod 2 e) lub b ≡ −5 x (mod 2 e) ma rozwiązanie x ∈ Z. U w a g a. Tezę tego ćwiczenia w języku algebry wyraża się tak: Jeżeli e ⩾ 3, to grupa ((Z/2 e)∗, ·) jest iloczynem prostym swoich podgrup cyklicznych (5) i (−1). 5.6.3 Jeszcze kilka przykładów Pokażemy tu parę przykładów zastosowań i wyznaczania pierwiastków pierwotnych (mod m). 200 5. Arytmetyka modularna ZADANIE 5.22 Niech p będzie liczbą pierwszą. Udowodnić, że Ak := 1 k + 2k + . . . + (p − 1)k ≡ { 0 (mod p), gdy p − 1 ∤ k, −1 (mod p), gdy p − 1|k. (5.63) R o z w i ą z a n i e. Niech g będzie ustalonym pierwiastkiem pierwotnym modulo p. Wów- czas ciąg gk, g2k, . . . , g(p−1)k jest permutacją ciągu składników sumy Ak w Z/p. Zatem Ak ≡ gk + g2k + . . . + g(p−1)k (mod p). Jeżeli p − 1|k, to każdy składnik tej sumy, na mocy MTF, przystaje do 1 (mod p), a tych składników jest p − 1, więc ich sumą jest (−1) (mod p). Z drugiej strony, tożsamość nieśmier- telna pozwala napisać (gk − 1)Ak ≡ gkp − gk ≡ gk(gk(p−1) − 1) ≡ 0 (mod p), znowu dzięki MTF. Jeżeli teraz p − 1 ∤ k, to gk − 1 ̸≡ 0 (mod p), więc musi być Ak ≡ 0 (mod p). ♦ Ćwiczenie 5.60 Udowodnić, że iloczyn wszystkich (różnych modulo p) pierwiastków pier- wotnych modulo p przystaje do (−1)ϕ(p−1) modulo p. Ćwiczenie 5.61 Udowodnić, że suma wszystkich (różnych modulo p) pierwiastków pier- wotnych modulo p przystaje do µ(p − 1) modulo p. Zobacz D4.6. Czytelnik, którego zdumiały warunki zachodzenia kongruencji (5.15) może rozwiązać: Ćwiczenie 5.62 Dla danej liczby m ∈ N oznaczmy przez P (m) iloczyn wszystkich liczb ze zbioru {k ∈ N : 1 ⩽ k ⩽ m, k ⊥ m}. Udowodnić, że P (m) ≡ −1 (mod m), gdy istnieje pierwiastek pierwotny (mod m). ZADANIE 5.23 Udowodnić, że jeżeli p ̸= 3 jest liczbą pierwszą Fermat’a, to −3 jest pierwiastkiem pierwotnym modulo p. R o z w i ą z a n i e. Niech p = Fn = 2 m+1, gdzie m = 2 n, będzie liczbą pierwszą. Oznaczmy a = (−3) 2m−1. Zgodnie z C5.55, liczba −3 jest pierwiastkiem pierwotnym modulo p wtedy i tylko wtedy, gdy a ̸≡ 1 (mod p). Załóżmy więc, nie wprost, że a ≡ 1 (mod p). Niech g będzie dowolnym pierwiastkiem pierwotnym modulo p. Wtedy −3 ≡ gk (mod p) dla pewnego wykładnika k ∈ N. Wykażemy, że k jest liczbą parzystą. Gdyby k = 2l + 1, to mielibyśmy 1 ≡ a ≡ (g2l+1)2m−1 ≡ (g2m) l · g2m−1 ≡ 1 l · g2m−1 ≡ −1 (mod p), zobacz C5.54, bo p−1 2 = 2 m−1. Ta niedorzeczność dowodzi, że k = 2r. Połóżmy b = gr. Wtedy: −3 ≡ b2 (mod p). (5.64) Niech c spełnia kongruencję 2c ≡ b − 1 (mod p). Oczywiście takie c istnieje, bo 2 jest odwracalna modulo p. Wówczas, dzięki (5.64): 8c3 ≡ (b − 1) 3 ≡ b(b2 + 3) − (3b2 + 1) ≡ b · 0 − (3(−3) + 1) ≡ 8 (mod p), skąd c3 ≡ 1 (mod p), bo 8 jest odwracalne modulo p. Warstwa c (mod p) ma więc, na mocy T5.15, rząd 1 lub 3 w grupie (Z/p)∗. Sprawdzenie, że ten rząd nie jest równy 1 pozostawiamy Czytelnikowi. Zatem rzp(c) = 3. To jednakże również nie może mieć miejsca, bo wtedy, na mocy T5.14, mielibyśmy nieprawdziwą podzielność 3|2 m. To kończy rozwiązanie. ♦ 5.6. Pierwiastki pierwotne 201 Ćwiczenie 5.63 Dowieść, że jeżeli p ∈ P i p ≡ 1 (mod 4), to g jest pierwiastkiem pier- wotnym (mod p) wtedy i tylko wtedy, gdy −g jest pierwiastkiem pierwotnym (mod p). Wy- wnioskować (zob. Z5.23), że 3 jest pierwiastkiem pierwotnym modulo Fn, gdy Fn ∈ P, n ⩾ 1. Ćwiczenie 5.64 Niech q = 2m + 1, m ⩾ 2. Udowodnić, że jeżeli 3 q−1 2 ≡ −1 (mod q), to q jest liczbą pierwszą (Fermat’a!). Wskazówka. Jeżeli q − 1|ϕ(q), to q jest liczbą pierwszą. Ćwiczenie 5.65 Dana jest liczba pierwsza postaci 4k + 3. Udowodnić, że liczba g jest pierwiastkiem pierwotnym modulo p wtedy i tylko wtedy, gdy rzp(−g) = p−1 2 . Ćwiczenie 5.66 Załóżmy, że p ≡ 3 (mod 8) jest taką liczbą pierwszą, że p−1 2 jest również liczbą pierwszą. Udowodnić, że 2 jest pierwiastkiem pierwotnym modulo p. 5.6.4 Indeks Indeks, zwany też logarytmem dyskretnym, j e s t logarytmem. I używa się go w teorii liczb tak, jak w analizie matematycznej używa się zwykłego logarytmu. Deﬁnicja 5.11 Niech g będzie ustalonym pierwiastkiem pierwotnym (mod m), gdzie m jest jednej z postaci (5.58). Indeksem danej warstwy a (mod m) ∈ (Z/m) ∗ przy podstawie g nazywamy taką warstwę k = k (mod ϕ(m)) ∈ Z/ϕ(m), że zachodzi gk ≡ a (mod m). (5.65) Taki indeks oznaczamy ind g(a), lub, gdy wiemy o jaki pierwiastek pierwotny chodzi, ind (a). Ćwiczenie 5.67 Załóżmy, że g i h są pierwiastkami pierwotnymi modulo m. Udowodnić, że dla dowolnych a, b ∈ (Z/m) ∗: (1) ind g(ab) ≡ ind g(a) + ind g(b) (mod ϕ(m)); (2) ind g(a) ≡ ind g(h) · ind h(a) (mod ϕ(m)). P r z y k ł a d. Weźmy m = 27 (= 33). Z C5.57 wiemy, że 2 i 5 są pierwiastkami pierwot- nymi (mod 27). Oto ciąg typu (5.41) dla s = 2 (mod 27): 2 4 8 16 5 10 20 13 26 25 23 19 11 22 17 7 14 1 Stąd dostaniemy tabelę funkcji (Z/27) ∗ ∋ x 7−→ y = ind2(x) ∈ Z/18: x 1 2 4 5 7 8 10 11 13 14 16 17 19 20 22 23 25 26 y 0 1 2 5 16 3 6 13 8 17 4 15 12 7 14 11 10 9 Czytelnik zechce zbudować analogiczną tabelkę indeksów o podstawie 5, a następnie na tej i wyżej zamieszczonej tabelce potrenować logarytmowanie modulo 27. ♦ Ćwiczenie 5.68 Uzasadnić, że dla dowolnej nieparzystej liczby pierwszej p zachodzi rów- ność indg(−1) = p−1 2 , gdzie g jest dowolnym pierwiastkiem pierwotnym (mod p). 202 5. Arytmetyka modularna 5.6.5 Dwa słowa o liczbach Carmichaela To jest dobre miejsce na powiedzenie kilku słów o tak zwanych liczbach Carmichaela. Deﬁnicja. Liczba złożona m ∈ N nazywa się liczbą Carmichaela, gdy dla każdej takiej liczby a ∈ Z, że a ⊥ m, zachodzi kongruencja am−1 ≡ 1 (mod m). TWIERDZENIE 5.22 (Kryterium Korselta) Liczba naturalna złożona m jest liczbą Carmichaela wtedy i tylko wtedy, gdy (i ) m jest liczbą bezkwadratową, (ii ) dla każdego dziel- nika pierwszego p|m zachodzi podzielność p − 1|m − 1. D O W Ó D. (⇒) (i ) Załóżmy, że m jest liczbą Carmichaela. Niech m = pkm ′, gdzie p ∈ P, k ∈ N i p ⊥ m ′. Wykażemy, że k = 1. Załóżmy więc, nie wprost, że k ⩾ 2. Na mocy CTR (Chińskiego Twierdzenia o Resztach), istnieje a ∈ Z spełniające warunki: a ≡ p + 1 (mod pk) i a ≡ 1 (mod m′). Wtedy a ⊥ m, więc am−1 ≡ 1 (mod m), bo m jest liczbą Carmichaela. Redukując to modulo p2, dostajemy (1 + p) m−1 ≡ 1 (mod p2). Ale (1 + p) m−1 ≡ 1 + (m − 1)p (mod p2). Ponieważ p|m, więc 1 + (m − 1)p ≡ 1 − p (mod p2). Dostajemy więc sprzeczność 1 ≡ 1 − p (mod p2). Dowodzi ona, że k = 1. (ii ) Pokazujemy teraz, że p − 1|m − 1 dla każdego p|m. Ponieważ m jest bezkwadratowa, więc p ⊥ m/p. Niech g będzie pierwiastkiem pierwotnym modulo p. Na mocy CTR znajdu- jemy taką liczbę całkowitą a, że a ≡ g (mod p) i a ≡ 1 (mod m p ). Jasne, że a ⊥ m. Zatem am−1 ≡ 1 (mod m). Redukując tę kongruencję modulo p dostajemy gm−1 ≡ 1 (mod p), skąd, na mocy T5.15, p − 1|m − 1, bo rzp(g) = p − 1. (⇐) Załóżmy, że m jest taką liczbą naturalną, bezkwadratową i złożoną, że p−1|m−1 dla każdego dzielnika pierwszego p|m. Weźmy dowolną liczbę a ⊥ m. Wówczas, dla dowolnego dzielnika pierwszego p|m, p ∤ a, więc ap−1 ≡ 1 (mod p), na mocy MTF. Więc również am−1 ≡ 1 (mod p) (bo p − 1|m − 1). To znaczy, że pi|am−1 − 1 dla każdej liczby pierwszej z rozkładu m = p1p2 · . . . · ps. Wobec tego, że czynniki pi są parami różne (więc też parami względnie pierwsze), na mocy C2.17 i oczywistej indukcji(!), m|am−1 − 1. □ Pokażemy dwa przykłady zastosowania kryterium Korselta: P r z y k ł a d 1. Załóżmy, że liczby 6n+1, 12n+1 i 18n+1, dla pewnego n ∈ N, są liczbami pierwszymi. Wtedy: Liczba m = (6n + 1)(12n + 1)(18n + 1) jest liczbą Carmichaela. Rzeczy- wiście, liczba m = (6n + 1)(12n + 1)(18n + 1), jako iloczyn trzech różnych liczb pierwszych, jest liczbą bezkwadratową. Warunek (i ) kryterium Korselta jest więc spełniony. Dla sprawdzenia warunku (ii ) tego kryterium mamy sprawdzić, że 6n, 12n i 18n są dzielnikami liczby m − 1. To wynika z równości m = 36N + 18n + 12n + 6n + 1 = 36N ′ + 1. Q.e.d. Wprawdzie n i e w i a d o m o czy istnieje nieskończenie wiele n ∈ N, dla których 6n+1, 12n+1, 18n+1 ∈ P, ale nietrudno wskazać takie przykłady. Największe n z naszej tabelki liczb pierwszych to n = 100: liczby 601, 1201 i 1801, są pierwsze. Mamy więc ”dużą” liczbę Carmichaela: 1 299 963 601. ♦ P r z y k ł a d 2. Każda liczba Carmichaela ma co najmniej trzy różne dzielniki pierwsze. Rzeczywiście, gdyby n = pq, gdzie p ̸= q ∈ P, było liczbą Carmichaela, to p − 1|pq − 1 i q − 1|pq − 1. Stąd natychmiast dostajemy sprzeczność: p − 1 = q − 1. Q.e.d. ♦ U w a g a. Udowodniono (1992), że liczb Carmichaela jest niekończenie wiele. Najmniejszą jest 561 = 3 · 11 · 17. Istnienie liczb Carmichaela jest pewną nieprzyjemnością w, ważnym w kryptograﬁi, ”fermatowskim” teście pierwszości, zob. [ 3 ]. 5.7. Reszty kwadratowe i prawo wzajemności 203 5.7 Reszty kwadratowe i prawo wzajemności Prawo wzajemności dla reszt kwadratowych jest najważniejszym i najpiękniejszym (co zawsze idzie w parze!) twierdzeniem elementarnej teorii liczb. Pierwszy jego dowód pokazał Gauss. 5.7.1 Reszty i niereszty kwadratowe modulo p Element s danego zbioru (G, ∗) z działaniem ∗ nazywa się kwadratem, gdy istnieje taki element t ∈ G, że s = t ∗ t = t 2. W grupie (R∗, ·) liczb rzeczywistych niezerowych (z działaniem mnożenia) kwadratami są liczby d o d a t n i e. W grupie (C∗, ·) niezerowych liczb zespolonych z mnożeniem k a ż d y element jest kwadratem. W grupie (Z, +) liczb całkowitych z dodawaniem kwadratami są liczby p a r z y s t e, a w grupie (R, +) liczb rzeczywistych z dodawaniem k a ż d y element jest kwadratem. W zbiorze (Z, ·) liczb całkowitych z mnożeniem kwadratów jest ”dość mało”: {0, 1, 4, 9, 16, . . . }. W tym paragraﬁe będziemy się zajmować charakteryzacją kwadratów w grupach ((Z/m) ∗, ·). Deﬁnicja 5.12 Kwadrat w grupie (Z/m) ∗ nazywa się resztą kwadratową modulo m, pozostałe elementy tej grupy nazywa się nieresztami kwadratowymi modulo m. Piszemy aRm, gdy a (mod m) jest resztą kwadratową, oraz aNm, gdy jest nieresztą kwadratową. P r z y k ł a d 1. Niech m = 30. Oglądając tabelkę mnożenia w grupie (Z/30) ∗ z ustępu 5.4.2 widzimy, że istnieją dwie reszty kwadratowe modulo 30. Są to 1 (mod 30) i 19 (mod 30). Istotnie kongruencja x2 ≡ 1 (mod 30) ma (cztery) rozwiązania: 1, 11, 19 i 29, a kongruen- cja x2 ≡ 19 (mod 30) ma również (cztery) rozwiązania: 7, 13, 17 i 23. Pozostałe elementy (warstwy modulo 30) grupy (Z/30) ∗, mianowicie 7, 11, 13, 17, 23 i 29 są nieresztami kwa- dratowymi modulo 30. ♦ Niech NWD (a, m) = 1. Wówczas aRm, gdy kongruencja x2 ≡ a (mod m) ma rozwią- zanie. Wiemy z WT5.13, że kongruencja ta ma rozwiązania wtedy i tylko wtedy, gdy mają rozwiązania kongruencje x2 ≡ a (mod pvp(m)) dla każdej liczby pierwszej p. W paragraﬁe 5.8 przekonamy się, że jeżeli p jest nieparzystą liczbą pierwszą, to aRpn wtedy i tylko wtedy, gdy aRp, zobacz T5.29. Wobec tego zajmiemy się dokładnie przypadkiem m = p > 2. TWIERDZENIE 5.23 Niech p będzie nieparzystą liczbą pierwszą. W grupie (Z/p) ∗ jest tyle samo reszt kwadratowych co niereszt kwadratowych. D O W Ó D. Oznaczmy s = p−1 2 . Bardzo łatwo jest wskazać s reszt kwadratowych: 1 2 (mod p), 2 2 (mod p), . . . , s 2 (mod p). Sprawdzamy, że wypisaliśmy s r ó ż n y c h warstw. Istotnie, gdyby a2 (mod p) = b2 (mod p) dla pewnych 1 ⩽ a ⩽ b ⩽ s, to byłoby (b − a)(b + a) ≡ 0 (mod p), co może, wobec narzuconych ograniczeń, zachodzić tylko, gdy a = b. Ponieważ każda niezerowa warstwa (mod p) równa jest a (mod p) lub −a (mod p) dla pewnego 1 ⩽ a ⩽ s, a takie dwie dają ten sam kwadrat, więc wypisaliśmy już w s z y s t k i e reszty kwadratowe. □ Ćwiczenie 5.69 Niech p będzie liczbą pierwszą, g dowolnym pierwiastkiem pierwotnym modulo p. Uzasadnić, że gk (mod p) jest resztą kwadratową modulo p wtedy i tylko wtedy, gdy wykładnik k jest liczbą parzystą. 204 5. Arytmetyka modularna 5.7.2 Symbol Legendre’a Funkcja, która na resztach kwadratowych modulo p przyjmuje wartość 1, a na nieresztach wartość −1 jest, mimo prostoty określenia, tak w a ż n a, że zasługuje na specjalną nazwę. Deﬁnicja 5.13 (Symbol Legendre’a) Niech p będzie n i e p a r z y s t ą liczbą pierwszą. Dla a ∈ Z kładziemy (a|p) = ( a p ) =  | | +1, gdy aRp, −1, gdy aNp, 0, gdy p|a. (5.66) 5.7.3 Kryterium Eulera Kryterium Eulera pozwala, za pomocą prostej operacji podnoszenia do potęgi, przekonać się czy dana reszta (mod p) jest resztą kwadratową. TWIERDZENIE 5.24 (Kryterium Eulera) Jeżeli p jest nieparzystą liczbą pierwszą, to dla dowolnego a ∈ Z zachodzi a p−1 2 ≡ (a p ) (mod p). (5.67) D O W Ó D. Gdy p|a sprawa jest oczywista. Niech więc p ∤ a i niech a ≡ gk (mod p) dla danego pierwiastka pierwotnego g. W C5.69 sprawdziliśmy, że gk (mod p) jest kwadratem wtedy i tylko wtedy, gdy k jest liczbą parzystą. Z drugiej strony, jeżeli k = 2l, to a p−1 2 ≡ (gk) p−1 2 ≡ (g2l) p−1 2 ≡ ( gp−1)l ≡ 1 l ≡ 1 (mod p). Jeżeli zaś k = 2l + 1, to a p−1 2 ≡ (gk) p−1 2 ≡ ( g2l+1) p−1 2 ≡ (gp−1)l g p−1 2 ≡ g p−1 2 ≡ −1 (mod p). Ostatnia kongruencja wynika z faktu, że g p−1 2 jest taką liczbą, której kwadrat ≡ 1 (mod p), a która sama n i e przystaje do 1 modulo p (musi więc przystawać do −1 modulo p, co wynika z T5.12 zastosowanego do wielomianu X 2 − 1). □ P r z y k ł a d 1. Zastosowanie kryterium Eulera dla zbadania charakteru kwadratowego da- nej warstwy modulo p jest możliwe, choć żmudne. Zbadamy na przykład, czy 31R97. Mamy 31 48 ≡ 961 24 ≡ (−9)24 ≡ 81 12 ≡ (−16) 12 ≡ 256 6 ≡ (−35) 6 ≡ (−36) 3 ≡ 1 (mod 97). Zatem (31|97) = +1. Czyli: kongruencja x2 ≡ 31 (mod 97) ma rozwiązania. Oczywiście z tego nie wynika, że umiemy je znaleźć. ♦ Mamy dwa natychmiastowe wnioski z T5.24: 5.7. Reszty kwadratowe i prawo wzajemności 205 WNIOSEK 1. Symbol Legendre’a jest funkcją ś c i ś l e m u l t y p l i k a t y w n ą: ( ab p ) = ( a p ) ( b p ) . □ Drugi oczywisty wniosek nazywa się I uzupełnieniem prawa wzajemności : WNIOSEK 2. Jeżeli p jest nieparzystą liczbą pierwszą, to ( −1 p ) = { +1 ⇐⇒ p ≡ 1 (mod 4), −1 ⇐⇒ p ≡ 3 (mod 4). □ (5.68) Widzimy, że jeżeli p jest nieparzystą liczbą pierwszą, to kongruencja x2 + 1 ≡ 0 (mod p) ma rozwiązania, gdy p ≡ 1 (mod 4), i nie ma rozwiązań, gdy p ≡ 3 (mod 4). Pokażemy trzy przykłady: P r z y k ł a d 2. Udowodnimy: Jeżeli p = Fn = 2 m + 1, gdzie m = 2 n, jest liczbą p i e r w s z ą Fermata, to każda niereszta kwadratowa modulo p jest pierwiastkiem pierwot- nym modulo p. Rzeczywiście, g jest pierwiastkiem pierwotnym (mod p) wtedy i tylko wtedy, gdy gϕ(p)/2 ̸≡ 1 (mod p), zob. C5.55, bo w badanym przypadku 2 jest j e d y n y m dzielnikiem pierwszym liczby ϕ(p) = 2n−1. W tym też przypadku ϕ(p) = p−1 2 . Zatem, g jest pierwiast- kiem pierwotnym (mod p) wtedy i tylko wtedy, gdy g(p−1)/2 ̸≡ 1 (mod p), czyli wtedy i tylko wtedy, gdy gNp. Q.e.d. ♦ P r z y k ł a d 3. Udowodnimy: Jeżeli dla n ∈ N zachodzi równość σ(n) = 2n + 1, to n jest kwadratem (liczby naturalnej). Niech p > 2 będzie dzielnikiem pierwszym liczby n i niech k = vp(n). Wówczas n = pkn′ i p ∤ n ′, więc, na mocy multyplikatywności funkcji σ, zobacz C4.2, mamy σ(n) = σ(pk)σ(n ′) = (1 + p + . . . + pk)σ(n ′) = 2n + 1. To dowodzi, że k ≡ 0 (mod 2). Widzimy, że vp(n) jest liczbą parzystą dla każdej nieparzystej liczby pierwszej p. Zapiszmy więc n = 2 lm2, gdzie 2 ∤ m. Wówczas 2 l+1m2 + 1 = 2n + 1 = σ(n) = σ(2 l)σ(m 2) = (2l+1 − 1)σ(m 2). Uzyskaną równość przekształcamy do postaci m 2+1 = (2 l+1−1)(σ(m 2)−m 2), z której widzimy, że m2 + 1 ≡ 0 (mod q) dla każdego dzielnika pierwszego q liczby 2 l+1 − 1. Jasne, że gdy l > 0, to liczba 2 l+1 − 1, będąc sama postaci 4t + 3, musi mieć dzielnik pierwszy q postaci 4t + 3. I wtedy (−1)Rq, co jest niemożliwe. Ostatecznie l = 0 i n = m 2. Q.e.d. ♦ P r z y k ł a d 4. Udowodnimy: Jeżeli p ∈ P, to ∑p−1 r=1 (r|p) · r ≡ 0 (mod p). Rzeczywiście, niech g będzie dowolnym pierwiastkiem pierwotnym (mod p). Wówczas p−1∑ r=1 ( r p ) r ≡ p−2∑ k=0 ( gk p ) gk ≡ p−2∑ k=0 (−1)kgk ≡ p−2∑ k=0 (−g) k (mod p). Mnożąc (w Z/p) sumę z prawej strony przez 1+g, dostajemy (zobacz tożsamość nieśmiertelną) (1 + g) ∑p−1 r=1 (r|p) · r ≡ 1 − (−g) p−1 ≡ 0 (mod p) na mocy MTF. Wystarczy teraz pomnożyć przez (1 + g) −1 (mod p). Q.e.d. ♦ 206 5. Arytmetyka modularna Ćwiczenie 5.70 Niech p będzie liczbą pierwszą i niech p ∤ a. Udowodnić, że warunkiem koniecznym i wystarczającym rozwiązalności kongruencji xn ≡ a (mod p) jest zachodzenie przy- stawania a p−1 d ≡ 1 (mod p), gdzie d = NWD (n, p − 1). 5.7.4 Kryterium Gaussa Jeden ze słynnych lematów Gaussa dostarcza, łatwiejszego w operowaniu niż kryterium Eulera, kryterium odróżniającego reszty kwadratowe (mod p) od niereszt kwadratowych (mod p). Niech p będzie n i e p a r z y s t ą liczbą pierwszą. Wówczas s := p−1 2 jest liczbą naturalną. Niech S = { [r1], [r2], . . . , [rs] } ⊆ (Z/p)∗ będzie takim s-elementowym podzbiorem, że (Z/p) ∗ = S ⊔ S′ = { [r1], [r2], . . . , [rs] } ⊔ { −[r1], −[r2], . . . , −[rs] }. (5.69) Podzbiorów S spełniających warunek (5.69) jest dużo, mianowicie 2 s. Jeżeli bowiem zapi- szemy (Z/p) ∗ = {[1], [p − 1]} ⊔ {[2], [p − 2]} ⊔ . . . ⊔ {[s], [p − s]}, to wybierając z każdej pary po jednym elemencie dostaniemy odpowiedni zbiór S. P r z y k ł a d 1. Najczęściej używanymi zbiorami S są dwa z nich. Są to: S = {1, 2, . . . , s}, (układ Gaussa), S = {2, 4, . . . , p − 1}, (układ Eisensteina). Tu i dalej, dla oznaczenia warstw (mod p), wypisujemy tylko reprezentanty tych warstw. ♦ Dla danej, niepodzielnej przez p, liczby całkowitej a i danego podzbioru S spełniającego warunek (5.69), zdeﬁniujmy zbiór: aS := {ar1, ar2, . . . , ars}. Oznaczmy: ν(p, a) = card (aS ∖ S). (5.70) Dla układu Gaussa, ν(p, a) oznacza liczbę tych elementów zbioru aS, które przy dzieleniu przez p dają (najmniejszą dodatnią!) resztę w i ę k s z ą n i ż s, a dla układu Eisensteina, liczbę tych elementów zbioru aS, które przy dzieleniu przez p dają resztę n i e p a r z y s t ą. Następne twierdzenie udowodnił K. Gauss w roku 1808. TWIERDZENIE 5.25 (Kryterium Gaussa) Przy wprowadzonych oznaczeniach, dla do- wolnej nieparzystej liczby pierwszej p i liczby całkowitej a ̸≡ 0 (mod p), zachodzi równość ( a p ) = (−1) ν(p, a). (5.71) D O W Ó D. Wypiszmy s kongruencji  ||| ||| ar1 ≡ ε(1)ri1 (mod p), ar2 ≡ ε(2)ri2 (mod p), . . . ars ≡ ε(s)ris (mod p), (5.72) 5.7. Reszty kwadratowe i prawo wzajemności 207 gdzie ε(k) = ±1. Ponieważ każda (niezerowa) warstwa modulo p jest elementem zbioru S lub jest elementem zbioru S′ (czyli jest elementem przeciwnym do pewnego elementu ri ∈ S), więc takie napisy mają miejsce. Zauważmy, że ilość wyrazów równych −1 w ciągu (ε(1), ε(2), . . . , ε(s)) jest równa ν(p, a). Zatem ε(1)ε(2) · . . . · ε(s) = (−1) ν(p, a). (5.73) Co więcej, ciąg (ri1, ri2, . . . , ris) jest p e r m u t a c j ą ciągu (r1, r2, . . . , rs). Istotnie, rów- ność rik = ril, dla pewnych 1 ⩽ k, l ⩽ s, dzięki kongruencjom (5.72), daje ε(k)ark ≡ rik ≡ ril ≡ ε(l)arl (mod p), skąd a(ε(k)rk − ε(l)rl) ≡ 0 (mod p), co, po uproszczeniu przez a (pamiętamy, że p ∤ a) daje rk ≡ rl (mod p) lub rk ≡ −rl (mod p). Ale druga z tych kongruencji zajść nie może, bo S ∩ S′ = ∅. Zatem rik = ril ⇒ rk = rl. Więc rzeczywiście, ciąg (ri1, ri2, . . . , ris) jest permutacją ciągu (r1, r2, . . . , rs). Oznaczmy przez R iloczyn (wszystkich) wyrazów pierwszego (i drugiego!) ciągu. Pomnóżmy stronami wszystkie s kongruencji (5.72). Otrzymamy: as · R ≡ as s∏ k=1 rk ≡ s∏ k=1 ark ≡ s∏ k=1 ε(k)rik ≡ s∏ k=1 ε(k) s∏ k=1 rik ≡ s∏ k=1 ε(k) · R (mod p). Mnożąc to obustronnie przez odwrotność R−1 (mod p) i korzystając z (5.73), dostajemy a p−1 2 = a s ≡ s∏ k=1 ε(k) ≡ (−1) ν(p, a) (mod p). Wobec tego, na mocy (5.67), (a|p) ≡ (−1)ν(p, a) (mod p), co daje równość (5.71), bo p jest liczbą nieparzystą. □ P r z y k ł a d 2. Weźmy na przykład p = 11, a = 6. Wówczas: jeżeli S = {1, 2, 5, 7, 8}, to aS = {−5, 1, 8, −2, −7}; jeżeli zaś S = {1, 2, 3, 6, 7}, to aS = {6, 1, 7, 3, −2}. W pierwszym przypadku ν(p, a) = 3, w drugim ν(p, a) = 1, ale w obu przypadkach mamy (−1) ν(p, a) = −1. Więc 6N11. ♦ Udowodnimy teraz tak zwane II uzupełnienie prawa wzajemności . Pozwala ono wy- znaczyć charakter kwadratowy liczby 2 modulo p: TWIERDZENIE 5.26 Jeżeli p jest nieparzystą liczbą pierwszą, to ( 2 p ) = { +1 ⇐⇒ p ≡ ±1 (mod 8), −1 ⇐⇒ p ≡ ±3 (mod 8). (5.74) D O W Ó D. Dla dowodu skorzystamy z kryterium Gaussa z S równym układowi Gaussa. Musimy w tym celu rozstrzygnąć ile jest większych niż s = p−1 2 liczb w zbiorze 2S = {2, 4, 6, . . . , p − 1}. 208 5. Arytmetyka modularna Ponieważ 2x ⩽ s wtedy i tylko wtedy, gdy x ⩽ s/2 = p−1 4 , więc widzimy, że ν(p, 2) = p − 1 2 − ⌊ p − 1 4 ⌋ . Każda nieparzysta liczba pierwsza p jest jednej z postaci 8k + 2t + 1, gdzie t = 0, 1, 2, 3. W tych przypadkach mamy odpowiednio: p − 1 2 − ⌊ p − 1 4 ⌋ = 4k + t − ⌊2k + t 2 ⌋ =  ||| ||| 2k, dla t = 0 2k + 1, dla t = 1 2k + 1, dla t = 2 2k + 2, dla t = 3 Widzimy, że ν(p, 2) jest liczbą parzystą wtedy i tylko wtedy, gdy p ≡ 1, 7 (mod 8) a liczbą nieparzystą wtedy i tylko wtedy, gdy p ≡ 3, 5 (mod 8). To kończy dowód. □ U w a g a. Łatwo sprawdzić, że (5.74) wyrażają dokładnie tę samą treść co równość ( 2 p ) = (−1) p2−1 8 . 5.7.5 Prawo wzajemności reszt kwadratowych Najważniejszym (i najpiękniejszym) twierdzeniem elementarnej teorii liczb jest theorema fun- damentale (twierdzenie podstawowe, zwane również theorema aureum – twierdzenie złote). TWIERDZENIE 5.27 (Prawo wzajemności reszt kwadratowych) Jeżeli p i q są różnymi nieparzystymi liczbami pierwszymi, to ( q p ) · ( p q ) = (−1) p−1 2 · q−1 2 . (5.75) D O W Ó D. Niech p ̸= q będą dwiema nieparzystymi liczbami pierwszymi. Dla wyznacze- nia wartości (q|p) wykorzystamy kryterium Gaussa z układem Eisensteina {2, 4, . . . , p − 1}. Mamy qS = {2q, 4q, . . . , (p − 1)q}. Dzielimy z resztą każdy element tego zbioru przez p: 2kq = ⌊ 2kq p ⌋ · p + rk, gdzie 1 ⩽ rk ⩽ p − 1, (5.76) dla k = 1, 2, . . . , s. Tym razem ν(p, q) oznacza liczbę n i e p a r z y s t y c h spośród reszt rk. Sprytny pomysł Eisensteina polega na wykorzystaniu równości ( q p ) = (−1) ν(p, q) = (−1)∑′ rk = (−1) ∑ rk, (5.77) gdzie przez ∑′ rk oznaczyliśmy sumę n i e p a r z y s t y c h spośród reszt rk, a przez ∑ rk sumę w s z y s t k i c h reszt rk. Trzecia z tych równości wynika z faktu ”neutralności” składników 5.7. Reszty kwadratowe i prawo wzajemności 209 parzystych w wykładniku potęgi o podstawie (−1). Druga zaś, wynika z oczywistego faktu, że suma pewnej ilości liczb nieparzystych różni się od ich ilości o liczbę parzystą. Wykładnik∑ rk obliczamy dodając stronami równości (5.76): s∑ k=1 rk = 2 · s∑ k=1 kq − p · s∑ k=1 ⌊ 2kq p ⌋ . Stąd, dzięki (5.77), ( q p ) = (−1) ∑s k=1⌊ 2kq p ⌋, (5.78) bo składniki parzyste w wykładniku można zaniedbać, a (−1)p = −1. Dokładnie tak samo dostaniemy ( p q ) = (−1) ∑t l=1⌊ 2lp q ⌋, (5.79) gdzie t = q−1 2 . Mnożąc stronami równości (5.78), (5.79), dostaniemy ( q p ) · ( p q ) = (−1) ∑s k=1⌊ 2kq p ⌋+ ∑t l=1⌊ 2lp q ⌋. Porównanie tej równości z równością (5.75), pokazuje, że dla zakończenia dowodu wystarczy udowodnić, że s∑ k=1 ⌊ 2kq p ⌋ + t∑ l=1 ⌊ 2lp q ⌋ ≡ p − 1 2 · q − 1 2 (mod 2). (5.80) Aby to zrobić zauważmy najpierw, że liczba ⌊ 2kq p ⌋ może być zinterpretowana jako liczba punktów kratowych o odciętej równej 2k i d o d a t n i e j rzędnej, leżących p o d prostą o równa- niu y = q p x (lub na tej prostej). Analogicznie, liczba ⌊ 2lp q ⌋ oznacza liczbę punktów kratowych o rzędnej równej 2l i dodatniej odciętej leżących n a l e w o od prostej o równaniu y = q p x. Opisane tu punkty kratowe będziemy w dalszym ciągu nazywać punktami wyróżnionymi. Na rysunku 5.2 widzimy prostokąt ABCD o wierzchołkach A = (0, 0), B = (p, 0), C = (p, q) i D = (0, q) (przy p = 17, q = 11). Punkty wyróżnione leżące w e w n ą t r z prostokąta ABCD zaznaczyliśmy czarnymi kółeczkami. Niech K, L, M, N oznaczają środki odpowiednich boków. Niech też S będzie środkiem prostokąta (na rysunku nie oznaczonym). Zauważmy, że na przekątnych wewnątrz prostokąta n i e m a punktów kratowych. Symetria osiowa o osi lN L przeprowadza trójkąt △CSL na trójkąt △BSL. Punkty wy- różnione pierwszego z tych trójkątów p r z e c h o d z ą w punkty wyróżnione drugiego. Zatem, wewnątrz trójkąta △CSB znajduje się p a r z y s t a liczba punktów wyróżnionych. Podobnie, dzięki symetrii osiowej o osi lKM , widzimy, że wewnątrz trójkąta △DSC znajduje się pa- rzysta liczba punktów wyróżnionych. Wobec tego, suma z lewej strony (5.80) jest tej samej parzystości, co liczba punktów wyróżnionych znajdujących się wewnątrz trójkąta △ABD. Jednocześnie, symetria osiowa o osi lN L przeprowadza wyróżnione punkty z wnętrza trój- kąta △DSN w niewyróżnione (zaznaczone krzyżykami) punkty kratowe z wnętrza trójkąta 210 5. Arytmetyka modularna △ASN , a symetria osiowa o osi lKM przeprowadza wyróżnione punkty z wnętrza trójkąta △BSK w niewyróżnione (zaznaczone krzyżykami) punkty kratowe z wnętrza trójkąta △ASK. B D C L M N K x A Rys. 5.2 To oznacza, że wyróżnionych punktów we wnętrzu trójkąta △ABD jest dokładnie tyle ile jest w s z y s t k i c h punktów kratowych we wnętrzu prostokąta AKSN , a tych jest p−1 2 · q−1 2 . W ten sposób dowód równości (5.75) jest zakończony. □ U w a g a 1. Pierwszy pełny dowód równości (5.75) pochodzi od Gaussa (data odkrycia: 8 IV 1796, data publikacji: 1801). Zbiór znanych dowodów ma (obecnie) około 200 elementów (sam Gauss opublikował sześć różnych dowodów). Pokazany wyżej dowód jest w zasadzie t r z e c i m d o w o d e m G a u s s a. Istotne u p r o s z c z e n i a pochodzą od Eisensteina. P r z y k ł a d. Prawo wzajemności (5.75) i jego uzupełnienia (5.68) i (5.74) pozwalają wyzna- czać charakter kwadratowy dowolnych liczb całkowitych względem dowolnego modułu pierw- szego. Sprawdzimy na przykład, czy −30 jest resztą kwadratową modulo 647. Obliczymy w tym celu wartość symbolu Legendre’a (−30|647). Mamy: ( 3 647 ) = ( 647 3 ) · (−1) 323·1 = ( 2 3 ) · (−1) = (−1) · (−1) = +1, ( 5 647 ) = ( 647 5 ) · (−1) 323·2 = ( 2 5 ) · (+1) = −1. Wobec multyplikatywności symbolu Legendre’a, mamy więc ( −30 647 ) = ( −1 647 ) · ( 2 647 ) · ( 3 647 ) · ( 5 647 ) = (−1) · (+1) · (+1) · (−1) = +1. 5.7. Reszty kwadratowe i prawo wzajemności 211 Zatem (−30)R647, co oznacza, że kongruencja x2 ≡ −30 (mod 647) ma rozwiązania. ♦ Ćwiczenie 5.71 Uzasadnić, że jeżeli liczba pierwsza p ≡ 173 (mod 1680), to (−2)Np, (−3)Np, (−5)Np i (−7)Np. U w a g a 2. Równość (5.75) najłatwiej zapamiętać i stosować następująco: Jeżeli dane są różne nieparzyste liczby pierwsze p, q, to (q|p) = − (p|q), gdy obie liczby p, q są postaci 4x + 3, gdy zaś co najmniej jedna z liczb p, q jest postaci 4x + 1, to (q|p) = (p|q). 5.7.6 Prawo wzajemności a ciągi arytmetyczne Istnieją silne i ważne związki między ciągami arytmetycznymi a prawem wzajemności. Poka- żemy teraz parę przykładów takich związków. Niech p oznacza n i e p a r z y s t ą liczbę pierwszą. I uzupełnienie prawa wzajemności może być sformułowane następująco: (−1)Rp ⇐⇒ p ≡ 1 (mod 4). (5.81) Zobacz (5.68). Widzimy stąd, że −1 jest resztą kwadratową modulo te liczby pierwsze p, które są wyrazami ciągu arytmetycznego (4x + 1). Na przykład p = 5, 13, 29, 37, 41, 53 itd. II uzupełnienie prawa wzajemności może być sformułowane9 następująco: 2Rp ⇐⇒ p ≡ ±1 (mod 8). (5.82) Zobacz (5.74). Widzimy stąd, że 2 jest resztą kwadratową modulo te liczby pierwsze p, które są wyrazami ciągu arytmetycznego (8x + 1) lub ciągu arytmetycznego (8x + 7). Na przykład p = 17, 41, 73, 89, 97 itd., lub p = 7, 23, 31, 47, 71, 79 itd. P r z y k ł a d 1. Zobaczymy teraz w jakich ciągach arytmetycznych leżą te liczby pierwsze p, dla których (−2)Rp. Ponieważ symbol Legendre’a jest funkcją multyplikatywną licznika, zobacz T5.23, więc (−2 p ) = ( −1 p ) ( 2 p ) . Wobec tego (−2|p) = +1 wtedy i tylko wtedy, gdy (−1|p) = (2|p) = +1 lub (−1|p) = (2|p) = −1. Pierwszy przypadek zachodzi wtedy i tylko wtedy, gdy p ≡ 1, 5 (mod 8) i p ≡ 1, 7 (mod 8), czyli wtedy i tylko wtedy, gdy p ≡ 1 (mod 8). Drugi przypadek zachodzi wtedy i tylko wtedy, gdy p ≡ 3, 7 (mod 8) i p ≡ 3, 5 (mod 8), czyli wtedy i tylko wtedy, gdy p ≡ 3 (mod 8). Mamy więc: (−2)Rp ⇐⇒ p ≡ 1, 3 (mod 8). (5.83) 9Napis postaci a ≡ ±b (mod c) jest skrótem alternatywy a ≡ b (mod d) l u b a ≡ −b (mod c). Podobnie, napis postaci a ≡ b, c (mod d) znaczy alternatywę a nie koniunkcję! 212 5. Arytmetyka modularna Zatem, −2 jest resztą kwadratową modulo p ̸= 2 wtedy i tylko wtedy, gdy p jest wyrazem jednego z ciągów arytmetycznych (8x + 1), (8x + 3). ♦ P r z y k ł a d 2. Zobaczymy w jakich ciągach arytmetycznych leżą te liczby pierwsze p, dla których 3Rp. Niech p ̸= 3. Rozpatrzmy przypadki: (1) p ≡ 1 (mod 4), (2) p ≡ 3 (mod 4). W przypadku (1), na mocy 5.7.5 U2, (3|p) = (p|3). Zatem (3|p) = +1 wtedy i tylko wtedy, gdy (p|3) = +1, czyli wtedy i tylko wtedy, gdy p ≡ 1 (mod 3). Warunki p ≡ 1 (mod 4) i p ≡ 1 (mod 3) są spełnione jednocześnie dla liczb pierwszych p spełniających p ≡ 1 (mod 12), i tylko dla takich liczb. W przypadku (2), znów na mocy 5.7.5 U2, (3|p) = − (p|3). Zatem (3|p) = +1 wtedy i tylko wtedy, gdy (p|3) = −1, czyli wtedy i tylko wtedy, gdy p ≡ 2 (mod 3). Warunki p ≡ 3 (mod 4) i p ≡ 2 (mod 3) są spełnione jednocześnie dla liczb pierwszych p spełniających p ≡ 11 (mod 12), i tylko dla takich liczb. Podsumowując, mamy: 3Rp ⇐⇒ p ≡ ±1 (mod 12). (5.84) Znowu więc znaleźliśmy ciągi arytmetyczne, w których rozmieszczone są te liczby pierwsze p, dla których liczba 3 jest resztą kwadratową modulo p. ♦ Ćwiczenie 5.72 Udowodnić, że (−3)Rp ⇐⇒ p ≡ 1, 7 (mod 12), (5.85) 5Rp ⇐⇒ p ≡ ±1, ±3 2 (mod 20), (5.86) (−5)Rp ⇐⇒ p ≡ 1, 3, 7, 9 (mod 20), (5.87) 7Rp ⇐⇒ p ≡ ±1, ±3 2, ±5 2 (mod 28), (5.88) (−7)Rp ⇐⇒ p ≡ 1, 9, 11, 15, 23, 25 (mod 28). (5.89) Spróbujmy uogólnić wyniki (5.84), (5.86) i (5.88): Ćwiczenie 5.73 Niech q będzie nieparzystą liczbą pierwszą. Udowodnić, że qRp ⇐⇒ p ≡ ±1, ±3 2, . . . , ±(q − 2)2 (mod 4q). (5.90) Ćwiczenie 5.74 Korzystając tylko z kryterium Gaussa, udowodnić (5.83) i (5.84). Pokażemy teraz jak można wykorzystać poznane własności symbolu Legendre’a w dowo- dzie kilku elementarnych przypadków twierdzenia Dirichlet’a T5.19, objętych lub nie przez twierdzenie T5.20. P r z y k ł a d 3. Zaczniemy od ciągu arytmetycznego (4x + 1)x∈N. Udowodnimy, że Liczb pierwszych postaci 4x + 1 jest nieskończenie wiele. Rzeczywiście, załóżmy, nie wprost, że p1 = 5, p2 = 13, . . . , ps są w s z y s t k i m i liczbami pierwszymi postaci 4x + 1 i rozważmy liczbę N = 4(p1p2 · . . . · ps)2 + 1. Niech p będzie dowolną liczbą pierwszą dzielącą N . Wówczas (2p1p2 · . . . · ps) 2 ≡ −1 (mod p), co oznacza, że (−1)Rp. Zatem, patrz (5.81), p ≡ 1 (mod 4). Jednocześnie p ̸= pi dla 1 ⩽ i ⩽ s. Sprzeczność. Q.e.d. ♦ 5.7. Reszty kwadratowe i prawo wzajemności 213 Porównajmy powyższy dowód z dowodami pokazanymi w przykładach P1 i P2 z ustępu 5.5.6. W każdym z nich ważną rolę gra stosownie dobrany wielomian. Wielomianami tymi są odpowiednio 4X 2 + 1, 3X + 2 i 4X − 1. Ćwiczenie 5.75 Udowodnić, że każdy z ciągów: (5x − 1), (8x − 1), (12x − 1), (12x + 7) zawiera nieskończenie wiele liczb pierwszych. Wskazówka. W dowodzie można wykorzystać wielomiany 20X 2 − 1, 8X 2 − 1, 12X 2 − 1, 4X 2 + 3 odpowiednio. 5.7.7 Trójmian kwadratowy modulo p Zobaczymy teraz jak rozwiązuje się równania kwadratowe w ciałach Z/p. TWIERDZENIE 5.28 Niech p > 2 będzie nieparzystą liczbą pierwszą. Kongruencja ax2 + bx + c ≡ 0 (mod p), (5.91) gdzie p ∤ a, ma rozwiązanie wtedy i tylko wtedy, gdy ∆ ≡ 0 (mod p) lub ∆Rp. Tu, tak jak w szkole, ∆ = b2 − 4ac. D O W Ó D. Mnożąc obie strony przez 4a otrzymujemy kongruencję równoważną (!) (2ax + b)2 ≡ ∆ (mod p). Stąd wynika nie tylko teza, ale i więcej: jeżeli przez √∆ oznaczymy dowolny p i e r w i a s t e k k w a d r a t o w y z ∆ modulo p, czyli element w Z/p spełniający warunek ( √∆) 2 ≡ ∆ (mod p), to rozwiązaniami (5.91) są (porównaj wzory (3.10)): x ≡ (2a) −1(−b ± √∆) (mod p). (5.92) Zauważmy, że odwrotność (2a)−1 (mod p) istnieje, bo p ∤ 2a. □ P r z y k ł a d. Znajdziemy wszystkie rozwiązania kongruencji 7x2 − 2x + 5 ≡ 0 (mod 79). Najpierw wyznaczamy wyróżnik: ∆ ≡ 2 2 − 4 · 7 · 5 ≡ 4 − 70 − 70 ≡ 4 + 9 + 9 ≡ 22 (mod 79). Następnie sprawdzamy czy 22R79: ( 22 79 ) = ( 2 79 ) (11 79 ) = (+1) · (−1) (79 11 ) = (−1) ( 2 11 ) = +1. Wobec tego istnieje √ 22 (mod 79). Jak go wyznaczyć? Metoda prób i błędów jest oczywiście dość niepraktyczna (wymaga znajdowania reszt z dzielenia kolejnych kwadratów 1 2, . . . , 38 2 przez 79). Na szczęście, ponieważ 79 ≡ 3 (mod 4), możemy powołać się na poniższe zadanie Z5.24. Wynika z niego, że √ ∆ = √ 22 ≡ 22 20 ≡ 10 10 ≡ 38 (mod 79). Ponieważ, jak łatwo sprawdzić, 14 −1 (mod 79) = 17 (mod 79), więc wzory (5.92) dają nam rozwiązania x1 = 17 · (2 + 38) (mod 79) = 48 (mod 79), x2 = 17 · (2 − 38) (mod 79) = 20 (mod 79). Zauważmy, że dostajemy stąd rozkład 7X 2 − 2X + 5 ≡ 7(X − 48)(X − 20) (mod 79) na czynniki liniowe nad ciałem Z/79. ♦ 214 5. Arytmetyka modularna ZADANIE 5.24 Udowodnić, że jeżeli p = 4k + 3 jest liczbą pierwszą oraz dRp, to d p+1 4 ≡ √d (mod p). R o z w i ą z a n i e. Mamy uzasadnić, że (d p+1 4 ) 2 ≡ d (mod p). Otóż: (d p+1 4 )2 = d p+1 2 = d p−1 2 d ≡ (+1)d ≡ d (mod p). Przedostatnia kongruencja wynika z założenia, że dRp i z kryterium Eulera (5.67). ♦ Ćwiczenie 5.76 Rozłożyć na czynniki nierozkładalne nad ciałami współczynników wielo- miany: 3X 2 + 5X − 123 ∈ F131[X], X 3 + 5X 2 − 397X + 391 ∈ F647[X]. Ćwiczenie 5.77 Niech a ̸≡ 0 (mod p), gdzie p jest liczbą pierwszą. Udowodnić, że jeżeli h(X) = aX 2 + bX + c, to (zobacz oznaczenie w D5.2), N (h; p) := 1 + ( ∆ p ) . Ćwiczenie 5.78 Dana jest liczba pierwsza p > 2. Udowodnić, że poniższe dwa zdania są równoważne: (1) istnieje taka liczba całkowita x, że p|x2 + 3x + 7, (2) istnieje taka liczba całkowita y, że p|y2 + 22y + 140. 5.7.8 Kilka zadań Pokażemy tu kilka typowych zadań, przy rozwiązaniu których przydatna (niezbędna?) jest wiedza na temat reszt i niereszt kwadratowych modulo p. ZADANIE 5.25 Niech h(X) = X 8 − 16. Udowodnić, że N (h; p) ̸= ∅ dla dowolnej liczby pierwszej. R o z w i ą z a n i e. Mamy rozkład h(X) = (X 2−2)(X 2+2)(X 2−2X+2)(X 2+2X+2), zobacz tożsamość Sophie Germain. Wyróżniki występujących tu czterech trójmianów kwadratowych są równe odpowiednio: ∆1 = 8, ∆2 = −8, ∆3 = −4 i ∆4 = −4. Jeżeli p ∈ P>2, to mamy ( ∆1 p ) (∆2 p ) (∆3 p ) = ( ∆1∆2∆3 p ) = ( (2 4) 2 p ) = +1. Stąd wynika, że co najmniej jeden z symboli (∆i|p) jest równy +1. Czyli, co najmniej jeden z trzech trójmianów ma pierwiastek (mod p), więc N (h; p) ̸= ∅ dla nieparzystych p ∈ P. Jasne jest też, że 0 (mod 2) ∈ N (h; 2). ♦ ZADANIE 5.26 Udowodnić, że jeżeli 2 n − 1|3 n − 1, n ∈ N, to n = 1. R o z w i ą z a n i e. Ponieważ 3|2 n − 1 dla parzystych n (oczywiście!), więc podzielność 2 n − 1|3 n − 1 może mieć miejsce tylko, gdy n ≡ 1 (mod 2). Niech p|2 n − 1 będzie dowolnym dzielnikiem pierwszym. Wtedy p|3 n−1, skąd 1 = (1|p) = (3n|p) = (3|p) n = (3|p), gdzie trzecia równość wynika z multyplikatywności symbolu Legendre’a, a czwarta – z nieparzystości liczby n. Zatem 3Rp, czyli, zob. (5.84), p ≡ ±1 (mod 12). Widzimy zatem, że jeżeli 2 n − 1|3 n − 1, to w s z y s t k i e dzielniki pierwsze liczby 2 n − 1 są postaci ±1 (mod 12). Więc i sama liczba 2 n − 1 jest postaci ±1 (mod 12). Ale równość 2 n − 1 = 12a + 1 jest możliwa tylko, gdy n = 1 (i a = 0), a równość 2 n − 1 = 12b − 1 w ogóle nie jest możliwa! ♦ 5.7. Reszty kwadratowe i prawo wzajemności 215 ZADANIE 5.27 Załóżmy, że p i q = 2p + 1 są liczbami pierwszymi. Udowodnić, że w takiej sytuacji, jeżeli p ≡ 1 (mod 4), to 2 jest pierwiastkiem pierwotnym modulo q, jeżeli zaś p ≡ 3 (mod 4), to −2 jest pierwiastkiem pierwotnym modulo q. R o z w i ą z a n i e. (1) p = 4k + 1. Niech d = rzq(2). Wówczas, jak to już wiemy od dawna, d|q − 1, czyli d|2p. Wobec tego d = 1 lub d = 2 lub d = p lub d = 2p. Chcemy udowodnić, że d = ϕ(q) = q − 1 = 2p. Ponieważ przypadki d = 1 i d = 2 prowadzą do nonsensownych wniosków 2 ≡ 1 (mod q) i 2 2 ≡ 1 (mod q), więc pozostaje nam uzasadnić, że n i e może zachodzić przypadek d = p. Załóżmy więc, nie wprost, że d = p. Wówczas (2 q ) ≡ 2 q−1 2 = 2 p ≡ 1 (mod q), gdzie pierwsza kongruencja wynika z kryterium Eulera. Zatem 2Rq. Ale to jest niemożliwe, bo q = 2p + 1 = 8k + 3, zobacz (5.74). (2) p = 4k + 3. Niech d = rzq(−2). Podobnie jak przed chwilą odrzucamy możliwości d = 1 i d = 2. Gdyby zaś d = p, to mielibyśmy ( −2 q ) ≡ (−2) q−1 2 ≡ (−2) p ≡ 1 (mod q). Więc (−2)Rq. Sprzeczność, bo q = 2p + 1 = 8k + 7 ≡ 7 ̸≡ 1, 3 (mod 8), zobacz (5.83). ♦ U w a g a 1. Liczba pierwsza p, dla której 2p + 1 jest również liczbą pierwszą, nazywa się liczbą pierwszą (Sophie) Germain. W tabelce na stronie vi, wśród 304 liczb pierwszych znajduje się 59 liczb pierwszych Germain. Z tego 28 przystaje do 1 modulo 4 (największą z nich jest 1973), a 31 przystaje do 3 modulo 4 (największą z ich jest 2003). N i e w i a d o m o, czy liczb pierwszych Germain jest skończenie czy nieskończenie wiele. ZADANIE 5.28 Załóżmy, że p ≡ 3 (mod 4) jest liczbą pierwszą Germain. Udowodnić, że Mp = 2 p − 1 jest liczbą złożoną. R o z w i ą z a n i e. Ponieważ q = 2p + 1 = 2(4k + 3) + 1 = 8k + 7, więc, na mocy II uzupełnienia prawa wzajemności, 2Rq. Niech a 2 ≡ 2 (mod q). Wówczas, dzięki MTF, 1 ≡ aq−1 ≡ a2p ≡ (a2) p ≡ 2 p (mod q). Zatem q|Mp, więc Mp ma dzielnik właściwy, bo q = 2p + 1 < 2 p − 1 dla p > 3. ♦ U w a g a 2. Wiemy, że Mn = 2 n−1 może być liczbą pierwszą tylko w przypadku, gdy n jest liczbą pierwszą, zobacz 2.3.3 P3. Ponieważ p = 11 jest liczbą pierwszą spełniającą założenia zadania Z5.27, więc widzimy, że 23|M11. To widzieliśmy już w 2.3.3 P3. Teraz jesteśmy w stanie udowodnić, że 4007|M2003. Czy umielibyśmy przekonać się o tym ”na piechotę”? ZADANIE 5.29 Wyznaczyć najmniejszą liczbę pierwszą p, dla której zachodzą równości p = s2 + t2 = u2 + 2v2 = w2 + 3x2 = y2 + 5z2 (5.93) przy pewnych całkowitych s, t, u, v, w, x, y, z. 216 5. Arytmetyka modularna R o z w i ą z a n i e. Zauważmy najpierw, że jeżeli dla liczb całkowitych a, b i d zachodzi równość p = a2 + db2, to p ∤ b. Istotnie, gdyby p|b, to, na mocy zasady podstawowej, p|a i zachodziłaby nonsensowna równość p = p2(a ′2 + db′2). Wobec tego, patrz T5.5, istnieje odwrotność b−1 (mod p). Wówczas (ab−1) 2 ≡ −d (mod p), więc (−d)Rp. Widzimy stąd, że jeśli zachodzą równości (5.93), to (−1)Rp, (−2)Rp, (−3)Rp, (−5)Rp, czyli, patrz (5.81), (5.83), (5.85), (5.87), p ≡ 1 (mod 4), p ≡ 1, 3 (mod 8), p ≡ 1, 7 (mod 12), p ≡ 1, 3, 7, 9 (mod 20). Ponieważ, 8k + 3 = 4(2k) + 3, 12k + 7 = 4(3k + 1) + 3, 20k + 3 = 4(5k) + 3 oraz 20k + 7 = 4(5k + 1) + 3, więc z szesnastu powyższych możliwości zostają tylko dwie: (1)  ||| ||| p ≡ 1 (mod 4) p ≡ 1 (mod 8) p ≡ 1 (mod 12) p ≡ 1 (mod 20) (2)  ||| ||| p ≡ 1 (mod 4) p ≡ 1 (mod 8) p ≡ 1 (mod 12) p ≡ 9 (mod 20) Oba te układy kongruencji mają rozwiązania, zobacz T5.9. Pierwszy układ jest przy tym równoważny kongruencji p ≡ 1 (mod 120), a drugi, kongruencji p ≡ 49 (mod 120). Najmniejszą liczbą pierwszą spełniającą (1) jest p = 241, a najmniejszą liczbą pierwszą spełniającą (2) jest p = 409. Sprawdzimy jeszcze, że spełnione są warunki (5.93). Otóż: 241 = 42 + 152 = 13 2 + 2 · 6 2 = 7 2 + 3 · 8 2 = 14 2 + 5 · 3 2, 409 = 32 + 202 = 11 2 + 2 · 12 2 = 19 2 + 3 · 4 2 = 2 2 + 5 · 9 2. Ponieważ min{241, 409} = 241, więc odpowiedzią jest: p = 241. ♦ ZADANIE 5.30 Udowodnić, że istnieje nieskończenie wiele takich liczb pierwszych p, dla których najmniejszy dodatni pierwiastek pierwotny (mod p) jest większy niż 2017. R o z w i ą z a n i e. Niech q1 = 2, q2 = 3, . . . , qs = 2017 będą wszystkimi liczbami pierw- szymi ⩽ 2017. Dzięki T5.20 wiemy, że istnieje nieskończenie wiele liczb pierwszych postaci 4q1q2 · . . . · qsx + 1. Twierdzimy, że jeżeli p jest taką liczbą, to żadna liczba 1 ⩽ h ⩽ 2017 nie jest pierwiastkiem pierwotnym (mod p). Rzeczywiście, ( qj p ) = ( p qj ) = ( 4q1q2 · . . . · qsx + 1 qj ) = ( 1 qj ) = +1, zob. 5.7.5 U2. Rozkładając liczbę naturalną h ⩽ 2017 na iloczyn liczb pierwszych, dostajemy równość h = ∏s j=1 qej j . Stąd, na mocy multyplikatywności symbolu Legendre’a, (h|p) = +1. Każda więc liczba naturalna h ⩽ 2017 jest resztą kwadratową (mod p). Ale reszta kwadratowa modulo p nie może być pierwiastkiem pierwotnym modulo p (dlaczego?). ♦ U w a g a 3. W naszej tabelce liczb pierwszych obok każdej liczby pierwszej p pokazujemy najmniejszy (dodatni) pierwiastek pierwotny (mod p. W Z5.30 pokazaliśmy więc, że gdzieś w dostatecznie obszernym rozszerzeniu takiej tabelki znajdzie się g ⩾ 2017. Z drugiej strony istnieje h i p o t e z a, że wartość g = 2 występuje nieskończenie wiele razy. 5.7. Reszty kwadratowe i prawo wzajemności 217 Ćwiczenie 5.79 Załóżmy, że p i q = 4p + 1 są liczbami pierwszymi. Udowodnić, że w takiej sytuacji 2 jest pierwiastkiem pierwotnym modulo q. U w a g a 4. W naszej tabelce na stronie vi można znaleźć pary (p, 4p + 1). Na przykład: (3, 13), (7, 29), (13, 53), (37, 149), (67, 269), (79, 317), . . . , (487, 1949). Ćwiczenie 5.80 Niech a, b, x, y ∈ Z będą takie, że NWD (ax, by) = 1. Dana jest liczba pierwsza p. Załóżmy, że p|ax2 + by2. Udowodnić, że w takim przypadku (−ab)Rp. Ćwiczenie 5.81 Załóżmy, że p = 2 2n + 1 jest liczbą pierwszą Fermat’a. Udowodnić, że 7 jest pierwiastkiem pierwotnym (mod p). Wskazówka. Z 5.7.3 P2 wiemy, że wystarczy uzasadnić zachodzenie równości (7|p) = −1. Ćwiczenie 5.82 Dowieść, że jeżeli p jest liczbą pierwszą postaci 8t + 5, to ani liczba (p − 1)! + 1 ani liczba (p − 3)! + 1 nie są kwadratami (liczb całkowitych). 5.7.9 Liczba lokalnie kwadratowa jest kwadratem (globalnym) Oczywiste jest, że jeżeli liczba całkowita c jest kwadratem (liczby całkowitej), c = a2, to dla każdego modułu m ∈ N warstwa c (mod m) jest kwadratem w pierścieniu Z/m. Chcemy teraz udowodnić twierdzenie odwrotne: Jeżeli c (mod m) jest kwadratem w Z/m dla każdego m, to c jest kwadratem w Z. Zaczniemy od zadania: ZADANIE 5.31 Dana jest liczba całkowita postaci c = ±2a2, a ̸= 0. Udowodnić, że istnieje nieskończenie wiele takich liczb pierwszych p, że p ∤ c i cNp. R o z w i ą z a n i e. Każda liczba pierwsza p ≡ 5 (mod 8), nie będąca dzielnikiem a, jest dobra. Rzeczywiście, jeżeli p jest taką liczbą, to ( c p ) = ( ±2a2 p ) = ( ±1 p ) ( 2 p ) (a p )2 = −1, bo pierwszy czynnik jest równy +1 (bez względu na wybór znaku: (1|p) = 1 zawsze, a (−1|p) = 1 dla liczb pierwszych postaci 8k + 5 = 4(2k + 1) + 1, zob. (5.68)), drugi czynnik jest równy −1, zob. (5.74), a trzeci (jako kwadrat) jest równy +1. Trzeba jeszcze uzasadnić, że istnieje nieskończenie wiele liczb pierwszych postaci 8x + 5. Można się powołać na twierdzenie Dirichlet’a T5.19. Można też rozumować podobnie jak w C5.75: Weźmy wielomian X 2 + 4 i jego wartość N = (p1p2 · . . . · ps) 2 + 4, gdzie p1 = 5, p2 = 13, . . . , ps są kolejnymi liczbami pierwszymi postaci 8x + 5. Oznaczmy na chwilę A = p1p2 · . . . · ps i niech p|N będzie dowolnym dzielnikiem pierwszym. Wówczas A 2 ≡ −4 (mod p), skąd (2−1A) 2 ≡ −1 (mod p). Więc (−1)Rp, czyli p = 4k + 1, zob. (5.68). Sprawdziliśmy w ten sposób, że w s z y s t k i e dzielniki pierwsze liczby N są postaci 8x + 1 lub 8x + 5. Gdyby wszystkie te dzielniki były postaci 8x + 1, to ich iloczyn również byłby tej postaci. Ale n i e jest (bo nieparzysty kwadrat A 2 przystaje do 1 (mod 8)). Wobec tego p = 8x + 5. I mamy nową liczbę pierwszą takiej postaci. ♦ Twierdzenie o globalności kwadratów lokalnych łatwo wywiedziemy z poniższego: 218 5. Arytmetyka modularna TWIERDZENIE 5.29 Jeżeli liczba całkowita c ̸= 0 nie jest kwadratem w pierścieniu Z, to istnieje taka liczba pierwsza p, że p ∤ c i cNp. D O W Ó D. Niech c nie będzie kwadratem (w Z). Wówczas, albo c jest postaci ±2a2 i wtedy Z5.30 załatwia sprawę, albo ma rozkład na czynniki postaci c = ±2 αa2q1 · . . . · qs, gdzie s ⩾ 1, a q1, . . . , qs są nieparzystymi dzielnikami pierwszymi. Oznaczmy przez b dowolną nieresztę kwadratową (mod q1). I niech d będzie taką liczbą całkowitą, że  |||||| |||||| d ≡ 1 (mod 8), d ≡ b (mod q1), d ≡ 1 (mod q2), . . . . . . d ≡ 1 (mod qs). Taka liczba d istnieje na mocy CTR. Na mocy zaś twierdzenia Dirichlet’a, istnieje nieskończenie wiele liczb pierwszych p postaci 8q1 · . . . · qsx + d. Twierdzimy, że każda z nich jest dobra (dla naszych celów). Rzeczywiście, na mocy multyplikatywności symbolu Legendre’a, mamy ( c p ) = ( ±1 p ) ( 2 p )α ( a2 p ) (q1 p ) · . . . · (qs p ) . Pierwszy czynnik jest równy +1, bo p ≡ 1 (mod 4), zob. I uzupełnienie PWRK, drugi czynnik jest równy (+1) α = +1, bo p ≡ 1 (mod 8), zob. II uzupełnienie PWRK, trzeci czynnik jest równy +1, bo jest kwadratem (a|p) 2 liczby ±1, zob. W1T5.24. Dla pozostałych czynników mamy równości (qj|p) = (p|qj), bo p ≡ 1 (mod 4), zob. 5.7.5 U2. Wobec tego ( c p ) = ( p q1 ) ( p q2 ) · . . . · ( p qs ) = ( d q1 ) ( d q2 ) · . . . · ( d qs ) = ( b q1 ) ( 1 q2 ) · . . . · ( 1 qs ) = −1, bo bNq1 i, oczywiście, 1Rqj. □ Ćwiczenie 5.83 Niech a, b, c ∈ Z i a ̸= 0. Uzasadnić, że równanie ax2 + bx + c = 0 ma pierwiastek wymierny wtedy i tylko wtedy, gdy kongruencja ax2 + bx + c ≡ 0 (mod p) ma rozwiązania dla w s z y s t k i c h liczb pierwszych p z wyjątkiem być może skończonej ich ilości. 5.8 Kongruencje modulo pn. Liczby p-adyczne Udowodnimy teraz ważne i ciekawe twierdzenie o podnoszeniu pierwiastków kongruencji wielo- mianowych z Z/p do Z/p n. Zaczniemy od deﬁnicji ogólnej: Deﬁnicja 5.14 Niech f (X) ∈ Z[X]. I niech m|m ′. Jeżeli c jest rozwiązaniem kongruencji f (x) ≡ 0 (mod m), a d jest takim rozwiązaniem kongruencji f (x) ≡ 0 (mod m ′), że c ≡ d (mod m), to mówimy, że d jest podniesieniem rozwiązania c z Z/m do Z/m ′. P r z y k ł a d. 3 (mod 7) jest p i e r w i a s t k i e m k w a d r a t o w y m z 2 (mod 7) (czyli rozwiąza- niem kongruencji x2 ≡ 2 (mod 7)). Jego podniesieniem do Z/49 jest 10 (mod 49). Kongruen- cja x2 ≡ 2 (mod 7) ma jeszcze jedno rozwiązanie: 4 (mod 7). Jego podniesieniem do Z/49 jest 39 (mod 49). Rozwiązania 3 (mod 7) n i e d a s i ę p o d n i e ś ć do Z/21. Istotnie, kongruencja x2 ≡ 2 (mod 21) w ogóle nie ma rozwiązań (dlaczego?). ♦ 5.8. Kongruencje modulo pn. Liczby p-adyczne 219 5.8.1 Reszty kwadratowe modulo pn Zaczniemy od zbadania podniesień pierwiastków kwadratowych z Z/p do Z/pn, n > 1. TWIERDZENIE 5.30 Niech p > 2 będzie liczbą pierwszą i niech p ∤ a. Kongruencja x2 ≡ a (mod pn), (5.94) przy n ⩾ 1, ma rozwiązania wtedy i tylko wtedy, gdy aRp. D O W Ó D. Jeżeli aRpn i c2 ≡ a (mod pn), to, oczywiście, c2 ≡ a (mod p), więc aRp. Wynikanie przeciwne jest trudniejsze. Aby przekonać się o jego prawdziwości pokażemy teraz e f e k t y w n ą m e t o d ę znajdowania rozwiązania kongruencji x2 ≡ a (mod pn+1), (5.95) jeżeli znamy rozwiązanie kongruencji (5.94). Załóżmy więc, że c jest rozwiązaniem (5.94), czyli, że c2 = a + pnb przy pewnym b ∈ Z. Twierdzimy, że wówczas istnieje takie t ∈ Z, że d = c + tp n jest rozwiązaniem (5.95). Istotnie, ponieważ dla d postaci c + tpn mamy d2 = (c + tp n)2 = c2 + 2ctp n + t 2p2n = a + pn(b + 2ct) + t 2p2n, więc wystarczy znaleźć takie t ∈ Z, żeby b + 2ct ≡ 0 (mod p) (co jest możliwe, bo liczba 2c, jako względnie pierwsza z p, jest odwracalna modulo p). Wówczas d 2 ≡ a (mod pn+1). □ Ćwiczenie 5.84 Udowodnić, że jeżeli aRp, to kongruencja (5.94) (przy p > 2) ma do- kładnie dwa rozwiązania. Ćwiczenie 5.85 Znaleźć rozwiązania kongruencji x2 ≡ 11 (mod 625). Ćwiczenie 5.86 Dana jest nieparzysta liczba pierwsza p. Udowodnić, że w grupie (Z/pn) ∗, n ∈ N, jest tyle samo reszt co niereszt kwadratowych. Zobaczymy teraz czy da się podnieść pierwiastki kwadratowe w przypadku, gdy p = 2. Rzecz jest w tym przypadku nieco bardziej skomplikowana: na przykład 3 jest resztą kwadra- tową modulo 2, ale nie jest resztą kwadratową modulo 4. Zachodzi jednak TWIERDZENIE 5.31 Niech 2 ∤ a. Wówczas kongruencja x2 ≡ a (mod 2 n), (5.96) przy n ⩾ 3, ma rozwiązania wtedy i tylko wtedy, gdy aR8. D O W Ó D. Zastosujemy technikę podobną do wyżej opowiedzianej. Załóżmy w tym celu, że c2 ≡ a (mod 2 n), n ⩾ 3, czyli że c2 = a + 2 nb i poszukajmy rozwiązania kongruencji x2 ≡ a (mod 2 n+1) w postaci d = c + 2n−1t. Ponieważ wówczas d 2 = (c + 2n−1t)2 = c2 + 2nct + 22n−2t 2 = a + 2n(b + ct) + 2n+1 · coś, bo 2n − 2 ⩾ n + 1, więc wystarczy znaleźć takie t, by b + ct ≡ 0 (mod 2). To jest możliwe, bo c jest nieparzyste (dlaczego?). Dowód jest zakończony. □ Ćwiczenie 5.87 Niech aR8 (w szczególności 2 ∤ a). Udowodnić, że wówczas kongruencja (5.96) ma cztery rozwiązania dla każdego n ⩾ 3. Ćwiczenie 5.88 Udowodnić, że kongruencja x2 ≡ 1 (mod m) ma dokładnie dwa rozwią- zania wtedy i tylko wtedy, gdy m = 4 albo m = pn, p > 2, albo m = 2pn, p > 2. 220 5. Arytmetyka modularna 5.8.2 Lemat Hensela Dowód twierdzenia, które chcemy teraz udowodnić, jest uogólnieniem dowodu T5.30. Ćwiczenie 5.89 Udowodnić, że dla dowolnego wielomianu f (X) ∈ Z[X] istnieje taki wie- lomian dwóch zmiennych r(X, Y ) ∈ Z[X, Y ], że dla dowolnych liczb x i h zachodzi równość f (x + h) = f (x) + f ′(x) · h + r(x, h) · h 2. Wskazówka. Zapoznać się z D6.1. TWIERDZENIE 5.32 (Lemat Hensela) Dany jest wielomian f (X) ∈ Z[X] i liczba pierwsza p. Załóżmy, że istnieje liczba całkowita a0 spełniająca warunki f (a0) ≡ 0 (mod p) i f ′(a0) ̸≡ 0 (mod p). Wówczas istnieje taki ciąg nieskończony (a0, a1, a2, . . . , an, . . . ) liczb całkowitych, że f (an) ≡ 0 (mod pn+1) i an ≡ an−1 (mod pn) (5.97) dla każdego n ∈ N. Ponadto, jeżeli ciąg (bn)n⩾0 również spełnia te warunki i b0 ≡ a0 (mod p), to bn ≡ an (mod pn+1) dla każdego n ∈ N. D O W Ó D. Poszukajmy najpierw liczby a1. Ponieważ chcemy by a1 ≡ a0 (mod p), więc szukamy a1 w postaci a0 + tp. Z C5.89 mamy równość f (a0 + tp) = f (a0) + f ′(a0) · tp + r(a0, tp) · t 2p2. Z założenia mamy f (a0) = cp dla pewnej liczby całkowitej c. Widzimy stąd, że dobierając takie t ∈ Z, by p|(c + tf ′(a0)), znajdziemy liczbę a1 := a0 + tp, dla której f (a1) ≡ 0 (mod p2). Istnienie (i jednoznaczność modulo p) stosownego t wynika natychmiast z T5.5 (kongruencja f ′(a0)t ≡ −c (mod p) ma dokładnie jedno rozwiązanie, bo f ′(a0) ̸≡ 0 (mod p)). Równie łatwo wykonać krok indukcyjny z n na n + 1. Rzeczywiście, mając a1, . . . , an spełniające warunki (5.97) poszukujemy an+1 w postaci an + tp n+1. Ponieważ f (an + tpn+1) = f (an) + f ′(an) · tpn+1 + r(an, tpn+1) · t 2p2n+2, a f (an) = cpn+1 dla pewnego c ∈ Z, więc (tak jak wyżej, bowiem f ′(an) ≡ f ′(a0) (mod p), zobacz T5.2) widzimy, że istnieje takie t ∈ Z, że f (an + tpn+1) ≡ 0 (mod pn+2). Dowód istnienia ciągu (an) został zakończony. Dowód jednoznaczności zostawiamy Czytelnikowi. □ Ćwiczenie 5.90 Kongruencja x2 + x + 5 ≡ 0 (mod 7) ma dwa rozwiązania modulo 7. Podnieść je do rozwiązań w Z/343. P r z y k ł a d. Rozważmy trójmian kwadratowy f (X) = X 2 + X + 2. Ma on pierwiastek 3 (mod 7) w Z/7. Poszukamy pierwiastków tego trójmianu modulo 49. Jeżeli c jest takim pierwiastkiem, to c 2+c+2 ≡ 0 (mod 49). Wówczas oczywiście c2+c+2 ≡ 0 (mod 7). Ale f (X) ma t y l k o j e d e n pierwiastek (mod 7). Łatwo to sprawdzić. [Jest to związane z faktem, że ∆ = 1 2 − 4 · 2 ≡ 0 (mod 7), zob. T5.28.] Zatem c = 3 + 7t dla pewnego t ∈ Z. Jednakże f (3 + 7t) = (3 + 7t) 2 + (3 + 7t) + 2 ≡ 49t2 + 49t + 14 ≡ 14 (mod 49), więc widzimy, że trójmian f (X) n i e ma pierwiastków w Z/49. Tym bardziej więc nie ma on pierwiastków w Z/7 k dla k > 2. Oczywiście nie jest to sprzeczne z lematem Hensela, ponieważ 5.8. Kongruencje modulo pn. Liczby p-adyczne 221 f ′(3) = 2 · 3 + 1 ≡ 0 (mod 7). Klasa 3 (mod 7) jest pierwiastkiem podwójnym trójmianu f (X). Mamy bowiem f (X) ≡ (X − 3) 2 (mod 7). ♦ Przypadkiem szczególnym lematu Hensela jest teza poniższego ćwiczenia (Czytelnik powi- nien się zastanowić, jakie znaczenie ma warunek p ∤ r): Ćwiczenie 5.91 Niech p będzie liczbą pierwszą, r liczbą naturalną niepodzielną przez p. Niech też p ∤ a. Udowodnić, że jeżeli kongruencja xr ≡ a (mod p) ma rozwiązania, to przy dowolnym n ∈ N kongruencja xr ≡ a (mod pn) ma rozwiązania. Gdy r = p, mamy takie ćwiczenie, które rozwiązuje się analogicznie do znanego nam już przypadku p = 2: Ćwiczenie 5.92 Niech p ∤ a. Wówczas rozwiązalność kongruencji xp ≡ a (mod p3) jest warunkiem koniecznym i wystarczającym rozwiązalności kongruencji xp ≡ a (mod pn) dla wszystkich n ⩾ 3. 5.8.3 Jedno interesujące zadanie Jeśli liczba całkowita c jest pierwiastkiem wielomianu h(X) ∈ Z[X], to (warstwa) c (mod m) jest pierwiastkiem redukcji h(X) = h (mod m)(X) tego wielomianu dla dowolnego modułu m, czyli, równoważnie, c jest rozwiązaniem kongruencji h(x) ≡ 0 (mod m) dla dowolnego modułu m ∈ N. To jest oczywiste. Wynikanie odwrotne jest n i e p r a w d z i w e. Najprostszy kontrprzykład pokazaliśmy w 5.4.4 P2. Dotyczył on wielomianu postaci h(X) = pqX 2 + (p − q)X − 1, gdzie p, q są różnymi liczbami pierwszymi. Czytelnik z łatwością uogólni rozumowanie z 5.4.4 P2 i wykaże, że wszystkie takie wielomiany h(X) również dostarczają kontrprzykładów. Kontrprzykład innego typu znajdujemy w zadaniu: ZADANIE 5.32 Niech h(X) = X 6 + 19X 4 + 56X 2 − 196. Udowodnić, że kongruencja h(x) ≡ 0 (mod m) (5.98) ma rozwiązania dla każdego m ∈ N, a równanie h(x) = 0 nie ma pierwiastków całkowitych. R o z w i ą z a n i e. (0) Sprawdzamy najpierw, że h(X) = (X 2 − 2)(X 2 + 7)(X 2 + 14). Wi- dzimy stąd, że równanie h(x) = 0 nie ma rozwiązań całkowitych. (1) Rozwiązaniem kongruencji (5.98) przy m = 2 e, e ⩽ 3, jest x = 1. To wynika z oczywistej kongruencji 1 2 + 7 ≡ 0 (mod 8). Twierdzenie T5.31 poucza nas więc, że (−7)R2 e przy każdym e ∈ N. Wobec tego, dla każdego e ∈ N istnieje x ∈ Z spełniające warunek x2 + 7 ≡ 0 (mod 2e), zatem i h(x) ≡ 0 (mod 2e). (2) Sprawdzamy, że h(3) ≡ 0 (mod 7) i h ′(3) ≡ 3 (mod 7). To, na mocy lematu Hensela, pokazuje, że dla każdego e ∈ N istnieje x ∈ Z spełniające warunek h(x) ≡ 0 (mod 7e). (3) Niech teraz p będzie liczbą pierwszą ̸= 2, 7. Wówczas, dzięki multyplikatywności symbolu Legendre’a, mamy (−14|p) = (−7|p) · (2|p). Stąd widzimy, że jeżeli (−14)Np i (−7)Np, to 2Rp. Zatem dla każdej liczby pierwszej p ̸= 2, 7 istnieje takie x ∈ Z, że co najmniej jeden z czynników x2 − 2, x2 + 7, x2 + 14 przystaje do 0 modulo p. Stąd, na mocy 222 5. Arytmetyka modularna T5.30, dla każdego e ∈ N istnieje takie x ∈ Z, że x2 − 2 ≡ 0 (mod pe) lub x2 + 7 ≡ 0 (mod pe) lub x2 + 14 ≡ 0 (mod pe), czyli h(x) ≡ 0 (mod pe). (4) Widzimy z powyższego, że kongruencja (5.98) ma rozwiązania przy każdym m będącym potęgą liczby pierwszej. Wniosek WT5.13 pozwala więc zakończyć rozwiązanie. ♦ Ćwiczenie 5.93 Czy kongruencja x6 + 13x4 − 45x2 − 225 ≡ 0 (mod m) jest rozwiązalna przy dowolnym module m? Ćwiczenie 5.94 Udowodnić, że jeżeli p ̸= q są różnymi liczbami pierwszymi, to kongru- encja pqxy + 1 ≡ px + qy (mod m) ma rozwiązania dla dowolnego modułu m. 5.8.4 Dwa słowa o liczbach p-adycznych Wykorzystamy to miejsce dla przytoczenia deﬁnicji tak zwanych liczb p-adycznych. Liczby p-adyczne wymyślił Kurt Hensel w roku 1897. Więcej można o tym poczytać w [ 7 ] i [ 9 ]. Ciąg c = (c0, c1, c2, . . . ) liczb całkowitych nazywamy nitką p-adyczną, gdy dla do- wolnego n ∈ N zachodzi cn ≡ cn−1 (mod pn). Dla danych nitek c = (c0, c1, c2, . . . ) i d = (d0, d1, d2, . . . ) piszemy c ∼ d, gdy dla każdego n ∈ Z⩾0 zachodzi cn ≡ dn (mod pn). Ćwiczenie 5.95 Udowodnić, że tak określona relacja ∼ jest relacją równoważności. Deﬁnicja 5.15 Klasę równoważności relacji ∼ nazywamy liczbą całkowitą p-adyczną. Zbiór liczb p-adycznych całkowitych oznaczamy Zp. Liczby p-adyczne d o d a j e m y i m n o ż y m y wyraz po wyrazie: [c0, c1, c2, . . . ] + [d0, d1, d2, . . . ] : = [c0 + d0, c1 + d1, c2 + d2, . . . ], [c0, c1, c2, . . . ] · [d0, d1, d2, . . . ] : = [c0d0, c1d1, c2d2, . . . ]. Ćwiczenie 5.96 Udowodnić, że przy takich działaniach zbiór Zp jest pierścieniem prze- miennym z jedynką b e z d z i e l n i k ó w z e r a. Wskazówka. Zerem w Zp jest liczba p-adyczna 0 := [0, 0, 0, . . . ], a jedynką jest liczba p-adyczna 1 := [1, 1, 1, . . . ]. Ćwiczenie 5.97 Dany jest wielomian f (X) ∈ Z[X] i liczba p-adyczna α = [(ck)]. Udo- wodnić, że ciąg (f (c0), f (c1), f (c2), . . . ) jest nitką p-adyczną. Jej klasę równoważności ozna- czamy f (α) i nazywamy wartością wielomianu f (X) dla argumentu α ∈ Zp. Powyższe ćwiczenie mówi, że wielomian f (X) ∈ Z[X] w y z n a c z a funkcję f : Zp −→ Zp. Lemat Hensela mówi w tym kontekście, że (przy stosownych założeniach) można znaleźć roz- wiązanie równania wielomianowego f (x) = 0 w pierścieniu Zp nawet gdy wielomian f (X) nie ma pierwiastków całkowitych. Istnieją (co najmniej) dwa powody, dla których szukamy pierwiastków równania wielomianowego f (x) = 0 w (większym niż Z) pierścieniu Zp: 5.8. Kongruencje modulo pn. Liczby p-adyczne 223 • Jeżeli f (α) = 0 dla α = [(cn)] ∈ Zp, to mamy za jednym zamachem rozwiązania kongruencji f (x) ≡ 0 (mod pn) dla wszystkich n ∈ N (bo f (cn) ≡ 0 (mod pn)). • Pierścień Zp ma własność zupełności, która pozwala na stosowanie metod analizy matematycznej (szukanie rozwiązań przybliżonych i przechodzenie do granicy) dla wyznaczania pierwiastków. My pokażemy tylko, w jaki sposób oblicza się odległość między liczbami p-adycznymi. W rozdziale 2 zdeﬁniowaliśmy funkcję vp : Z −→ Z⩾0 ∪ {+∞} wykładnika p-adycznego. Funkcję tę przedłużamy do funkcji vp : Zp −→ Z⩾0 ∪ {+∞} za pomocą przepisu: vp([(cn)]) := lim n→∞ vp(cn). (5.99) Ćwiczenie 5.98 Udowodnić, że jeżeli α = [(cn)] jest różną od 0 liczbą całkowitą p- adyczną, to ciąg (vp(cn)) przyjmuje od pewnego miejsca stałą wartość i, wobec tego, jego granicą jest ta stała wartość. Oczywiście kładziemy też vp(0) = +∞. Mając już funkcję vp wykładnika p-adycznego możemy zdeﬁniować funkcję odległości, czyli metrykę w Zp. Kładziemy: dp(α, β) := p−vp(α−β). (5.100) Ćwiczenie 5.99 Uznając, że p−∞ = 0 udowodnić, że, określona wzorem (5.100), funkcja dp : Zp × Zp −→ R⩾0 ma następujące trzy własności: (1) dp(α, β) = 0 wtedy i tylko wtedy, gdy α = β, (2) dp(α, β) = dp(β, α) dla dowolnych α, β ∈ Zp, (3) dp(α, γ) ⩽ dp(α, β) + dp(β, γ) dla dowolnych α, β, γ ∈ Zp. Wskazówka. W rzeczywistości zachodzi – mocniejsza niż nierówność (3), która nazywa się nierównością trójkąta – tak zwana ultrametryczna nierówność trójkąta: (3)′ dp(α, γ) ⩽ max {dp(α, β), dp(β, γ)}. Ćwiczenie 5.100 Udowodnić, że równanie x2 + 1 = 0 ma rozwiązania w pierścieniu Z5, a n i e ma rozwiązań w pierścieniu Z7. Ćwiczenie 5.101 Udowodnić, że przestrzeń metryczna (Zp, dp) jest zwarta, to znaczy, że każdy ciąg (αn) o wyrazach z pierścienia Zp ma podciąg zbieżny. Zobacz RIN . Rozdział 6 Dodatkowe wiadomości o wielomianach [...] wohl die wichtigste Reihe der Mathematik, entdeckte der große englische Mathematiker und Physiker Isaac Newton. Die ber¨uhmte Abhandlung, die außer der Exponantialreihe auch die Sinusreihe, Cosinusreihe, Arcussinusreihe, logaritmische Reihe und Binomialreihe enth¨alt, wurde um 1665 verfaßt [...] (Heinrich D¨orrie) W tym rozdziale nauczymy się paru nowych rzeczy o wielomianach. Zaczniemy od róż- niczkowania wielomianów. Potem opowiemy kolejno o wielomianach symetrycznych, o liczbach algebraicznych i uwalnianiu się od niewymierności w mianowniku, o twierdzeniu Liouville’a i liczbach przestępnych, o, pochodzącym z końca XX wieku, tak zwanym kombinatorycznym twierdzeniu o zerach i w końcu, o liczbach i wielomianach Bernoulli’ego. 6.1 Pochodna wielomianu Pochodna funkcji ma ogromne znaczenie w analizie matematycznej, czyli w badaniu prze- biegu zmienności funkcji: pochodna f ′ funkcji f : R −→ R (jeśli istnieje) jest funkcją wyra- żającą szybkość rośnięcia funkcji f . Zobacz RIN , gdzie dowiadujemy się (między innymi), że daleko n i e każda funkcja ma pochodną. 6.1.1 Funkcja wielomianowa W matematyce szkolnej wielomian jest f u n k c j ą. W matematyce, wielomian f (X) ∈ K[X] jest n a p i s e m, który w y z n a c z a funkcję K ∋ x 7−→ f (x) ∈ K. Ćwiczenie 6.1 Udowodnić, że jeżeli K = Q, R lub C i f (X) ∈ K[X] jest wielomianem, to funkcja x 7−→ f (x) w y z n a c z a wielomian f (X). K o n t r p r z y k ł a d. Niech K = Fp. Wielomian f (X) = X p − X, ewidentnie niezerowy, wyznacza funkcję równą 0. To jest tylko inne sformułowanie MTF. Wyjaśnienie tego zjawiska jest proste: w s z y s t k i c h funkcji Fp −→ Fp jest skończenie wiele (mianowicie pp), a wszyst- kich wielomianów w Fp[X] jest nieskończenie wiele (istnieją wielomiany dowolnych stopni). Ciekawostką jest fakt, że k a ż d a funkcja Fp −→ Fp jest funkcją wielomianową. Czytelnik może zechcieć to udowodnić posiłkując się twierdzeniem interpolacyjnym. ♦ 6.1. Pochodna wielomianu 225 6.1.2 Deﬁnicja pochodnej Dla wielomianów pochodną deﬁniujemy czysto f o r m a l n i e. To znaczy, bez używania pojęcia granicy. Dzięki temu, pojęcie pochodnej wielomianu ma znacznie szerszy zakres znaczeniowy. Pochodna wielomianu f (X) ∈ R[X], traktowanego jako funkcja z R do R, mówi jak rośnie ta funkcja. Pochodna wielomianu f (X) ∈ Fp[X], o współczynnikach z ciała skończonego Fp, n i e mówi nic o rośnięciu odpowiedniej funkcji. Przyczyna tego stanu rzeczy jest natury fundamentalnej: w ciele Fp nie istnieje żaden rozsądny sposób wprowadzenia relacji mniejszy- równy ⩽. Zatem nie ma pojęcia funkcji monotonicznej Fp −→ Fp. Deﬁnicja 6.1 Niech f (X) = a0 + a1X + a2X 2 + . . . + anX n ∈ K[X] będzie wielomianem. Pochodną tego wielomianu nazywamy wielomian (czytamy: ef prim) f ′(X) = a1 + 2a2X + . . . + nanX n−1. Ćwiczenie 6.2 Udowodnić, że dla dowolnych f, g ∈ K[X] zachodzą równości: (f + g) ′(X) = f ′(X) + g′(X), (6.1) (f g) ′(X) = f ′(X)g(X) + f (X)g′(X). (6.2) Pochodna pochodnej danego wielomianu nazywa się drugą pochodną, oznaczamy ją f ′′(X) (czytamy: ef bis). Pochodna (k − 1)-szej pochodnej nazywa się k-tą pochodną, oznaczamy ją f (k)(X). Ćwiczenie 6.3 Udowodnić, że jeżeli f (X) = a0 + a1X + a2X 2 + . . . + anX n ∈ C[X], to a0 = f (0), a1 = f ′(0), a2 = 1 2 f ′′(0), . . . , ak = 1 k!f (k)(0), . . . . (6.3) U w a g a. Czytelnik zauważył, że w powyższym ćwiczeniu założyliśmy, że współczynniki rozważanego wielomianu są l i c z b a m i z e s p o l o n y m i (w szczególności: rzeczywistymi lub wymiernymi). Chodzi o to, że w nie każdym ciele K zachodzi nierówność k! ̸= 0. 6.1.3 Twierdzenia Rolle’a i Lagrange’a Twierdzenie Rolle’a i wniosek z niego płynący – twierdzenie Lagrange’a o wartości średniej, dotyczą funkcji różniczkowalnych (= mających pochodną) określonych na zbiorze liczb rzeczywistych. Jego dowód wymaga czegoś więcej niż czysto formalna deﬁnicja pochodnej – mianowicie rozumienia pochodnej jako granicy (ilorazu różnicowego), zobacz RIN . Dlatego tutaj opuścimy ten dowód. Samo twierdzenie jest bardzo proste: TWIERDZENIE 6.1 (Twierdzenie Rolle’ a) Jeżeli a < b są pierwiastkami wielomianu f (X) o współczynnikach r z e c z y w i s t y c h, to istnieje takie c ∈ [ a; b ], że f ′(c) = 0. □ Ćwiczenie 6.4 Udowodnić, że jeżeli dla a0, . . . , an ∈ R zachodzi równość ∑n k=0 ak k+1 = 0, to wielomian a0 + a1X + . . . + anX n ma co najmniej jeden pierwiastek rzeczywisty. Twierdzenie Lagrange’a o wartości średniej jest prostym wnioskiem z twierdzenia Rolle’a: 226 6. Dodatkowe wiadomości o wielomianach TWIERDZENIE 6.2 (Twierdzenie Lagrange’ a o wartości średniej ) Jeżeli f (X) jest dowolnym wielomianem o współczynnikach r z e c z y w i s t y c h, a < b są dowolnymi licz- bami rzeczywistymi, to istnieje taka liczba c ∈ [ a; b ], że f (b) − f (a) b − a = f ′(c). D O W Ó D. Rozważmy wielomian g(X) = f (X) − f (a) − f (b) − f (a) b − a (X − a). Ze wzorów (6.1) i (6.2) na pochodną sumy i pochodną iloczynu widzimy, że g′(X) = f ′(X) − f (b) − f (a) b − a . Ponadto widzimy, że g(a) = g(b) = 0. To, na mocy twierdzenia Rolle’a, daje równość g′(c) = 0 dla pewnego c ∈ [ a; b ], czyli tezę. □ 6.1.4 Wzór Maclaurina i wzór Taylora Równości (6.3) pozwalają napisać równość f (X) = f (0) + f ′(0)X + 1 2 f ′′(0)X 2 + . . . + 1 n!f (n)(0)X n (6.4) prawdziwą dla dowolnego wielomianu o współczynnikach zespolonych stopnia n. Tę równość nazywa się czasami wzorem Maclaurina. Użyteczny bywa wniosek płynący z (6.4), pozwalający zapisywać dany wielomian względem ”przesuniętej” zmiennej X − α: Ćwiczenie 6.5 Udowodnić następujący wzór Taylora: f (X) = F (α) + ∞∑ k=1 f (k)(α) k! (X − α)k, (6.5) dla dowolnego wielomianu f (X) ∈ C[X] i dowolnej liczby α ∈ C. Zauważmy, że suma po prawej stronie w istocie jest skończona (jeżeli bowiem wielomian f ma stopień n, to wszystkie pochodne f (k)(X), dla k > n, są wielomianami zerowymi). P r z y k ł a d. Rozważmy wielomian f (X) = X n. Zapisujemy go względem zmiennej ”prze- suniętej” X − α: X n = αn + ∞∑ k=1 f (k)(α) k! (X − α)k = n∑ k=0 ( n k ) αn−k(X − α)k, bo f (k)(α) = n(n − 1) · . . . · (n − k + 1)αn−k (dla f (X) = X n). Wystarczy położyć X = α + β, by rozpoznać znany ze szkoły wzór dwumienny, zobacz (1.7). ♦ 6.2. Wielomiany symetryczne 227 6.1.5 Pochodna a pierwiastki wielokrotne Pochodną wielomianu wykorzystuje się przy badaniu pierwiastków wielokrotnych. Deﬁnicja 6.2 Dane jest ciało K i wielomian f (X) ∈ K[X]. Element α ∈ K nazywa się pierwiastkiem wielokrotnym wielomianu f (X), gdy (X − α) 2|f (X). Mówimy, że pier- wiastek wielokrotny α jest pierwiastkiem k-krotnym, gdy k ⩾ 2 oraz (X − α) k|f (X) i (X − α) k+1 ∤ f (X). TWIERDZENIE 6.3 Dany jest wielomian f (X) ∈ K[X]. Element α ∈ K jest jego pier- wiastkiem wielokrotnym wtedy i tylko wtedy, gdy f (α) = f ′(α) = 0. D O W Ó D. Jeżeli f (X) = (X − α)2g(X) dla pewnego wielomianu g(X), to, f (α) = 0, oraz, na mocy wzoru (6.2), f ′(X) = 2(X − α)g(X) + (X − α) 2g′(X), skąd f ′(α) = 0. Odwrotnie, jeżeli f (α) = f ′(α) = 0, to f (X) = (X − α)g(X) i f ′(X) = (X − α)h(X) dla pewnych wielomianów g(X), h(X) ∈ K[X], na mocy twierdzenia B´ezout’a. Liczymy pochodną iloczynu: f ′(X) = (X − α) ′g(X) + (X − α)g′(X) = g(X) + (X − α)g′(X). Mamy więc g(X) + (X − α)g′(X) = (X − α)h(X). Skąd g(X) = (X − α)(h(X) − g′(X)) i ostatecznie f (X) = (X − α)2(h(X) − g′(X)). □ Ćwiczenie 6.6 Udowodnić, że α jest pierwiastkiem k-krotnym wielomianu f (X) ∈ K[X] wtedy i tylko wtedy, gdy f (α) = f ′(α) = . . . = f (k−1)(α) = 0, oraz f (k)(α) ̸= 0. Ćwiczenie 6.7 Udowodnić, że wielomian f (X) ∈ C[X] ma pierwiastek wielokrotny wtedy i tylko wtedy, gdy wielomiany f (X) i f ′(X) nie są względnie pierwsze. Wywnioskować stąd, że wielomian f (X) ∈ Q[X] nierozkładalny w Q[X] nie ma pierwiastków wielokrotnych. ZADANIE 6.1 Udowodnić, że jeżeli wielomian f (X) ∈ K[X] jest względnie pierwszy ze swoją pochodną f ′(X), a wielomian a(X) jest wielomianem stopnia ⩾ 1, to 1 a(X)2 ∤ f (X). R o z w i ą z a n i e. Względna pierwszość wielomianów f (X) i f ′(X) pociąga, zob. C3.31, istnienie równości f (X)s(X)+f ′(X)t(X) = 1 dla pewnych wielomianów s(X), t(X). Załóżmy, nie wprost, że f (X) = a(X)2g(X) dla pewnego g(X) ∈ K[X]. Dwukrotne zastosowanie wzoru Leibniza (6.2) daje równość f ′(X) = 2a(X)a′(X)g(X) + a(X) 2g′(X) = a(X)h(X). Stąd dostajemy nonsensowną równość a(X)[s(X) + h(X)t(X)] = 1. ♦ 6.2 Wielomiany symetryczne Musimy powiedzieć słów parę na temat wielomianów symetrycznych. Znajomość najprostszych ich własności jest niezbędna każdemu olimpijczykowi. Dotyczy to zwłaszcza zastosowań wzorów Vi`ete’a (3.53). Z lewej strony tych wzorów występują bowiem wyrażenia wielomianowe mające własność symetryczności. 1Można powiedzieć, że f (X) jest elementem bezkwadratowym w pierścieniu K[X], por. C2.36. 228 6. Dodatkowe wiadomości o wielomianach 6.2.1 Deﬁnicja Wielomian wielu zmiennych nazywa się wielomianem symetrycznym, gdy można mu dowolnie permutować zmienne, a on tego nie ”czuje”. Deﬁnicja 6.3 Wielomian s(X1, X2, . . . , Xn) ∈ K[X1, X2, . . . , Xn] nazywa się wielomia- nem symetrycznym, gdy s(X1, X2, . . . , Xn) = s(Xτ (1), Xτ (2), . . . , Xτ (n)) dla dowolnej permutacji τ ∈ Sn. P r z y k ł a d 1. Jasne, że wielomiany sk = sk(X1, X2, . . . , Xn) := X k 1 + X k 2 + . . . + X k n (6.6) są wielomianami symetrycznymi n zmiennych. ♦ Aby zobaczyć nową serię wielomianów symetrycznych n zmiennych, rozważmy równość (T + X1)(T + X2) · . . . · (T + Xn) = T n + σ1T n−1 + σ2T n−2 + . . . + σn−1T + σn. (Mnożymy i porządkujemy względem potęg T .) Współczynniki σk są, oczywiście, wielomia- nami n zmiennych X1, X2, . . . , Xn. Łatwo widzieć, że są one wielomianami symetrycznymi: Ćwiczenie 6.8 Uzasadnić, że wielomiany σk są wielomianami symetrycznymi. Uzasadnić też, że deg σk = k. Deﬁnicja 6.4 Wielomiany σk = σk(X1, X2, . . . , Xn) nazywamy elementarnymi wielo- mianami symetrycznymi n zmiennych. Wartości elementarnych wielomianów symetrycznych występują we wzorach Vi`ete’a (3.53), które możemy zapisać w postaci σk = (−1)k an−k an , (6.7) gdzie σk = σk(λ1, λ2, . . . , λn) jest wartością k-tego elementarnego wielomianu symetrycznego na układzie (λ1, λ2, . . . , λn) wszystkich (każdy pierwiastek wypisany tyle razy, ile wynosi jego krotność) pierwiastków wielomianu ∑ akX k stopnia n. Najczęściej spotykamy przypadek n = 3. Wtedy, porównaj (3.59), σ1 = X1 + X2 + X3, σ2 = X1X2 + X2X3 + X3X1, σ3 = X1X2X3. Ćwiczenie 6.9 Liczby x, y, u, v spełniają warunki x + y + u + v = 1 x + 1 y + 1 u + 1 v = 2. Udowodnić, że 1 1−x + 1 1−y + 1 1−u + 1 1−v = 2. Wskazówka. Znowu ta ﬁlozoﬁa Vi`ete’ a! Wielomian czwartego stopnia o pierwiastkach x, y, u, v ma postać T 4 − 2T 3 + aT 2 − 2bT + b. Jak wobec tego wygląda wielomian o pierwiastkach 1 − x, 1 − y, 1 − u, 1 − v? Ćwiczenie 6.10 Niech a, b, c ∈ Z i a + b + c = 0. Udowodnić, że 32(a4 + b4 + c4) jest kwadratem (liczby całkowitej). 6.2. Wielomiany symetryczne 229 6.2.2 Twierdzenie Newtona Udowodnimy podstawowe twierdzenie Newtona mówiące, że elementarne wielomiany syme- tryczne są ”cegiełkami”, z których można zbudować k a ż d y wielomian symetryczny. Przed dowodem musimy wykonać pewną pracę wstępną, dzięki której nauczymy się bardziej syste- mowo kodować jednomiany danego stopnia k. Przez R(n, k) oznaczamy zbiór wszystkich ciągów n-wyrazowych (i1, i2, . . . , in), gdzie ij są liczbami całkowitymi nieujemnymi spełniającymi warunek i1 + . . . + in = k, zobacz KOM . Ciągi ze zbioru R(n, k) oznaczamy literami I, J, K, itp. Jeżeli K = (k1, k2, . . . , kn) ∈ R(n, k), to jednomian X k1 1 X k2 2 · . . . · X kn n będziemy oznaczać w skrócie symbolem X K. Przez N = N (n, k) oznaczymy podzbiór zbioru R(n, k) składający się z ciągów n i e r o s n ą c y c h. Zbiór N uporządkujmy za pomocą relacji ≺ zdeﬁniowanej tak: K ≺ L, gdy pierwsza z różnych od 0 różnic l1 − k1, l2 − k2, . . . , ln − kn jest liczbą dodatnią. Na przykład (4, 2, 1, 1, 1) ≺ (4, 2, 2, 1, 0) w N (5, 9). Oczywiście (9, 0, 0, 0, 0) jest największym, a (2, 2, 2, 2, 1) jest najmniejszym elementem w N (5, 9). Ćwiczenie 6.11 Udowodnić, że relacja ≺ jest relacją porządku liniowego w N (n, k). Gdy I ∈ R(n, k), przez r(I) oznaczamy ciąg należący do N (n, k) mający te same wyrazy co I (ustawione w porządku nierosnącym). Na przykład, jeżeli I = (1, 0, 3, 1, 4) ∈ R(5, 9), to r(I) = (4, 3, 1, 1, 0). Ćwiczenie 6.12 Niech J = (j1, j2, . . . , jn) ∈ N (n, k). Udowodnić, że wielomian FJ := σj1−j2 1 σj2−j3 2 · . . . · σjn−1−jn n−1 σjn n (6.8) jest wielomianem symetrycznym i jednorodnym stopnia k. Ponadto, jednym z jego składników jest jednomian X J , a wszystkie pozostałe jego składniki są jednomianami postaci cX I, gdzie r(I) ≺ J. TWIERDZENIE 6.4 (Twierdzenie Newtona) Każdy wielomian symetryczny n zmien- nych o współczynnikach w pierścieniu R da się zapisać w postaci wielomianu zmiennych σ1, σ2, . . . , σn o współczynnikach w tym samym pierścieniu R. D O W Ó D. Po rozwiązaniu ćwiczeń C6.11 i C6.12 dowód jest natychmiastowy. Ponieważ każdy wielomian jest (jednoznacznie) sumą swoich składników jednorodnych, zo- bacz (3.65), więc wystarczy zapisać w postaci wielomianu zmiennych σj dowolny wielomian symetryczny i jednorodny. Niech więc A(X1, X2, . . . , Xn) będzie wielomianem symetrycz- nym i jednorodnym stopnia k. Zauważmy, że w takiej sytuacji, jeżeli jednomian cX K jest jego składnikiem, to również jego składnikami są w s z y s t k i e jednomiany postaci cX L, gdzie ciąg L = (l1, l2, . . . , ln) jest dowolną permutacją ciągu K = (k1, k2, . . . , kn). To wynika z symetryczności wielomianu (czyli możliwości permutowania zmiennych Xi). W szczególności jednomian cX r(K) jest składnikiem A. 230 6. Dodatkowe wiadomości o wielomianach Załóżmy teraz, że aX J jest występującym w A jednomianem z największym (w sensie relacji ≺) (multi)wykładnikiem J. Wówczas różnica A − aFJ , jeżeli jest różna od 0, to jest wielomianem symetrycznym i jednorodnym stopnia k, a ponadto wszystkie występujące w niej jednomiany (niezerowe) mają (multi)wykładniki I spełniające nierówność r(I) ≺ J. Ponieważ zbiór R(n, k) jest zbiorem skończonym, więc jest jasne, że po skończonej ilości takich operacji (”kasowania” największego (multi)wykładnika) dojdziemy do wielomianu zerowego. To kończy dowód. □ Ćwiczenie 6.13 Korzystając z opisanego w powyższym dowodzie algorytmu, przedstawić wielomiany s3(X, Y, Z) = X 3 + Y 3 + Z 3 oraz s4(X, Y, Z) = X 4 + Y 4 + Z 4 w postaci wielo- mianów zmiennych σ1 = X + Y + Z, σ2 = XY + Y Z + ZX i σ3 = XY Z. Ćwiczenie 6.14 Niech x1, x2 będą pierwiastkami trójmianu aX 2 + bX + c (a ̸= 0). Udo- wodnić następującą formułę Waringa: xn 1 + xn 2 = n ∑ k (−1)n+k (n − k − 1)! k!(n − 2k)! ak−nbn−2kck, gdzie sumujemy po wszystkich naturalnych k, dla których 0 ⩽ k ⩽ n/2. Por. 3.2.7 U1. 6.2.3 Wyróżnik Szczególnie często używanym wielomianem symetrycznym jest tak zwany wyróżnik: Deﬁnicja 6.5 Następujący wielomian ∆(X1, X2, . . . , Xn) = ∏ 1⩽k<l⩽n (Xk − Xl) 2 (6.9) nazywamy wyróżnikiem n zmiennych X1, X2, . . . , Xn. Jasne, że dla danych liczb (ogólniej, elementów jakiegoś ciała) x1, x2, . . . , xn, wartość ∆(x1, x2, . . . , xn) jest równa 0 wtedy i tylko wtedy, gdy pewne dwie z liczb x1, x2, . . . , xn są równe. Ćwiczenie 6.15 Uzasadnić, że wyróżnik jest wielomianem symetrycznym. Wyrazić wy- różnik 2 i 3 zmiennych przez elementarne wielomiany symetryczne odpowiedniej liczby zmien- nych. W przypadku 3 zmiennych założyć, dla uproszczenia, że σ1 = 0. 6.2.4 Funkcje tworzące Wyrazy αk danego (skończonego lub nie) ciągu (αk)k⩾0 wygodnie jest uznawać za współ- czynniki ”wielomianu” ∑ k⩾0 αkT k jednej zmiennej T . Cudzysłów można wyrzucić, gdy ciąg jest skończony. W przypadku nieskończonym mówimy raczej o formalnym szeregu potęgowym. Zobacz ustęp 9.2.2, z którego należy zapoznać się z tak zwanym szeregiem Neumanna (9.16). Dobrze też zajrzeć do KOM 4.3.2. 6.2. Wielomiany symetryczne 231 Deﬁnicja 6.6 Niech (αk)k⩾0 będzie danym ciągiem. Formalny szereg potęgowy ∑ k⩾0 αkT k nazywamy funkcją tworzącą ciągu (αk). Pierwszy nasz przykład funkcji tworzącej jest wielomianem. Niech σk = σk(X1, . . . , Xn) będą elementarnymi wielomianami symetrycznymi n zmiennych. Umawiamy się dodatkowo, że σ0 = 1 i σk = 0 dla k > n. Funkcję tworzącą ciągu (σk) oznaczymy w skrócie Σ(T ). Ćwiczenie 6.16 Uzasadnić, że zachodzi równość Σ(T ) = (1 + T X1)(1 + T X2) · . . . · (1 + T Xn). (6.10) Drugi nasz przykład funkcji tworzącej nie jest już wielomianem. Rozważmy mianowicie ciąg (sk) wielomianów danych przez (6.6). Jego funkcja tworząca jest formalnym szeregiem potęgowym: S(T ) := ∞∑ k=0 skT k. Ćwiczenie 6.17 Umawiamy się, że s0 = n. Udowodnić, że S(T ) = 1 1 − T X1 + 1 1 − T X2 + . . . + 1 1 − T Xn . (6.11) Zdeﬁniujmy jeszcze jeden ciąg wielomianów symetrycznych. Niech mianowicie rk = rk(X1, X2, . . . , Xn) := ∑ k1+k2+···+kn=k X k1 1 X k2 2 · . . . · X kn n . (6.12) Sumujemy po wszystkich układach (k1, k2, . . . , kn) nieujemnych liczb całkowitych o sumie równej k (ta suma ma (k+n−1 n−1 ) składników, zobacz KOM T1.6(4)). Wielomian rk jest więc sumą wszystkich jednomianów stopnia k (każdy ze współczynnikiem 1). Wobec tego nazy- wamy go pełnym wielomianem symetrycznym jednorodnym stopnia k. Wygodnie jest uznać, że r0 = 1. Funkcję tworzącą ciągu (rk) oznaczymy symbolem R(T ). Ćwiczenie 6.18 Udowodnić, że zachodzi równość R(T ) = 1 1 − T X1 · 1 1 − T X2 · . . . · 1 1 − T Xn . (6.13) Dla zilustrowania działania techniki funkcji tworzących rozwiążmy: ZADANIE 6.2 Udowodnić, że dla n ⩾ 1 zachodzi równość n∑ k=0 (−1)kσkrn−k = 0. (6.14) 232 6. Dodatkowe wiadomości o wielomianach R o z w i ą z a n i e. Mamy, na mocy (6.10) i (6.13): Σ(−T ) · R(T ) = 1. Równość ta jest równoważna z równościami (6.14) dla n ⩾ 1 oraz równością σ0r0 = 1. ♦ Ćwiczenie 6.19 Stosując technikę funkcji tworzących udowodnić, że nrn = n∑ k=1 skrn−k. (6.15) 6.3 Liczby algebraiczne i przestępne Liczby algebraiczne to pierwiastki równań wielomianowych o współczynnikach całkowitych (równoważnie: wymiernych). Pozostałe liczby to liczby przestępne. Niektóre liczby wymierne są całkowite. A niektóre liczby algebraiczne nazywamy liczbami algebraicznymi całkowitymi. Deﬁnicja 6.7 Liczbę zespoloną α nazywamy liczbą algebraiczną, gdy istnieje taki nie- zerowy wielomian f (X) ∈ Z[X], że f (α) = 0. W przypadku przeciwnym nazywamy ją liczbą przestępną. Liczbę zespoloną α nazywamy liczbą algebraiczną całkowitą, gdy istnieje taki wielomian u n o r m o w a n y f (X) ∈ Z[X], że f (α) = 0. Zbiór liczb algebraicznych ozna- czamy symbolem A, a zbiór liczb algebraicznych całkowitych, symbolem I. Ćwiczenie 6.20 Udowodnić, że jeżeli liczba rzeczywista x jest współmierna z liczbą π (to znaczy, że x/π ∈ Q), to sin x i cos x są liczbami algebraicznymi. Wskazówka. Wykorzystać (1.7) i (1.14). 6.3.1 Wielomian minimalny liczby algebraicznej Z każdą liczbą algebraiczną związany jest jej wielomian minimalny. Ćwiczenie 6.21 Niech dana będzie liczba algebraiczna α. Udowodnić, że zbiór Iα = {f (X) ∈ Q[X] : f (α) = 0} (6.16) jest ideałem w pierścieniu Q[X]. Wywnioskować stąd, że istnieje dokładnie jeden taki wielo- mian unormowany mα(X) ∈ Q[X], że Iα = (mα(X)). Deﬁnicja 6.8 Niech α będzie liczbą algebraiczną. Zdeﬁniowany w powyższym ćwiczeniu wielomian mα(X) nazywamy wielomianem minimalnym liczby algebraicznej α. Stopień deg mα(X) wielomianu minimalnego liczby algebraicznej α nazywa się stopniem liczby α. P r z y k ł a d 1. Niech α = √ 2+√3. Wówczas α2 = 5+2√6. Stąd (α2−5) 2 = (2 √6) 2 = 24, więc α4 − 10α2 + 1 = 0. Widzimy, że α jest pierwiastkiem wielomianu X 4 − 10X 2 + 1. Przeto α ∈ I. Łatwo sprawdzić, że wielomian X 4 − 10X 2 + 1 jest nierozkładalny. Czyli, że liczba√2 + √ 3 jest liczbą algebraiczną (całkowitą) stopnia 4. ♦ 6.3. Liczby algebraiczne i przestępne 233 P r z y k ł a d 2. Niech α = n√√ 3 + 1. Wtedy αn − 1 = √ 3, skąd (αn − 1) 2 = 3. Widzimy zatem, że α jest pierwiastkiem wielomianu f (X) = X 2n−2X n−2. Jest więc liczbą algebraiczną całkowitą. Kryterium Eisensteina T3.17 (przy wyborze p = 2) pokazuje, że wielomian f (X) jest nierozkładalny. Stąd łatwo wywnioskować, że f (X) = mα(X). Rzeczywiście, ponieważ f ∈ Iα = (mα), więc f (X) = mα(X)g(X) dla pewnego g(X) ∈ Q[X]. Ta równość, wobec nierozkładalności wielomianu f , dowodzi, że deg g = 0, więc g ∈ Q∖{0}. I wreszcie, ponieważ oba wielomiany f i mα są unormowane, g = 1. ♦ ZADANIE 6.3 Dowieść, że wielomian minimalny liczby algebraicznej jest nierozkładalny. R o z w i ą z a n i e. Załóżmy, że mα(X) = f (X)g(X). Wtedy f (α)g(α) = mα(α) = 0, więc f (α) = 0 lub f (α) = 0. Niech f (α) = 0. Wówczas f (X) ∈ Iα, czyli f (X) = mα(X)k(X) dla pewnego wielomianu k(X) ∈ Q[X]. Stąd mα(X) = mα(X)k(X)g(X). Zatem, na mocy C3.6, deg g(X) = 0. ♦ Ćwiczenie 6.22 Uzasadnić, że zbiór liczb algebraicznych stopnia 1 pokrywa się ze zbiorem liczb wymiernych, a zbiór liczb algebraicznych stopnia 2 jest równy {x + y√∆ : x, y ∈ Q, ∆ ̸= 1 jest bezkwadratową liczbą całkowitą}. Deﬁnicja 6.9 Liczbę algebraiczną stopnia 2 nazywamy niewymiernością kwadratową. Ćwiczenie 6.23 Udowodnić równość zbiorów Q ∩ I = Z. Ćwiczenie 6.24 Udowodnić, że liczba √3−√5 jest liczbą algebraiczną stopnia 4, a liczba√2 + 3√ 3 jest liczbą algebraiczną stopnia 6. 6.3.2 Uwalnianie się od niewymierności w mianowniku Pokażemy teraz metodę ”uwalniania się od niewymierności” w mianowniku, czyli zapisywania liczb postaci u(α)/v(α), gdzie α jest liczbą algebraiczną, a u(X), v(X) ∈ Q[X], w postaci w(α), dla pewnego w(X) ∈ Q[X]. Okazuje się, że dla zrobienia takiej sztuczki wystarczy znać algorytm dzielenia z resztą, zobacz T3.3, i wielomian minimalny mα(X). TWIERDZENIE 6.5 Jeżeli α jest liczbą algebraiczną stopnia n, to zbiór Q(α) := {a0 + a1α + a2α2 + . . . + an−1αn−1 : a0, a1, . . . , an−1 ∈ Q} jest ciałem. D O W Ó D. Zauważmy, że Q(α) jest zbiorem wartości, dla argumentu α, wszystkich wie- lomianów o współczynnikach wymiernych, stopnia < n. Możliwość2 dodawania i odejmowania w tym zbiorze jest oczywista. Musimy więc uzasadnić, że zbiór Q(α) jest zamknięty względem mnożenia i dzielenia (nie przez zero, oczywiście!). 2Mówimy, że zbiór Q(α) jest zamknięty względem dodawania i odejmowania. 234 6. Dodatkowe wiadomości o wielomianach Niech f (α), g(α) ∈ Q(α), gdzie f (X), g(X) ∈ Q[X] i deg(f ), deg(g) < n. Podzielmy (z resztą) iloczyn f (X)g(X) przez wielomian minimalny mα(X). Otrzymamy f (X)g(X) = q(X)mα(X) + r(X) gdzie deg r(X) < n. Zatem f (α)g(α) = q(α)mα(α) + r(α) = r(α) ∈ Q(α). Widzimy, że zbiór Q(α) jest za- mknięty względem mnożenia. Ponieważ dzielenie jest mnożeniem przez odwrotność, więc wy- starczy uzasadnić, że jeżeli f (α) ∈ Q(α) ∖ {0}, to 1 f (α) ∈ Q(α). Aby to zrobić zauważmy, że NWD (f, mα) ∼ 1 (bo, zob. C3.35, mα jest wielomianem nierozkładalnym i nie dzieli wielomianu f (X), który jest stopnia < n). Zatem f (X)k(X) + mα(X)l(X) = 1 dla pewnych k(X), l(X) ∈ Q[X], zobacz T3.11. Kładąc tu X = α, mamy f (α)k(α) = 1. Jeżeli r(X) jest resztą z dzielenia k(X) przez mα(X), to k(α) = r(α) i ostatecznie 1 f (α) = r(α) ∈ Q(α), (6.17) bo deg(r) < n. Dzielenie (nie przez zero!) jest więc wykonalne w zbiorze Q(α). Ostatecznie, zbiór Q(α) jest ciałem. □ U w a g a 1. W tym dowodzie poznaliśmy ogólną metodę uwalniania się od niewymierności w mianowniku, czyli metodę odwracania wyrażeń wielomianowych od liczby będącej pierwiast- kiem wielomianu. Mówi o tym równość (6.17). W matematyce szkolnej poznaliśmy przypadek szczególny tej metody, gdy mamy do czynienia z niewymiernościami kwadratowymi. U w a g a 2. Ciało Q może być w tym twierdzeniu zastąpione przez dowolne ciało. Spró- bujcie sformułować i udowodnić odpowiednią wersję ogólną. Ćwiczenie 6.25 Uwolnić się od niewymierności w mianowniku: 1 1 + 3 3√ 2 − 5 3√4. Ćwiczenie 6.26 Uzasadnić, że zbiór {a + b√2 : a, b ∈ Q} j e s t ciałem (względem zwy- kłych działań dodawania i mnożenia liczb), a zbiór {a + b 3√2 : a, b ∈ Q} n i e j e s t ciałem3. 6.3.3 Pierścień liczb algebraicznych całkowitych Wykorzystamy wiedzę dotyczącą wielomianów symetrycznych w dowodzie faktu że zbiór I liczb algebraicznych całkowitych jest p i e r ś c i e n i e m (względem zwykłych działań). Stąd dostaniemy natychmiastowy wniosek, że zbiór A wszystkich liczb algebraicznych jest c i a ł e m. Ćwiczenie 6.27 Udowodnić, że wielomian minimalny liczby algebraicznej całkowitej ma współczynniki całkowite. Wskazówka. Jeżeli f (α) = 0 dla pewnego wielomianu unormowanego f (X) ∈ Z[X], to f (X) ∈ Iα, zobacz (6.16), więc f (X) = mα(X)g(X) dla pewnego wielomianu g(X) ∈ Q[X]. Zastosować twierdzenie T3.15. TWIERDZENIE 6.6 Zbiór I liczb algebraicznych całkowitych jest pierścieniem. 3Ale zbiór {a + b 3√2 + c 3√4 : a, b, c ∈ Q} jest ciałem (względem zwykłych działań). Por. T6.5. 6.3. Liczby algebraiczne i przestępne 235 D O W Ó D. Mamy udowodnić, że jeżeli α, β są liczbami algebraicznymi całkowitymi, to zarówno suma α + β jak i iloczyn αβ są liczbami algebraicznymi całkowitymi. Niech mα = mα(X), mβ = mβ(X) ∈ Z[X] będą wielomianami minimalnymi liczb α, β. Zapiszmy ich rozkłady w C[X], zobacz T3.18: mα(X) = a0 + a1X + . . . + X n = (X − α1)(X − α2) · . . . · (X − αn), mβ(X) = b0 + b1X + . . . + X m = (X − β1)(X − β2) · . . . · (X − βm). Pierwiastki αi są parami różne, zobacz C6.7. Również pierwistki βj są parami różne. Możemy przyjąć, że α = α1 i β = β1. Rozważmy wielomian u n o r m o w a n y stopnia nm: F (X) = n∏ i=1 m∏ j=1 (X − αi − βj). (6.18) Jego pierwiastkiem jest liczba α + β = α1 + β1. S p r a w d z i m y, że wielomian F (X) ma współczynniki całkowite, co będzie dowodzić, że α + β ∈ I. Zapiszemy iloczyn (6.18) w postaci mβ(X − α1)mβ(X − α2) · . . . · mβ(X − αn), czyli [b0 + b1(X − α1) + . . . + (X − α1) m] · . . . · [b0 + b1(X − αn) + . . . + (X − αn) m]. Widzimy stąd, że F (X) jest wielomianem symetrycznym zmiennych α1, α2, . . . , αn o współczynnikach w pierścieniu Z[X]. Zatem, na mocy twierdzenia Newtona T6.4, widzimy, że F (X) jest wielomianem o współczynnikach w Z[X] zmiennych σk(α1, . . . αn), i = 1, . . . , n. Ponieważ, na mocy wzorów Vi`ete’a, zobacz (6.7), σk(α1, α2, . . . , αn) = (−1)kan−k ∈ Z, więc widzimy, że F (X) ma współczynniki całkowite. Zatem α + β ∈ I. Dla dowodu, że αβ ∈ I rozważmy wielomian G(X) = n∏ i=1 m∏ j=1 (X − αiβj). Ponieważ jest on wielomianem unormowanym, a liczba αβ = α1β1 jest jego pierwiastkiem, więc wystarczy uzasadnić, że jest on wielomianem o współczynnikach całkowitych. Robi się to tak samo jak wyżej zapisując go uprzednio w postaci iloczynu αm 1 mβ ( X α1 ) αm 2 mβ ( X α2 ) · . . . · αm n mβ ( X αn ) , z której widać, że jest on symetryczny względem α1, . . . , αn. Reszta rozumowania przebiega jak wyżej. Mamy więc αβ ∈ I. □ Ćwiczenie 6.28 Udowodnić, że jeżeli α jest różną od 0 liczbą algebraiczną, to 1 α jest liczbą algebraiczną tego samego stopnia. To ćwiczenie i niewielka modyﬁkacja dowodu T6.6 (polegająca w gruncie rzeczy wyłącznie na zamianie Z na Q) pokazują, że prawdziwy jest następujący: WNIOSEK Zbiór A liczb algebraicznych jest c i a ł e m. □ 236 6. Dodatkowe wiadomości o wielomianach Ćwiczenie 6.29 Udowodnić, że α ∈ A wtedy i tylko wtedy, gdy istnieje taka liczba całko- wita s ∈ Z̸=0 i taka liczba algebraiczna całkowita α0, że α = α0/s. Wskazówka. Pomnożyć równość anαn + an−1αn−1 + . . . + a0 = 0 przez an−1 n . Pierwszy sposób rozwiązania poniższego zadania wykorzystuje T6.6 i C6.23. ZADANIE 6.4 Udowodnić, że jeżeli n ∈ N⩾2, to liczba L = n√√2 + 1 + n√√2 − 1 nie jest liczbą wymierną (LXVI OM). R o z w i ą z a n i e. S p o s ó b 1. (wg. Pawła Poczobuta) Ponieważ L = α + β, gdzie α = n√√2 + 1, β = n√√2 − 1, a α i β są liczbami algebraicznymi całkowitymi (liczba α spełnia równanie (xn − 1) 2 = 2, czyli jest pierwiastkiem wielomianu unormowanego f (X) = X 2n − 2X n − 1, a β, podobnie, jest pierwiastkiem wielomianu g(X) = X 2n + 2X n − 1), więc, na mocy T6.6, L ∈ I. Gdyby więc L była liczbą wymierną, to, na mocy C6.23, byłaby liczbą całkowitą (zwykłą). Ale 2 < α + β = L < 3, gdzie pierwsza nierówność wynika z nierówności AG (bo αβ = 1), a druga nierówność wynika łatwo z nierówności między średnią arytmetyczną a średnią n-potęgową. Sprzeczność. S p o s ó b 2. (wg. Wojciecha Wawrowa) Zakładając nie wprost, że L ∈ Q widzimy, że α i β są (różnymi!) pierwiastkami wielomianu X 2 − L X + 1 ∈ Q[X] (bowiem zachodzą równości typu Vi`ete’a α + β = L i αβ = 1). Przeto α = u + √δ, β = u − √ δ, gdzie u = L/2 ∈ Q, δ = (L2 − 4)/4 ∈ Q, ale √δ /∈ Q (gdyby √ δ ∈ Q, to liczba α = u + √δ byłaby wymiernym pierwiastkiem wielomianu f (X) = X 2n − 2X n − 1, który jednak, jak łatwo widzieć, nie ma pierwiastków wymiernych, zobacz Z2.4). Powołując się teraz na C6.30 dostajemy sprzeczność, bo, jak łatwo sprawdzić, f (β) ̸= 0. ♦ Ćwiczenie 6.30 Udowodnić, że jeżeli u + √ δ, gdzie u, δ są takie jak wyżej, jest pier- wiastkiem wielomianu F (X) ∈ Q[X], to również u − √ δ jest pierwiastkiem tego wielomianu. U w a g a. Standardowe rozwiązanie zadania Z6.4 można przeprowadzić według schematu pokazanego w przykładzie P2 w ustępie 9.2.1. Ćwiczenie 6.31 Niech ω = ωn, zob. (3.35), i niech f (X) ∈ Z[X]. Udowodnić, że iloczyn f (ω)f (ω2) · . . . · f (ωn−1) jest liczbą całkowitą wymierną4. 6.3.4 Nierozkładalność wielomianów cyklotomicznych Chcemy teraz zaprezentować dowód twierdzenia T3.21. W dowodzie wykorzystujemy parę rze- czy z tego rozdziału. Ale najważniejsza sprawa jest taka: w trakcie dowodu będziemy w istotny sposób wykorzystywać prawdziwość tezy T3.14 w pierścieniach wielomianów o współczynnikach w d o w o l n y m ciele (w tym przypadku, ciele skończonym Fp). LEMAT 6.1 Jeżeli p ∈ P, to dla dowolnego wielomianu f (X) ∈ Z[X] zachodzi f (X) p ≡ f (X p) (mod p). 4Mówimy tak (i piszemy) dla odróżnienia liczb ze zbioru Z od liczb z jego nadzbioru I. 6.3. Liczby algebraiczne i przestępne 237 D O W Ó D. To jest natychmiastowym wnioskiem z następującej kongruencji (α1 + α2 + · · · + αr) p ≡ αp 1 + αp 2 + · · · + αp r (mod p), którą łatwo, korzystając z C2.50, udowodnić przez indukcję względem r. Mając to, piszemy (a0 + a1X + · · · + anX n) p ≡ ap 0 + ap 1X p + · · · + ap n(X n) p ≡ a0 + a1X p + · · · + anX pn (mod p), gdzie druga kongruencja wynika z MTF (w wersji (5.12)). □ Chcemy udowodnić, że wielomian cyklotomiczny Φn(X) jest nierozkładalny w Q[X], rów- noważnie, w Z[X]. Oznaczmy przez m(X) wielomian minimalny liczby ω := ωn, zob. (3.35). Ponieważ ω ∈ I (ω jest pierwiastkiem wielomianu unormowanego X n − 1 ∈ Z[X]), więc m(X) ∈ Z[X], zob. C6.27. Z deﬁnicji (3.44) widzimy, że ω jest pierwiastkiem wielomianu Φn(X). To, na mocy C6.21, daje podzielność m(X)|Φn(X). Zapiszmy Φn(X) = m(X)f (X). Ponieważ m(X) jest nierozkładalny (zob. Z6.3), więc nierozkładalność wielomianu Φn(X) jest równoważna równości m(X) = Φn(X). Tę równość wyprowadzimy z lematu: LEMAT 6.2 Przy przyjętych oznaczeniach, każdy pierwiastek (zespolony) wielomianu Φn(X) jest też pierwiastkiem wielomianu m(X). D O W Ó D. Niech p będzie dowolną taką liczbą pierwszą, że p ∤ n. Wówczas ωp, zgod- nie z deﬁnicją (3.44), jest pierwiastkiem5 wielomianu Φn(X). Wobec tego zachodzi równość m(ωp)f (ωp) = Φn(ωp) = 0. Udowodnimy, że m(ωp) = 0. Załóżmy, nie wprost, że m(ωp) ̸= 0. Wówczas musi być f (ωp) = 0. To oznacza, że g(ω) = 0, gdzie g(X) := f (X p). Wobec tego, zob. C6.21, wielomian g(X) ∈ Z[X] należy do ideału głównego (mω), czyli zachodzi równość g(X) = m(X)h(X) dla pewnego wielomianu h(X) ∈ Q[X]. W rzeczywistości, zobacz T3.15, h(X) ∈ Z[X]. Stąd f (X p) = m(X)h(X), więc, na mocy L6.1, f (X) p ≡ m(X)h(X) (mod p). Oznaczmy przez f , m, h redukcje wielomianów f, m, g ∈ Z[X] modulo p. Kongruencja f (X) p ≡ m(X)g(X) (mod p) daje równość w pierścieniu Fp[X]: f (X)p = m(X)h(X). (∗) Załóżmy, że k(X) ∈ Fp[X] jest pewnym, nierozkładalnym w Fp[X], dzielnikiem wielomianu m(X). Wówczas, dzięki jednoznaczności rozkładu w Fp[X], zob. T3.14, i równości (∗), dosta- jemy podzielność k(X)|f (X). Ponieważ jednocześnie Φn(X) = m(X)f (X), więc dostajemy k(X) 2|Φn(X) w pierścieniu Fp[X]. Wiemy też, że Φn(X|X n − 1 w Z[X]. Ta podzielność, po redukcji (mod p), daje podzielność k(X) 2|X n − 1 w Fp[X]. To jest jednakowoż sprzeczne z tezą zadania Z6.1, bo wielomian X n − 1 jest, oczywiście(?!), względnie pierwszy ze swoją pochodną nX n−1 (pamiętamy założenie p ∤ n, czyli n ̸= 0 w Fp). Otrzymana sprzeczność dowodzi, że m(ωp) = 0 dla każdej liczby pierwszej p ∤ n. Najprościej dokończyć dowód za pomocą twierdzenia Dirichlet’a T5.19: Każdy pierwiastek wielomianu Φn(X) jest postaci ωk, gdzie k ⊥ n. Wybieramy liczbę pierwszą p postaci qn + k. Takich jest mnóstwo. I, wobec już dowiedzionego, mamy 0 = m(ωp) = m(ωk). □ Ćwiczenie 6.32 Dokończyć dowód nierozkładalności wielomianów cyklotomicznych. 5Po wykonaniu dzielenia z resztą p = qn + k, widzimy, że k ⊥ n i ωp = ωk. 238 6. Dodatkowe wiadomości o wielomianach 6.3.5 Liczby przestępne Liczba (zespolona) nie będąca liczbą algebraiczną nazywa się, jak wiemy, liczbą p r z e s t ę p n ą. I s t n i e n i e liczb przestępnych zostało udowodnione w połowie XIX wieku przez matema- tyka francuskiego Josepha Liouville’a. Metodę Liouville’a dowodu istnienia liczb przestępnych zaprezentujemy w kolejnym ustępie. W roku 1872 Charles Hermite (Francja) udowodnił, że pewna ważna stała matematyczna, liczba e (podstawa logarytmów naturalnych), jest liczbą przestępną. W tym samym mniej wię- cej czasie Georg Cantor (Niemcy) za pomocą nowatorskiego i genialnie prostego rozumowania uzasadnił, że algebraiczność liczby rzeczywistej (czy zespolonej) jest własnością w y j ą t k o w ą, a przestępność jest własnością t y p o w ą. Schemat jego rozumowania jest następujący: ▷ wszystkie liczby wymierne można ponumerować (liczbami naturalnymi), więc ▷ wszystkie wielomiany o współczynnikach wymiernych można ponumerować, więc ▷ wszystkie liczby algebraiczne można ponumerować, a ▷ liczb rzeczywistych (tym bardziej liczb zespolonych) n i e d a się ponumerować. Mówiąc w skrócie: zbiór liczb algebraicznych jest zbiorem przeliczalnym, a zbiór liczb rze- czywistych (tym bardziej więc jego nadzbiór – zbiór liczb zespolonych) n i e j e s t przeliczalny. Porównaj KOM , rozdział 1. Jednym z piękniejszych twierdzeń matematyki jest TWIERDZENIE 6.7 (Lindemann, 1881) Liczba π jest liczbą przestępną. □ Z twierdzenia Lindemanna wynika n e g a t y w n e rozwiązanie problemu kwadratury koła, czyli konstrukcji (za pomocą cyrkla i linijki) kwadratu o polu równym polu koła o promieniu 1. Równoważnie: konstrukcji odcinka długości √π. Nietrudno udowodnić, że konstruowalne są wyłącznie odcinki o długościach będących liczbami algebraicznymi, a i to z d e c y d o w a n i e n i e w s z y s t k i e. A liczba √π jest przestępna. [Gdyby √ π ∈ A, to byłoby π = √π√π ∈ A, zob. WT6.6.] 6.3.6 Twierdzenie Liouville’a Udowodnimy tu pewną własność liczb algebraicznych rzeczywistych. Mówi ona, że takie liczby niezbyt dobrze dają się przybliżać liczbami wymiernymi. TWIERDZENIE 6.8 (Liouville) Jeżeli α ∈ R jest liczbą algebraiczną stopnia n, to istnieje taka liczba dodatnia C, że dla dowolnej liczby wymiernej h/k zachodzi nierówność \f \f \f \fα − h k \f \f \f \f > C kn . (6.19) D O W Ó D. Niech f (X) = a0 + a1X + . . . + anX n ∈ Z[X] będzie wielomianem stowarzy- szonym z wielomianem minimalnym liczby α. Rozważmy przedział [ α − 1; α + 1 ]. W tym przedziale pochodna f ′ wielomianu f jest ograniczona |f ′(x)| ⩽ M. 6.3. Liczby algebraiczne i przestępne 239 Możemy oczywiście założyć, że M > 1. Połóżmy C = 1 M . Przy takim C nierówność (6.19) jest, oczywiście, spełniona dla każdego h/k leżącego poza przedziałem [ α − 1; α + 1 ]. Jeżeli zaś |α − h/k| ⩽ 1, to mamy (na mocy twierdzenia o wartości średniej T6.2) \f \f \f \ff (h k )\f \f \f \f = \f \f \f \ff ( h k ) − f (α) \f \f \f \f = |f ′(µ)| · \f \f \f \fh k − α\f \f \f \f , dla pewnego µ leżącego między α a h/k. Stąd \f \f \f \f h k − α\f \f \f \f = |f (h/k)| |f ′(µ)| ⩾ 1 M · \f \f \f \ff ( h k )\f \f \f \f = C · |a0kn + a1kn−1h + . . . + anh n| |kn| ⩾ C kn , bo a0kn + a1kn−1h + . . . + anh n = f (h/k)kn jest niezerową liczbą całkowitą, więc jej wartość bezwzględna jest ⩾ 1. □ Twierdzenie Liouville’a ma wartość teoretyczną: za jego pomocą po raz pierwszy w historii udowodniono (dokładniej: Liouville udowodnił) i s t n i e n i e liczb przestępnych: ZADANIE 6.5 Udowodnić, że liczba λ = ∑∞ s=1 10 −s! jest liczbą przestępną. R o z w i ą z a n i e. Załóżmy, nie wprost, że λ jest liczbą algebraiczną stopnia n i wybierzmy tak duże N ∈ N, aby N > n oraz 10 N !−1 > 1 C , gdzie C jest stałą występującą w twierdzeniu Liouville’a. Niech h/k oznacza sumę N po- czątkowych wyrazów szeregu deﬁniującego liczbę λ. Wówczas k = 10 N ! i \f \f \f \fλ − h k \f \f \f \f = ∞∑ s=N +1 10 −s! < 10 10(N +1)! = 10 kN +1 < C kn , co jest sprzeczne z tezą twierdzenia Liouville’a. ♦ U w a g a 1. W zadaniach olimpijskich wykorzystuje się nierówności postaci (6.19) dla liczb algebraicznych małych stopni, zazwyczaj niewymierności kwadratowych, na przykład: Ćwiczenie 6.33 Udowodnić, że dla dowolnej liczby wymiernej a/b zachodzi: \f \f \f√2 − a b \f \f \f > 1 (2 √2 + 2)b2 > 1 5b2 . (6.20) Dzięki szacowaniu (6.20) możemy rozwiązać trudne zadanie: ZADANIE 6.6 Udowodnić, że istnieje taki ciąg nieskończony liczb rzeczywistych (sn), że |sn| ⩽ 5 dla każdego n oraz dla dowolnych dwóch indeksów k ̸= l zachodzi nierówność |sk − sl| ⩾ 1 |k − l| . (6.21) 240 6. Dodatkowe wiadomości o wielomianach R o z w i ą z a n i e. Twierdzimy, że ciąg (sn) dany wzorem sn = 5{n √2} (gdzie {x} = x − ⌊x⌋ oznacza część ułamkową liczby rzeczywistej x, zobacz paragraf 12.1) jest ciągiem spełniającym warunek (6.21). Istotnie, 0 ⩽ sn < 5. Ponadto, |sk − sl| = 5|{k√2} − {l√2}| = 5|k√2 − ⌊k√ 2⌋ − l√2 + ⌊l√2⌋| = 5|k − l| · \f \f \f \f√ 2 − q k − l \f \f \f \f , gdzie q = ⌊k√2⌋ − ⌊l√2⌋. To, wobec nierówności (6.20), kończy uzasadnienie. ♦ U w a g a 2. Wartość stałej C z nierówności (6.19) nie jest zazwyczaj ważna. Ważne jest i s t n i e n i e takiej stałej. Stała C = 1/(2 √2 + 2), której istnienia w (6.20) dowodzimy według wzoru z dowodu T6.8 (wielomianem minimalnym liczby √2 jest X 2 − 2), może być łatwo zwiększona do C = 1/4. Na przykład tak: gdy a/b ∈ [ √2 − 1; √ 2 + 1 ], to \f \f \f√ 2 − a b \f \f \f = |2b2 − a2| b2 \f \f√2 + a b \f \f ⩾ 1 b2 \f \f√ 2 + a b \f \f ⩾ 1 b2( √2 + √2 + 1) > 1 4b2 . Gdy a/b /∈ [ √ 2 − 1; √ 2 + 1 ], nierówności | √2 − a/b| > 1/b 2 > 1/4b2 są oczywiste. 6.4 O zerach wielomianów wielu zmiennych W tym paragraﬁe powiemy kilka słów o zerach (miejscach zerowych) wielomianów wielu zmien- nych. W szczególności zaprezentujemy ciekawe uogólnienie T3.4, tak zwane kombinatoryczne twierdzenie o zerach. Wiemy, że każdy wielomian jednej zmiennej f (X) ∈ R[X] w y z n a c z a funkcję wielomia- nową, R ∋ α 7−→ f (α) ∈ R. Oznaczamy ją tą samą literą f . Podobnie dla wielomianów wielu zmiennych: jeżeli F (X1, . . . , Xn) ∈ R[X1, . . . , Xn] jest takim wielomianem, to R n ∋ (α1, . . . , αn) 7−→ F (α1, . . . , αn) ∈ R jest wyznaczoną przez F funkcją (wielomianową) określoną na R n := R × · · · × R (n-krotny iloczyn kartezjański), czyli na zbiorze wszystkich ciągów długości n o wyrazach z R. Jeżeli R = K jest ciałem (w dalszym ciągu ograniczamy się do takiego przypadku), to zbiór K n nazywamy n-wymiarową arytmetyczną przestrzenią wektorową nad ciałem K. Element (α1, . . . , αn) przestrzeni K n nazywamy wektorem i oznaczamy w skrócie α. Używamy takiego oznaczenia (zob. też ustęp 5.4.4): Jeżeli F (X1, . . . , Xn) ∈ K[X1, . . . , Xn] jest wielomianem o współczynnikach w ciele K, to przez N (F ; K) oznaczamy zbiór miejsc zerowych wielomianu F w Kn. To znaczy: N (F ; K) := {(α1, . . . , αn) ∈ Kn : F (α1, . . . , αn) = 0}. (6.22) Ćwiczenie 6.34 Jeżeli Fi(X1, . . . , Xn) ∈ K[X1, . . . , Xn], dla i = 1, . . . , r, są wielomia- nami o współczynnikach w ciele, a P (X1, . . . , Xn) jest ich iloczynem, to zachodzi równość N (P ; K) = N (F1; K) ∪ N (F2; K) ∪ · · · ∪ N (Fr; K). 6.4. O zerach wielomianów wielu zmiennych 241 Na rysunkach 6.1 widzimy ilustracje zbiorów N (F ; R) dla wielomianów: X 2 − 4X − Y − 5, XY − 1 oraz −3X 3 + Y 3 + X 2Y − 3XY 2 − 2X 2 − 2Y 2 + 12X − 4Y + 8. Przy tym na rysunku 6.1c rozpoznajemy sumę N (X 2 + Y 2 − 4; R) ∪ N (−3X + Y − 2; R). Rys. 3.2a Rys. 3.2b wl w 2l l l wm m w 2m m w 2l wl wm w 2m Rys. 6.1a Rys. 6.1b Rys. 6.1c 6.4.1 Combinatorial Nullstellensatz Imię Combinatorial Nullstellensatz 6 (Kombinatoryczne Twierdzenie o Zerach), na- dane twierdzeniu T6.9, jest coraz szerzej używane. Jest ono uogólnieniem, na przypadek wielu zmiennych, twierdzenia Lagrange’a T3.4. Ćwiczenie 6.35 Dany jest wielomian h(X) ∈ K[X] stopnia k ⩾ 0 o współczynnikach w ciele K. Udowodnić, że jeżeli A ⊆ K i |A| > k, to A ∖ N (h; K) ̸= ∅, czyli że istnieje takie α ∈ A, że h(α) ̸= 0. (Pamiętamy, że wielomian stopnia 0 jest s t a ł ą różną od 0.) Oto uogólnienie tej tezy na przypadek wielomianów wielu zmiennych: TWIERDZENIE 6.9 (Combinatorial Nullstellensatz – 1996) Dany jest wielomian F (X1, X2, . . . , Xn) ∈ K[X1, X2, . . . , Xn]. Niech deg(F ) = k1 + k2 + . . . + kn, gdzie ki są nieujemnymi liczbami całkowitymi, i niech jednomian X k1 1 X k2 2 · . . . · X kn n występuje w wielomianie F z n i e z e r o w y m współczynnikiem. Wówczas, dla dowolnych podzbiorów A1, A2, . . . , An ⊆ K spełniających warunki |Ai| > ki dla i = 1, 2, . . . , n, istnieje taki ciąg (α1, α2, . . . , αn) ∈ A1 × A2 × · · · × An, że F (a1, a2, . . . , an) ̸= 0. D O W Ó D. Dowód przeprowadzimy dla wielomianu dwóch zmiennych Y, X przez indukcję względem stopnia d = deg(F ). Sprawa jest prosta, gdy d = 1. Rzeczywiście, wówczas F (Y, X) = bY + aX + c. Załóżmy, że a ̸= 0, czyli że jednomian aX = aX 1Y 0 występuje w wielomianie F z niezerowym współczynnikiem, i że |A| > 1, |B| > 0, i α1, α2 ∈ A ⊆ K, α1 ̸= α2 i β ∈ B ⊆ K. Równości F (β, α1) = F (β, α2) = 0, czyli aα1 = −bβ − c = aα2, wobec założenia a ̸= 0, dają α1 = α2. Sprzeczność. Załóżmy więc, że teza jest prawdziwa dla wszystkich wielomianów stopni < d i rozważmy wielomian F (Y, X) ∈ K[Y, X] stopnia d = l + k, zawierający jednomian bY lX k, gdzie b ̸= 0. 6Nazwa nawiązuje do, leżącego u podstaw wielkiej i ważnej dziedziny matematyki – geometrii algebra- icznej, sto lat wcześniejszego i znacznie mniej elementarnego, twierdzenia Hilberta o zerach. Nazwa Nullstellensatz używana jest nie tylko w języku niemieckim. 242 6. Dodatkowe wiadomości o wielomianach Możemy (b.s.o.) założyć, że k ⩾ 1. Zapiszmy F (Y, X) w postaci F (Y, X) = f0(Y ) + f1(Y )X + · · · + ft(Y )X t (6.23) wielomianu zmiennej X o współczynnikach w K[Y ]. Niech A, B ⊆ K będą podzbiorami spełniającymi warunki |A| > k, |B| > l. Niech α ∈ A będzie dowolnym ustalonym elementem. Dokładnie tak samo jak w dowodzie T3.1 obliczamy różnicę F (Y, X) − F (Y, α): t∑ j=0 fj(Y )X j − t∑ j=0 fj(Y )αj = t∑ j=1 fj(Y )(X j − αj) = (X − α) t∑ j=1 fj(Y )gj−1(X), gdzie X j − αj = (X − α)(X j−1 + αX j−2 + · · · + αj−1) =: (X − α)gj−1(X). Mamy więc F (Y, X) = (X − α)G(Y, X) + F (Y, α), (6.24) gdzie G(Y, X) = f1(Y ) + f2(Y )g1(X) + · · · + ft(Y )gt−1(X). Wielomian G(Y, X) jest wie- lomianem stopnia d − 1. Sprawdzamy, że jednomian Y lX k−1 stopnia d − 1 występuje w nim ze współczynnikiem równym b. Po pierwsze, w sumie (6.23) jednomian ten znajdujemy (tylko) w iloczynie fk(Y )X k, więc fk(Y ) = bY l+ wyrazy niższego stopnia (wyrazów stopnia wyższego niż l nie ma, bo deg F (Y, X) = l + k), skąd widzimy, że fk(Y )gk−1(X) jest postaci bY lX k−1+ wyrazy niższego stopnia względem Y . Po drugie, ponieważ deg gj−1(X) = j − 1, więc w iloczynach fj(Y )gj−1(X), dla j < k, jednomiany Y lX k−1 n i e występują. Po trze- cie, w iloczynach fj(Y )gj−1(X), dla j > k, jednomiany Y lX k−1 n i e występują, bo wtedy deg fj(Y ) + j ⩽ d = l + k < l + j, czyli deg fj(Y ) < l. Wobec tego, na mocy założenia indukcyjnego, istnieje (β, α1) ∈ B × (A ∖ {α}), dla którego G(β, α1) ̸= 0. Wówczas, na mocy (6.24), F (β, α1) − F (β, α) = (α1 − α)G(β, α1) ̸= 0, skąd F (β, α1) ̸= F (β, α). Zatem, co najmniej jedna z wartości F (β, α1), F (β, α) jest ̸= 0. W ten sposób kończymy dowód w przypadku dwóch zmiennych. Dowód dla wielomianu większej liczby zmiennych jest prostym uogólnieniem przedstawionego. □ CN (Combinatorial Nullstellensatz), którego ilustracje Czytelnik zechce dostrzec na rysun- kach 6.1, stosuje się zazwyczaj w kombinatoryce. P r z y k ł a d 1. (Zadanie o broszkach) Przy okrągłym stole siedzi n posłanek. Każda ma w torebce dwie różne broszki. Czy mogą one tak wybrać jedną z posiadanych broszek i przypiąć sobie do żakietu, by żadne dwie sąsiadki nie miały przypiętej takiej samej? Aby odpowiedzieć na to pytanie rozważmy cykliczny wielomian broszkowy Bc(X1, X2, . . . , Xn) := (X1 − X2)(X2 − X3) · . . . · (Xn−1 − Xn)(Xn − X1) i zauważmy, że Bc(α1, α2, . . . , αn) = 0 wtedy i tylko wtedy, gdy zachodzi co najmniej jedna równość αj = αj+1 (indeksy liczymy cyklicznie, tzn. αn+1 = α1). Ponumerujmy teraz wszystkie broszki tak, by różne broszki miały różne numery. Niech Ai będzie dwuelementowym zbiorem numerów broszek w i-tej torebce. Możliwość pożądanego wyboru broszek jest równoważna możliwości wyboru takiego (α1, . . . , αn) ∈ A1 × · · · × An, że Bc(α1, . . . , αn) ̸= 0. Taki wybór, z kolei, na mocy CN, jest na pewno możliwy, gdy w wielomianie Bc występuje jednomian aX1X2·. . .·Xn z niezerowym współczynnikiem a. Można sprawdzić, że a = 2, gdy 2|n, ale a = 0, gdy 2 ∤ n, zob. C6.35. ♦ Podkreślmy, że najdelikatniejszym momentem w stosowaniu twierdzenia CN jest szukanie jednomianu aX k1 1 X k2 2 · . . . · X kn n stopnia deg F z n i e z e r o w y m współczynnikiem. 6.4. O zerach wielomianów wielu zmiennych 243 Ćwiczenie 6.36 Udowodnić, że po wymnożeniu (tzn., ”otwarciu nawiasów”) w iloczynie (X1 −X2)(X2 −X3)·. . .·(Xn −X1) dostajemy sumę 2 n jednomianów stopnia n, wśród których jedyną redukcją wyrazów podobnych jest suma X1 · . . . · Xn + (−1) nX1 · . . . · Xn. Wskazówka. Dobrze jest najpierw zbadać jednomiany (stopnia n − 1, innych tam nie ma!) w niecyklicznym wielomianie broszkowym 7 B(X1, X2, . . . , Xn) := (X1 − X2)(X2 − X3) · . . . · (Xn−1 − Xn). Czasami stosuje się CN ”w drugą stronę”. P r z y k ł a d 2. Udowodnimy, że jednomian X1X2X3X4 n i e występuje w wielomianie (X1 + X2 + X3 + X4)(X1 + X2 + X3 − X4)(X1 + X2 − X3 − X4)(X1 − X2 − X3 − X4), to znaczy występuje ze współczynnikiem równym 0. Rzeczywiście, gdyby tak nie było, to, na mocy CN, moglibyśmy w zbiorze {1, −1} × {1, −1} × {1, −1} × {1, −1} znaleźć ciąg (ε1, ε2, ε3, ε4), dla którego liczby c1 = ε1 + ε2 + ε3 + ε4, c2 = ε1 + ε2 + ε3 − ε4, c3 = ε1 + ε2 − ε3 − ε4 i c4 = ε1 − ε2 − ε3 − ε4 byłyby różne od 0. To jest n i e m o ż l i w e, zobacz C6.37. Łatwo bowiem zauważyć, że wszystkie te liczby są parzyste, a kolejne różnią się o 2, tzn., |c1 − c2| = |c2 − c3| = |c3 − c4| = 2. ♦ Ćwiczenie 6.37 Udowodnić dyskretną własność Darboux ciągów o wyrazach całkowi- tych: Jeżeli (dn) jest takim ciągiem o wyrazach całkowitych, że |dn − dn+1| = 1 dla każdego n, a liczba a ∈ Z spełnia nierówności dk ⩽ a ⩽ dk+r dla pewnych k, r ∈ N, to istnieje taka liczba całkowita 0 ⩽ s ⩽ r, że dk+s = a. Ćwiczenie 6.38 Niech Fk(X1, . . . , Xn) = ∑k j=1 Xj − ∑n j=k+1 Xj dla k = 1, . . . , n. Udo- wodnić, że jeżeli 2|n, to jednomian X1X2 · . . . · Xn nie występuje w iloczynie F1F2 · . . . · Fn. ZADANIE 6.7 Dana jest liczba naturalna n i podzbiór przestrzeni trójwymiarowej R3: A = {(x, y, z) ∈ R 3 : x, y, z ∈ Z oraz 0 ⩽ x, y, z ⩽ n}. Wyznaczyć n a j m n i e j s z ą liczbę płaszczyzn, których suma (teoriomnogościowa) zawiera zbiór A ∖ {(0, 0, 0)} i n i e zawiera punktu (0, 0, 0). (IMO’2007) R o z w i ą z a n i e. Płaszczyzna o równaniu ax+by+cz+d = 0 jest zbiorem miejsc zerowych wielomianu aX + bY + cZ + d ∈ R[X, Y, Z], czyli zbiorem N (aX + bY + cZ + d; R). Łatwo wskazać 3n płaszczyzn, których suma (teoriomnogościowa) zawiera zbiór A ∖ {(0, 0, 0)} i nie zawiera punktu (0, 0, 0). To są płaszczyzny N (X − 1; R), N (X − 2; R), . . . , N (X − n; R) prostopadłe do osi Ox, płaszczyzny N (Y − 1; R), N (Y − 2; R), . . . , N (Y − n; R) prostopadłe do osi Oy i płaszczyzny N (Z − 1; R), N (Z − 2; R), . . . , N (Z − n; R) prostopadłe do osi Oz. Sumą tych płaszczyzn jest zbiór N (G; R), gdzie G(X, Y, Z) = n∏ j=1 (X − j)(Y − j)(Z − j), 7Wielomian broszkowy (cykliczny i niecykliczny) jest przykładem wielomianu Petersena danego skończo- nego grafu prostego G = (V, E): PG(X1, . . . , Xv) := ∏ i<j (Xi − Xj) χ({Ai,Aj }), gdzie V = {A1, A2, . . . , Av}, a χ : P2(V) → {0, 1} jest funkcją charakterystyczną podzbioru E ⊆ P2(V). Dla oznaczeń zob. KOM . 244 6. Dodatkowe wiadomości o wielomianach zobacz C6.34. Pokażemy, że żadna liczba k < 3n płaszczyzn n i e jest dobra. Załóżmy nie wprost, że ajx + bjy + cjz + dj = 0, dla j = 1, 2, . . . , k, są równaniami płaszczyzn czyniących zadość narzuconym wymaganiom i rozważmy wielomian H(X, Y, Z) = k∏ j=1 (ajX + bjY + cjZ + dj). Stopień tego wielomianu jest równy k. Zgodnie z założeniem mamy H(x, y, z) = 0 dla każdego (x, y, z) ∈ A ∖ {(0, 0, 0)}, ale H(0, 0, 0) ̸= 0. Wobec tego różnica λG − H, przy dowolnej stałej λ ∈ R̸=0, zeruje się dla wszystkich (x, y, z) ∈ A ∖ {(0, 0, 0)}. Jednocześnie, ponieważ zarówno H(0, 0, 0) jak i G(0, 0, 0) są różne od 0, więc, dla λ = H(0, 0, 0) G(0, 0, 0) , wielomian F = λG − H zeruje się na c a ł y m zbiorze A. Ale degF = 3n, (zob. C3.70(2)), i jednomian X nY nZ n występuje w wielomianie F ze współczynnikiem λ, więc, na mocy CN, nie może się zerować na całym A = {0, 1, . . . , n} × {0, 1, . . . , n} × {0, 1, . . . , n}. Sprzeczność, ♦ Ćwiczenie 6.39 (Dla Czytelników nie bojących się przestrzeni n-wymiarowej R n.) Udo- wodnić, że jeżeli Hi = N (ai1X1+· · ·+ainXn+bi; R), i = 1, . . . , r, jest rodziną hiperpłaszczyzn pokrywającą wszystkie punkty zbioru {1, 2}n z wyjątkiem (1, . . . , 1), to r ⩾ n. 6.4.2 Kilka zastosowań Pokażemy jeszcze kilka klasycznych zastosowań kombinatorycznego twierdzenia o zerach. Twierdzenie Erd˝osa, Ginzburga, Ziva ZADANIE 6.8 Udowodnić twierdzenie Erd˝osa, Ginzburga, Ziva: W każdym ciągu długości 2n − 1 o wyrazach całkowitych, istnieje podciąg długości n, suma wyrazów którego jest podzielna przez n. R o z w i ą z a n i e. Udowodnimy to dla n = p będącego liczbą pierwszą. Weźmy ciąg 2p − 1 liczb całkowitych. Jasne, że obchodzą nas tylko reszty z dzielenia tych liczb przez p. Ustawiamy te reszty następująco r1 ⩽ r2 ⩽ r3 ⩽ . . . ⩽ r2p−1 i traktujemy jako elementy w Fp. Wówczas, jeżeli istnieje taki wskaźnik k, że rk = rk+p−1, to rk + rk+1 + . . . + rk+p−1 = prk i mamy podciąg długości p, suma wyrazów którego jest podzielna przez p. Jeżeli zaś nie ma takiego k, to rozważmy podzbiory d w u e l e m e n t o w e A1 = {r1, rp}, A2 = {r2, rp+1}, . . . , Ap−1 = {rp−1, r2p−2} ciała Fp i jeden podzbiór jednoelementowy Ap = {r2p−1}. Rozważmy wielomian W (X1, X2, . . . , Xp) = (X1 + X2 + . . . + Xp) p−1 − 1 ∈ Fp[X1, X2, . . . , Xp]. Wielomian ten ma stopień równy p−1, współczynnik przy X1X2 ·. . .·Xp−1 jest równy (p−1)!, czyli jest różny od zera w Fp, zobacz twierdzenie Wilsona. Na mocy CN znajdziemy więc taki element (α1, α2, . . . , αp) ∈ A1 × A2 × . . . × Ap, że W (α1, α2, . . . , αp) ̸= 0. To oznacza, że C := α1 + . . . + αp jest podzielna przez p. Gdyby bowiem p ∤ C, to, na mocy małego twierdzenia Fermat’a, byłoby p|C p−1 − 1, czyli W (α1, . . . , αn) = 0 w Fp. ♦ Ćwiczenie 6.40 Udowodnić twierdzenie EGZ dla dowolnego n. Wskazówka. Liczbę na- turalną n nazwij liczbą miłą, gdy dla niej zachodzi teza Z6.8. Udowodnij, że iloczyn liczb miłych jest liczbą miłą. 6.4. O zerach wielomianów wielu zmiennych 245 Twierdzenie Cauchy’ego-Davenporta Wprowadzimy oznaczenie: Jeżeli A, B są podzbiorami pewnego ciała (lub pierścienia, lub grupy z działaniem +), to przez A + B oznaczamy zbiór wszystkich sum postaci α + β, gdzie α ∈ A, β ∈ B. Twierdzenie Cauchy’ego-Davenporta, które udowodnimy za pomocą CN, podaje oszacowanie liczby elementów w zbiorze A + B, gdzie A, B są podzbiorami ciała Fp. TWIERDZENIE 6.10 (Twierdzenie Cauchy’ ego-Davenporta) Jeżeli A, B są nie- pustymi podzbiorami ciała Fp, to |A + B| ⩾ min(p, |A| + |B| − 1). D O W Ó D. Sprawdzamy najpierw, że jeżeli |A| + |B| > p, to A + B = Fp. Rzeczywiście, wybierzmy dowolny element γ ∈ Fp i rozważmy zbiór γ − B := {γ − β : β ∈ B}. Jasne, że |γ − B| = |B| (bo β 7−→ γ − β jest bijekcją B na γ − B). Więc |A| + |γ − B| > p = |Fp|. Zatem zbiory A i γ − B nie mogą być rozłączne (Zasada Łat na Kapocie!, zob. KOM ). Niech α0 = γ − β0 będzie ich wspólnym elementem. Wtedy γ = α0 + β0 ∈ A + B. Załóżmy więc, że |A| + |B| ⩽ p i, nie wprost, że |A + B| ⩽ |A| + |B| − 2. Niech C będzie takim podzbiorem w Fp, że A + B ⊆ C oraz |C| = |A| + |B| − 2. I niech F (X, Y ) = ∏ γ∈C(X + Y − γ). (6.25) Kładąc k = |A| − 1, l = |B| − 1 widzimy, że współczynnik przy jednomianie X kY l w wielo- mianie F (X, Y ) jest równy (k+l k ) , co jest różne od zera w Fp, bo k + l < p, a p jest liczbą pierwszą. Combinatorial Nullstellensatz, po wyborze n = 2, A1 = A, A2 = B, pozwala znaleźć takie α0 ∈ A, β0 ∈ B, że F (α0, β0) ̸= 0. Ale czynnik X + Y − (α0 + β0) występuje po prawej stronie w (6.25), bo α0 + β0 ∈ A + B ⊆ C. Sprzeczność. □ Ćwiczenie 6.41 Udowodnić, że jeżeli p jest liczbą pierwszą, A jest niepustym podzbiorem ciała Fp, to |{x + y : x, y ∈ A, x ̸= y}| ⩾ min(p, 2|A| − 3). Ćwiczenie 6.42 Udowodnić, że jeżeli p jest liczbą pierwszą, A, B są niepustymi podzbio- rami ciała Fp, to |{x + y : x ∈ A, y ∈ B, xy ̸= 1}| ⩾ min(p, |A| + |B| − 3). 6.4.3 Twierdzenia Chevalley’a i Warninga Wykorzystamy CN w dowodzie twierdzenia Chevalley’a. Następnie, naśladując Warninga, wzmocnimy to twierdzenie. Te twierdzenia mówią o istnieniu rozwiązań układów równań wie- lomianowych nad ciałami skończonymi 8 Fp. Zaczniemy od ważnej o b s e r w a c j i: Jeżeli K jest ciałem skończonym i ϕ : K −→ K jest d o w o l n ą funkcją, to istnieje taki wielomian f (X) ∈ K[X], że wyznaczona przez niego funkcja wielomianowa jest równa ϕ. Dowód jest natychmiastowy, wystarczy powołać się na twierdzenie interpolacyjne Lagrange’a. W przypadku, gdy K = Fp, posługując się MTF, możemy to uzasadnić (w istocie: pozornie) prościej. Rozwiążemy ogólniejsze: 8W rozdziale dziewiątym poznamy jeszcze jedną serię ciał skończonych, mianowicie Fp2 dla wszystkich liczb pierwszych p. Można wykazać, że dla każdej liczby pierwszej p i dowolnego wykładnika n ∈ N istnieje (jedno z dokładnością do izomorﬁzmu) ciało mające p n elementów. I więcej ciał skończonych nie ma. 246 6. Dodatkowe wiadomości o wielomianach ZADANIE 6.9 Udowodnić, że jeżeli Φ : Fn p −→ Fp jest d o w o l n ą funkcją, to istnieje taki wielomian F (X1, . . . , Xn) ∈ Fp[X1, . . . , Xn], że F (α) = Φ(α) dla każdego α ∈ Fp. R o z w i ą z a n i e. Ustalmy dowolny wektor α = (α1, . . . , αn). Funkcja wielomianowa wyznaczona przez wielomian Dα(X1, X2, . . . , Xn) = 1 − (X1 − α1)p−1(X2 − α2) p−1 · . . . · (Xn − αn) p−1 jest, na mocy MTF, funkcją charakterystyczną zbioru jednoelementowego {α}. To znaczy: Dα(β) = { 1, gdy β = α, 0, gdy β ̸= α. (6.26) Stąd: wielomian ∑ α∈Fn p Φ(α)Dα(X1, . . . , Xn) wyznacza funkcję (wielomianową) równą Φ. ♦ Rozważmy teraz układ równań wielomianowych postaci (U )  ||| ||| G1(x1, x2, . . . , xn) = 0, G2(x1, x2, . . . , xn) = 0, . . . Gr(x1, x2, . . . , xn) = 0, (6.27) gdzie Gi(X1, . . . , Xn) ∈ Fp[X1, . . . , Xn], dla i = 1, . . . , r, są danymi wielomianami o współ- czynnikach w Fp. Przez N (G1, . . . , Gr; Fp) oznaczamy zbiór rozwiązań takiego układu. Jest to zbiór takich wektorów α ∈ Fn p , że Gi(α) = 0 dla każdego i. Innymi słowy N (G1, . . . , Gr; Fp) = N (G1; Fp) ∩ N (G2; Fp) ∩ · · · ∩ N (Gr; Fp). Ćwiczenie 6.43 Udowodnić, że wielomian DU := (1 − G p−1 1 )(1 − G p−1 2 ) · . . . · (1 − G p−1 r ) (6.28) wyznacza funkcję (wielomianową) charakterystyczną podzbioru N (G1, . . . , Gr; Fp). To zna- czy funkcję przyjmującą wartość 1 ∈ Fp dla argumentów należących do N (G1, . . . , Gr; Fp) i wartość 0 ∈ Fp dla pozostałych argumentów. Łatwo teraz, korzystając z CN, udowodnić TWIERDZENIE 6.11 (Twierdzenie Chevalley’ a – 1935) Jeżeli wielomiany Gi z układu (6.27) spełniają warunek deg(G1) + deg(G2) + · · · + deg(Gr) < n (6.29) i układ ten ma rozwiązanie, to ma co najmniej d w a rozwiązania. D O W Ó D. Załóżmy, nie wprost, że N (G1, . . . , Gr; Fp) = {α}. Wówczas, na mocy (6.26) i C6.43, wielomian F = DU − Dα wyznacza funkcję wielomianową tożsamościowo równą 0. Jednocześnie deg DU = (p − 1)deg G1 + · · · + (p − 1)deg Gr < (p − 1)n na mocy C3.70(1) i założenia (6.29), a deg Da = (p − 1)n na mocy C3.70(1). Wobec tego deg F = (p − 1)n, zob. 6.4. O zerach wielomianów wielu zmiennych 247 C3.70(2). Ponadto, łatwo wskazać niezerowy jednomian maksymalnego stopnia w wielomianie F . Jest to oczywiście X p−1 1 · . . . · X p−1 n . Jeżeli więc położymy A1 = · · · = An = Fp, to, na mocy CN, powinniśmy znaleźć β ∈ Fn p , dla którego F (β) ̸= 0. Sprzeczność. □ P r z y k ł a d. Dla dowolnej liczby p ∈ P istnieją takie liczby całkowite x, y, z, że x2+y2+z2 jest niezerową wielokrotnością p. Rzeczywiście, wielomian G(X, Y, Z) = X 2 + Y 2 + Z 2 jest wielomianem stopnia 2 trzech zmiennych. Ponieważ 2 < 3, a (0, 0, 0) jest rozwiązaniem układu G(x, y, z) = 0, więc, wobec T6.11, istnieje jeszcze co najmniej jedno rozwiązanie. Po- równaj też lemat L8.4, gdzie pokazujemy proste (opierające się na Zasadzie Łat na Kapocie) rozumowanie dowodzące prawdziwości powiedzianego. Trudno byłoby wymyślić podobnie pro- ste rozumowanie w odniesieniu do wielomianu x2 + 5xy + y2 − 3yz + 2x + 11z = 0 (i podobnych wielomianów stopnia 2 trzech zmiennych i bez wyrazu wolnego – wtedy bowiem istnieje roz- wiązanie zerowe!). Obecnie wiemy, że kongruencja x2 + 5xy + y2 − 3yz + 2x + 11z ≡ 0 (mod p) ma niezerowe rozwiązania. ♦ Dążymy teraz do udowodnienia uzyskanego przez Warninga wzmocnienia twierdzenia Che- valley’a. Udowodnimy w tym celu lemat o sumie (wszystkich) wartości wielomianu nad ciałem Fp. Ponieważ przestrzeń Fn p jest zbiorem skończonym, więc możemy d o d a ć wszystkie war- tości dowolnego wielomianu: S(F ) := ∑ α∈Fn p F (α). LEMAT 6.3 Jeżeli w jednomianie J = J(X1, . . . , Xn) = X k1 1 X k2 2 · . . . · X kn n co najmniej jeden wykładnik ki nie jest podzielny przez p − 1, to S(J) = 0. D O W Ó D. Opiera się na tezie Z5.22. Mamy bowiem S(J) = ∑ α∈Fn p αk1 1 · . . . · αkn n = ( ∑ α1∈Fp αk1 1 ) · . . . · ( ∑ αn∈Fp αkn n ), i co najmniej jeden z n czynników z prawej strony jest równy 0 w Fp. □ Mając ten lemat łatwo dostajemy rzeczone wzmocnienie: TWIERDZENIE 6.12 (Twierdzenie Chevalley’ a-Warninga – 1935) Przy założe- niach twierdzenia T6.11 zachodzi kongruencja card N (G1, . . . , Gr; Fp) ≡ 0 (mod p). (6.30) D O W Ó D. Z ćwiczenia C6.43 wiemy, że suma S(DU ) jest sumą tylu jedynek (w Fp) ile elementów ma zbiór N (G1, . . . , Gr; Fp). Kongruencja (6.30) jest więc równoważna równości S(DU ) = 0 w Fp. W dowodzie T6.11 przekonaliśmy się, że deg DU < (p − 1)n, co oznacza, że w każdym jednomianie γX k1 1 · . . . · X kk n występującym w wielomianie DU co najmniej jeden wykładnik ki jest < p − 1. Więc, na mocy L6.3, S(DU ) = 0. □ Ponieważ liczba całkowita d o d a t n i a i podzielna przez p jest większa od 1, więc jest jasne, że Warning rzeczywiście otrzymał wzmocnienie twierdzenia Chevalley’a. 248 6. Dodatkowe wiadomości o wielomianach 6.5 Wielomiany i liczby Bernoulli’ego Ten paragraf poświęcamy na opowiedzenie o pewnych, ważnych w matematyce, wielomianach. 6.5.1 Sumowanie potęg Liczby i wielomiany Bernoulli’ego pojawiają się przy próbach wyrażania sum Sk(N ) := 1 k + 2k + . . . + N k (6.31) k-tych potęg kolejnych liczb naturalnych (od 1 do N ) jako wartości pewnych wielomianów. Z 1.1.2 P wiemy, że S1(N ) = 1 2N 2+ 1 2N , a z C1.2.1, że S2(N ) = 1 3N 3+ 1 2N 2+ 1 6N . Pokażemy prostą rekurencyjną (wymyśloną przez Jacoba Bernoulli’ego) procedurę wyrażania Sk(N ) za pomocą S1(N ), S2(N ), . . . , Sk−1(N ). Wzór dwumienny (1.7) daje równość: (n + 1)k+1 = ( k + 1 0 )n k+1 + ( k + 1 1 ) nk + . . . + (k + 1 k )n + (k + 1 k + 1 ) . Przesumujmy to w zakresie od n = 1 do n = N . Dostajemy N∑ n=1 (n + 1)k+1 = N∑ n=1 n k+1 + ( k + 1 1 ) N∑ n=1 nk + . . . + (k + 1 k ) N∑ n=1 n + N∑ n=1 1. Różnica sumy z lewej strony i pierwszej sumy ze strony prawej jest równa (N + 1)k+1 − 1. Stąd (N + 1)k+1 − 1 = k∑ j=0 ( k + 1 j ) Sj(N ), co, po prostym przekształceniu, daje równość rekurencyjną: Sk(N ) = 1 k + 1 ( (N + 1)k+1 − 1 − k−1∑ j=0 ( k + 1 j )Sj(N ) ) . (6.32) Ćwiczenie 6.44 Dowieść, że dla każdego k ∈ Z⩾0 istnieje (jednoznacznie wyznaczony) wielomian Sk(X) ∈ Q[X], którego wartością dla dowolnej liczby naturalnej N jest suma (6.28). Dowieść, że deg Sk(X) = k + 1, a jego współczynnik wiodący jest równy 1 k+1. 6.5.2 Wielomiany i liczby Bernoulli’ego Wyprowadzoną przez Bernoulli’ego równość (6.29) wygodnie jest zapisać w nieco innej postaci. Deﬁnicja 6.10 k-wielomianem Bernoulli’ego nazywamy wielomian Bk(X) := S′ k(X − 1). 6.5. Wielomiany i liczby Bernoulli’ego 249 Ćwiczenie 6.45 Udowodnić, że wielomiany Bernoulli’ego spełniają poniższe warunki: (1) Bk(X + 1) − Bk(X) = kX k−1, (2) B′ k(X) = kBk−1(X), (3) Bk(1 − X) = (−1)kBk(X). Ćwiczenie 6.46 Udowodnić, że Bk(X) jest jedynym takim wielomianem ∈ R[X], że ∫ a+1 a Bk(x)dx = ak dla każdej liczby rzeczywistej a. Ćwiczenie 6.47 Udowodnić, że zachodzi równość wielomianów Sk(X) = Bk(X + 1) − Bk(1) k + 1 . (6.33) Deﬁnicja 6.11 Wartość Bk(1) nazywamy k-tą liczbą Bernoulli’ego i oznaczamy Bk. Ćwiczenie 6.48 Udowodnić, że dla każdego k ∈ Z⩾0 zachodzi równość k∑ j=0 ( k + 1 j ) Bj = k + 1. (6.34) Ćwiczenie 6.49 Udowodnić, że funkcja tworząca ciągu wielomianów 1 k! Bk(X) jest równa ∑ k⩾0 Bk(X) k! T k = T eXT eT − 1, (6.35) gdzie e Z = ∑ k⩾0 (k!) −1Z k, 0! = 1. Rozdział 7 Aproksymacje diofantyczne J’ai fourni ma carri`ere; j’ai acquis quelque c´el´ebrit´e dans les math´ematiques. [...]; je n’ai point fait de mal; il faut bien ﬁnir. (”ostatnie” słowa Lagrange’a) W tym rozdziale zajmiemy się problemem przybliżania liczb rzeczywistych przez liczby wy- mierne. Zaczniemy od twierdzenia Dirichlet’a, wspomnimy o ciągach Farey’a i przejdziemy do głównego tematu tego rozdziału – teorii ułamków łańcuchowych i jej zastosowań do aproksy- macji diofantycznych, niewymierności kwadratowych i równania indyjskiego (Pella). 7.1 Twierdzenie Dirichlet’a Jeżeli mamy liczbę rzeczywistą α, to łatwo jest znaleźć liczby wymierne leżące b l i s k o α. Wybieramy dowolny mianownik k ∈ N i następnie ”skradamy” się do liczby α krokami długo- ści 1 k . Jasne, że znajdziemy taką (dokładnie jedną) liczbę h ∈ Z, że h k ⩽ α < h+1 k . Wówczas, oczywiście, \f \f \f \f α − h k \f \f \f \f < 1 k . Chcemy jednak osiągnąć więcej. Chodzi o to, by używając niezbyt dużych mianowników ”po- dejść” do danej liczby rzeczywistej znacznie bliżej. To jest możliwe: P r z y k ł a d 1. Przyjrzyjmy się następującym przybliżeniom liczby π: 10 −3 < \f \fπ − 22 7 \f \f < 2 · 10 −3, 10 −2 < \f \fπ − 25 8 \f \f < 2 · 10 −2 2 · 10 −7 < \f \fπ − 355 113\f \f < 3 · 10 −7, 10 −3 < \f \fπ − 358 114\f \f < 2 · 10 −3. Widzimy stąd, że przybliżenie π za pomocą ułamków o mianowniku 7 jest 10 razy lepsze niż za pomocą ułamków o mianowniku 8. Mianownik 113 jest zaś ponadtysiąckrotnie lepszy niż mianownik 114. ♦ Pierwsze twierdzenie o aproksymacji (= przybliżeniu) pochodzi od Dirichlet’a. Przy dowo- dzie swojego twierdzenia zastosował on tak zwaną zasadę szuﬂadkową, zobacz KOM . 7.2. Ciągi Farey’a 251 TWIERDZENIE 7.1 (Twierdzenie Dirichlet’ a o aproksymacji ) Dana jest liczba rzeczywista α i liczba naturalna N . Wtedy istnieje taki mianownik k, że 1 ⩽ k ⩽ N oraz \f \f \f \f α − h k \f \f \f \f ⩽ 1 k(N + 1) (7.1) dla odpowiednio dobranego licznika h ∈ Z. D O W Ó D. Rozważmy ciąg (0, {α}, {2α}, . . . , {N α}, 1) długości N +2 (przez {x} ozna- czamy część ułamkową liczby rzeczywistej x, zobacz ustęp 12.1.1) i podzielmy przedział [ 0; 1 ], do którego należą wszystkie wyrazy tego ciągu, na N + 1 podzbiorów (szuﬂadek ) [ 0 N +1; 1 N +1 ] , [ 1 N +1; 2 N +1 ] , . . . , [ N N +1; N +1 N +1 ] . Ponieważ w naszym ciągu jest N +2 wyrazów, a szuﬂadek jest tylko N +1, więc w co najmniej jednej szuﬂadce znajdą się dwa wyrazy ciągu. To oznacza, że istnieje takie 1 ⩽ s ⩽ N , że |1 − {sα}| ⩽ 1 N + 1 , (tzn. 1 i {sα} leżą w tej samej szuﬂadce), l u b istnieje takie 1 ⩽ t ⩽ N , że |{tα} − 0| ⩽ 1 N + 1 , (tzn. {tα} i 0 leżą w tej samej szuﬂadce), l u b istnieją takie 1 ⩽ t < s ⩽ N , że |{sα} − {tα}| ⩽ 1 N + 1 . W pierwszym przypadku kładziemy h = ⌊sα⌋ + 1, k = s, w drugim kładziemy h = ⌊tα⌋, k = t, a w trzecim kładziemy h = ⌊sα⌋ − ⌊tα⌋, k = s − t. □ Ćwiczenie 7.1 Udowodnić, że dla danej liczby rzeczywistej α istnieje n i e s k o ń c z e n i e wiele takich par (h, k) ∈ Z × N, że \f \f \f \f α − h k \f \f \f \f ⩽ 1 k2 . (7.2) 7.2 Ciągi Farey’a Za pomocą tych ciągów można udowodnić pewne wzmocnienie tezy ostatniego ćwiczenia. Deﬁnicja 7.1 Dla danej liczby naturalnej n ⩾ 1, symbolem Fn oznaczamy ciąg usta- wionych w kolejności rosnącej wszystkich ułamków nieskracalnych a b , gdzie 0 ⩽ a ⩽ b ⩽ n i a + b ̸= 0. Na przykład F5 to ciąg (0 1 , 1 5, 1 4, 1 3, 2 5 , 1 2 , 3 5 , 2 3, 3 4, 4 5, 1 1 ) . Ciąg Fn nazywamy n-tym ciągiem Farey’a. 252 7. Aproksymacje diofantyczne TWIERDZENIE 7.2 (Twierdzenie Cauchy’ ego-Farey’ a) Jeżeli a b < c d są dwoma ko- lejnymi ułamkami w danym ciągu Farey’a, to bc − ad = 1. D O W Ó D. Twierdzenie to wyraża prosty fakt geo- metryczny. Weźmy (w prostokątnym kartezjańskim ukła- dzie współrzędnych) punkty K = (b, a), L = (d, c) i O = (0, 0). [Na rysunku 7.1 widzimy przypadek n = 4. Zaznaczyliśmy punkty (t, s) odpowiadające wszystkim ułamkom s/t ciągu F4 w tym punkt K = (2, 1) i punkt L = (3, 2).] Wówczas na brzegu i wewnątrz trójkąta △KLO nie ma żadnych punktów kratowych poza punk- tami K, L, O (należy to szczegółowo uzasadnić!). Trójkąt △KLO ma, na mocy twierdzenia Picka (dowód tego twierdzenia podamy w części GEO poświęconej geometrii kombinatorycznej), pole równe 1 2. Z geometrii analitycznej wiemy, że pole tego trójkąta wynosi 1 2|bc − ad|. Stąd teza. □ 1 2 3 4 4 3 2 1 0 Rys. 7.1 TWIERDZENIE 7.3 Jeżeli a b < k l < c d są trzema kolejnymi ułamkami w danym ciągu Farey’a Fn, to zachodzi równość k l = a + c b + d . D O W Ó D. Z twierdzenia Cauchy’ego-Farey’a wiemy, że bk − al = 1 = cl − dk. Przeto, k(b + d) = l(a + c), czyli k l = a+c b+d . □ Jeżeli a b < c d są dwoma ułamkami, gdzie a, b, c, d ∈ Z⩾0, to ułamek a + c b + d nazywa się mediantą tych dwóch ułamków. Możemy więc powiedzieć, że środkowy wyraz w każdej trójce kolejnych wyrazów danego ciągu Farey’a jest mediantą dwóch skrajnych. Zastosujemy teraz naszą wiedzę o ciągach Farey’a w dowodzie następującego wzmocnienia tezy ćwiczenia C7.1: TWIERDZENIE 7.4 (twierdzenie o aproksymacji diofantycznej ) Dla danej liczby rzeczywistej α istnieje nieskończenie wiele par (h, k) ∈ Z × N, dla których \f \f \f \f α − h k \f \f \f \f < 1 2k2 . (7.3) D O W Ó D. Załóżmy, że α jest liczbą niewymierną, α ∈ ( 0; 1 ). Przypadek ogólny Czy- telnik zechce rozważyć samodzielnie. Pokażemy, że jeżeli α leży między dwoma kolejnymi ułamkami w danym ciągu Fareya Fn, n ⩾ 2, a b < α < c d, 7.3. Ułamki łańcuchowe 253 to co najmniej jeden z ułamków a b lub c d spełnia nierówność (7.3). Istotnie, załóżmy nie wprost, że α − a b ⩾ 1 2b2 i c d − α ⩾ 1 2d2 . Wówczas, po dodaniu stronami i wykorzystaniu T7.2, mamy 1 2d2 + 1 2b2 ⩽ ( c d − α) + (α − a b ) = bc − ad bd = 1 bd, co jest równoważne z b2 + d2 ⩽ 2bd, czyli z (b − d) 2 ⩽ 0. To jednakże jest możliwe tylko, gdy b = d. Ale dwa kolejne ułamki w danym ciągu Fareya Fn, n ⩾ 2, nigdy nie mają równych mianowników (dlaczego?). Sprzeczność. □ U w a g a. Nierówności (7.2) i (7.3) są postaci \f \f \f \f α − h k \f \f \f \f < 1 λk2 , dla stałej λ = 1 i λ = 2. Oczywiście, im większa stała λ tym mniejsze szanse na znale- zienie nieskończenie wielu par (h, k) spełniających nierówność. W ustępie 7.3.3 udowodnimy twierdzenie Hurwitza mówiące, że stała λ = √ 5 jest jeszcze dobra. 7.3 Ułamki łańcuchowe Najefektywniejszej metody przybliżania liczb rzeczywistych liczbami wymiernymi dostarcza teoria ułamków łańcuchowych. Przedstawimy tu tylko jeden ze sposobów tworzenia ułamków łańcuchowych i podamy najbardziej elementarne własności tej konstrukcji. 7.3.1 Kanoniczne rozwinięcia. Reguła Eulera Zaczynamy od tak zwanego kanonicznego rozwinięcia liczby rzeczywistej na ułamek łańcuchowy i ustalamy notacje. Deﬁnicja 7.2 Jeżeli γ = γ0 jest daną liczbą rzeczywistą, to tworzymy ciąg (cn) liczb całkowitych i ciąg (γn) liczb rzeczywistych następująco: cn = ⌊γn⌋ (7.4) i, jeżeli γn ∈ Z, to kończymy procedurę, jeżeli zaś γn /∈ Z, to kładziemy γn+1 = 1 γn − cn . (7.5) Zauważmy, że wszystkie, z wyjątkiem być może γ0, wyrazy ciągu (γn) leżą w przedziale otwar- tym ( 1; ∞ ), a wśród liczb całkowitych cn jedynie liczba c0 może być ujemna – pozostałe są ściśle dodatnie. Liczby ck nazywamy mianownikami, a liczby γk nazywamy pseudomia- nownikami kanonicznego rozwinięcia liczby γ na ułamek łańcuchowy. 254 7. Aproksymacje diofantyczne P r z y k ł a d 1. Weźmy liczbę γ = 43 30. Wówczas c0 = 1, γ1 = 30 13, c1 = 2, γ2 = 13 4 , c2 = 3, γ3 = c3 = 4. ♦ Łatwo zauważyć ścisły związek między kanonicznym rozwinięciem liczby wymiernej na uła- mek łańcuchowy a algorytmem Euklidesa wyznaczania największego wspólnego dzielnika. Ćwiczenie 7.2 Opisać ten związek. P r z y k ł a d 2. Weźmy liczbę γ = √2. Wówczas c0 = 1, γ1 = 1 √ 2 − 1 = √2 + 1, c1 = 2, γ2 = 1 √ 2 + 1 − 2 = γ1. Tym razem otrzymaliśmy nieskończone ciągi (ci) = (1, 2, 2, 2, . . . ), (γi) = (√ 2, √2 + 1, √2 + 1, √ 2 + 1, . . . ). ♦ Przyjrzyjmy się jeszcze innym przykładom: Stosując opisany w D7.2 algorytm, znajdujemy przykładowe Ciągi mianowników kanonicznych rozwinięć liczb √D na ułamki łańcuchowe D Ciąg mianowników rozwinięcia √D A B A 2 − DB2 2 (1, 2) 1 1 −1 3 (1, 1, 2) 2 1 +1 5 (2, 4) 2 1 −1 6 (2, 2, 4) 5 2 +1 7 (2, 1, 1, 1, 4) 8 3 +1 8 (2, 1, 4) 3 1 +1 10 (3, 6) 3 1 −1 11 (3, 3, 6) 10 3 +1 12 (3, 2, 6) 7 2 +1 13 (3, 1, 1, 1, 1, 6) 18 5 −1 14 (3, 1, 2, 1, 6) 15 4 +1 19 (4, 2, 1, 3, 1, 2, 8) 170 39 +1 21 (4, 1, 1, 2, 1, 1, 8) 55 12 +1 31 (5, 1, 1, 3, 5, 3, 1, 1, 10) 1520 273 +1 43 (6, 1, 1, 3, 1, 5, 1, 3, 1, 1, 12) 3482 531 +1 46 (6, 1, 3, 1, 1, 2, 6, 2, 1, 1, 3, 1, 12) 24335 3588 +1 Jak widzimy wszystkie otrzymane ciągi mianowników są okresowe (okres zaznaczono kreską) i okres rozpoczyna się od miejsca c1. Znaczenie trzeciej, czwartej i piątej kolumny zostanie wyjaśnione w 11.4.1 i 11.4.4. 7.3. Ułamki łańcuchowe 255 Ćwiczenie 7.3 Rozwinąć na ułamek łańcuchowy liczby 1 + √5 2 i √ n2 + 1. Ćwiczenie 7.4 Udowodnić, że kanoniczne rozwinięcie liczby γ ∈ R na ułamek łańcuchowy jest skończone wtedy i tylko wtedy, gdy γ jest liczbą wymierną. Łatwo zobaczyć, że jeżeli istnieją wypisane wyrazy (w kanonicznym rozwinięciu liczby γ), to zachodzi równość γ = c0 + 1 c1 + 1 c2 + 1 γ3 . (7.6) Pisanie ułamków takich jak (7.6) jest kłopotliwe, wprowadzimy więc specjalne skróty: Deﬁnicja 7.3 Niech X, X0, X1, X2, . . . będą zmiennymi. Określamy indukcyjnie ⟨X⟩ = X, ⟨X0, X1, . . . , Xn⟩ = X0 + 1 ⟨X1, X2, . . . , Xn⟩. Na przykład mamy ⟨c0, c1, c2, γ3⟩ = c0 + 1 ⟨c1, c2, γ3⟩ = c0 + 1 c1 + 1 ⟨c2, γ3⟩ = c0 + 1 c1 + 1 c2 + 1 γ3 = γ, na mocy (7.6). Ogólnie, dla dowolnego n ⩾ 0 zachodzi równość γ = ⟨c0, c1, . . . , cn−1, γn⟩, (7.7) gdzie ck = ⌊γk⌋ są liczbami określonymi przez (7.4) i (7.5). U w a g a. W literaturze spotyka się inne sposoby ”jednolinijkowego” zapisu ułamków postaci (7.6). Najczęstszym jest taki: c0 + 1 c1 + | 1 c2 + | 1 c3 + | 1 γ4 . Z drugiej strony możemy przedstawiać ułamki łańcuchowe w postaci zwykłych ułamków. Na przykład ułamek (7.6) jest, jak łatwo sprawdzić, równy c0c1c2γ3 + c2γ3 + c0γ3 + c0c1 + 1 c1c2γ3 + γ3 + c1 Poeksperymentowawszy nieco z takimi zapisami przekonujemy się, że zachodzą równości ⟨X0, X1, . . . , Xn⟩ = K(X0, X1, . . . , Xn) K(X1, X2, . . . , Xn), (7.8) 256 7. Aproksymacje diofantyczne gdzie K są wielomianami wypisanych zmiennych. Wielomian K(Y1, Y2, . . . , Ys) nazwiemy kontynuantą zmiennych Y1, . . . , Ys. To, że zarówno w liczniku jak i w mianowniku stoi kon- tynuanta, nie jest niczym dziwnym: wszak mianownik ułamka ⟨X0, X1, . . . , Xn⟩ jest, zgodnie z D7.3, r ó w n y licznikowi ułamka ⟨X1, . . . , Xn⟩. Jeżeli (Y1, Y2, . . . , Ys) jest ciągiem (kolejność jest w a ż n a) zmiennych, to iloczyn po- staci Yi1Yi2 · . . . · Yir, gdzie 1 ⩽ i1 < i2 < · · · < ir ⩽ s, nazwiemy wyróżnionym, gdy zbiór {1, 2, . . . , s} ∖ {i1, i2, . . . , ir} da się przedstawić w postaci sumy r o z ł ą c z n e j zbiorów dwu- elementowych postaci {k, k+1}. W szczególności iloczyn ”pełny” Y1Y2·. . .·Ys jest wyróżniony. Również wyróżnionym jest iloczyn pusty, z deﬁnicji równy 1, w przypadku, gdy s ≡ 0 (mod 2). REGUŁA EULERA K(Y1, Y2, . . . , Ys) jest sumą wszystkich iloczynów wyróżnionych. Ćwiczenie 7.5 Udowodnić poprawność Reguły Eulera. Wskazówka. Korzystając z deﬁ- nicji D7.3 udowodnić tożsamość K(Y1, Y2, . . . , Ys) = Y1K(Y2, . . . , Ys) + K(Y3, . . . , Ys). 7.3.2 Nieskończone ułamki łańcuchowe Oznaczmy przez C zbiór wszystkich takich ciągów nieskończonych (cn)n⩾0 o wyrazach cał- kowitych, że cn ⩾ 1 dla wszystkich n ̸= 0. W poprzednim ustępie zdeﬁniowaliśmy funkcję M : R ∖ Q −→ C , która liczbie niewymiernej γ przyporządkowuje ciąg (c0, c1, c2, . . . ) mia- nowników kanonicznego rozwinięcia liczby γ na ułamek łańcuchowy. Teraz przekonamy się, że funkcja M jest b i j e k c j ą zbioru R ∖ Q liczb niewymiernych n a zbiór C . Deﬁnicja 7.4 Niech (c0, c1, c2, c3, . . . ) będzie dowolnym elementem zbioru C . Liczbę Rn = ⟨c0, c1, c2, . . . , cn⟩ = Pn Qn , gdzie Pn = K(c0, c1, . . . , cn), Qn = K(c1, c2, . . . , cn) (porównaj równości (7.8)), nazywamy n-tym reduktem (nieskończonego) ułamka łańcuchowego ⟨c0, c1, c2, c3, . . . ⟩. Wygodnie jest też przyjąć, że P−1 = 1, Q0 = 1, Q−1 = 0. Łatwo spostrzec rekurencyjne zależności między wielomianami Pn i Qn: Ćwiczenie 7.6 Udowodnić przez indukcję, że dla n ⩾ 1 zachodzą tożsamości Pn = cnPn−1 + Pn−2, (7.9) Qn = cnQn−1 + Qn−2, (7.10) PnQn−1 − QnPn−1 = (−1) n−1. (7.11) Wskazówka. Tożsamości (7.11) dowodzi się za pomocą oczywistej indukcji korzystając z toż- samości (7.9) i (7.10), których prawdziwość wynika natychmiast z Reguły Eulera. Ćwiczenie 7.7 Udowodnić, że Qn+1 > Qn ⩾ n dla każdego n ⩾ 1. TWIERDZENIE 7.5 Ciąg (Rn) jest (oscylującym) ciągiem zbieżnym. 7.3. Ułamki łańcuchowe 257 D O W Ó D. Korzystając z równości (7.9) i (7.10) możemy zapisać dla dowolnego n ⩾ 0 Rn+2 − Rn = Pn+2 Qn+2 − Pn Qn = cn+2Pn+1 + Pn cn+2Qn+1 + Qn − Pn Qn = cn+2(Pn+1Qn − Qn+1Pn) Qn(cn+2Qn+1 + Qn) . To, dzięki równości (7.11), daje: Rn+2 − Rn = cn+2 · (−1) n Qn(cn+2Qn+1 + Qn). (7.12) Ponieważ liczby cn+2 i Qk są dodatnie, więc równość (7.12) pokazuje, że R2k+3 − R2k+1 < 0 i R2k+2 − R2k > 0 (7.13) dla dowolnego k ⩾ 0. Nierówności (7.13) mówią, że parzystoindeksowy podciąg (R2k) ciągu reduktów jest ciągiem (ściśle) rosnącym, a nieparzystoindeksowy podciąg (R2k+1) jest ciągiem (ściśle) malejącym. Podobnie obliczamy: R2k+1 − R2k = (−1) 2k Q2kQ2k+1 = 1 Q2kQ2k+1 . (7.14) Z tej równości widać, że R2k < R2k+1 dla wszystkich k ⩾ 0. W rzeczywistości k a ż d y wyraz R2n jest mniejszy niż k a ż d y wyraz R2m+1. Aby to uzasadnić połóżmy k = max(n, m). Wtedy, na mocy już udowodnionego, R2n ⩽ R2k < R2k+1 ⩽ R2m+1. Położenie reduktów na osi liczbowej pokazujemy (schematycznie) poniżej: Rys. 7.2 2n+12n 2n+22n 2 _ 2n 1_ 2n 3__R R R R R R a kk kkkk kk kkg Ciąg rosnący (R2k) i ograniczony od góry (przez R1 na przykład) ma granicę. Oznaczmy ją przez γ. Łatwo widzieć, że γ < R2k+1 dla każdego k. Istotnie, gdyby γ ⩾ R2k+1, to γ > R2k+3 i w przedziale ( R2k+3, γ ) znaleźlibyśmy pewien (naprawdę nieskończenie wiele) wyraz R2m, co jest niemożliwe. Ciąg (R2k+1), jako malejący i ograniczony od dołu przez γ, ma granicę γ′ ⩾ γ. Dowód twierdzenia będzie skończony, gdy uzasadnimy, że γ′ = γ. Załóżmy więc nie wprost, że γ′ − γ = ε > 0. Wtedy ε = γ′ − γ ⩽ R2k+1 − R2k = 1 Q2kQ2k+1 ⩽ 1 2k(2k + 1) dla każdego k, na mocy (7.14) i tezy ćwiczenia C7.7. Jasne, że to jest niemożliwe. □ Granicę γ nazywamy wartością nieskończonego ułamka łańcuchowego ⟨c0, c1, c2, . . . ⟩ wy- znaczonego przez ciąg (cn) ∈ C i piszemy γ = ⟨c0, c1, c2, . . . ⟩. W ten sposób określiliśmy funkcję W : C −→ R, która ciągowi (cn)n⩾0 przyporządkowuje wartość W((cn)) = ⟨c0, c1, . . . ⟩ nieskończonego ułamka łańcuchowego. 258 7. Aproksymacje diofantyczne Spróbujmy teraz kanonicznie rozwinąć otrzymaną liczbę γ = ⟨c0, c1, . . . ⟩ na ułamek łań- cuchowy, czyli wyznaczyć ciąg M(γ). Z dowodu T7.5 wiemy, że c0 = R0 < γ < R1 = c0 + 1 c1 . To dowodzi, że ⌊γ⌋ = c0 (bowiem z założenia c1 ⩾ 1). Zatem c0 jest zerowym mianownikiem kanonicznego rozwinięcia liczby γ na ułamek łańcuchowy. Ogólniej, jeżeli przez γn oznaczymy wartość ⟨cn, cn+1, cn+2, . . . ⟩, to cn < γn < cn + 1 cn+1 co dowodzi, że cn = ⌊γn⌋ dla każdego n. Udowodniliśmy w ten sposób, że jeżeli γ = ⟨c0, c1, c2, . . . ⟩ jest wartością nieskończonego ułamka łańcuchowego wyznaczonego przez ciąg (cn) ∈ C , to n-tym mianownikiem kanonicz- nego rozwinięcia liczby γ na ułamek łańcuchowy jest liczba cn (a n-tym pseudomianownikiem jest wartość γn = ⟨cn, cn+1, . . . ⟩). To oznacza, że M ◦ W = IdC . Mamy więc udowodnioną pierwszą połowę ważnego twierdzenia: TWIERDZENIE 7.6 Funkcja M : R ∖ Q −→ C jest bijekcją. D O W Ó D. Pozostało nam uzasadnić, że W ◦ M = IdR∖Q, czyli że jeżeli γ jest dowolną liczbą rzeczywistą niewymierną, a c0, c1, c2, . . . są mianownikami jej kanonicznego rozwinięcia na ułamek łańcuchowy, to limn→∞ ⟨c0, c1, . . . , cn⟩ = γ. Otóż, ponieważ γ = ⟨c0, c1, . . . , cn−1, γn⟩ = γnPn−1 + Pn−2 γnQn−1 + Qn−2 (7.15) (patrz (7.7), (7.8), (7.9) i (7.10)), więc widzimy, że odległość |γ − ⟨c0, c1, . . . , cn⟩| jest równa \f \f \f \f γnPn−1 + Pn−2 γnQn−1 + Qn−2 − cnPn−1 + Pn−2 cnQn−1 + Qn−2 \f \f \f \f = \f \f \f \f (γn − cn) · (−1) n−2 (γnQn−1 + Qn−2)(cnQn−1 + Qn−2) \f \f \f \f . Odległość ta jest zatem dowolnie mała dla wszystkich dostatecznie dużych n (bo cn = ⌊γn⌋, więc |γn − cn| < 1, a γnQn−1 + Qn−2 > cnQn−1 + Qn−2 ⩾ 2n − 3, zobacz C7.7). □ WNIOSEK Dla dowolnego ciągu (cn) ∈ C wartość ⟨c0, c1, c2, . . . ⟩ nieskończonego ułamka łańcuchowego jest liczbą niewymierną. □ Opisana przez twierdzenie T7.6 wzajemnie jednoznaczna odpowiedniość M : R ∖ Q ∋ γ ←→ (c0, c1, c2, . . . ) ∈ C : W między liczbami niewymiernymi a nieskończonymi ciągami mianowników ich kanonicznych roz- winięć na ułamki łańcuchowe pozwala w dalszym ciągu mówić sensownie o reduktach liczb niewymiernych. n-ty redukt ⟨c0, c1, . . . , cn⟩ liczby niewymiernej γ oznaczamy Rn(γ). Ćwiczenie 7.8 Udowodnić, że kolejne redukty Rn = Rn(γ) są coraz lepszymi przybliże- niami liczby niewymiernej γ, to znaczy: |γ − R0| > |γ − R1| > |γ − R2| > . . . > |γ − Rn| > . . . . Ćwiczenie 7.9 Udowodnić tak zwane prawo najlepszego przybliżenia: Jeżeli dana liczba wymierna h k , gdzie h ∈ Z, k ∈ N, lepiej przybliża daną liczbę niewymierną γ niż n-ty redukt Rn(γ), gdzie n ⩾ 1, to mianownik k jest większy niż mianownik Qn reduktu Rn = Rn(γ): \f \f \f \f γ − h k \f \f \f \f < \f \f \f \f γ − Pn Qn \f \f \f \f =⇒ k > Qn. 7.3. Ułamki łańcuchowe 259 P r z y k ł a d. Dzięki rozwinięciom pokazanym w tabelce z ustępu 7.3.1 wyznaczamy kolejne redukty Rn( √2): R0 = ⟨1⟩ = 1, R1 = ⟨1, 2⟩ = 3/2, R2 = ⟨1, 2, 2⟩ = 7/5, R3 = ⟨1, 2, 2, 2⟩ = 17/12, R4 = ⟨1, 2, 2, 2, 2⟩ = 41/29, R5 = ⟨1, 2, 2, 2, 2, 2⟩ = 99/70. Przyjrzyjmy się jak dobrze przybliżają one √ 2: | √2 − R0| ≈ 0, 414216, | √2 − R1| ≈ 0, 085786, | √2 − R2| ≈ 0, 014214, | √2 − R3| ≈ 0, 002453, | √2 − R4| ≈ 0, 000420, | √2 − R5| ≈ 0, 000072. Przybliżenia podajemy w zapisie dziesiętnym, by łatwiej widzieć ich ”dobroć”. ♦ 7.3.3 Złota liczba. Twierdzenie Hurwitza Poznamy teraz jedną liczbę niewymierną w pewnym sensie najgorzej przybliżalną liczbami wy- miernymi. Następnie udowodnimy metodą Borela zapowiedziane w paragraﬁe 7.2 twierdzenie Hurwitza. Deﬁnicja 7.5 Liczbę τ = 1 + √5 2 nazywamy liczbą złotą. U w a g a. Czytelnik, który rozwiązał C7.3, być może postawił hipotezę, skąd się bierze taka nazwa. I być może wymyślił, że τ jest ”najprostszą” liczbą niewymierną w przy- rodzie matematycznej. (Liczby równoważne liczbie złotej również czasami nazywamy liczbami złotymi.) Tymczasem to już staro- żytni Grecy natraﬁli na tę liczbę poszukując ”najbardziej prostokątnego” prostokąta czyli takiego, który nie jest ”za długi” ani ”za kwadratowy”. Uznano, że jest tylko jeden (z d o k ł a d n o ś c i ą d o p o d o b i e ń s t w a) taki prostokąt: mianowicie prostokąt ABCD, Rys. 7.2 A B CD K L który jest sumą kwadratu AKLD i prostokąta LKBC ∼ ABCD, zobacz rysunek 7.2. Ćwiczenie 7.10 Co to ma wspólnego z równością τ = ⟨1, 1, 1, . . . ⟩ ? Ćwiczenie 7.11 Uzasadnić, że n-ty redukt liczby złotej jest równy fn+2/fn+1, gdzie fn oznacza n-tą liczbę Fibonacci’ego, zobacz rozdział 9. W trakcie dowodu poniższego twierdzenia Hurwitza możemy zauważyć ważną rolę jaką gra liczba złota (istotny jest fakt, że prawie wszystkie mianowniki liczby złotej są najmniejsze możliwe). TWIERDZENIE 7.7 (Hurwitz – 1891) Dla danej liczby rzeczywistej γ istnieje nieskoń- czenie wiele takich par (h, k) ∈ Z × N, że \f \f \f \f γ − h k \f \f \f \f < 1 √ 5k2 . (7.16) 260 7. Aproksymacje diofantyczne D O W Ó D. Udowodnimy, że jeżeli Pn/Qn, Pn+1/Qn+1, Pn+2/Qn+2 są kolejnymi reduk- tami liczby niewymiernej γ, to co najmniej jedna z par (h, k) = (Pn, Qn), (Pn+1, Qn+1), (Pn+2, Qn+2) spełnia nierówność (7.16). Rozpoczniemy od następującej obserwacji: O b s e r w a c j a. Załóżmy, że a/b < c/d są takimi liczbami wymiernymi, że b, d > 0 i bc − ad = 1. Wówczas, jeżeli c/d − a/b ⩾ 1/ √ 5b2 + 1/ √5d2, to 1/τ < b/d < τ . D o w ó d o b s e r w a c j i. Założona nierówność jest równoważna √5b/d ⩾ 1 + b2/d 2 (widać to po obustronnym pomnożeniu przez √ 5b2). To oznacza, że wartość wielomianu f (X) = X 2 − √ 5X + 1 dla argumentu x = b d jest liczbą niedodatnią. Ponieważ pierwiastkami tego wielomianu są liczby τ i 1 τ , więc widzimy, że 1 τ ⩽ b d ⩽ τ . Nierówności są w istocie ścisłe, bo τ jest liczbą niewymierną. Q.e.d. Przechodzimy do dowodu twierdzenia. Załóżmy, nie wprost, że nierówność (7.16) nie za- chodzi dla żadnej z trzech wymienionych par (h, k). To znaczy, że zachodzą nierówności \f \f \f \f γ − Pn Qn \f \f \f \f ⩾ 1 √5Q2 n , \f \f \f \f γ − Pn+1 Qn+1 \f \f \f \f ⩾ 1 √5Q 2 n+1 , \f \f \f \f γ − Pn+2 Qn+2 \f \f \f \f ⩾ 1 √ 5Q2 n+2 . (7.17) Z dowodu T7.5 wiemy, że kolejne redukty liczby niewymiernej leżą z różnych stron tej liczby. Wobec tego (P) Pn Qn < Pn+2 Qn+2 < γ < Pn+1 Qn+1 lub (N) Pn+1 Qn+1 < γ < Pn+2 Qn+2 < Pn Qn w zależności od tego, czy n jest liczbą parzystą czy nieparzystą. Nierówności (7.17) dają więc w przypadku (P): Pn+1 Qn+1 − Pn Qn = \f \f \f \f Pn+1 Qn+1 − γ \f \f \f \f + \f \f \f \f γ − Pn Qn \f \f \f \f ⩾ 1 √5Q 2 n+1 + 1 √5Q2 n , Pn+1 Qn+1 − Pn+2 Qn+2 = \f \f \f \f Pn+1 Qn+1 − γ \f \f \f \f + \f \f \f \f γ − Pn+2 Qn+2 \f \f \f \f ⩾ 1 √5Q 2 n+1 + 1 √5Q 2 n+2 . Dzięki o b s e r w a c j i (zobacz też (7.11)) mamy stąd 1 τ < Qn+1 Qn < τ, 1 τ < Qn+1 Qn+2 < τ. (7.18) [Analogicznie dowodzimy nierówności (7.18) w przypadku nieparzystym (N).] Nierówności (7.18) pozwalają napisać (pamiętamy o równości (7.10) i nierówności cn+2 ⩾ 1) τ > Qn+2 Qn+1 = cn+2Qn+1 + Qn Qn+1 = cn+2 + Qn Qn+1 > 1 + 1 τ , co jest niemożliwe, bo τ = 1 + 1/τ . □ Ćwiczenie 7.12 Udowodnić, że istnieje nieskończenie wiele takich par (h, k) ∈ Z × N, że | √ 2 − h/k| < 1/ √8k2. Ćwiczenie 7.13 Udowodnić, że jeżeli τ jest liczbą złotą, λ > √5, to istnieje tylko s k o ń c z e n i e w i e l e takich par (h, k) ∈ Z × N, że |τ − h/k| < 1/λk2. 7.3. Ułamki łańcuchowe 261 7.3.4 Grupa GL2(Z) W tym ustępie poznamy pierwszą ważną w teorii liczb grupę n i e p r z e m i e n n ą. Przed dal- szym czytaniem należy zapoznać się z ustępami 9.4.1 i 9.4.2, gdzie poznajemy macierze 2 × 2 i ich wyznaczniki. Iloczyn macierzy A, B oznaczamy A · B lub AB. Macierz odwrotną da- nej macierzy A ∈ GL2(Z) oznaczamy symbolem A−1. Wyznaczona jest ona (jednoznacznie!) przez zależność AA−1 = A−1A = E, gdzie E = ( 1 0 0 1) jest macierzą jednostkową. Zbiór wszystkich macierzy ( a b c d) o wyrazach całkowitych i wyznaczniku ad − bc = ±1 oznaczamy symbolem GL2(Z). P r z y k ł a d. Jeżeli Pn/Qn, Pn+1/Qn+1 są dwoma kolejnymi reduktami danej liczby niewy- miernej γ, to macierz (Pn Pn+1 Qn Qn+1 ) (7.19) należy do GL2(Z), zobacz (7.11). Jeżeli a b < c d są dwoma kolejnymi wyrazami ciągu Farey’a Fn, to ( a c b d) ∈ GL2(Z), zobacz T7.2. ♦ Ćwiczenie 7.14 Udowodnić, że (GL2(Z), ·), gdzie · jest mnożeniem macierzy, jest grupą. Zobacz D1.5. Wskazówka. Elementem neutralnym jest macierz jednostkowa E. Sprawdzić, że ( a b c d)−1 = ( wd −wb −wc wa ) , gdzie w = ad − bc. Ćwiczenie 7.15 Udowodnić, że podzbiór SL2(Z) zbioru GL2(Z) składający się z macie- rzy o wyznaczniku równym +1 jest podgrupą grupy GL2(Z), zobacz D5.8. Wprowadzimy specjalne oznaczenia czterech elementów grupy GL2(Z): T = (1 1 0 1 ) , S = ( 0 −1 1 0 ) , J = ( 0 1 1 0 ) , R = (−1 0 0 1 ) . (7.20) Macierze T i S należą do podgrupy SL2(Z). Zaś J, R ∈ GL2(Z) ∖ SL2(Z). Ćwiczenie 7.16 Udowodnić, że macierz S jest elementem rzędu 4, a macierze J i R są elementami rzędu 2 w grupie GL2(Z). Macierz T jest elementem rzędu nieskończonego. TWIERDZENIE 7.8 Każda macierz, A ∈ GL2(Z) da się przedstawić w postaci iloczynu potęg (o wykładnikach ∈ Z) macierzy T, S i R. D O W Ó D. Niech A = ( a b c d ) . Rozważymy najpierw przypadek, gdy b = 0. Wówczas ad = ±1. Zatem a ∈ {+1, −1} i d ∈ {+1, −1}. Łatwo sprawdzić, że (1 0 c 1 ) = JTcJ, (1 0 c −1 ) = JTcS, (−1 0 c 1 ) = ST cJ, ( −1 0 c −1 ) = STcS. (7.21) 262 7. Aproksymacje diofantyczne Ponieważ J = RS, więc w przypadku b = 0 teza jest prawdziwa. Pokażemy teraz metodę zmniejszania ”b”, gdy b ̸= 0. W takim przypadku zapiszmy a = qb + r, gdzie 0 ⩽ r < |b|. Równość (a b c d ) = (b r d s ) (q 1 1 0 ) = (b r d s ) TqRS, jak łatwo sprawdzić, zachodzi dla s = c − qd. Mamy bs − rd = b(c − qd) − (a − qb)d = bc − ad = ±1, zatem (b r d s) ∈ GL2(Z). Jeżeli r = 0, to jedna z równości (7.21) pozwala zakończyć rozumowanie. Jeżeli zaś r > 0, to powtarzamy sztukę: jeżeli b = q1r + r1 i s1 = d − q1s, to ( a b c d ) = (b r d s ) T qRS = (r r1 s s1 ) Tq1RST qRS. Postępując tak dalej widzimy, że kolejne linijki algorytmu Euklidesa (2.8) pozwalają zapisać równość A = ( rn−1 0 sn−1 sn)T qnRS · . . . · Tq1RSTqRS, gdzie rn−1 jest ostatnią niezerową resztą w algorytmie (czyli, jak wiemy rn−1 = NWD (a, b) = 1). To kończy dowód. □ Ćwiczenie 7.17 Przedstawić macierz ( 11 71 2 13 ) w postaci iloczynu potęg macierzy T, S. 7.3.5 Równoważność liczb Powiemy parę słów na temat pewnej relacji równoważności w zbiorze liczb rzeczywistych. Re- lacja ta jest ściśle związana z (kanonicznym) rozwijaniem liczb na ułamki łańcuchowe. Deﬁnicja 7.6 Liczby γ, β ∈ R nazywamy równoważnymi, co zapisujemy γ ≃ β, gdy istnieją takie liczby całkowite a, b, c, d, że |ad − bc| = 1 oraz β = aγ + b cγ + d . (7.22) Równość (7.22) będziemy w dalszym ciągu zapisywać w postaci: β = A(γ), gdzie A = (a b c d ) ∈ GL2(Z). Ćwiczenie 7.18 Udowodnić, że jeżeli A, B ∈ GL2(Z), to dla dowolnej liczby γ ∈ R zachodzą warunki: (1) A(B(γ)) = (AB)(γ), (2) β = A(γ) ⇔ γ = A−1(β) (7.23) Ćwiczenie 7.19 Udowodnić, że relacja ≃ jest relacją równoważności, zobacz KOM . Ćwiczenie 7.20 Udowodnić, że każde dwie liczby wymierne są równoważne i że każda liczba równoważna liczbie wymiernej jest liczbą wymierną. Innymi słowy, zbiór Q liczb wy- miernych jest klasą równoważności względem relacji ≃. 7.3. Ułamki łańcuchowe 263 Ćwiczenie 7.21 Udowodnić, że jeżeli γ = γ0 jest liczbą rzeczywistą niewymierną i (γn) jest opisanym w deﬁnicji D7.2 ciągiem pseudomianowników, to dla każdego n zachodzi γ ≃ γn i, ogólniej, γn ≃ γm dla dowolnych n, m. Wskazówka. Zobacz (7.15) i (7.11). Ogonem ciągu nieskończonego (xn)n⩾0 nazwiemy podciąg (xs+n)n⩾0. Opisana w deﬁnicji D7.2 procedura przyporządkowuje liczbie rzeczywistej γ jednoznacznie wyznaczony ciąg mianowników M(γ) = (cn)n⩾0. Wiemy, zobacz C7.4, że ciąg M(γ) jest skończony wtedy i tylko wtedy, gdy γ ∈ Q. Ćwiczenie 7.22 Udowodnić, że jeżeli γ jest liczbą niewymierną, to pewien ogon ciągu M(γ + 1) równy jest pewnemu ogonowi ciągu M(γ). Ćwiczenie 7.23 Udowodnić, że jeżeli γ jest liczbą niewymierną, to pewien ogon ciągu M(1/γ) równy jest pewnemu ogonowi ciągu M(γ). Ćwiczenie 7.24 Udowodnić, że jeżeli γ = ⟨c0, c1, c2, . . . ⟩ jest wartością nieskończonego ułamka łańcuchowego, to pewien ogon ciągu M(−γ) równy jest pewnemu ogonowi ciągu M(γ). Dokładniej: M(−γ) = (−c0 − 1, c2 + 1, c3, c4, . . . ), gdy c1 = 1, natomiast, gdy c1 ⩾ 2, to M(−γ) = (−c0 − 1, 1, c1 − 1, c2, c3, . . . ). TWIERDZENIE 7.9 Liczby niewymierne γ i β są równoważne wtedy i tylko wtedy, gdy pewien ogon ciągu M(γ) r ó w n y jest pewnemu ogonowi ciągu M(β). D O W Ó D. Jeżeli ciągi (cn) = M(γ) i (bn) = M(β) mają równe ogony, to γk = βl dla pewnych indeksów k, l. Wtedy, na mocy C7.21 i C7.19, γ ≃ γk = βl ≃ β, więc γ ≃ β. Odwrotnie, gdy γ = A(β) dla pewnej macierzy A ∈ GL2(Z), to korzystając z opisanego w twierdzeniu T7.8 rozkładu macierzy A i faktu, że T(γ) = γ + 1, R(γ) = −γ, RS(γ) = 1/γ, kończymy dowód dzięki C7.22, C7.23 i C7.24. Czytelnik powinien samodzielnie uzupełnić odpowiednie szczegóły rozumowania. □ 7.3.6 Niewymierności kwadratowe Niewymierności kwadratowe są najprostszymi liczbami niewymiernymi, a ich rozwinięcia na ułamki łańcuchowe są szczególnie sympatyczne. Zobaczymy to w kolejnych ustępach. Deﬁnicja 7.7 Liczbę niewymierną γ ∈ R nazywamy niewymiernością kwadratową, gdy istnieje taki trójmian kwadratowy f (X) = AX 2 + BX + C ∈ Z[X] (A ̸= 0), że f (γ) = 0. Zbiór wszystkich niewymierności kwadratowych oznaczymy symbolem Q. Znane ze szkoły wzory na pierwiastki równania kwadratowego, porównaj (3.10), pokazują, że każda niewymierność kwadratowa jest postaci x + √∆ y , (7.24) gdzie x, y, ∆ są liczbami całkowitymi, przy czym ∆ jest liczbą naturalną nie będącą kwadra- tem, a √∆ oznacza p i e r w i a s t e k a r y t m e t y c z n y (= dodatni). 264 7. Aproksymacje diofantyczne ZADANIE 7.1 Udowodnić, że jeżeli liczba niewymierna γ jest pierwiastkiem trójmianów AX 2 + BX + C, A ′X 2 + B′X + C ′ ∈ Z[X] i NWD (A, B, C) = 1, to istnieje taka liczba d ∈ Z, że A ′ = dA, B′ = dB, C ′ = dC. R o z w i ą z a n i e. Oznaczmy f (X) = AX 2 + BX + C i g(X) = A ′X 2 + B′X + C ′. W ustępie 6.3.1 dowiedzieliśmy się, że istnieje taka liczba w y m i e r n a d, że g(X) = df (X). Oba wielomiany f (X), g(X) są bowiem generatorami ideału Iγ, zobacz C6.15. W naszym aktualnym przypadku rozumowanie wygląda następująco: Oznaczmy d = A ′/A. Równość g(X) − df (X) = (B′ − dB)X + C ′ − dC pokazuje, że γ jest pierwiastkiem wielomianu (B′ − dB)X + C ′ − dC. Stąd, ponieważ γ jest liczbą niewymierną, wnioskujemy, że B′ − dB = 0 i następnie, że C ′ − dC = 0. Wobec tego A ′ = dA, B′ = dB i C ′ = dC. Czyli AB′ = A ′B i AC ′ = A ′C. Mamy wykazać, że d = A ′/A ∈ Z. Załóżmy, że nie, czyli że istnieje liczba pierwsza p|A, ale p ∤ A ′. Wtedy, na mocy T2.15, p|B i p|C. To jest niemożliwe, bo z założenia NWD (A, B, C) = 1. ♦ Widzimy, że każda niewymierność kwadratowa γ wyznacza j e d n o z n a c z n i e taki trój- mian f (X) = AX 2 + BX + C ∈ Z[X], że f (γ) = 0, NWD (A, B, C) = 1 i A > 0. Nazwijmy go trójmianem minimalnym niewymierności (kwadratowej) γ. Wyróżnik ∆ = B2 − 4AC tego trójmianu nazwiemy wyróżnikiem niewymierności kwadratowej γ. Zbiór wszystkich niewymierności kwadratowych o wyróżniku ∆ oznaczymy symbolem Q(∆). Ćwiczenie 7.25 Uzasadnić, że wyróżnik ∆ niewymierności kwadratowej spełnia warunek ∆ ≡ 0, 1 (mod 4). Udowodnić też, że każda liczba naturalna ∆ spełniająca ten warunek i nie będąca kwadratem jest wyróżnikiem co najmniej jednej niewymierności kwadratowej. Z każdą niewymiernością kwadratową γ związana jest jednoznacznie liczba γ′ będąca dru- gim pierwiastkiem trójmianu minimalnego niewymierności γ. Wiemy ze szkoły, że jeżeli γ jest zadana przez (7.24), to γ′ = x− √∆ y . Liczbę γ′ nazywamy sprzężoną z (niewymiernością kwadratową) γ. Niewymierność kwadratowa γ i jej sprzężona γ′ mają ten sam wyróżnik (bo mają ten sam trójmian minimalny). Ćwiczenie 7.26 Udowodnić, że jeżeli γ ∈ R jest niewymiernością kwadratową, to γ′ jest j e d y n ą taką liczbą rzeczywistą, że γ + γ′ i γγ′ są liczbami wymiernymi. ZADANIE 7.2 Udowodnić, że jeżeli γ ∈ Q(∆), a A ∈ GL2(Z), to A(γ) ∈ Q(∆). Ponadto A(γ) ′ = A(γ′). R o z w i ą z a n i e. Niech AX 2 + BX + C ∈ Z[X] będzie trójmianem minimalnym liczby γ. Niech β = A(γ). Sprawdzamy, czy teza zachodzi dla trzech konkretnych macierzy A. (1) Niech A = T. Wówczas β = γ + 1, więc γ = β − 1 i γ2 = β2 − 2β + 1. Zatem 0 = Aγ2 + Bγ + C = Aβ2 + (B − 2A)β + (A − B + C). 7.3. Ułamki łańcuchowe 265 Wobec tego AX 2 + (B − 2A)X + (A − B + C) jest trójmianem minimalnym liczby β. (Łatwo sprawdzić, że jest to wielomian pierwotny.) Ponadto (B − 2A) 2 − 4A(A − B + C) = B2 − 4AC. Więc γ + 1 ∈ Q(∆). Musimy jeszcze uzasadnić, że β′ = γ′ + 1. To wynika z C7.26, bo (γ + 1) + (γ′ + 1) = (γ + γ′) + 2 = 2 − B A ∈ Q, (γ + 1)(γ′ + 1) = γγ′ + γ + γ′ + 1 = C A − B A + 1 ∈ Q na mocy wzorów Vi`ete’a. (2) Niech A = S. Wówczas β = −1/γ. Łatwo widzieć, że CX 2 −BX +A jest trójmianem minimalnym liczby β. Więc β ∈ Q(∆). Sprawdzenie, że β′ = −1/γ′ za pomocą wzorów Vi`ete’a i tezy ćwiczenia C7.26 jest natychmiastowe. (3) Niech A = R. Wówczas β = −γ. Jasne, że trójmianem minimalnym liczby β jest AX 2 − BX + C o tym samym wyróżniku ∆. Również jasne, że β′ = −γ′. Twierdzenie T7.8 pozwala zakończyć rozwiązanie (jak?). ♦ 7.3.7 Okresowe ułamki łańcuchowe Rozwijanie liczb rzeczywistych na ułamki łańcuchowe jest koncepcyjnie podobne do rozwijania (dodatnich) liczb rzeczywistych na ułamki dziesiętne (zobacz paragraf 12.2). Jest jednak z teo- rioliczbowego punktu widzenia znacznie ważniejsze. W tym ustępie przyjrzymy się okresowym ułamkom łańcuchowym. P r z y k ł a d. Najprostszym ciągiem okresowym jest ciąg stały. Niech c ∈ N. Wartość γ ułamka ⟨c, c, c, . . . ⟩ jest, zobacz (7.15), liczbą spełniającą warunek γ = ⟨c, γ⟩, czyli γ = c+1/γ. Wobec tego γ jest większym niż c pierwiastkiem trójmianu kwadratowego X 2−cX−1. Mamy więc do czynienia z niewymiernością kwadratową ⟨c, c, c, . . . ⟩ = c + √c2 + 4 2 . Sprzężoną niewymiernością kwadratową jest γ′ = c−√c2+4 2 . Zwróćmy uwagę, że γ > 1, a −1 < γ′ < 0. Więc γ jest tak zwaną zredukowaną niewymiernością kwadratową: ♦ Deﬁnicja 7.8 Niewymierność kwadratowa γ nazywa się zredukowaną niewymierno- ścią kwadratową, gdy γ > 1 i jednocześnie −1 < γ′ < 0. Ćwiczenie 7.27 Uzasadnić, że jeżeli a, b ∈ N, to wartość okresowego ułamka łańcucho- wego ⟨a, b, a, b, . . . ⟩ jest zredukowaną niewymiernością kwadratową. TWIERDZENIE 7.10 Jeżeli (c0, c1, c2, . . . ) jest czysto-okresowym ciągiem o wyrazach naturalnych, to wartość ⟨c0, c1, c2, . . . ⟩ jest zredukowaną niewymiernością kwadratową. D O W Ó D. Niech γ = ⟨c0, c1, . . . ⟩ będzie wartością nieskończonego ułamka łańcucho- wego wyznaczonego przez ciąg czysto-okresowy (cn). [Ciąg (x0, x1, . . . ) nazywa się ciągiem czysto-okresowym, gdy istnieje taka liczba s ∈ N, że xn+s = xn dla każdego n ∈ Z⩾0.] 266 7. Aproksymacje diofantyczne Wiemy, że γ jest l i c z b ą n i e w y m i e r n ą. Załóżmy, że okres ma długość s, czyli że cs+n = cn dla każdego n = 0, 1, . . . . Wówczas γs := ⟨cs, cs+1, . . . ⟩ = ⟨c0, c1, . . . ⟩ = γ. Jednocześnie, zobacz (7.15), γ = ⟨c0, c1, . . . , cs−1, γs⟩. Wobec tego, zob. (7.8) i (7.9), (7.10), γ = K(c0, c1, . . . , cs−1, γ) K(c1, c2, . . . , cs−1, γ) = γPs−1 + Ps−2 γQs−1 + Qs−2 . Zatem γ jest większym niż 1 (niewymiernym!) pierwiastkiem trójmianu kwadratowego f (X) = Qs−1X 2 + (Qs−2 − Ps−1)X − Ps−2. (7.25) Oznaczmy przez γ′ drugi pierwiastek tego trójmianu. Ponieważ f (0) = −Ps−2 < 0 (dlaczego?), a f (−1) = Qs−1 − Qs−2 + Ps−1 − Ps−2 > 0 (zob. C7.7), więc −1 < γ′ < 0. □ WNIOSEK. Jeżeli ciąg (cn) ∈ C jest okresowy od pewnego miejsca, to wartość nieskoń- czonego ułamka łańcuchowego jest niewymiernością kwadratową. D O W Ó D. Okresowość (od pewnego miejsca) ciągu (cn) oznacza istnienie takich s i k, że cs+n = cn dla wszystkich n ⩾ k. Czyli czystą okresowość ciągu (ck, ck+1, ck+2, . . . ). Z twierdzenia T7.10 wiemy, że wartość γk = ⟨ck, ck+1, . . . ⟩ jest (zredukowaną) niewymiernością kwadratową. Jednocześnie, zobacz (7.15), γ = ⟨c0, c1, . . . , ck−1, γk⟩, czyli γ = A(γk), gdzie A = (Pk−1 Pk−2 Qk−1 Qk−2 ) ∈ GL2(Z) (zobacz (7.19)). Dla zakończenia dowodu wystarczy zauważyć, że γk = A−1(γ) (patrz C7.18 (7.23)(2)) i powołać się na Z7.2. □ Tezę poniższego zadania wykorzystamy w następnym ustępie. ZADANIE 7.3 Załóżmy, że γ = ⟨ c0, c1, . . . , cs−1 ⟩ jest wartością czysto-okresowego ułamka łańcuchowego. Udowodnić, że wówczas −1/γ′ = ⟨ cs−1, cs−2, . . . , c0 ⟩. R o z w i ą z a n i e. Oznaczmy na chwilę b0 = cs−1, b1 = cs−2, . . . , bs−1 = c0. Wtedy ⟨ cs−1, cs−2, . . . , c0 ⟩ = ⟨ b0, b1, . . . , bs−1 ⟩. Oznaczmy wartość tego ułamka łańcuchowego przez β. Wiemy, że γ jest (większym niż 1) pierwiastkiem trójmianu (7.25). Analogicznie, β jest pierwiastkiem trójmianu g(X) = Q ′ s−1X 2 + (Q′ s−2 − P ′ s−1)X − P ′ s−2, gdzie oznaczyliśmy P ′ n = K(b0, b1, . . . , bn) i Q ′ n = K(b1, b2, . . . , bn). Z ćwiczenia C7.28 dowiadujemy się, że zachodzą równości P ′ s−1 = Ps−1, P ′ s−2 = Qs−1, Q ′ s−1 = Ps−2 i Q ′ s−2 = Qs−2. Wobec tego g(X) = −X 2 · f ( − 1 X ) , (7.26) gdzie f (X) jest trójmianem (7.25). Ponieważ g(β) = 0, więc równość (7.26) pokazuje, że f (−1/β) = 0, czyli −1/β jest (ujemnym, bo β > 1) pierwiastkiem trójmianu f (X). Zatem −1/β = γ′. ♦ Ćwiczenie 7.28 Udowodnić, że kontynuanty mają następujące własności symetrii: K(Y1, Y2, . . . , Yn) = K(Yn, Yn−1, . . . , Y1). 7.3. Ułamki łańcuchowe 267 7.3.8 Twierdzenia Lagrange’a i Galois’a W poprzednim ustępie przekonaliśmy się, że wartości okresowych ułamków łańcuchowych są niewymiernościami kwadratowymi. Okazuje się, że jest też odwrotnie. Mówią o tym udowod- nione w tym ustępie twierdzenia Lagrange’a i Galois’a. Ćwiczenie 7.29 Udowodnić, że jeżeli γ jest zredukowaną niewymiernością kwadratową, to wszystkie pseudomianowniki γn kanonicznego rozwinięcia liczby γ = γ0 na ułamek łańcuchowy są również zredukowanymi niewymiernościami kwadratowymi. Ćwiczenie 7.30 Udowodnić, że jeżeli γ jest zredukowaną niewymiernością kwadratową, to −1/γ′ też jest zredukowaną niewymiernością kwadratową. LEMAT 7.1 Istnieje tylko skończenie wiele zredukowanych niewymierności kwadratowych danego wyróżnika. D O W Ó D. Niech γ = x+√∆ y ∈ Q(∆) będzie zredukowaną niewymiernością kwadratową o wyróżniku ∆. To oznacza, że γ > 1, a liczba sprzężona γ′ = x− √∆ y leży w przedziale otwartym ( −1; 0 ), zobacz rysunek 7.3. Widzimy, że γ − γ′ > 1. Więc 2 √∆/y > 1. Stąd y > 0 i y < 2 √ ∆. Również γ +γ′ > 0, więc 2x/y > 0, czyli x > 0. Zaś z warunku γ′ > −1 wnioskujemy, że −y < x − √ ∆. Mamy więc Rys. 7.2 A B CD K L 0 1 aa`1- Rys. 7.3 0 < x < √ ∆ i 0 < y < 2 √∆. Ponieważ, przy ustalonym ∆, istnieje tylko skończenie wiele par (x, y) liczb całkowitych spełniających te warunki, więc dowód jest zakończony. □ TWIERDZENIE 7.11 (Twierdzenie Galois’ a – 1828) Jeżeli γ jest zredukowaną nie- wymiernością kwadratową, to ciąg (cn) mianowników jej kanonicznego rozwinięcia na ułamek łańcuchowy jest ciągiem czysto-okresowym. D O W Ó D. Popatrzmy na ciąg (γn) pseudomianowników kanonicznego rozwinięcia liczby γ = γ0 na ułamek łańcuchowy. Z ćwiczenia C7.21 wiemy, że wszystkie liczby γn są równoważne liczbie γ. Wobec tego zadanie Z7.2 poucza nas, że γn ∈ Q(∆) dla każdego n = 0, 1, . . . . Z ćwiczenia C7.29 wiemy, że wszystkie liczby γn są zredukowanymi niewymiernościami kwadra- towymi o wyróżniku ∆. Ponieważ (zobacz L7.1) takich niewymierności jest tylko skończenie wiele, więc istnieją takie indeksy 0 ⩽ m < n, że γm = γn. To dowodzi, że ciąg mianowników (ck) jest ciągiem okresowym (od pewnego miejsca – mianowicie od miejsca cm). Gdy m = 0, to mamy do czynienia z czystą okresowością. Załóżmy więc, że m > 0. Równość γm−1 = cm−1 + 1 γm po sprzężeniu daje równość γ′ m−1 = cm−1 + 1 γ′ m (zobacz Z7.2), co z kolei zapiszemy następująco: − 1 γ′ m = cm−1 + 1 − 1 γ′ m−1 . (7.27) 268 7. Aproksymacje diofantyczne Ponieważ, zgodnie z C7.30, zarówno −1/γ′ m jak i −1/γ′ m−1 są zredukowanymi niewymierno- ściami kwadratowymi, czyli są większe niż 1, więc równość (7.27) dowodzi, że ⌊−1/γ′ m⌋ = cm−1. Dokładnie tak samo sprawdzamy, że ⌊−1/γ′ n⌋ = cn−1. Ale γm = γn, więc γ′ m = γ′ n, czyli też −1/γ′ m = −1/γ′ n. Liczby równe mają równe części całkowite, więc cm−1 = cn−1. Zatem γm−1 = ⟨cm−1, γm⟩ = ⟨cn−1, γn⟩ = γn−1. W ten sposób po skończonej liczbie kroków dojdziemy do równości γ = γ0 = γn−m, czyli do równości γ = ⟨ c0, c1, . . . , cs−1 ⟩, gdzie s = n − m. □ Z twierdzenia Galois’a wyprowadzimy dwa (historycznie wcześniejsze) twierdzenia. TWIERDZENIE 7.12 (Twierdzenie Lagrange’ a – 1768) Jeżeli γ jest niewymierno- ścią kwadratową, to ciąg (cn) mianowników jej kanonicznego rozwinięcia na ułamek łańcuchowy jest ciągiem okresowym (od pewnego miejsca). D O W Ó D. Wobec twierdzenia Galois’a wystarczy udowodnić, że pewien pseudomianownik γn jest zredukowaną niewymiernością kwadratową. Ponieważ γn > 1 dla każdego n, więc wystarczy udowodnić, że −1 < γ′ n < 0 dla pewnego n. Równość (7.15) daje po sprzężeniu (zobacz Z7.2) γ′ = γ′ nPn−1 + Pn−2 γ′ nQn−1 + Qn−2 . Wyznaczając stąd γ′ n (zobacz też (7.23)(2)) otrzymamy γ′ n = γ′Qn−2 − Pn−2 −γ′Qn−1 + Pn−1 = (−1) · Qn−2 Qn−1 · Pn−2 Qn−2 − γ′ Pn−1 Qn−1 − γ′ . (7.28) Z twierdzenia T7.5 wiemy, że redukty Pk/Qk są zbieżne do γ > 1. Istnieje więc taka parzysta liczba n, że 1 < Pn−2/Qn−2 < Pn−1/Qn−1. Dla takiego n licznik drugiego ułamka w (7.28) jest mniejszy niż mianownik i oba są dodatnie. Ponieważ jednocześnie 0 < Qn−2/Qn−1 < 1, zobacz C7.7, więc −1 < γ′ n < 0 dla takiego n. To kończy dowód. □ Przyjrzyjmy się jeszcze raz przykładom w tabelce z ustępu 7.3.1. Zauważamy, że wszystkie wypisane rozwinięcia są o k r e s o w e (okres zaznaczono kreską). Okresy te zaczynają się od wyrazu c1, a kończą na wyrazie o wartości 2c0. Nie jest to zjawisko przypadkowe. Zachodzi mianowicie poniższe twierdzenie: TWIERDZENIE 7.13 (Twierdzenie Lagrange’ a) Jeżeli D ∈ N nie jest kwadratem, to kanoniczne rozwinięcie liczby √D na ułamek łańcuchowy jest okresowe: √D = ⟨ c0, c1, . . . , cs−1, cs ⟩ (7.29) (okres pewnej długości s, zaznaczono kreską). Ponadto zachodzi równość cs = 2c0, a część (c1, . . . , cs−1) okresu jest ciągiem palindromicznym. 7.3. Ułamki łańcuchowe 269 D O W Ó D. Niech ⌊√D⌋ = c0. I niech β = c0+√D. Łatwo widzieć, że β jest zredukowaną niewymiernością kwadratową. Niech β = ⟨ b0, b1, . . . , bs−1 ⟩. Taka równość ma miejsce wobec twierdzenia Galois’a. Oczywiście b0 = 2c0. Z zadania Z7.3 wiemy, że − 1 β′ = ⟨ bs−1, bs−2, . . . , b0 ⟩. Jednocześnie, ponieważ β′ = c0 − √ D, − 1 β′ = 1 √ D − c0 = 1 β − b0 = 1 ⟨ 0, b1, . . . , bs−1, b0 ⟩ = ⟨ b1, . . . , bs−1, b0 ⟩. To kończy dowód. □ Poniższy wniosek z twierdzenia T7.13 był podstawowym powodem, dla którego Lagrange zajmował się ułamkami łańcuchowymi (zobacz też paragraf 11.4): WNIOSEK Niech D będzie liczbą naturalną nie będącą kwadratem. Wówczas, jeżeli Pn/Qn oznacza n-ty redukt ułamka łańcuchowego (7.29), to dla każdego k ∈ N zachodzi równość P 2 ks−1 − DQ2 ks−1 = (−1) ks. (7.30) D O W Ó D. Równość (7.15) ma dla n = ks w tym przypadku postać √D = (c0 + √ D)Pks−1 + Pks−2 (c0 + √ D)Qks−1 + Qks−2 . Przekształcając to, otrzymamy c0Pks−1 + Pks−2 − DQks−1 = (c0Qks−1 + Qks−2 − Pks−1) √D, skąd, wobec wymierności Pi, Qi i niewymierności √D, mamy Pks−2 = DQks−1 − c0Pks−1, Qks−2 = Pks−1 − c0Qks−1. Kładąc n = ks − 1 w tożsamości (7.11), znajdujemy więc (−1)ks−2 = Pks−1Qks−2 − Qks−1Pks−2 = Pks−1(Pks−1 − c0Qks−1) − Qks−1(DQks−1 − c0Pks−1) = P 2 ks−1 − DQ2 ks−1, co kończy dowód. □ Ćwiczenie 7.31 Brahmagupta napisał, że ktoś, kto w ciągu roku potraﬁ znaleźć nietry- wialne (to znaczy różne od (x, y) = (1, 0)) rozwiązanie równania x2 − 92y2 = 1 w liczbach naturalnych, jest matematykiem. I co ty na to Czytelniku? Rozdział 8 Sumy kwadratów Tout nombre premier, qui surpasse de l’unit´e un multiple du quaternaire, est une seule fois la somme de deux carr´es. (Pierre Fermat w liście do Mersenne’a - 1640) Theorema. Omnis numerus primus formae 4n + 1 est summa duorum quadratorum. (Leonhard Euler - 1747) Liczba 5 = 1 2 + 2 2 nie jest kwadratem, ale jest sumą dwóch kwadratów. Jak scharakte- ryzować te liczby całkowite (nieujemne!), które dadzą się przedstawić w postaci sumy dwóch kwadratów? W tym rozdziale pokażemy kilka częściowych odpowiedzi na to pytanie. Pod- stawowym twierdzeniem rozdziału jest T8.1, sformułowane (i prawdopodobnie udowodnione), jak widać z ”motta”, przez Fermat’a i (z pewnością) udowodnione ponad sto lat później przez Eulera. Podamy kilka dowodów tego twierdzenia. Następnie, wykorzystując twierdzenie Min- kowskiego o ﬁgurze wypukłej, zajmiemy się możliwością przedstawiania liczb całkowitych w postaci x2 + 2y2, x2 + 3y2 i, ogólniej, w postaci x2 + cy2. Jeszcze ogólniej, można się pytać o możliwość przedstawiania liczb całkowitych w postaci ax2 + bxy + cy2, gdzie a, b, c ∈ Z. Powiemy parę słów na ten temat. W szczególności, pokażemy (pochodzący od Lagrange’a) po- mysł redukowania form kwadratowych aX 2 + bXY + cY 2 do postaci prostszych, które łatwiej poddają się badaniu. Kolejnym, prezentowanym tu, osiągnięciem Lagrange’a jest dowód twier- dzenia o możliwości przedstawienia dowolnej liczby naturalnej w postaci s u m y c z t e r e c h k w a d r a t ó w. Rozdział kończymy (piątym) dowodem TFE. 8.1 Jedna ważna tożsamość Zaczniemy od pewnej tożsamości. Jej ślady odnaleźć można już u Diofantosa, a szczególne jej przypadki znali i używali Brahmagupta i Leonardo z Pizy (Fibonacci). Deﬁnicja 8.1 Następującą tożsamość: (x2 + cy2)(u 2 + cv2) = (xu ± cyv)2 + c(xv ∓ yu)2, (8.1) 8.1. Jedna ważna tożsamość 271 której dowód jest oczywistym rachunkiem, nazywać będziemy tożsamością Brahmagupty , a w przypadku c = 1 – tożsamością Fibonacci’ ego. Ustalmy c ∈ Z i rozważmy równanie x2 + cy2 = n, gdzie n jest liczbą całkowitą. Załóżmy, że badamy rozwiązania tego równania w liczbach naturalnych x, y ∈ N := {k ∈ Z : k > 0}. Z tożsamości Brahmagupty łatwo wyciągnąć dwa wnioski: WNIOSEK 1 Jeżeli (x1, y1) jest rozwiązaniem równania x2 + cy2 = n1, a (x2, y2) jest rozwiązaniem równania x2 + cy2 = n2, to równanie x2 + cy2 = n1n2 ma (co najmniej) dwa rozwiązania (|x1x2 − cy1y2|, |x1y2 + x2y1|) oraz (|x1x2 + cy1y2|, |x1y2 − x2y1|) (różne!). □ WNIOSEK 2 Jeżeli n = (−1)epe1 1 pe2 2 · . . . · pes s jest rozkładem na czynniki pierwsze, to w a r u n k i e m w y s t a r c z a j ą c y m rozwiązalności równania x2 + cy2 = n jest rozwiązalność równań x2 + cy2 = (−1) e i x2 + cy2 = pi dla i = 1, 2, . . . , s. □ P r z y k ł a d 1. Równanie x2 + 2y2 = 59 ma rozwiązanie (3, 5), a równanie x2 + 2y2 = 114 ma rozwiązanie (4, 7). Wobec tego równanie x2 + 2y2 = 6726 ma (co najmniej) dwa rozwiązania. Rzeczywiście: (3 2 + 2 · 5 2)(4 2 + 2 · 7 2) = 58 2 + 2 · 412 = 822 + 2 · 12 = (3 2 + 2 · (−5) 2)(4 2 + 2 · 7 2) ♦. P r z y k ł a d 2. Szczególnie ciekawy przykład zastosowania wniosku 1 mamy, gdy n1 = 1. Na przykład 2 2 − 3 · 1 2 = 1 i 3 2 − 3 · 2 2 = −3. Więc para (2, 1) jest rozwiązaniem równania x2 − 3y2 = 1, a para (3, 2) jest rozwiązaniem równania x2 − 3y2 = −3. Wobec tego para (12, 7) jest nowym rozwiązaniem równania x2 − 3y2 = −3. Tę sztuczkę możemy powtarzać! To prowadzi do rekurencyjnie zadanego ciągu (an, bn) rozwiązań równania x2 − 3y2 = −3: Jeżeli a2 n − 3b2 n = −3, to (an+1, bn+1) = (2an + 3bn, an + 2bn). ♦ Wielomian X 2+cY 2 jest przykładem binarnej formy kwadratowej aX 2+bXY +cY 2, zobacz paragraf 8.4. Jeżeli a, b, c są dowolnymi liczbami całkowitymi, to symbolem W(a, b, c) oznaczać będziemy zbiór wszystkich liczb całkowitych dających się przedstawić w postaci ax2 + bxy + cy2 dla pewnych całkowitych x, y: W(a, b, c) = {ax2 + bxy + cy2 : x, y ∈ Z}. Na przykład W(1, 0, 0) = W(0, 0, 1) jest zbiorem kwadratów, W(1, 0, 1) jest zbiorem liczb całkowi- tych będących sumami dwóch kwadratów, a W(0, 1, 0) jest całym zbiorem Z. Niech c ∈ Z będzie dowolną liczbą całkowitą. Dzięki tożsamości Brahmagupty dowodzimy ciekawej i ważnej własności zbioru W(1, 0, c): m ∈ W(1, 0, c) ∧ n ∈ W(1, 0, c) =⇒ m · n ∈ W(1, 0, c). Mówimy, że zbiór W(1, 0, c) jest multyplikatywnie zamknięty. Sympatyczne wykorzystanie multyplikatywnej zamkniętości zbioru W(1, 0, 6) zobaczyć można w rozwiązaniu zadania z drugiego etapu LXII Olimpiady Matematycznej: ZADANIE 8.1 Udowodnić, że n i e ma takich liczb całkowitych x1, x2, . . . , x2011, ani y1, y2, . . . , y2011, dla których liczba L = (2x2 1 + 3y2 1)(2x2 2 + 3y2 2) · . . . · (2x2 2011 + 3y2 2011) byłaby kwadratem liczby naturalnej. 272 8. Sumy kwadratów R o z w i ą z a n i e. Załóżmy, nie wprost, że wskazana liczba L jest kwadratem. Wówczas 2 2012L również jest kwadratem. Czyli M 2 = 2 2012L = 2 · [(2x1) 2 + 6y2 1)((2x2) 2 + 6y2 2) · . . . · ((2x2011) 2 + 6y2 2011)]. Korzystając z multyplikatywnej zamkniętości zbioru W(1, 0, 6), możemy zapisać powyższą rów- ność skrótowo tak: M 2 = 2(A2 + 6C 2) przy pewnych A, C ∈ Z. Kładąc B = 2C, dostajemy M 2 = 2A 2 + 3B2. Ale to jest niemożliwe! [Aby to zobaczyć wystarczy zredukować (mod 3) i zastosować metodę desantu.] ♦ Elementarnym, ale bardzo ważnym, ćwiczeniem jest poniższe: Ćwiczenie 8.1 Udowodnić, że jeżeli p jest liczbą pierwszą, p ∤ c i p ∈ W(1, 0, c), to liczba (−c) jest resztą kwadratową modulo p. 8.2 Sumy dwóch kwadratów W tym paragraﬁe udowodnimy (dwiema metodami) twierdzenie Fermat’a-Eulera. W literaturze nazywa się je częściej twierdzeniem Fermat’a, ale, ponieważ pierwsze znane dowody pochodzą od Eulera, więc nazywamy je twierdzeniem Fermat’a-Eulera. TFE pozwoli scharakteryzować te liczby naturalne, które dadzą się przedstawić w postaci sumy dwóch kwadratów (liczb cał- kowitych). 8.2.1 Twierdzenie Fermat’a-Eulera Pierwszy prezentowany przez nas dowód TFE opiera się na twierdzeniu T7.1. LEMAT 8.1 Jeżeli n, a, b ∈ N, NWD (a, b) = 1 oraz n|a2 + b2, to istnieją takie liczby całkowite x, y, że n = x2 + y2. D O W Ó D. Udowodnimy to najpierw w przypadku, gdy b = 1. Zastosujemy w tym celu T7.1 do liczb α = a n i N = ⌊√ n⌋. Znajdziemy wówczas takie h, k, że \f \f \f \f a n − h k \f \f \f \f ⩽ 1 k(N + 1) oraz k ⩽ N. (8.2) Twierdzimy, że x = ak − nh i y = k są dobre. Aby to sprawdzić pokażemy, że x2 + y2 jest niezerową wielokrotnością liczby n mniejszą niż 2n. To, oczywiście, skończy dowód w przypadku b = 1. Mamy x2 + y2 = (ak − nh)2 + k2 = a2k2 − 2ahkn + n 2h 2 + k2 = k2(a2 + 1) + n(nh 2 − 2ahk). Założenie, n|a2 + 1 daje więc n|x2 + y2. Z drugiej strony mnożąc nierówność (8.2) przez nk i podnosząc do kwadratu dostajemy x2 = |ak − nh| 2 ⩽ ( n N + 1 )2 < n. 8.2. Sumy dwóch kwadratów 273 Ostania nierówność wynika z oczywistej nierówności n < (N + 1) 2. Ponadto, ponieważ 1 ⩽ k ⩽ N , więc y2 = k2 ⩽ N 2 = ⌊√ n⌋2 ⩽ √n 2 = n. Zatem 0 < x 2 + y2 < 2n. Jeżeli b ̸= 1, to dobieramy takie u, v ∈ Z, by au + bv = 1. Wówczas, na mocy tożsamości Fibonacci’ego (8.1): (a 2 + b2)(u 2 + v2) = (av − bu) 2 + (au + bv) 2 = A 2 + 1. Zatem n|A2 + 1, więc n jest sumą dwóch kwadratów. □ Ćwiczenie 8.2 Udowodnić, że jeżeli liczba naturalna n jest dzielnikiem liczby 34x2 − 42xy + 13y2, gdzie x, y ∈ Z są względnie pierwsze, to n jest sumą dwóch kwadratów (liczb całkowitych). TWIERDZENIE 8.1 (Twierdzenie Fermat’ a-Eulera, TFE) Nieparzysta liczba pierw- sza p da się przedstawić w postaci x2 + y2 wtedy i tylko wtedy, gdy p ≡ 1 (mod 4). P I E R W S Z Y D O W Ó D TFE. Konieczność warunku p ≡ 1 (mod 4) jest oczywista. Dla dowodu dostateczności weźmy a ∈ Z spełniające a2 ≡ −1 (mod p) (zob. WT5.24). Wtedy p|a2 + 1. Zatem, na mocy lematu L8.1, p jest sumą dwóch kwadratów. □ P r z y k ł a d. Weźmy nasze ulubione liczby pierwsze 1777 i 1801 (łatwo je zapamiętać: oznaczają rok urodzenia Gaussa i rok wydania jego słynnych Disquisitiones Arithmeticae). Dają one resztę 1 z dzielenia przez 4, więc muszą się dać przedstawić w postaci sumy dwóch kwadratów. Rzeczywiście: 1777 = 16 2 + 392, 1801 = 24 2 + 352. ♦ Z przytoczonego na początku rozdziału ”motta” widzimy, że Fermat zdawał sobie sprawę z niezwykle ważnej okoliczności, mianowicie j e d y n o ś c i p r z e d s t a w i e n i a (une seule fois). Udowodnimy to w poniższym zadaniu: ZADANIE 8.2 Udowodnić, że przedstawienie p = x2+y2 liczby pierwszej w postaci sumy dwóch kwadratów jest j e d n o z n a c z n e (z dokładnością do zamiany x2 na y2). R o z w i ą z a n i e. Niech p = x2 1 + y2 1 = x2 2 + y2 2 (8.3) będą dwoma przedstawieniami liczby pierwszej p w postaci sumy dwóch kwadratów. Wówczas NWD (xi, yi) = 1 (bo kwadrat wspólnego dzielnika xi i yi jest dzielnikiem p) oraz p ∤ xi i p ∤ yi. Mnożąc obustronnie kongruencję x2 i + y2 i ≡ 0 (mod p) przez odwrotność (y2 i ) −1 otrzy- mamy (xiy−1 i ) 2 ≡ −1 (mod p). Widzimy więc, że x1y−1 1 i x2y−1 2 są rozwiązaniami kongruencji z2 + 1 ≡ 0 (mod p). Ale, zobacz T5.12, kongruencja ta ma co najwyżej dwa rozwiązania (je- żeli a (mod p) jest rozwiązaniem, to drugim rozwiązaniem jest −a (mod p)). Zatem x1y−1 1 ≡ ± x2y−1 2 (mod p), co, po obustronnym pomnożeniu przez y1y2, daje x1y2 ≡ ± x2y1 (mod p). Zmieniając ewentualnie y1 na −y1, mamy x1y2 ≡ x2y1 (mod p). Równości (8.3) i tożsamość 274 8. Sumy kwadratów podstawowa (8.1) (przy c = 1) dają p2 = (x2 1 + y2 1)(x2 2 + y2 2) = (x1x2 + y1y2) 2 + (x1y2 − x2y1)2. Ponieważ p|x1y2 − x2y1, więc też p|x1x2 + y1y2. Po podzieleniu przez p2 otrzymamy 1 = (x1x2 + y1y2 p )2 + ( x1y2 − x2y1 p )2 . Stąd x1x2 = −y1y2 lub x1y2 = x2y1. Jeżeli zachodzi pierwsza z tych równości, to, wobec względnej pierwszości x1 i y1, na mocy ZTA, mamy x1|y2, a wobec względnej pierwszości x2 i y2, y2|x1. Zatem x1 = ± y2 i wtedy x2 = ± y1. Podobnie rozpatrujemy drugi przypadek i dostajemy: x1 = ± x2 i y1 = ± y2. To kończy rozwiązanie. ♦ U w a g a. Wobec równości (które Czytelnik z pewnością zechce sprawdzić!) F6 = (2 32) 2 + 12 = 4 046 803 256 2 + 1 438 793 759 2 (8.4) i powyższego, widzimy, że liczba Fermat’a F6 n i e j e s t liczbą pierwszą. Podobnie, równości F5 = (2 16) 2 + 12 = 62 2642 + 20 449 2 dowodzą złożoności piątej liczby Fermat’a, por. 5.5.5 U2. 8.2.2 Drugi dowód twierdzenia Fermat’a-Eulera Twierdzenie Fermat’a-Eulera jest tak ważne, że pokażemy drugi jego dowód. Tym razem nie korzystamy z aproksymacji diofantycznej ani z prawa wzajemności. LEMAT 8.2 Jeżeli liczba pierwsza p ≡ 1 (mod 4), to istnieje 0 < m < p i takie liczby x, y ∈ Z, że mp = x2 + y2. D O W Ó D. Najpierw, nie korzystając z kryterium Eulera, sprawdzamy, że jeżeli p jest liczbą pierwszą postaci 4k + 1, to (−1)Rp. Mamy, dzięki twierdzeniu Wilsona, −1 ≡ (p − 1)! ≡ 1 · (p − 1) · 2(p − 2) · . . . · 2k(p − 2k) ≡ (−1) 2k(1 · 2 · . . . · 2k) 2 (mod p). Widzimy stąd, że jeżeli p ≡ 1 (mod 4), to istnieje taka a ∈ Z, że a2 ≡ −1 (mod p), czyli a2 + 1 = sp dla pewnego s ∈ N. Wybierzmy takie x, by a ≡ x (mod p) i by |x| < p/2. Wówczas x2+1 = mp dla pewnej liczby naturalnej m. Ponadto mp = x2+1 < (p/2) 2+1 < p 2. Stąd 0 < m < p. Wystarczy teraz przyjąć y = 1. □ U w a g a. Pokazane powyżej zastosowanie twierdzenia Wilsona daje rozwiązanie kongruencji z2 ≡ −1 (mod p) dla liczb pierwszych p ≡ 1 (mod 4). Rozwiązaniem tym jest (2k)! (mod p). Przechodzimy do naszego d r u g i e g o d o w o d u twierdzenia Fermat’a-Eulera (ponieważ w dowodzie tym wykorzystuje się pomysł desantu, więc jest wysoce prawdopodobne, że podobnie rozumował sam Fermat): D R U G I D O W Ó D TFE. Lemat L8.2 poucza nas, że i s t n i e j ą wielokrotności mp liczby p będące sumami dwóch kwadratów. Niech mp = x2 + y2, gdzie 0 < m < p, będzie taką wielokrotnością. Pokażemy, że jeżeli m > 1, to istnieje taka m n i e j s z a liczba naturalna m ′ < m, że m′p r ó w n i e ż jest sumą dwóch kwadratów. Rozważamy osobno przypadki, gdy m jest parzysta i gdy m jest nieparzysta. W pierwszym przypadku, niech m = 2m ′. Wówczas x ≡ y (mod 2). Wobec tego ( x + y 2 )2 + ( x − y 2 )2 = x2 + y2 2 = m′p 8.2. Sumy dwóch kwadratów 275 jest sumą kwadratów liczb c a ł k o w i t y c h. W przypadku nieparzystego m ⩾ 3 zapiszmy: { x = x1m + a przy pewnym |a| < m 2 , y = y1m + b przy pewnym |b| < m 2 . (8.5) Możliwość takiego dzielenie z resztą wynika z nieparzystości m. Wtedy mamy a2 + b2 = (x − x1m) 2 + (y − y1m) 2 = (x2 + y2) + m · coś = m · cóś. Oznaczmy a2 + b2 = mm ′. Wówczas mm ′ = a2 + b2 < (m 2 )2 + (m 2 )2 = m 2 2 , skąd m ′ < m 2 . Korzystając teraz z tożsamości Fibonacci’ego możemy napisać mm ′ · mp = (a2 + b2)(x2 + y2) = (xb − ya)2 + (xa + yb) 2. Ponieważ bardzo łatwo, dzięki równościom (8.5), sprawdzamy, że m|xb − ya, więc powyższa równość daje m 2|(xa + yb) 2. Możemy podzielić obustronnie przez m 2: m ′p = ( xb − ya m )2 + ( xa + yb m )2 . Jeżeli teraz m′ = 1, to mamy przedstawienie p w postaci sumy dwóch kwadratów. Jeżeli zaś m ′ > 1, to możemy powtórzyć ”sztuczkę”. Jasne, że po nie więcej niż log2 m takich ”sztuczek” dojdziemy do przedstawienia 1 · p = x2 + y2. □ W poniższym (niełatwym!) ćwiczeniu pokazujemy, pochodzące od Gaussa, r o z w i ą z a n i e z a d a n i a p r z e d s t a w i e n i a liczby pierwszej p = 4k + 1 w postaci x2 + y2: Ćwiczenie 8.3 Udowodnić, że jeżeli p = 4k + 1 jest liczbą pierwszą i x ≡ (2k + 1)( 2k k ) (mod p), y ≡ (2k + 1)(2k)! ( 2k k ) (mod p) oraz |x|, |y| ⩽ 2k, to x2 + y2 = p. 8.2.3 Twierdzenie o przedstawieniu Udowodnimy teraz twierdzenie charakteryzujące liczby naturalne dające się przedstawić w po- staci sumy dwóch kwadratów liczb całkowitych. TWIERDZENIE 8.2 Liczba naturalna n da się przedstawić w postaci sumy dwóch kwa- dratów wtedy i tylko wtedy, gdy dla każdej liczby pierwszej p postaci 4k + 3, wykładnik p-adyczny vp(n) jest liczbą parzystą. D O W Ó D. (⇐=) Przedstawmy n w postaci n = k2m, gdzie m jest iloczynem różnych liczb pierwszych postaci 4k + 1 i (ewentualnie) dwójki. Dzięki T8.1, równości 2 = 12 + 12 i wielokrotnemu zastosowaniu tożsamości (8.1) możemy napisać m = x2 + y2. Stąd n = (kx) 2 + (ky) 2. 276 8. Sumy kwadratów (=⇒) Załóżmy teraz, że n = x2 + y2 jest sumą dwóch kwadratów i że liczba pierwsza p ≡ 3 (mod 4) dzieli n. Twierdzimy, że wówczas p|x i p|y. Gdyby bowiem p ∤ x, to, oznaczając przez u odwrotność x modulo p, mielibyśmy nu 2 = (xu)2 + (yu)2, skąd 1 + (yu) 2 ≡ 0 (mod p), co jest niemożliwe (bo −1 jest nieresztą kwadratową modulo p ≡ 3 (mod 4)). Podobnie sprawdzamy, że p|y. Zatem n = x2 + y2 = (pa)2 + (pb) 2, więc p2|n. Dokończenie rozumowania jest teraz natychmiastowe. □ 8.2.4 Funkcja r(n) Oznaczmy przez r(n) liczbę wszystkich takich par (x, y) ∈ Z × Z, że x2 + y2 = n. Inaczej mówiąc, r(n) oznacza liczbę punktów kratowych leżących na okręgu K((0, 0), √ n) o środku w początku układu (współrzędnych prostokątnych) i promieniu √n. Wiemy, że r(n) = 0 dla każdej liczby naturalnej n ≡ 3 (mod 4). Wiemy też, że r(p) = 8 dla każdej liczby pierwszej p ≡ 1 (mod 4). To oznacza, że – na przykład – okrąg o promieniu√37 i środku w punkcie kratowym przechodzi przez dokładnie osiem punktów kratowych. Funkcja arytmetyczna r zachowuje się bar- dzo nieregularnie i nie znamy żadnego wzoru wyrażającego wartości funkcji r. Dużo łatwiej jest zbadać wartość średnią: R(n) = 1 + r(1) + . . . + r(n) n . Licznik tego wyrażenia oznacza, jak łatwo widzieć, liczbę całkowitoliczbowych rozwiązań nierówności x2 + y2 ⩽ n, czyli liczbę punktów kratowych zawartych w kole D((0, 0), √n). Ponieważ każdy (z wyjątkiem ”paru” skraj- nych) punkt kratowy zawiera się w tym kole wraz z odpowiadającym mu kwadratem jed- nostkowym, więc liczba tych punktów krato- wych jest w przybliżeniu równa polu π( √n)2 tego koła. Stąd dostajemy równość Rys. 8.1 limn→∞ R(n) = π, którą interpretujemy tak: Liczba naturalna m a p r z e c i ę t n i e π rozkładów na sumę dwóch kwadratów. Ćwiczenie 8.4 Udowodnić powyższą równość. Wskazówka. Sumaryczne pole kwadracików jednostkowych, których lewy dolny róg należy do koła o środku w początku układu i promieniu√N , jest liczbą zawartą między polem koła o promieniu √N − √2 a polem koła o promieniu√N + √2. Zobacz rysunek 8.1. 8.3. Nieco geometrii w teorii liczb 277 8.3 Nieco geometrii w teorii liczb Opowiemy teraz jak można zastosować w teorii liczb proste pojęcia z geometrii płaszczyzny. Posługujemy się przy tym płaszczyzną z wyróżnionym p r o s t o k ą t n y m układem współ- rzędnych. Prostokątny układ współrzędnych pozwala utożsamiać punkty płaszczyzny z parami uporządkowanymi u = (a, b) liczb rzeczywistych. Zbiór wszystkich takich par, czyli iloczyn kartezjański R × R, oznaczany w skrócie R2 (czytamy: er kwadrat), jest g r u p ą względem dodawania punktów określonego następująco: jeżeli u = (a, b), w = (c, d), to kładziemy u + w := (a + c, b + d). (8.6) [Oczywiście tak określone działanie jest łączne, przemienne, ma element neutralny 0 = (0, 0) i każdy punkt w = (a, b) ma element przeciwny −w := (−a, −b).] Czytelnik, oczywiście, wie, że geometrycznie oznacza to, że punkty 0, u, u + w, w są k o l e j n y m i wierzchołkami równoległoboku. Punkty można też m n o ż y ć przez liczby. Iloczyn punktu v = (a, b) przez liczbę s jest punktem sv := (sa, sb). Odległość punktu v od zera 0 oznaczać będziemy ∥v∥. Ponieważ przeciwległe boki równoległoboku są równej długości, więc odległość punktów v1, v2 równa jest odległości punktu v1 − v2 od 0, czyli ∥v1 − v2∥. Nierówność trójkąta ma przy tych oznaczeniach postać ∥v1 − v3∥ ⩽ ∥v1 − v2∥ + ∥v2 − v3∥, zobacz GEO . 8.3.1 Kraty w płaszczyźnie Spotykaliśmy już parokrotnie zbiór punktów kratowych, czyli punktów o obu współrzędnych całkowitych. Zbiór ten nazywamy też kratą Gaussa. Uogólnieniem tego pojęcia jest pojęcie kraty w płaszczyźnie. Deﬁnicja 8.2 Niech dane będą dwa punkty u, w nie leżące na jednej prostej przechodzącej przez początek układu. Wówczas zbiór wszystkich kombinacji liniowych postaci ku + lw, gdzie k, l ∈ Z, nazywa się kratą generowaną przez punkty u, w. Oznaczamy ją Λ(u, w). Ćwiczenie 8.5 Narysować kratę generowaną przez punkty (1, 3) i (−2, 4). Szczególnie ładną jest krata Eisensteina ge- nerowana przez punkty (1, 0) i ( 1 2, √3 2 ), zobacz rysunek 10.5. Rys. 8.2 Ćwiczenie 8.6 Udowodnić, że Λ(u, w) = Λ(u′, w′) wtedy i tylko wtedy, gdy istnieją takie, spełniające warunek |ad − bc| = 1, liczby całkowite a, b, c, d, że u ′ = au + bw, w′ = cu + dw. 278 8. Sumy kwadratów Deﬁnicja 8.3 Równoległobok o wierzchołkach 0 = (0, 0), u, w i u + w nazywa się rów- noległobokiem podstawowym kraty Λ(u, w), a pole tego równoległoboku nazywa się wy- różnikiem kraty Λ(u, w) i oznacza d(Λ). Zobacz rysunek 8.2. Ćwiczenie 8.7 Udowodnić, że takie oznaczenie jest sensowne, to znaczy, że d(Λ) nie zależy od wyboru punktów generujących kratę, a tylko od samej kraty Λ. 8.3.2 Dyskretne podgrupy płaszczyzny Każda krata jest podgrupą płaszczyzny. Pokażemy teraz prostą ale ważną topologiczną cha- rakteryzację krat. Grupa (R2, +) punktów płaszczyzny z dodawaniem zadanym przez (8.6) ma mnóstwo pod- grup (zobacz D5.8 w ustępie 5.5.1). P r z y k ł a d. Zbiór (wszystkich) punktów dowolnej prostej przechodzącej przez 0 jest pod- grupą w R 2. Zbiór wszystkich punktów wymiernych, czyli takich punktów (a, b), że a, b są liczbami wymiernymi, jest podgrupą w R2. Dowolna krata jest podgrupą w R2. ♦ Deﬁnicja 8.4 Podgrupę Γ grupy (R 2, +) nazywamy podgrupą dyskretną, gdy istnieje taka liczba ε > 0, że w kole D(0, ε) := {v ∈ R 2 : ∥v∥ ⩽ ε} o środku w 0 i promieniu ε nie leży żaden, różny od 0, punkt podgrupy Γ . Czyli, gdy D(0, ε) ∩ Γ = {0}. ZADANIE 8.3 Udowodnić, że krata jest podgrupą dyskretną w R2. R o z w i ą z a n i e. Niech Λ = Λ(u, w), gdzie u = (a, b), w = (c, d), będzie daną kratą. I niech xu + yw = (ax + cy, bx + dy) będzie dowolnym punktem kraty Λ. Oznaczmy A := a2 + b2, C := c2 + d2 i B = 2(ac + bd). Wówczas: ∥xu + yw∥2 = (ax + cy)2 + (bx + dy) 2 = (a2 + b2)x2 + 2(ac + bd)xy + (c2 + d2)y2 = Ax2 + Bxy + Cy2 = (2Ax + By) 2 4A + 4AC − B2 4A y2 ⩾ − ∆ 4A y2, gdzie ∆ := B2 − 4AC. Jasne, że tak samo dostaniemy nierówność ∥xu + yw∥ 2 ⩾ −(∆/4C)x2. Dodając te dwie nierówności dostaniemy ∥xu + yw∥2 ⩾ −∆ 8 ( x2 C + y2 A ) . Zauważmy, że ∆ < 0. To wynika z nierówności Schwarza (ac + bd) 2 ⩽ (a2 + b2)(c2 + d2), która staje się równością wtedy i tylko wtedy, gdy ad − bc = 0, co oznacza, że punkty u, w, 0 leżą na jednej prostej i zostało wykluczone. Oznaczając µ = max(A, C) i r2 = −∆/(8µ) możemy więc napisać ∥xu + yw∥ 2 ⩾ −∆ 8 ( x2 µ + y2 µ ) = − ∆ 8µ (x2 + y2) ⩾ r2(x2 + y2) ⩾ r2, bo x2 + y2 ⩾ 1 dla wszystkich xu + yw ̸= 0. Zatem D(0, r/2) ∩ Λ = {0}. ♦ Udowodnimy teraz ”prawie” odwrócenie tezy Z8.3: 8.3. Nieco geometrii w teorii liczb 279 TWIERDZENIE 8.3 Jeżeli Γ jest dyskretną podgrupą punktów płaszczyzny, to zachodzi jedna z trzech możliwości: (0) Γ = {0}, (1) Γ jest grupą Zu = {ku : k ∈ Z} dla pewnego u ̸= 0, (2) Γ j e s t k r a t ą. D O W Ó D. Zauważmy najpierw, że jeżeli ε > 0 jest taką liczbą, że D(0, ε) ∩ Γ = {0}, to D(v1, ε/3) ∩ D(v2, ε/3) = ∅ dla dowolnych dwóch różnych punktów v1, v2 ∈ Γ . Istotnie, gdyby v ∈ D(v1, ε/3) ∩ D(v2, ε/3), to ∥v1 − v2∥ = ∥v1 − v + v − v2∥ ⩽ ∥v1 − v∥ + ∥v − v2∥ ⩽ ε/3 + ε/3 < ε, więc v1 − v2 = 0. Załóżmy teraz, że Γ ̸= {0}. Wówczas możemy wybrać niezerowy punkt u ∈ Γ leżący najbliżej punktu 0. Możliwość takiego wyboru jest intu- icyjnie oczywista. [Dowód można przeprowadzić tak: Wybieramy dowolny niezerowy punkt u0 ∈ Γ . Niech ∥u0∥ = r0 > 0. Jeżeli nie ma punktów w Γ leżących bliżej 0, to kładziemy u = u0. Jeżeli zaś w grupie Γ istnieją niezerowe punkty leżące bliżej 0, to wybieramy dowolny z nich. Niech to będzie u1. Niech ∥u1∥ = r1. Oczywi- ście r1 < r0. Jeżeli u1 nie jest najbliższy 0, to znajdujemy u2 jeszcze bliższy 0 i tak dalej. Po n takich wyborach mamy punkty u1, u2, . . . , un. Wszystkie one leżą w kole D(0, r0) i to tak, że koła D(uj, ε/3) są (zgodnie z uwagą uczynioną na Rys. 8.3 u w początku) parami rozłączne i wszystkie zawarte w kole D(0, r0 + ε/3). Wobec tego suma pól tych kół, czyli liczba nπε 2/9 jest mniejsza niż pole koła D(0, r0+ε/3), czyli liczba π(r0+ε/3)2. Jasne, że wobec tego n nie może być zbyt duża. Zatem możliwych jest tylko skończenie wiele wyborów punktów uj.] Mając punkt u rozważmy zbiór Zu := {ku : k ∈ Z} = { . . . , −2u, −u, 0, u, 2u, . . . } (8.7) wszystkich jego całkowitoliczbowych wielokrotności. T w o r z ą one grupę, której wszystkie elementy leżą na jednej prostej, mianowicie na prostej Ru = {au : a ∈ R}. Czytelnik sam uzasadni, że Γ ∩ Ru = Zu. Zachodzi jeden z dwóch przypadków: albo Zu = Γ , albo Zu ̸= Γ . Pierwszy przypadek daje (1). W drugim przypadku wybierzmy ze zbioru Γ ∖ Ru punkt najbliższy 0. Niech to będzie w. Twierdzimy, że Λ(u, w) = Γ . Zawieranie Λ(u, w) ⊆ Γ jest oczywiste (bo Γ jest grupą, więc zawiera wszystkie kombinacje liniowe ku + lw dla k, l ∈ Z). Wykażemy więc, że każdy punkt v ∈ Γ należy do Λ(u, w). Aby to zobaczyć narysujmy rodzinę prostych równoległych do prostej 0w przechodzących przez wszystkie punkty xu, x ∈ Z i rodzinę prostych równoległych do prostej 0u przechodzących przez wszystkie punkty yw, y ∈ Z. Proste te tworzą rodzinę równoległoboków, których wierzchołkami są punkty kraty Λ(u, w), zobacz rysunek 8.3. Gdyby teraz pewien punkt v ∈ Γ nie należał do Λ(u, w), to leżałby w pewnym ze wskazanych równoległoboków. Jeżeli leży w ćwiartce tego równoległoboku wyzna- czonej przez wierzchołek ku + lw (jak na rysunku), to, jak łatwo widać z nierówności trójkąta, 280 8. Sumy kwadratów ∥v − (ku + lw)∥ < 1 2∥u∥ + 1 2∥w∥ ⩽ ∥w∥. Ale to jest niemożliwe, bo punkt w był wybrany najbliżej punktu 0. Wobec tego Γ = Λ(u, w). □ 8.3.3 Twierdzenie Minkowskiego o ﬁgurze wypukłej Udowodnimy bardzo ładne i bardzo przydatne twierdzenie Minkowskiego. Mówimy, że dana ﬁgura na płaszczyźnie jest centralnie symetryczna, gdy punkt zerowy (czyli początek układu) jest środkiem symetrii tej ﬁgury. Przypomnijmy, że ﬁgurę nazywamy wypukłą, gdy wraz z dowolnymi dwoma punktami zawiera c a ł y o d c i n e k łączący te punkty. TWIERDZENIE 8.4 (Twierdzenie Minkowskiego o ﬁgurze wypukłej ) Niech dana będzie krata Λ(u, w) i centralnie symetryczna, ograniczona ﬁgura wypukła F, której pole S(F) spełnia warunek S(F) > 4d(Λ). (8.8) Wówczas pewien, różny od zerowego, punkt kraty Λ(u, w) należy do ﬁgury F. D O W Ó D. Niech G oznacza obraz ﬁgury F przy jednokładności o środku w początku układu i skali 1/2. Jasne, że G jest również ﬁgurą wypukłą i centralnie symetryczną. Pole S(G), jako równe S(F)/2 2, pełnia warunek S(G) > d(Λ). Niech S(G) = d(Λ) + ε, gdzie ε > 0. Oznaczmy przez Hx obraz dowolnego zbioru H przy translacji o wektor x ∈ Λ. Wówczas S(Hx) = S(H), bo przesuwanie nie zmienia pola. Oznaczmy przez k taką liczbę naturalną, że G ⊆ ⋃ |a|, |b|⩽k Rau+bw, (8.9) gdzie Rau+bw oznacza przesunięcie równoległoboku podstawowego R kraty Λ o wektor wo- dzący punktu au + bw. Istnienie takiej liczby k wynika z ograniczoności ﬁgury G. Z inkluzji (8.9) wynika, że dla dowolnego N ∈ N zachodzi ⋃ |a|, |b|⩽N Gau+bw ⊆ ⋃ |a|, |b|⩽N +k Rau+bw. (8.10) Twierdzimy, że zbiory Gx dla różnych x ∈ Λ n i e m o g ą być parami rozłączne. Rzeczy- wiście, gdyby były parami rozłączne, to, dzięki (8.10), mielibyśmy (2N + 1)2(d(Λ) + ε) = (2N + 1)2S(G) ⩽ (2N + 2k + 1)2S(R) = (2N + 2k + 1)2d(Λ). Taka nierówność nie może jednak zachodzić dla wszystkich N . Wynika z niej bowiem, że ε ⩽ 4k2d(Λ) (2N + 1)2 + 4kd(Λ) 2N + 1 , co nie może zachodzić dla wszystkich N , bo ε > 0. Wobec tego istnieją takie dwa różne punkty x, y ∈ Λ, że Gx ∩ Gy ̸= ∅. 8.3. Nieco geometrii w teorii liczb 281 Czyli istnieją takie punkty a, b ∈ G, że x + a = y + b. Stąd x − y = 2 · ( 1 2 b + 1 2(−a) ) . Ale −a ∈ G, bo G jest centralnie symetryczny. Zatem wektor z = 1 2(b + (−a)), jako środek odcinka łączącego punkty b i −a wypukłego zbioru G, należy do G. Czyli 2z ∈ F. Ostatecznie, niezerowy wektor x − y kraty Λ należy do F. □ U w a g a 1. Jeżeli niezerowy punkt u kraty Λ należy do F, to symetryczny względem początku układu punkt −u kraty Λ również należy do F. Widzimy więc, że przy założeniach twierdzenia, co najmniej d w a n i e z e r o w e punkty należą do Λ ∩ F. U w a g a 2. Twierdzenie Minkowskiego spotykamy też w KOM . Tam pokazujemy nieco inny dowód nieco innej wersji twierdzenia. Po pierwsze robimy to tam w przestrzeni n- wymiarowej (w miejscu liczby 4 z nierówności (8.8) występuje tam liczba 2 n). Po drugie nierówność jest ”tępa”, ale za to trzeba dołożyć założenie d o m k n i ę t o ś c i ﬁgury (bryły) F (jest ono ważne: na przykład zbiór {(x, y) : |x|, |y| < 1}, kwadrat, ma pole 4 i nie za- wiera żadnego niezerowego punktu kraty Gaussa). Po trzecie tam ograniczyliśmy się do kraty całkowitoliczbowej (chociaż to założenie łatwo odrzucić). 8.3.4 Dwa zastosowania Pokażemy teraz dwa zastosowania twierdzenia Minkowskiego o ﬁgurze wypukłej. TWIERDZENIE 8.5 (Twierdzenie Thue’ go) Jeżeli m ⩾ 2 jest liczbą naturalną i li- czba całkowita a jest względnie pierwsza z m, to istnieją r ó ż n e o d z e r a liczby całkowite x, y spełniające warunki: x ≡ ay (mod m), oraz |x|, |y| ⩽ √ m. D O W Ó D. Pokażemy dwa sposoby rozumowania. Pierwszy jest całkowicie elementarny, drugi wykorzystuje twierdzenie Minkowskiego. W rzeczywistości te dowody nie różnią się ni- czym istotnym i drugi można uznać za ilustrację geometryczną pierwszego. S p o s ó b 1. Niech A = ⌊√m⌋. Rozważmy dowolnie ustawione w ciąg liczby x + ay, gdzie x i y przebiegają zbiór {0, 1, . . . , A}. Ponieważ w tym ciągu jest (A + 1) 2 wyrazów, a (A + 1) 2 > m, to możemy wybrać dwa r ó ż n e wyrazy dające tę samą resztę z dzielenia przez m. Niech to będą x1 + ay1 i x2 + ay2. Wówczas, (x1 − x2) + a(y1 − y2) ≡ 0 (mod m). (8.11) Ponieważ 0 ⩽ x1, x2 ⩽ A, więc |x1 − x2| ⩽ A ⩽ √m. Podobnie, |y1 − y2| ⩽ √m. Kładziemy x = x1 − x2, y = y2 − y1. Pozostaje nam sprawdzić, że x ̸= 0 i y ̸= 0. Otóż, gdyby y = 0, to, wobec (8.11), mielibyśmy m|x1 − x2. Jednocześnie |x1 − x2| ⩽ √m < m. Stąd x1 − x2 = 0, więc (x1, y1) = (x2, y2) wbrew dokonanemu wyborowi różnych wyrazów ciągu. Gdyby zaś x1 = x2, to kongruencja (8.11) dałaby m|a(y1 − y2). W takim przypadku założona względna pierwszość m i a oraz ZTA dają podzielność m|y1 − y2, która, tak jak przed chwilką, prowadzi do równości y1 = y2. Uzyskane sprzeczności dowodzą, że x ̸= 0 i y ̸= 0. □ 282 8. Sumy kwadratów S p o s ó b 2. Rozważmy kratę Λ generowaną przez punkty u = (a, 1) i w = (m, 0). Jasne, że d(Λ) = m. Niech F będzie zbiorem wypukłym i centralnie symetrycznym (kwadratem!): F = {(x, y) : |x|, |y| ⩽ √ m}. (Przypadek gdy m = 10, a = 13 widzimy na ry- sunku 8.4.) Wówczas µ(F) = (2 √m)2 = 4m ⩾ 4d(Λ). Stosując twierdzenie Minkowskiego widzimy, że istnieją takie, nie równe jednocześnie 0, liczby cał- kowite k, l, że punkt q = ku + lw = (ka + lm, k) jest niezerowym punktem należącym do kwadratu Rys. 2.1 Rys. 8.3Rys. 8.4 F. Sprawdzamy, że współrzędne x = ka + lm i y = k punktu q s p e ł n i a j ą w y m a g a n i a postawione w tezie. Kongruencja x ≡ ay (mod m) jest oczywista. Nierówności |x|, |y| ⩽ √ m również są jasne, bo q ∈ F. Pozostaje wykazać, że x ̸= 0 i y ̸= 0. Gdyby y = k = 0, to q = (lm, 0) byłby punktem kwadratu F, więc |lm| ⩽ √m, co jest możliwe tylko dla l = 0, bo m ⩾ 2. Wtedy punkt q byłby punktem zerowym, wbrew wyborowi. Gdyby zaś x = 0, to ka = −lm, skąd, patrz ZTA, m|k, co dałoby |y| = |k| ⩾ m, co znowu jest niemożliwe. □ A oto dowód twierdzenia Fermat’a-Eulera, tym razem za pomocą twierdzenia Thue’go: T R Z E C I D O W Ó D TFE. Załóżmy, że −1 jest resztą kwadratową modulo m, gdzie m ⩾ 2 jest d o w o l n ą liczbą naturalną nie będącą kwadratem. Mamy więc a2 ≡ −1 (mod m) (8.12) dla pewnego a ∈ Z. Jasne, że wtedy NWD (a, m) = 1. Wybierzmy takie x i y jak w tezie twierdzenia Thue’go. Wówczas, po pierwsze: x2 + y2 ≡ x2 − a2y2 = (x − ay)(x + ay) ≡ 0 · (x + ay) ≡ 0 (mod m). A po drugie 0 < x2 + y2 < ( √m)2 + (√m) 2 = 2m. Druga nierówność jest też ostra, bo √ m n i e j e s t liczbą całkowitą. Zatem x2 + y2 jest mniejszą niż 2m i niezerową wielokrotnością m. Stąd x2 + y2 = m. Wiemy dobrze, że jeżeli m = p ≡ 1 (mod 4), to założenie (8.12) jest spełnione. Przeto, każda liczba pierwsza ≡ 1 (mod 4) jest sumą dwóch kwadratów. □ Zabawnym zastosowaniem twierdzenia Minkowskiego jest dowód twierdzenia o party- zantach, które jest tezą poniższego zadania: ZADANIE 8.4 Na rysunku obok widzimy plan fra- gmentu lasu. Tworzące ”kratę” kółka to drzewa . Ich pnie mają taką samą średnicę d. Odległość między środ- kami najbliższych drzew wynosi 1. W punkcie oznaczo- nym krzyżykiem znajduje się obserwator. Udowodnić, że nie może on dostrzec partyzanta znajdującego się w od- ległości większej lub równej 2/d. • • • • • • • • • • • • • • • • • • • • • • • • × • • • • • • • • • • • • • • • • • • • • • • • • 8.3. Nieco geometrii w teorii liczb 283 R o z w i ą z a n i e. Oznaczmy przez O punkt, w którym znajduje się obserwator. Nasze zadanie sprowadza się do wykazania, że jeżeli P jest takim punktem płaszczyzny lasu, że |OP | ⩾ 2/d, to odcinek OP ”zahacza” o pewne drzewo. Aby zobaczyć, że to rzeczywiście zachodzi rozważmy prostokąt R o szerokości d, długości 2|OP |, środku w punkcie O i dłuższym boku rów- noległym do prostej lOP . Prostokąt R jest cen- tralnie symetrycznym zbiorem wypukłym o polu spełniającym |R| = 2|OP | · d ⩾ 4. Na mocy twierdzenia Minkowskiego (i uwagi po nim), co najmniej jedno drzewo ma środek w pro- stokącie R leżący z tej samej strony obserwatora co punkt P partyzanta. Zatem, pień tego drzewa ”zasłania” punkt P . ♦ Rys. 8.5 P O d d 2 d 8.3.5 Liczby naturalne postaci x 2 + 2y2 i x2 + 3y2 Scharakteryzujemy teraz liczby naturalne ze zbiorów W(1, 0, 2) i W(1, 0, 3). Zaczniemy od udo- wodnionego przez Lagrange’a (znanego już Fermat’owi ) następującego twierdzenia: TWIERDZENIE 8.6 (Lagrange – 1775) Nieparzysta liczba pierwsza p da się przedsta- wić w postaci x2 + 2y2 wtedy i tylko wtedy, gdy p ≡ 1, 3 (mod 8). D O W Ó D. Ponieważ kwadraty modulo 8 to 0, 1, 4, a podwojone kwadraty to 0, 2, więc jasne, że suma kwadratu i podwojonego kwadratu może dawać resztę 0, 1, 2, 3, 4, 6 nigdy zaś reszty 5, 7. Stąd wynika, że nie tylko liczby pierwsze ≡ 5, 7 (mod 8) ale w ogóle żadne liczby naturalne ≡ 5, 7 (mod 8) nie mogą być sumami kwadratu i podwojonego kwadratu. Pozostaje nam wykazać, że liczby pierwsze ≡ 1, 3 (mod 8) s ą sumami kwadratu i podwojonego kwadratu. Niech więc p ≡ 1, 3 (mod 8) będzie liczbą pierwszą. To, na mocy (5.83), oznacza, że (−2)Rp, czyli że istnieje liczba całkowita a spełniająca kongruencję: a2 ≡ −2 (mod p). (8.13) Jasne, że p ∤ a. Stosując twierdzenie Thue’go (z m = p i a = a), znajdujemy takie niezerowe liczby całkowite x, y, że x ≡ ay (mod p), a ponadto |x|, |y| < √ p. Wówczas, na mocy (8.13), x2 + 2y2 ≡ x2 − a2y2 ≡ (x − ay)(x + ay) ≡ 0 (mod p), a, ponieważ |x| i |y| są ”małe”, więc x2 + 2y2 < ( √p) 2 + 2( √ p)2 = 3p. Zatem x2 + 2y2 jest dodatnią wielokrotnością liczby p ściśle mniejszą od 3p, co oznacza, że x2 + 2y2 = p lub 2p. Jeżeli x2 + 2y2 = p, to dobra nasza. Jeżeli zaś x2 + 2y2 = 2p, to zachodzi równość x = 2z dla pewnego z ∈ Z. Skąd 2z2 + y2 = p, i znowu liczba p okazała się być równą sumie kwadratu i podwojonego kwadratu. □ 284 8. Sumy kwadratów P r z y k ł a d 1. Niektóre z naszych ulubionych liczb pierwszych dają resztę 1 lub 3 przy dzieleniu przez 8. Są więc sumami kwadratu i podwojonego kwadratu: 1777 = 25 2 + 2 · 24 2, 1801 = 1 2 + 2 · 30 2, 2011 = 43 2 + 2 · 9 2. ♦ Ćwiczenie 8.8 Udowodnić, że jeżeli p > 2 jest taką liczbą pierwszą, że p|s2 + 2t 2 dla pewnych względnie pierwszych liczb całkowitych s, t, to (−2)Rp, więc, że p = x2 + 2y2 dla pewnych względnie pierwszych liczb calkowitych x, y. Ćwiczenie 8.9 Udowodnić, że przedstawienie liczby pierwszej postaci 8k + 1 lub 8k + 3 jako sumy kwadratu i podwojonego kwadratu jest (z dokładnością do znaku) jednoznaczne. ZADANIE 8.5 Udowodnić, że liczba naturalna n da się przedstawić w postaci x2 + 2y2 wtedy i tylko wtedy, gdy dla każdej liczby pierwszej p ≡ 5, 7 (mod 8) wykładnik vp(n) jest liczbą parzystą. R o z w i ą z a n i e. (⇐=) Przedstawiając liczbę naturalną n w postaci n = k2m, gdzie m jest iloczynem różnych liczb pierwszych postaci 2, 8k +1, 8k +3, i pisząc (dzięki wielokrotnemu zastosowaniu T8.6 i tożsamości (8.1) dla c = 2, jest to możliwe) m = x2 + 2y2 otrzymamy n = (kx) 2 + 2(ky) 2. (=⇒) Załóżmy teraz, że n = x2 + 2y2 (8.14) jest sumą kwadratu i podwojonego kwadratu i że liczba pierwsza p ≡ 5, 7 (mod 8) dzieli n. Twierdzimy, że wówczas p|x i p|y. Gdyby bowiem p ∤ y, to oznaczając przez u odwrotność y modulo p mielibyśmy nu2 = (xu) 2 + 2(yu) 2, skąd 0 ≡ (xu) 2 + 2 (mod p) co jest niemożliwe, bo −2 jest nieresztą kwadratową modulo p ≡ 5, 7 (mod 8). Zatem p|y. Równość (8.14) pokazuje więc wtedy, że również p|x. Stąd n = x2 + 2y2 = (pa) 2 + 2(pb) 2, więc p2|n. Dokończenie rozumowania jest oczywiste. ♦ Proponujemy Czytelnikowi, żeby zechciał sprawdzić czy zrozumiał wyżej zaprezentowaną technikę, ćwicząc ją na formie (kwadratowej) X 2 + 3Y 2: Ćwiczenie 8.10 Udowodnić (udowodnione przez Eulera) twierdzenie T8.7. TWIERDZENIE 8.7 Liczba pierwsza p da się przedstawić w postaci x2 + 3y2 wtedy i tylko wtedy, gdy p ≡ 1, 7 (mod 12). □ Ćwiczenie 8.11 Udowodnić, że przedstawienie liczby pierwszej p ≡ 1 (mod 6) (czyli ≡ 1, 7 (mod 12)) w postaci sumy kwadratu i potrojonego kwadratu jest, z dokładnością do znaku, j e d n o z n a c z n e. Ćwiczenie 8.12 Udowodnić, że liczba naturalna n jest postaci x2 + 3y2 wtedy i tylko wtedy, gdy wykładnik p-adyczny vp(n) jest liczbą parzystą dla p = 2 i dla każdej liczby pierwszej p ≡ 5, 11 (mod 12). 8.3. Nieco geometrii w teorii liczb 285 P r z y k ł a d 2. Niektóre z naszych ulubionych liczb pierwszych dają resztę 1 lub 7 przy dzieleniu przez 12. Są więc sumami kwadratu i potrojonego kwadratu: 1777 = 7 2 + 3 · 24 2, 1783 = 14 2 + 3 · 23 2, 1801 = 37 2 + 3 · 12 2. Liczba 7204 = 4 · 1801 spełnia warunki z ćwiczenia C8.12 i ma następujące dwa przedstawienia w postaci x2 + 3y2: 7204 = 4 · 1801 = 4 · (37 2 + 3 · 12 2) = 742 + 3 · 24 2, 7204 = (1 2 + 3 · 1 2)(37 2 + 3 · 12 2) = (37 − 3 · 12) 2 + 3(12 + 37)2 = 1 2 + 3 · 49 2. Drugie przedstawienie dostajemy za pomocą tożsamości podstawowej (8.1). ♦ 8.3.6 Liczby pierwsze postaci x 2 + 5y2 W tym ustępie powiemy trochę na temat przedstawiania liczb naturalnych w postaci x2 + 5y2. Sprawa jest bardziej skomplikowana niż w dotychczas rozważanych przypadkach. Zaczniemy od rozwiązania zadania z ﬁnału LIX Olimpiady Matematycznej. ZADANIE 8.6 Udowodnić, że jeżeli liczba pierwsza p ≡ 3 (mod 4) jest dzielnikiem liczby s2 + 5t 2 przy pewnych względnie pierwszych s, t ∈ Z, to istnieją takie względnie pierwsze liczby całkowite x, y, że 2p = x2 + 5y2. R o z w i ą z a n i e. S p o s ó b 1. (Szkic rozwiązania ﬁrmowego) Warunek p|s2+5t2, czyli kon- gruencja s2 ≡ −5t 2 (mod p) przy względnie pierwszych s, t, implikuje, że p ∤ t. Więc t (mod p) jest odwracalne. Niech u będzie odwrotnością t modulo p. Wtedy (su) 2 ≡ −5 (mod p). To oznacza, że a = su spełnia kongruencję: a2 ≡ −5 (mod p). (8.15) Ponieważ p ∤ a, więc możemy przywołać twierdzenie Thue’go, T8.5, i znaleźć x, y ∈ Z ∖ {0} spełniające warunki: x ≡ ay (mod p) i |x|, |y| ⩽ √p. Wówczas, podobnie jak w trzecim dowodzie TFE i w dowodzie T8.6, sprawdzamy, że x2 + 5y2 ≡ x2 − a2y2 ≡ (x − ay)(x + ay) ≡ 0 (mod p), (8.16) czyli, że x2 + 5y2 jest niezerową wielokrotnością p. Ponadto, nierówności |x|, |y| < √p dają x2 + 5y2 < ( √p) 2 + 5(√p) 2 = 6p. (8.17) Widzimy stąd, że x2 + 5y2 = p, 2p, 3p, 4p lub 5p. W rozwiązaniu ﬁrmowym należało w tym miejscu wykluczyć wszystkie możliwości z wyjątkiem x2 + 5y2 = 2p. Jeżeli wykorzystamy za- łożenie, że p ≡ 3 (mod 4), to odrzucenie możliwości p i 5p jest proste. Wystarczy zredukować modulo 4: p ≡ 5p ≡ x2 + 5y2 ≡ x2 + y2 ≡ 0, 1, 2 (mod 4). (8.18) 286 8. Sumy kwadratów I dostajemy sprzeczność z założeniem, że p ≡ 3 (mod 4). Odrzucenie możliwości 3p i 4p jest nieco bardziej wymagające. Czytelnik może zechce to zrobić samodzielnie, my tymczasem zaproponujemy sposób trochę bardziej ”uczony”. ♦ S p o s ó b 2. Wykorzystamy twierdzenie Minkowskiego T8.4, ze stosownie dobraną e l i p s ą w charakterze ﬁgury wypukłej. Początek rozwiązania jest taki sam jak wyżej. Niech więc a spełnia (8.15). Rozważmy tę samą kratę co w drugim sposobie dowodu twierdzenia Thue’go (przy m = p): Λ(u, w), gdzie u = (a, 1), w = (p, 0) (wyróżnik d(Λ) tej kraty jest równy p). Wybierzemy natomiast lepszy (dla naszych celów) zbiór wypukły. Mianowicie, niech F będzie elipsą (pełną): F = {(x, y) : x2 + 5y2 ⩽ K} , gdzie K = 4√5 π−1p. Elipsa F ma półosie √K i √ K/5, więc jej pole wynosi µ(F) = π√K √ K/5 = 4p ⩾ 4d(Λ). Ponadto, elipsa ta jest zbiorem centralnie symetrycznym, wypu- kłym i domkniętym (zobacz GEO ). Z twierdzenia Minkowskiego wnosimy więc, że zawiera ona niezerowy punkt kraty Λ. Niech to będzie (x, y) = ku + lw = (ka + lp, k). Ponieważ x ≡ ay (mod p), więc tak samo jak w (8.16) widzimy, że p|x2 + 5y2. Przewaga tego sposobu rozwiązania nad sposobem 1 polega na tym, że możemy znacznie poprawić szacowanie (8.17). Mamy mianowicie x2 + 5y2 ⩽ K = 4 √5π−1 p, ponieważ punkt (x, y) należy do elipsy F. Stąd, ponieważ 4 √5π−1 ≈ 2, 8470 < 3, więc x2 + 5y2 = p lub x2 + 5y2 = 2p. Przypadek x2 + 5y2 = p odrzucamy jak wyżej. Względna pierwszość x i y jest oczywista. ♦ Analizując sposób 2 przedstawionego wyżej rozwiązania udowodnimy: TWIERDZENIE 8.8 Liczba pierwsza p > 5 da się przedstawić w postaci x2 + 5y2 wtedy i tylko wtedy, gdy p ≡ 1, 9 (mod 20). D O W Ó D. Liczby pierwsze p > 5 są jednej z ośmiu postaci: 20k ± 1, 20k ± 3, 20k ± 7 lub 20k ± 9. [Wiemy z twierdzenia Dirichlet’a, że każda z tych postaci jest reprezentowana przez nieskończenie wiele liczb pierwszych.] Jeżeli p = x2 + 5y2, to (−5)Rp, zobacz C8.1. Ale, zobacz (5.87), (−5)Rp wtedy i tylko wtedy, gdy p ≡ 1, 3, 7, 9 (mod 20). Wobec tego liczby pierwsze p ≡ 19, 17, 13, 11 (mod 20) n i e s ą postaci x2 + 5y2. Również liczby pierwsze p ≡ 3, 7 (mod 20) n i e s ą postaci x2 + 5y2. Łatwo to zobaczyć badając reszty z dzielenia przez 4: x2 + 5y2 ≡ 0, 1, 2 (mod 4), zobacz (8.18), a p ≡ 3, 7 (mod 20) daje resztę 3 modulo 4. Widzimy, że jedynie liczby pierwsze p ≡ 1, 9 (mod 20) mają szansę na bycie postaci x2 + 5y2. Niech p ≡ 1, 9 (mod 20) będzie taką liczbą pierwszą. W sposobie 2 rozwiązania Z8.6 wy- kazaliśmy, że istnieją takie liczby x, y, że x2 + 5y2 = p lub x2 + 5y2 = 2p. Badając modulo 8 łatwo widzimy, że x2 + 5y2 ̸= 2p. (Istotnie, jeżeli p ≡ 1, 9 (mod 20), to 2p ≡ 2 (mod 8). Jednocześnie x2 + 5y2 ≡ 0, 1, 4, 5, 6 (mod 8). Zatem x2 + 5y2 ̸≡ 2p (mod 8), więc tym bardziej x2 + 5y2 ̸= 2p.) Wobec tego x2 + 5y2 = p. □ P r z y k ł a d 1. Liczby pierwsze 1801 i 1789 dają resztę 1 i 9 modulo 20. Zatem: 1801 = 26 2 + 5 · 15 2, 1789 = 13 2 + 5 · 18 2. ♦ 8.4. Binarne formy kwadratowe 287 Ćwiczenie 8.13 Udowodnić, że przedstawienie liczby pierwszej w postaci x2 + cy2 (jeżeli istnieje) jest jednoznaczne z dokładnością do znaku. Wskazówka. Zobacz Z8.2. Pierre Fermat przyglądał się liczbom pierwszym ≡ 3, 7 (mod 20), o których wiemy, że n i e s ą postaci x2 + 5y2, i zauważył, że iloczyn każdych dwóch takich liczb j e s t postaci x2 + 5y2. Weźmy na przykład p = 23, q = 47. Wówczas pq = 19 2 + 5 · 12 2, p 2 = 22 2 + 5 · 3 2, q2 = 2 2 + 5 · 21 2. ZADANIE 8.7 Uzasadnić spostrzeżenie Fermata. R o z w i ą z a n i e. Z rozwiązania zadania Z8.6 wiemy, że jeżeli p ≡ 3, 7 (mod 20), to 2p da się przedstawić w postaci x2 + 5y2. Niech więc p1, p2 ≡ 3, 7 (mod 20) i niech 2p1 = x2 1 + 5y2 1, 2p2 = x2 2 + 5y2 2. Wówczas, na mocy tożsamości Brahmagupty, 4p1p2 = (x1x2 ± 5y1y2)2 + 5(x1y2 ∓ x2y1) 2. Zauważmy, że liczby x1, x2, y1, y2 są nieparzyste(?!) i podzielmy obustronnie przez 4. Podkreślmy też, że mamy swobodę wyboru znaków w nawiasach. Stąd, obok przedstawienia 23·47 = 192+5·12 2 dostajemy również przedstawienie 23·47 = 262+5·9 2, a obok przedstawienia 23 2 = 22 2 + 5 · 3 2 przedstawienie trywialne 23 2 = 23 2 + 5 · 0 2. I podobnie dla 47 2. ♦ W następnym paragraﬁe a także w rozdziale 10 rzucimy jeszcze trochę światła na to intry- gujące zjawisko. Tymczasem rozwiążmy takie ćwiczenie: Ćwiczenie 8.14 Niech c będzie dodatnią liczbą całkowitą. Niech też m ⩾ 2 oznacza ustalony moduł. Załóżmy, że (−c)Rm. (Przypomnijmy, że w tym jest zawarty warunek NWD (m, c) = 1, zobacz D5.12). Udowodnić, że wówczas co najmniej jedna z liczb m, 2m, . . . , ⌊Mc⌋ m da się zapisać w postaci x2 + cy2 dla całkowitych x, y ̸= 0. Tu Mc = 4 π √c. Liczbę Mc nazywamy stałą Minkowskiego (dla wyróżnika ∆ = −4c). Stała M6 jest równa w przybliżeniu 3, 1188. Możemy to wykorzystać w rozwiązaniu poniższego ćwiczenia: Ćwiczenie 8.15 Dowieść, że liczba pierwsza p da się przedstawić w postaci x2 + 6y2 wtedy i tylko wtedy, gdy p ≡ 1, 7 (mod 24). Udowodnić, że iloczyn dwóch liczb pierwszych p1, p2 ≡ 5, 11 (mod 24) da się przedstawić w postaci x2 + 6y2. 8.4 Binarne formy kwadratowe Wielomiany X 2 + cY 2 ∈ Z[X, Y ], których zbiorami wartości (dla argumentów całkowitych) zajmowaliśmy się dotychczas, są przykładami tak zwanych (binarnych) form kwadratowych. Badanie zbiorów wartości binarnych form kwadratowych jest fascynujące i prowadzi do rozle- głych dziedzin matematyki, takich jak algebraiczna teoria liczb czy teoria form modu- larnych. Nasz cel jest nierównie skromniejszy: przedstawienie dowodu Lagrange’a twierdzenia Fermat’a-Eulera TFE. 288 8. Sumy kwadratów Deﬁnicja 8.5 Wielomian dwóch zmiennych o współczynnikach całkowitych f (X, Y ) = aX 2 + bXY + cY 2 (8.19) nazywamy binarną formą kwadratową. Mówimy, że forma f (X, Y ) przedstawia liczbę całkowitą n, gdy istnieją takie liczby całkowite x, y, że f (x, y) = n. Gdy, dodatkowo, można znaleźć takie x, y, że NWD (x, y) = 1 i f (x, y) = n, to mówimy, że forma f właściwie przedstawia liczbę n. Dla skrócenia zapisu formę aX 2 +bXY +cY 2 będziemy oznaczać sym- bolem (a, b, c). Zbiór liczb, które przedstawia ta forma oznaczamy W(a, b, c) = Wf . [Binarny oznacza tu: dwóch zmiennych.] P r z y k ł a d. Dotychczas zajmowaliśmy się formami (1, 0, c) = X 2 +cY 2. Wiemy, na przy- kład, że liczby pierwsze p ≡ 1 (mod 4) są w ł a ś c i w i e przedstawiane przez formę (1, 0, 1). Ogólniej, jasne jest, że każde przedstawienie liczby pierwszej p przez formę kwadratową jest przedstawieniem w ł a ś c i w y m, bo kwadrat (każdego) wspólnego dzielnika x, y jest dzielni- kiem p. Również przedstawienie liczby bezkwadratowej jest przedstawieniem właściwym. W przykładzie P2 z ustępu 8.3.5 widzieliśmy, że forma (1, 0, 3) przedstawia zarówno właściwie jak i niewłaściwie liczbę 7204. ♦ 8.4.1 Wyróżnik formy Wyróżnik formy kwadratowej zawiera ważne informacje na jej temat. Deﬁnicja 8.6 Liczbę ∆ = b2 − 4ac nazywamy wyróżnikiem formy kwadratowej (8.19). Jasne, że wyróżnik formy jest liczbą całkowitą spełniającą warunek ∆ ≡ 0, 1 (mod 4). ZADANIE 8.8 Udowodnić, że dla dowolnej liczby całkowitej ∆ ≡ 0, 1 (mod 4) istnieje forma kwadratowa, której wyróżnik równy jest ∆. R o z w i ą z a n i e. Jeżeli ∆ ≡ 0 (mod 4), to forma X 2 − 1 4∆Y 2 jest oczywiście dobra. Jeżeli zaś ∆ ≡ 1 (mod 4), to oczywiście dobrą jest forma X 2 + XY + 1 4(1 − ∆)Y 2. ♦ 8.4.2 Równoważność form Wprowadzimy teraz ważne pojęcie równoważności form. Formy równoważne przedstawiają dokładnie te same liczby. Deﬁnicja 8.7 Mówimy, że forma f (X, Y ) jest równoważna formie g(X, Y ), gdy istnieje taka macierz (A B C D) ∈ GL2(Z) (zobacz 7.3.4), że g(x, y) = f (Ax + By, Cx + Dy) dla wszystkich (x, y) ∈ Z × Z. Piszemy w takim przypadku f (A B C D) = g. Fakt, że formy f i g są równoważne zapisujemy tak: f ≃ g. P r z y k ł a d 1. Równość (2x+3y)2+(x+2y)2 = 5x2+16xy+13y2 prawdziwa dla wszystkich (x, y) ∈ Z × Z pokazuje, że (1, 0, 1) (2 3 1 2) = (5, 16, 13). ♦ 8.4. Binarne formy kwadratowe 289 Ćwiczenie 8.16 Udowodnić, że relacja ≃ jest relacją równoważności, zobacz KOM . Ćwiczenie 8.17 Formy równoważne mają równe wyróżniki. Dowieść. Wskazówka. Ele- ganckie rozwiązanie korzysta z T7.8. ZADANIE 8.9 Udowodnić, że jeżeli formy aX 2 + bXY + cY 2 i a1X 2 + b1XY + c1Y 2 są równoważne, to zbiory W(a, b, c) i W(a1, b1, c1) są równe. R o z w i ą z a n i e. Teza wynika z możliwości ”odwrócenia” zależności { x′ = Ax + By, y′ = Cx + Dy, gdzie (A B C D) ∈ GL2(Z). Istotnie, równości te są równoważne równościom { x = Dwx′ − Bwy′, y = −Cwx ′ + Awy′, gdzie w = AD − BC =: det (A B C D) . ♦ P r z y k ł a d 2. Zauważmy, że oczywista równość a(x + ry) 2 + b(x + ry)y + cy2 = ax2 + (b + 2ar)xy + (c + br + ar2)y2 pokazuje, że forma (a, b, c) jest równoważna formie ze współczynnikiem środkowym niewięk- szym co do wartości bezwzględnej niż współczynnik lewy. Wystarczy dobrać taką liczbę całko- witą r, by |b + 2ra| ⩽ |a|. Na przykład, równość 3(x + 2y) 2 − 11(x + 2y)y + y2 = 3x2 + xy − 9y2 pokazuje, że (3, −11, 1) ≃ (3, 1, −9), przy czym macierzą realizującą tę równoważność jest( 1 2 0 1) ∈ SL2(Z). ♦ Formy równoważne przedstawiają te same liczby. Jednak nie musi być na odwrót: P r z y k ł a d 3. Uzasadnimy, że W(1, 1, 1) = W(1, 0, 3) mimo, że (1, 1, 1) ̸≃ (1, 0, 3) [bo pierwsza z tych form ma wyróżnik −3, a druga ma wyróżnik −12]. Tymczasem równość x2 + 3y2 = (x − y) 2 + (x − y) · 2y + (2y) 2 pokazuje, że każda liczba będąca sumą kwadratu i potrojonego kwadratu jest przedstawialna przez formę (1, 1, 1). Zatem W(1, 0, 3) ⊆ W(1, 1, 1). Odwrotnie, weźmy liczbę u 2 + uv + v2 przedstawianą przez formę (1, 1, 1). Wówczas u2 + uv + v2 =  || || (u + v 2 )2 + 3 · ( v 2 )2 , gdy v ≡ 0 (mod 2), ( u 2 + v)2 + 3 · ( u 2 )2 , gdy u ≡ 0 (mod 2), ( u−v 2 )2 + 3 · ( u+v 2 )2 , gdy u ≡ v ≡ 1 (mod 2), co dowodzi zawierania W(1, 1, 1) ⊆ W(1, 0, 3). ♦ 290 8. Sumy kwadratów 8.4.3 Lemat Lagrange’a Udowodnimy teraz ważny lemat. Dzięki niemu można rozstrzygać problem przedstawiania liczb całkowitych przez formy kwadratowe danego wyróżnika. LEMAT 8.3 Forma f (X, Y ) właściwie przedstawia liczbę całkowitą n wtedy i tylko wtedy, gdy istnieje równoważna jej forma postaci g(X, Y ) = nX 2 + kXY + mY 2. D O W Ó D. (=⇒) Załóżmy, że forma f (X, Y ) = aX 2 + bXY + cY 2 przedstawia właściwie liczbę n. Wówczas istnieją takie względnie pierwsze liczby A i C, że f (A, C) = n. Ze względnej pierwszości wynika istnienie takich liczb całkowitych B, D, że AD − BC = 1, zobacz T2.6. Wtedy f (Ax + By, Cx + Dy) = a(Ax + By)2 + b(Ax + By)(Cx + Dy) + c(Cx + Dy)2 = (aA 2 + bAC + cC 2)x2 + . . . = nx2 + kxy + my2 =: g(x, y), gdzie k = 2aAB + bBC + bAD + 2cCD i m = f (B, D) = aB2 + bBD + cD2. Zatem g ≃ f i g(1, 0) = n, więc forma g(X, Y ) właściwie przedstawia liczbę n. (⇐=) Wynikanie w tę stronę jest natychmiastowym wnioskiem z Z8.9. □ Udowodnimy teraz dwa twierdzenia o możliwości przedstawiania liczb całkowitych przez formy kwadratowe. TWIERDZENIE 8.9 Jeżeli forma f (X, Y ) ma wyróżnik ∆ i właściwie przedstawia liczbę n, a d jest dzielnikiem liczby n, to istnieje forma h(X, Y ) mająca ten sam wyróżnik ∆, która właściwie przedstawia liczbę d. D O W Ó D. Niech n = de. Z lematu Z8.3 wiemy, że istnieje forma (n, k, m) równoważna formie f (X, Y ). Wówczas ∆ = k2 − 4mn = k2 − 4med. Zatem forma h(X, Y ) = dX 2 + kXY + meY 2 ma wyróżnik ∆ i właściwie przedstawia liczbę d = h(1, 0). □ TWIERDZENIE 8.10 Niech ∆ ≡ 0, 1 (mod 4). Wówczas liczba n ∈ Z może być właściwie przedstawiona przez p e w n ą formę o wyróżniku ∆ wtedy i tylko wtedy, gdy istnieje liczba całkowita k spełniająca k2 ≡ ∆ (mod 4|n|). (8.20) D O W Ó D. (=⇒) Załóżmy, że n = ax2 + bxy + cy2 dla pewnych a, b, c ∈ Z i pewnych względnie pierwszych x, y ∈ Z. Wówczas, jak wiemy z lematu L8.3, istnieje forma (n, k, m) równoważna formie (a, b, c). W szczególności, zobacz C8.16, wyróżnik ∆ = b2 − 4ac równa się wyróżnikowi formy (n, k, m). Zatem ∆ = k2 − 4mn. Więc (8.20) zachodzi. (⇐=) Odwrotnie, jeżeli zachodzi (8.20), czyli zachodzi równość k2 − ∆ = 4mn dla pewnej liczby całkowitej m, to forma f (X, Y ) = nX 2 + kXY + mY 2 ma wyróżnik równy ∆ i f (1, 0) = n. Zatem p e w n a forma o wyróżniku ∆ właściwie przedstawia n. □ P r z y k ł a d 2. Rozważmy wyróżnik ∆ = −4. Twierdzenie T8.10 mówi, że liczba całkowita n da się właściwie przedstawić przez p e w n ą formę o wyróżniku −4 wtedy i tylko wtedy, gdy istnieje rozwiązanie kongruencji u 2 ≡ −4 (mod 4|n|). Jasne, że rozwiązanie tej kongruencji jest 8.4. Binarne formy kwadratowe 291 liczbą parzystą: u = 2t. To prowadzi do badania kongruencji t 2 ≡ −1 (mod |n|), czyli do problemu istnienia pierwiastków kongruencji wielomianowej t2 + 1 ≡ 0 (mod |n|). (8.21) Rozłóżmy liczbę naturalną |n| na czynniki pierwsze |n| = pe1 1 · pe2 2 · . . . · pes s . Z wniosku WT5.13 wiemy, że kongruencja (8.21) ma rozwiązanie wtedy i tylko wtedy, gdy mają rozwiązania wszystkie kongruencje t 2 + 1 ≡ 0 (mod pei i ) (8.22) dla każdego i = 1, 2, . . . , s. Jeżeli pi > 2, to kongruencja (8.22) ma rozwiązanie wtedy i tylko wtedy, gdy pi ≡ 1 (mod 4), zobacz T5.30. Zaś kongruencja t2 ≡ −1 (mod 2e) ma rozwiązanie wtedy i tylko wtedy, gdy e ⩽ 1. Podsumowując, widzimy, że liczba całkowita n da się w ł a ś c i w i e przedstawić przez pewną formę o wyróżniku −4 wtedy i tylko wtedy, gdy 4 ∤ n i vp(n) = 0 dla wszystkich liczb pierwszych p ≡ 3 (mod 4). W szczególności każda liczba pierwsza p ≡ 1 (mod 4) da się przedstawić przez pewną formę o wyróżniku −4. Pomysł Lagrange’a dowodu twierdzenia Fer- mat’a-Eulera polega na wykazaniu, że k a ż d a forma o wyróżniku −4 jest równoważna formie (1, 0, 1) lub formie (−1, 0, −1). Zobaczymy to w następnym ustępie. ♦ Ćwiczenie 8.18 Scharakteryzować te liczby całkowite, które można właściwie przedstawić przez pewną formę o wyróżniku −3 i te liczby całkowite, które można przedstawić przez pewną formę o wyróżniku −12. Jakie stąd płyną wnioski? Ćwiczenie 8.19 Scharakteryzować wszystkie liczby całkowite, które dadzą się przedstawić przez pewną formę o wyróżniku 8. 8.4.4 Redukcja form dodatnio-określonych Formy kwadratowe (8.19) dzielą się na dwa typy: formy o wyróżniku d o d a t n i m, są to tak zwane formy nieokreślone i formy o wyróżniku u j e m n y m, są to tak zwane formy okre- ślone. Dla uproszczenia ograniczymy się tu do form określonych. Dla danej formy dodatnio- określonej będziemy poszukiwać – wśród form jej równoważnych – formy najprostszej. Deﬁnicja 8.8 Forma kwadratowa przyjmująca wyłącznie w a r t o ś c i n i e u j e m n e, przy czym wartość 0 tylko dla (x, y) = (0, 0), nazywa się formą dodatnio-określoną. ZADANIE 8.10 Udowodnić, że forma f (X, Y ) = aX 2 + bXY + cY 2 jest dodatnio- określona wtedy i tylko wtedy, gdy a, c > 0 i ∆ < 0. R o z w i ą z a n i e. To wynika z oczywistej tożsamości 4af (x, y) = (2ax + by)2 − ∆y2, (8.23) czyli z postaci kanonicznej trójmianu kwadratowego, patrz ustęp 3.2.5. ♦ 292 8. Sumy kwadratów TWIERDZENIE 8.11 Jeżeli (a, b, c) jest formą dodatnio-określoną, to istnieje równo- ważna jej forma (a0, b0, c0) spełniająca warunki |b0| ⩽ a0 ⩽ c0, (8.24) przy czym, jeżeli a0 = c0, to można wybrać b0 nieujemne. D O W Ó D. Dla dowodu podamy algorytm pozwalający w skończonej liczbie kroków z r e d u k o w a ć daną formę do postaci spełniającej (8.24). Algorytm ten polega na kolejnym wykonywaniu jednej z następujących procedur: (1) Jeżeli c < a, to zamieniamy formę (a, b, c) na równoważną jej formę (c, −b, a), (2) Jeżeli |b| > a, to zamieniamy formę (a, b, c) na równoważną jej formę (a, b1, c1), gdzie b1 = b + 2ra i r ∈ Z jest tak wybrane, żeby |b1| ⩽ a. Przy tym c1 wyznaczamy z równości b2 1 − 4ac1 = ∆. Macierz (A B C D) realizująca równoważność w procedurze (1) jest równa ( 0 −1 1 0 ) (macierz za- miany (X, Y ) na (−Y, X)). W procedurze (2) używamy macierzy (1 r 0 1) . Widzimy, że uży- wamy wyłącznie macierzy S i T zdeﬁniowanych w (7.20), bo (1 r 0 1) = Tr. □ P r z y k ł a d. Weźmy formę (10, 34, 29) o wyróżniku −4. Tu b > a. Stosując procedurę (2), znajdujemy b1 z przedziału [ −10; 10 ]. W tym celu odejmujemy od b odpowiednią wielokrotność 20, w tym przypadku 40. Po tym otrzymujemy formę (10, −6, c1), gdzie c1 spełnia warunek −4 = (−6)2−4·10c1, więc c1 = 1. Mamy więc równoważną formę (10, −6, 1). Stosujemy teraz procedurę (1). Dostajemy formę (1, 6, 10). Stosujemy ponownie procedurę (2). Dostaniemy formę (1, 0, c2), gdzie c2, wyliczone z równości −4 = 02 − 4 · 1 · c2, jest równe 1. Widzimy więc, że 10X 2 + 34XY + 29Y 2 ≃ X 2 + Y 2. ♦ Dodatnio-określoną formę spełniającą warunki (8.24) nazywa się formą zredukowaną. To, że forma (10, 34, 29) o wyróżniku −4 jest równoważna formie (1, 0, 1) nie jest niczym dziwnym, bowiem: ZADANIE 8.11 Udowodnić, że wszystkie dodatnio-określone formy o wyróżniku −4 są równoważne formie (1, 0, 1) = X 2 + Y 2. R o z w i ą z a n i e. Niech (a0, b0, c0) będzie zredukowaną formą dodatnio-określoną o wy- różniku −4. Wtedy b2 0 = 4a0c0 − 4 ⩾ 4b2 0 − 4. Stąd |b0| ⩽ √ 4/3, czyli |b0| ⩽ 1. Ale b0 jest parzyste. Więc b0 = 0. Wobec tego 4a0c0 = 4, czyli a0 = c0 = 1. ♦ Dzięki temu możemy udowodnić twierdzenie Fermat’a-Eulera m e t o d ą L a g r a n g e’ a: C Z W A R T Y D O W Ó D TFE. Jeżeli p ≡ 1 (mod 4), to, jak wiemy, zobacz dowód lematu L8.2 z ustępu 8.2.2 lub I uzupełnienie prawa wzajemności, kongruencja u 2 ≡ −4 (mod 4p) ma rozwiązania. Wobec tego, zobacz T8.10, p e w n a forma f (X, Y ) o wyróżniku −4 przedstawia liczbę p. Ale f (X, Y ) ≃ X 2 + Y 2, więc i X 2 + Y 2 przedstawia p, zobacz Z8.9. □ Ćwiczenie 8.20 Udowodnić podobnie twierdzenie T8.2. Zob. 8.4.3 P2. 8.5. Sumy więcej niż dwóch kwadratów 293 Tabelka dodatnio-określonych form zredukowanych dla małych |∆| ∆ Wszystkie zredukowane dodatnio-określone formy o wyróżniku ∆ h(∆) −3 X 2 + XY + Y 2 1 −4 X 2 + Y 2 1 −7 X 2 + XY + 2Y 2 1 −8 X 2 + 2Y 2 1 −11 X 2 + XY + 3Y 2 1 −12 X 2 + 3Y 2 1 −15 X 2 + XY + 4Y 2, 2X 2 + XY + 2Y 2 2 −19 X 2 + XY + 5Y 2 1 −20 X 2 + 5Y 2, 2X 2 + 2XY + 3Y 2 2 −23 X 2 + XY + 6Y 2, 2X 2 − XY + 3Y 2, 2X 2 + XY + 3Y 2 3 Ćwiczenie 8.21 Udowodnić, że w powyższej tabelce jest wszystko w porządku. Ćwiczenie 8.22 Wyznaczyć rozwiązania równania 57x2 + 144xy + 91y2 = 1801 w liczbach całkowitych, zobacz P2 z ustępu 8.3.5. Ćwiczenie 8.23 Udowodnić, że jeżeli nieparzysta liczba pierwsza p jest dzielnikiem liczby a2 + 3, to forma X 2 + XY + Y 2 przedstawia liczbę p. Ćwiczenie 8.24 Dowieść, że jeżeli −7 jest resztą kwadratową modulo p ≡ 1 (mod 2), to równanie x2 + xy + 2y2 = p ma rozwiązania w liczbach całkowitych. ZADANIE 8.12 Rozwiązać jeszcze raz zadanie Z8.6. R o z w i ą z a n i e. Jeżeli liczba pierwsza p jest dzielnikiem liczby s2 + 5t 2 przy pewnych względnie pierwszych s, t, to istnieje a spełniające a2 ≡ −5 (mod p). Wówczas 2a jest rozwiązaniem kongruencji u 2 ≡ −20 (mod 4p). Zatem, na mocy T8.10, liczba p może być właściwie przedstawiona przez p e w n ą formę o wyróżniku −20. Czyli (zobacz tabelkę) przez formę X 2 +5Y 2 lub przez formę 2X 2 +2XY +3Y 2. Ponieważ forma X 2 +5Y 2 nie przedstawia liczb pierwszych p ≡ 3 (mod 4) (co pokazuje redukcja modulo 4), więc ”robi” to forma 2X 2 + 2XY + 3Y 2. Istnieją więc względnie pierwsze x, y ∈ Z, dla których 2x2 + 2xy + 3y2 = p. Wówczas (2x + y) 2 + 5y2 = 2p. ♦ 8.5 Sumy więcej niż dwóch kwadratów Powiemy tu co nieco na temat przedstawiania liczb naturalnych w postaci sumy trzech lub czterech kwadratów. Zaczniemy od wyniku pozytywnego. 294 8. Sumy kwadratów 8.5.1 Twierdzenie o sumach czterech kwadratów Pokażemy teraz dowód twierdzenia Lagrange’a mówiącego, że każda liczba naturalna d a s i ę (niejednoznacznie!) przedstawić w postaci sumy czterech kwadratów liczb całkowitych. Podstawową rolę odegra przy tym następująca tożsamość Eulera: (a2 + b2 + c2 + d2)(x2 + y2 + u2 + v2) = = (ax + by + cu + dv) 2 + (ay − bx + cv − du)2+ + (au − bv − cx + dy) 2 + (av + bu − cy − dx)2. (8.25) Tożsamość Eulera jest uogólnieniem tożsamości Brahmagupty-Fibonacci’ego (8.1) (dla c = 1). Jej dowód polega na oczywistym rachowaniu. Wykorzystamy ją w dowodzie twierdzenia Lagrange’a T8.12 (podobnie jak wykorzystywaliśmy tożsamość Fibonacci’ego w drugim dowo- dzie twierdzenia Fermat’a-Eulera). Znający kwaterniony rozpoznają w tożsamości Eulera inny zapis faktu, że moduł iloczynu dwóch kwaternionów równy jest iloczynowi modułów tych kwaternionów. Leonhard Euler, próbując udowodnić twierdzenie T8.12 ”odkrył” tę tożsamość w roku 1748 (więc na blisko sto lat przed ”odkryciem” kwaternionów przez Hamiltona). Ja- sne, że (dzięki tożsamości Eulera) wystarczy udowodnić, że każda liczba p i e r w s z a da się przedstawić w postaci sumy czterech kwadratów. Przechodzimy do sformułowania i dowodu twierdzenia Lagrange’a: TWIERDZENIE 8.12 (Lagrange’ a o czterech kwadratach) Każda liczba naturalna da się przedstawić w postaci sumy czterech kwadratów (liczb całkowitych). D O W Ó D. Dowód jest podobny do przedstawionego w ustępie 8.2.2 dowodu twierdzenia Fermat’a-Eulera T8.1. Zaczniemy od łatwego lematu. LEMAT 8.4 Jeżeli p jest dowolną nieparzystą liczbą pierwszą, to istnieje liczba naturalna m < p i takie liczby całkowite x, y, u, v, że mp = x2 + y2 + u 2 + v2. D O W Ó D. Niech s = p−1 2 . Rozważmy dwa podzbiory w Z/p: A = {x2 (mod p) : 0 ⩽ x ⩽ s}, B = {−y2 − 1 (mod p) : 0 ⩽ y ⩽ s}. Z łatwością sprawdzamy, że każdy z tych zbiorów ma dokładnie s + 1 elementów. Zatem A ∩ B ̸= ∅. Istnieją więc takie liczby całkowite 0 ⩽ x, y ⩽ s, że x2 ≡ −y2 − 1 (mod p), czyli, że x2 + y2 + 1 2 + 0 2 = mp dla pewnej liczby naturalnej m. Ponadto x2 + y2 + 1 2 + 0 2 ⩽ s2 + s2 + 1 < p 2. Wystarczy położyć u = 1, v = 0. □ W kolejnym lemacie będziemy ”zmniejszali” m. LEMAT 8.5 Każdą liczbę p i e r w s z ą da się przedstawić w postaci sumy czterech kwa- dratów liczb całkowitych. 8.5. Sumy więcej niż dwóch kwadratów 295 D O W Ó D. Rzecz jest oczywista dla p = 2. Załóżmy więc, że p jest nieparzystą liczbą pierwszą i że (istniejąca na mocy poprzedniego lematu) liczba m > 0 w przedstawieniu mp = x2 + y2 + u2 + v2 (8.26) jest n a j m n i e j s z a z możliwych. Udowodnimy, że wówczas: (1) m n i e j e s t liczbą parzystą, (2) m n i e j e s t liczbą nieparzystą ⩾ 3. (1) Gdyby m = 2m ′, to dwie spośród liczb x, y, u, v byłyby tej samej parzystości i dwie pozostałe również tej samej parzystości. Nie zmniejszając ogólności możemy założyć, że x ≡ y (mod 2) i u ≡ v (mod 2). Wówczas ( x + y 2 )2 + (x − y 2 )2 + ( u + v 2 )2 + ( u − v 2 )2 = x2 + y2 + u 2 + v2 2 = m ′p, co jest niemożliwe, bo m miało być najmniejsze. (2) Załóżmy teraz, że m ⩾ 3 jest liczbą nieparzystą i podzielmy liczby x, y, u, v przez m z najmniejszą, co do wartości bezwzględnej, resztą:  ||| ||| x = x1m + a, gdzie |a| < m 2 , y = y1m + b, gdzie |b| < m 2 , u = u1m + c, gdzie |c| < m 2 , v = v1m + d, gdzie |d| < m 2 . (8.27) Z tych równości otrzymujemy a2 + b2 + c2 + d2 = (x − x1m)2 + (y − y1m) 2 + (u − u1m) 2 + (v − v1m) 2 = mp + Am, gdzie A ∈ Z. Stąd mm ′ = a2 + b2 + c2 + d 2 (8.28) dla pewnego m ′ ∈ Z. Z nierówności max {|a|, |b|, |c|, |d|} < m/2 otrzymujemy a2 + b2 + c2 + d2 < 4 · (m 2 )2 = m2, co, wobec równości (8.28), dowodzi, że m ′ < m. Pomnóżmy teraz równości (8.28) i (8.26) stronami i skorzystajmy z tożsamości Eulera. Dostaniemy mm ′ · mp = X 2 + Y 2 + U 2 + V 2, (8.29) gdzie X = ax + by + cu + dv, Y = ay − bx + cv − du, U = au − bv − cx + dy, V = av + bu − cy − dx. 296 8. Sumy kwadratów Dzięki równościom (8.27) łatwo sprawdzić, że Y, U, V ≡ 0 (mod m). Na przykład: U = (x − x1m)u − (y − y1m)v − (u − u1m)x + (v − v1m)y = m(−x1u + y1v + u1x − v1y). Wobec równości (8.29) widzimy stąd, że również X jest podzielne przez m. Dzieląc więc obustronnie równość (8.29) przez m 2 znajdujemy: m ′p = (X/m) 2 + (Y /m) 2 + (U/m)2 + (V /m) 2. Ale mp miała być n a j m n i e j s z ą wielokrotnością p przedstawialną w postaci sumy czte- rech kwadratów! Mamy więc s p r z e c z n o ś ć, bo m ′ < m. To kończy dowód lematu. □ Jasnym jest teraz jak, wykorzystując ponownie tożsamość Eulera, dokończyć dowód twier- dzenia Lagrange’a o czterech kwadratach. □ 8.5.2 Uwagi o sumach trzech kwadratów Trudniej jest scharakteryzować te liczby naturalne, które dadzą się przedstawić w postaci sumy trzech kwadratów. Ćwiczenie 8.25 Udowodnić, że jeżeli liczba naturalna n ≡ 7 (mod 8), to n n i e j e s t sumą trzech kwadratów. Ćwiczenie 8.26 Udowodnić, że jeżeli liczba naturalna n = 4k da się przedstawić w postaci sumy trzech kwadratów, to i liczba k da się tak przedstawić. Z ostatnich ćwiczeń łatwo wywnioskować, że żadna liczba postaci 4 n(8k + 7) n i e d a s i ę p r z e d s t a w i ć w postaci sumy trzech kwadratów. Okazuje się, że zachodzi: TWIERDZENIE 8.13 (Twierdzenie Gaussa-Legendre’ a) Każda liczba naturalna n i e będąca postaci 4 n(8k + 7) jest sumą trzech kwadratów liczb całkowitych. □ U w a g a 1. Dowód twierdzenia T8.13 jest trudny. Podany w końcu XVIII wieku przez Legendre’a dowód był niepełny. Wykorzystywał bowiem fakt, że w każdym ciągu arytmetycz- nym (rn + a) spełniającym warunek NWD (r, a) = 1, występuje nieskończenie wiele wyrazów będących liczbami pierwszymi. Fakt ten jest prawdziwy, zobacz T5.19, wszelako został udo- wodniony przez Dirichlet’a później, bo w roku 1837. Pierwszy pełny dowód twierdzenia T8.13 pochodzi od Gaussa. U w a g a 2. Widzieliśmy, że w naszym drugim dowodzie twierdzenia Fermat’a-Eulera T8.1, zobacz ustęp 8.2.2, ważną rolę grała tożsamość podstawowa (8.1) (z c = 1). Jeszcze większą rolę grała tożsamość Eulera (8.25) w dowodzie twierdzenia Lagrange’a. Wspomnieliśmy już, że tożsamość Eulera jest prostym wnioskiem z faktu istnienia takiego m n o ż e n i a w zbiorze R 4 punktów przestrzeni czterowymiarowej, dzięki któremu R 4 staje się ciałem (co prawda n i e p r z e m i e n n y m), tak zwanym ciałem kwaternionów (”odkrytym” przez Hamiltona w 1843 roku – zobacz na przykład [10]). Podobnie, tożsamość (8.1) z c = 1 jest w istocie tylko innym zapisem równości (1.12) wyrażającej ważną własność mnożenia liczb zespolonych, czyli punktów płaszczyzny R 2. Otóż, punktów przestrzeni trójwymiarowej R 3 n i e d a j e s i ę mnożyć w tak porządny sposób. N i e i s t n i e j e też (wobec tego) żadna tożsamość wyraża- jąca iloczyn dwóch sum trzech kwadratów w postaci sumy trzech kwadratów. Jest to ważna przyczyna trudności dowodu twierdzenia Gaussa-Legendre’a. 8.6. Dodatek. Piąty dowód TFE 297 Ćwiczenie 8.27 Liczby Tk = 1+2+ . . . +k nazywają się liczbami trójkątnymi (umowa: T0 = 0). Korzystając z twierdzenia Gaussa-Legendre’a udowodnić, że każda liczba naturalna jest sumą trzech liczb trójkątnych. Wskazówka. Zauważyć równoważność (2u + 1)2 + (2v + 1)2 + (2w + 1)2 = 8n + 3 ⇐⇒ u(u + 1) 2 + v(v + 1) 2 + w(w + 1) 2 = n. 8.6 Dodatek. Piąty dowód TFE Pokażemy tu nasz piąty dowód twierdzenia Fermat’a-Eulera. Ten dowód jest n a j p r o s t s z y m dowodem w książce. Nie musimy nawet wiedzieć, że kongruencja x2 ≡ −1 (mod p) ma rozwią- zania (przy p ≡ 1 (mod 4)). Możemy też nic nie wiedzieć o aproksymacjach diofantycznych. Wykorzystamy za to rozwinięcia liczb wymiernych na ułamki łańcuchowe. Własności kontynuant. Wiemy, że skończony ułamek łańcuchowy ⟨a0, a1, . . . , an⟩, pisze się jako zwykły ułamek w postaci ilorazu kontynuant: ⟨a0, a1, . . . , an⟩ = K(a0, a1, . . . , an) K(a1, . . . , an) . (8.30) Znamy też Regułę Eulera pozwalającą wyznaczać te kontynuanty. Zobacz ustęp 7.3.1. Z tej reguły wywiedliśmy już równość K(c1, c2, . . . , cn) = c1K(c2, . . . , cn) + K(c3, . . . , cn) (zobacz wskazówkę do C7.5) i równość (7.11), z której natychmiast wynika n i e s k r a c a l n o ś ć ułamków postaci (8.30), gdy a0 ∈ Z i ai ∈ N, przy i = 1, . . . , n. Z jeszcze paru wniosków z Reguły Eulera będziemy korzystać w dalszym ciągu: Ćwiczenie 8.28 Udowodnić, że dla dowolnych ci i dowolnego 1 ⩽ k < n zachodzi równość K(c1, . . . , cn) = K(c1, . . . , ck−1)K(ck+2, . . . , cn) + K(c1, . . . , ck)K(ck+1, . . . , cn). Umawiamy się tu, że K( ) = 1. Ćwiczenie 8.29 Uzasadnić, że jeżeli c = (c1, c2, . . . , cn) ∈ N n jest ciągiem palindromicz- nym długości n i e p a r z y s t e j n ⩾ 3, oraz c1 ⩾ 2, to K(c) jest liczbą złożoną. Ćwiczenie 8.30 Uzasadnić, że jeżeli c = (c1, c2, . . . , cn) ∈ N n jest ciągiem palindromicz- nym długości p a r z y s t e j, to K(c) jest sumą dwóch kwadratów. Kanoniczne rozwinięcia liczb wymiernych na ułamki łańcuchowe. Czytelnik, który rozwiązał ćwiczenie C7.2 wie doskonale, że kanoniczne rozwinięcie liczby wy- miernej n m (zakładamy tu, że m > 0) na ułamek łańcuchowy jest zakodowane w algorytmie Euklidesa zastosowanym do pary n, m. Na przykład, pierwsza linijka tego algorytmu, czyli n = a0m + r0, daje, po obustronnym podzieleniu przez m, równość n m = a0 + r0 m = a0 + 1 m r0 . (8.31) 298 8. Sumy kwadratów Druga linijka (która istnieje w przypadku, gdy r0 ̸= 0), czyli m = a1r0 + r1, po obustronnym podzieleniu przez r1 (jeżeli r1 ̸= 0, oczywiście!), pozwala zapisać równość (8.31) w postaci: n m = a0 + 1 a1 + r1 r0 = a0 + 1 a1 + 1 r0 r1 . Itd. Dwie ostatnie linijki algorytmu mają postać rs−3 = as−1rs−2 + rs−1 (przedostatnia linijka algorytmu; tu, jak wiemy, rs−1 = NWD (n, m)) i rs−2 = asrs−1 (ostania linijka). Ponieważ rs−2 > rs−1, więc widzimy, że ostatni mianownik as (kanonicznego rozwinięcia liczby wymiernej na ułamek łańcuchowy) jest ś c i ś l e w i ę k s z y niż 1. Każda zatem liczba wymierna u = n m da się zapisać w postaci u = ⟨a0, a1, . . . , as⟩, (8.32) gdzie a0 ∈ Z, a1, . . . , as ∈ N oraz (jeżeli s > 0, równoważnie, jeżeli u /∈ Z) as ⩾ 2. Taki zapis jest (przy narzuconych ograniczeniach) j e d n o z n a c z n y. O pewnej inwolucji. Powyższe spostrzeżenie pozwala określić pewną inwolucję. Deﬁnicja 8.9 Odwzorowanie f : X −→ X danego zbioru X w ten sam zbiór X nazywa się inwolucją, gdy zachodzi równość f ◦ f = IdX. Ćwiczenie 8.31 Udowodnić, że każda inwolucja jest bijekcją. Rozważmy teraz zbiór Q⩾2 wszystkich liczb wymiernych większych lub równych 2. Każda liczba u ∈ Q⩾2 ma, jak wiemy, dokładnie jedno przedstawienie postaci (8.32), w którym a0 ⩾ 2 i as ⩾ 2. Zdeﬁniujemy odwzorowanie I : Q⩾2 −→ Q⩾2 następująco: u = ⟨a0, a1, . . . , as−1, as⟩ 7−→ ⟨as, as−1, . . . , a1, a0⟩ = I(u). (8.33) Ponieważ as = ⌊I(u)⌋ ⩾ 2, więc I(u) rzeczywiście należy do Q⩾2. Jasne jest, że odwzorowanie I j e s t i n w o l u c j ą. Niech p > 2 będzie nieparzystą liczbą pierwszą. Oznaczmy s = p−1 2 i niech Ap = {p 1 , p 2 , . . . , p s } (8.34) będzie(!) podzbiorem zbioru Q⩾2. ZADANIE 8.13 Udowodnić, że obcięcie inwolucji I do zbioru Ap jest inwolucją na tym zbiorze. To znaczy, że I(u) ∈ Ap dla każdego u ∈ Ap. R o z w i ą z a n i e. Niech p k , gdzie 1 ⩽ k ⩽ s, będzie elementem zbioru Ap. I niech p k = ⟨a0, a1, . . . , an⟩ = K(a0, a1, . . . , an) K(a1, . . . , an) (8.35) 8.6. Dodatek. Piąty dowód TFE 299 będzie kanonicznym rozwinięciem liczby p k na ułamek łańcuchowy. Ponieważ stojące po obu stronach tej równości ułamki są n i e s k r a c a l n e, więc, zobacz C2.18, p = K(a0, a1, . . . , an). Zapiszmy teraz analogicznie liczbę I( p k ): I ( p k ) = ⟨an, an−1, . . . , a0⟩ = K(an, an−1, . . . , a0) K(an−1, . . . , a0) . (8.36) Z C7.28 wiemy, że K(an, an−1, . . . , a0) = K(a0, a1, . . . , an). To oznacza, że nieskracalny ułamek z prawej strony równości (8.36) ma licznik równy p. Ponadto, część całkowita liczby I( p k ), czyli an, spełnia an ⩾ 2. Zatem liczba wymierna I( p k ) jest ⩾ 2 i ma w liczniku p. Należy więc do zbioru Ap. ♦ Lemat o inwolucji. Udowodnimy prosty lemat o punktach stałych inwolucji na zbiorach skończonych. Dla do- wolnego odwzorowania f : X −→ X przez Fix(f ) oznaczamy zbiór {x ∈ X : f (x) = x} punktów stałych odwzorowania f . LEMAT 8.6 Dany jest zbiór skończony X i inwolucja I : X −→ X. Wówczas |Fix(I)| ≡ |X| (mod 2). (8.37) D O W Ó D. Niech Fix(I) = {x1, x2, . . . , xs}. Pozostałe elementy zbioru X występują w parach postaci {x, I(x)}. Mamy więc rozbicie X = {x1} ⊔ . . . ⊔ {xs} ⊔ {xs+1, I(xs+1)} ⊔ . . . ⊔ {xt, I(xt)}, z którego wynika równość |X| = s + 2(t − s) pociągająca kongruencję (8.37). □ Oto dwa oczywiste wnioski z tego lematu: WNIOSEK 1 Inwolucja określona na zbiorze (skończonym) mającym nieparzystą liczbę elementów ma co najmniej jeden punkt stały. □ WNIOSEK 2 Jeżeli x0 jest punktem stałym inwolucji określonej na zbiorze parzystoele- mentowym, to ta inwolucja ma jeszcze co najmniej jeden punkt stały x1 ̸= x0. □ Piąty dowód TFE. Dzięki powyższym uwagom jesteśmy w stanie jeszcze raz udowodnić TFE: P I Ą T Y D O W Ó D TFE. Niech p = 4m+1 będzie liczbą pierwszą. Wówczas zbiór (8.34) ma 2m elementów. Element p 1 tego zbioru jest, oczywiście, punktem stałym inwolucji I. Na mocy wniosku W2L8.6, w zbiorze Ap musi istnieć jeszcze co najmniej jeden punkt stały inwolu- cji I. Niech to będzie liczba p k i niech zachodzą równości (8.35). Wówczas ciąg (a0, a1, . . . , an) jest ciągiem palindromicznym długości parzystej (gdyby był długości nieparzystej, to, na mocy C8.29, liczba p = K(a0, . . . , an) byłaby złożona). Zatem ciąg (a0, a1, . . . , an) jest postaci (a0, . . . , as, as, . . . , a0). Po rozwiązaniu C8.30 wiemy, że wtedy: p = K(a0, . . . , as, as, . . . , a0) = K(a0, . . . , as) 2 + K(a0, . . . , as−1)2. □ U w a g a 1. Pokazany dowód pochodzi z pracy A.T.Benjamin, D.Zeilberger Pythagorean primes and palindromic continued fractions 1. Tam znaleźć można również dowód jednoznacz- 1Za zwrócenie uwagi na tę pozycję autor jest wdzięczny koledze Wojtkowi Wawrowowi 300 8. Sumy kwadratów ności (por. Z8.2). U w a g a 2. Omówienie słynnego One-sentence Proof that every Prime p ≡ 1 (mod 4) is a Sum of Two Squares Dona Zagiera znaleźć można w [ 0 ]. Dowód ten również wykorzystuje lemat L8.6. U w a g a 3. W pracy Benjamina i Zeilbergera znaleźć też można interesującą i przydatną interpretację kombinatoryczną (wartości) kontynuanty K(c1, c2, . . . , cn) w przypadku, gdy ci ∈ N. Mianowicie, K(c1, c2, . . . , cn) oznacza liczbę możliwych ułożeń kostek 1×2 i 1×1 na szachownicy o c wierszach i n kolumnach (tu c = max{c1, . . . , cn}), zgodnie z następującymi zasadami: (1) wszystkie kostki leżą r e g u l a r n i e (tzn. kostka 1 × 1 pokrywa jedno pole szachownicy, a kostka 1 × 2, dwa sąsiednie pola), (2) dolny wiersz jest cały pokryty tymi kostkami, (3) kostki 1 × 2 mogą leżeć t y l k o w dolnym wierszu, (4) w j-tej kolumnie może leżeć co najwyżej cj kostek 1 × 1, tworzących spójną ”kolumnę”, (5) w kolumnach, których dolne pola są zakryte przez kostki 1 × 2, n i e leżą żadne inne kostki. Na rysunku poniżej widzimy wszystkie takie ułożenia kostek dla ciągu (c1, c2, c3, c4) = (1, 2, 3, 2). Rys. 8.5 P O d d 2 d Widzimy tu, że K(1, 2, 3, 2) = 23. Ćwiczenie 8.32 Udowodnić prawdziwość opisanej interpretacji kontynuant. Udowodnić za jej pomocą Regułę Eulera i rozwiązać C8.28. Rozdział 9 Arytmetyka ciągów rekurencyjnych When the emperor Frederic II sejourned there [in Pisa], Leonardo [Fibonacci ] was [...] introduced into the court circle, at that time a meeting point for Latin, Arabic and Greek culture. (Andr´e Weil) W elementarnej teorii ciągów rekurencyjnych badamy ciągi (an) spełniające warunki an+2 = P an+1 + Qan, (9.1) dla każdego n ∈ Z⩾0. Tu P, Q są zadanymi s t a ł y m i. Równanie postaci (9.1) nazywamy równaniem rekurencyjnym liniowym (drugiego rzędu o stałych współczynnikach). Jasne, że ciąg (an) spełniający równanie (9.1) jest j e d n o z n a c z n i e wyznaczony przez podanie dwóch początkowych wyrazów a0, a1 (są to tak zwane warunki początkowe). Wielomian (trójmian kwadratowy) W (X) = X 2 − P X − Q (9.2) nazywa się wielomianem charakterystycznym równania (9.1) i (spełniającego to równa- nie) ciągu (an). Pierwiastki wielomianu W (X) będziemy oznaczać literami α, β i nazywać pierwiastkami charakterystycznymi równania (9.1). Spełniają one zależności α + β = P, αβ = −Q, α2 = P α + Q, β2 = P β + Q. (9.3) Zbiór wszystkich ciągów spełniających (9.1) będziemy oznaczać symbolem Rek(P, Q). 9.1 Klasyczny ciąg Fibonacci’ego Deﬁnicja 9.1 (Klasyczny) ciąg Fibonacci’ego (fn) jest elementem Rek(1, 1) wyzna- czonym przez warunki początkowe f0 = 0, f1 = 1. Jego początek wygląda więc tak: 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, . . . . Jasne jest również, że jest to ciąg rosnący o wyrazach całkowitych (nieujemnych). 302 9. Arytmetyka ciągów rekurencyjnych 9.1.1 Wzór Binet’a Zaczniemy od podania zwartej postaci n-tego wyrazu klasycznego ciągu Fibonacci’ego. ZADANIE 9.1 Udowodnić tak zwany wzór Binet’ a: fn = 1 √5 (1 + √5 2 )n − 1 √5 (1 − √ 5 2 )n. R o z w i ą z a n i e. Niech α = (1 + √5)/2, β = (1 − √5)/2. Te liczby są pierwiastkami wielomianu charakterystycznego X 2 − X − 1. Zależności (9.3) mają w tym przypadku postać: α + β = 1, αβ = −1, α2 = α + 1, β2 = β + 1. (9.4) Z prawej strony dowodzonego wzoru stoi więc liczba gn := αn − βn α − β . (9.5) Mamy udowodnić, że dla każdego n ∈ Z⩾0 zachodzi równość fn = gn. Sprawdzenie, że taka równość ma miejsce dla n = 0 i n = 1 jest natychmiastowe. Tożsamość xn+2 − yn+2 = (x + y)(xn+1 − yn+1) − xy(xn − yn), po podzieleniu przez x − y i podstawieniu x = α, y = β, daje równość gn+2 = gn+1 + gn. To kończy rozwiązanie. ♦ U w a g a. Ponieważ |β| < 1, więc mamy równość przybliżoną fn ≈ αn/ √5. 9.1.2 Kilka tożsamości Pokażemy teraz pewną ilość tożsamości spełnianych przez wyrazy klasycznego ciągu Fibo- nacci’ego. Dobrze jest przeprowadzić jak najwięcej dowodów samodzielnie, zarówno za pomocą indukcji jak i za pomocą wzoru Binet’a. ZADANIE 9.2 Udowodnić tożsamość f2n = n∑ k=0 ( n k ) fn−k. R o z w i ą z a n i e. Na mocy wzoru Binet’a (9.5) mamy równość: (α − β)f2n = α2n − β2n = (α2) n − (β2)n, gdzie α i β spełniają (9.4). Zatem, na mocy (9.4), (α − β)f2n = (α + 1)n − (β + 1)n. 9.1. Klasyczny ciąg Fibonacci’ego 303 Na mocy wzoru dwumiennego dostajemy: (α + 1)n − (β + 1)n = n∑ k=0 (n k )αn−k − n∑ k=0 ( n k ) βn−k = n∑ k=0 (n k ) (αn−k − βn−k). Wobec tego (α − β)f2n = n∑ k=0 (n k )(αn−k − βn−k). Wystarczy teraz podzielić przez α − β. ♦ Ćwiczenie 9.1 Udowodnić przez indukcję, że dla każdej liczby całkowitej n ⩾ 0 zachodzą poniższe równości. Następnie udowodnić te równości korzystając ze wzoru Binet’a (jak to pokazujemy w rozwiązaniach zadań Z9.2, Z9.3) i wykryć gdzie ”zginęła” indukcja. (1) f0 + f1 + . . . + fn = fn+2 − 1, (2) f1 + f3 + . . . + f2n−1 = f2n, (3) f0 + f2 + . . . + f2n = f2n+1 − 1, (4) f 2 0 + f 2 1 + . . . + f 2 n = fnfn+1, (5) f0f1 + f1f2 + . . . + f2n−1f2n = f 2 2n, (6) f0f1 + f1f2 + . . . + f2nf2n+1 = f 2 2n+1 − 1. Przed rozwiązaniem następnego zadania proponujemy Czytelnikowi udowodnienie tezy: Ćwiczenie 9.2 Udowodnić dwiema metodami poniższe równości αn = fn · α + fn−1, βn = fn · β + fn−1, (9.6) gdzie fk oznacza k-ty wyraz (klasycznego) ciągu Fibonacci’ego, a α, β są pierwiastkami cha- rakterystycznymi tego ciągu, czyli liczbami opisanymi przez równości (9.4). ZADANIE 9.3 Udowodnić tak zwaną tożsamość Ces`aro: fmn = m∑ k=1 ( m k )fkf k n f m−k n−1 . (9.7) R o z w i ą z a n i e. Podobnie jak w zadaniu poprzednim zapiszmy fmn za pomocą wzoru Binet’a (α − β)fmn = (αn) m − (βn) m. Na mocy równości (9.6) i wzoru dwumiennego, dostajemy zatem: (α − β)fmn = (fn · α + fn−1) m − (fn · β + fn−1) m = = m∑ k=0 (m k ) ( (αfn) kf m−k n−1 − (βfn) kf m−k n−1 ) = m∑ k=0 ( m k ) f k n f m−k n−1 (αk − βk). Dzieląc przez (α − β) i uwzględniając wzory Binet’a, mamy (9.7). ♦ 304 9. Arytmetyka ciągów rekurencyjnych Ćwiczenie 9.3 Udowodnić następujące równości fn+1fn−1 − f 2 n = (−1)n, (9.8) fm+1fn + fn−1fm = fn+m. (9.9) Równość (9.8) nosi nazwę wzoru Cassini’ ego. W dalszym ciągu zobaczymy, że wzór Cassini’ego jest w istocie przypadkiem szczególnym wzoru (9.9). 9.1.3 Dwie interpretacje ciągu (fn) Ciąg Fibonacci’ego występuje w różnych sytuacjach kombinatorycznych. Opiszemy tu dwie. Dla innych interpretacji zobacz KOM . Interpretacja Piechura. Wyobraźmy sobie, że w punkcie 1 osi liczbowej stoi piechur i ma dojść do punktu n ∈ N. Pozwalamy mu iść tylko w prawo i tylko krokami długości 1 lub 2. Postaramy się odpowiedzieć na pytanie: Na ile sposobów może on pokonać tę drogę? Oznaczmy liczbę tych sposobów przez pn. Jasne, że p1 = 1 (”nicnierobić” można na jeden sposób!). Równie jasne, że p2 = 1 (piechur wykonuje jeden krok długości 1). Rozważmy teraz dowolną liczbę n ⩾ 3. Istnieją dwa różne typy marszrut naszego piechura od punktu 1 do punktu n: do pierwszego typu należą te marszruty, których ostatni krok ma długość 1, a do drugiego te, których ostatni krok ma długość 2. Marszrut pierwszego typu jest tyle, na ile sposobów piechur może dojść do punktu n − 1, czyli pn−1. W czasie marszrut drugiego typu, piechur dociera do liczby n − 2, na dokładnie pn−2 sposoby(!), a następnie wykonuje (jednoznacznie wyznaczony) krok długości 2. Widzimy więc, że: pn = pn−1 + pn−2. Ciąg (pn) spełnia więc to samo równanie rekurencyjne co ciąg Fibonacci’ego i ma te same dwie wartości początkowe p1 = f1, p2 = f2. Zatem pn = fn dla wszystkich n ∈ N. Ćwiczenie 9.4 Udowodnić równość (9.9) posługując się interpretacją piechura. Ćwiczenie 9.5 Niech Pn oznacza ilość sposobów przejścia z punktu 1 do punktu n przez piechura o nogach tak długich, że może stawiać kroki długości 1 lub 2 lub 3. Wyznaczyć związek rekurencyjny jaki spełniają liczby Pn. Pokażemy jeszcze jedną interpretację wyrazów ciągu Fibonacci’ego: Ćwiczenie 9.6 Uzasadnić, że fn = K(1, . . . , 1) (wartość kontynuanty na ciągu (1, . . . , 1) długości n − 1). Wywnioskować stąd, że liczba f2k+1, k ⩾ 1, jest sumą dwóch kwadratów, a liczba f2k, k ⩾ 3, jest liczbą złożoną. Wskazówka. Zobacz C8.30 i C8.29. 9.1.4 Ciąg (fn) jest NWD -ciągiem Ciąg Fibonacci’ego (klasyczny) ma własność podzielności, a nawet jest NWD -ciągiem. Przypomnijmy (zobacz rozwiązanie Z2.B9), że to oznacza zachodzenie równości f NWD (m, n) = NWD (fm, fn) (9.10) dla dowolnych m, n ∈ N. 9.2. Metoda Eulera i metoda funkcji tworzących 305 Każdy NWD -ciąg, jak wiemy (zob. U1 w rozwiązaniu Z2.B9), ma własność podzielności. Wykazujemy najpierw, że klasyczny ciąg Fibonacci’ego ma tę własność: ZADANIE 9.4 Udowodnić, że ciąg (fn) spełnia warunek: m|n ⇒ fm|fn. R o z w i ą z a n i e. Podamy rozwiązanie z wykorzystaniem równości (9.9). Dowodzimy mia- nowicie przez indukcję względem q ⩾ 1, że fm|fqm. Ponieważ jest to oczywiste dla q = 1, więc załóżmy, że fqm = Kfm i podstawmy n = qm w równości (9.9). Wówczas f(q+1)m = fqm+m = fm+1fqm + fqm−1fm = fm+1Kfm + fqm−1fm = K ′fm. To, na mocy zasady indukcji, kończy rozwiązanie. U w a g a. Teza zadania da się też natychmiast wyprowadzić z tożsamości Ces`aro (9.7). ♦ Łatwo też wykazać, że k o l e j n e wyrazy ciągu Fibonacci’ego są względnie pierwsze: Ćwiczenie 9.7 Udowodnić, że NWD (fn, fn+1) = 1. Okazuje się, że prawdziwe jest twierdzenie ogólniejsze: TWIERDZENIE 9.1 Ciąg Fibonacci’ego (fn) jest NWD -ciągiem. D O W Ó D. Załóżmy, że n > m i wykonajmy dzielenie z resztą: n = qm + r, gdzie 0 ⩽ r < m. Tożsamość (9.9) i równość fqm = Kfm pozwalają napisać fn = fqm+r = fr+1fqm + fqm−1fr = Kfr+1fm + fqm−1fr. Z tej równości widzimy, że D(fm, fr) ⊆ D(fn, fm). W istocie między tymi zbiorami wspólnych dzielników zachodzi równość. Rzeczywiście, jeżeli d|fn i d|fm, to z powyższej równości wno- simy, że d|fqm−1fr. Ale wiemy, że fqm−1 i fqm są względnie pierwsze, więc d, jako dzielnik fm, czyli też fqm, jest względnie pierwsze z fqm−1. Zatem, na mocy ZTA, d|fr. To dowodzi, że D(fm, fr) = D(fn, fm), skąd: NWD (fn, fm) = NWD (fm, fr). Jasnym teraz być powinno jak skończyć dowód, doprowadzając do końca algorytm Euklidesa wyznaczania największego wspólnego dzielnika liczb n i m. □ Ćwiczenie 9.8 Udowodnić, że dla 3 ⩽ m ⩽ n zachodzi wynikanie: fm|fn ⇒ m|n. 9.2 Metoda Eulera i metoda funkcji tworzących W zadaniu Z9.1 pokazaliśmy wzór Binet’a wyrażający w sposób zwarty n-tą liczbę ciągu Fibo- nacci’ego. W tym paragraﬁe poznamy uogólnienie tego wzoru na przypadek dowolnego ciągu spełniającego (9.1). Następnie poznamy tak zwane funkcje tworzące badanych ciągów. 9.2.1 Metoda Eulera Euler szukał rozwiązania równania rekurencyjnego (9.1) w postaci an = ξn. Będziemy go naśladować, bo (mistrzów zawsze) warto! Ćwiczenie 9.9 Udowodnić, że jeżeli ciąg (an) = (ξn) spełnia równanie (9.1) i ξ ̸= 0, to ξ jest pierwiastkiem wielomianu charakterystycznego (9.2). 306 9. Arytmetyka ciągów rekurencyjnych Niech więc dany będzie ciąg (an) ∈ Rek(P, Q) wyznaczony (jednoznacznie) przez warunki początkowe a0 i a1. Oznaczmy (jak zwykle) przez α, β pierwiastki wielomianu charaktery- stycznego X 2 − P X − Q. Przy tych oznaczeniach zachodzi: TWIERDZENIE 9.2 Jeżeli α ̸= β, to istnieją takie stałe A, B, że an = A · αn + B · βn (9.11) dla każdego n ∈ Z⩾0. Jeżeli zaś α = β, to istnieją takie stałe C, D, że an = C · αn + D · nαn−1 (9.12) dla każdego n ∈ Z⩾0. D O W Ó D. Sprawdzenie, że ciąg (xn) zadany przez xn = Aαn + Bβn, przy d o w o l n y c h stałych A, B, spełnia równanie (9.1), jest natychmiastowe: xn+2 = Aαn+2 + Bβn+2 = Aαn(P α + Q) + Bβn(P β + Q) = P (Aαn+1 + Bβn+1) + Q(Aαn + Bβn) = P xn+1 + Qxn. (Druga równość wynika z faktu, że α i β są pierwiastkami wielomianu charakterystycznego, czyli z równości α2 = P α + Q i β2 = P β + Q.) Jeżeli zaś α = β, to ciąg (xn) zadany przez xn = Cαn + Dnαn−1, przy d o w o l n y c h stałych C, D, również spełnia równanie (9.1): xn+2 = C · αn+2 + D · (n + 2)αn+1 = C · αn(P α + Q) + D · (n + 2)αn−1(P α + Q) = P (C · αn+1 + D · (n + 1)αn) + Q(C · αn + D · nαn−1) + Dαn−1(P α + 2Q) = P xn+1 + Qxn. Ostatnia równość wynika z faktu, że P α + 2Q = 0 (bo ∆ = P 2 + 4Q = 0 i α = P/2 (= β)). Aby zakończyć dowód równości (9.11) i (9.12) musimy dobrać takie stałe A, B w pierwszym przypadku i C, D w drugim przypadku, aby spełnione były warunki początkowe. Innymi słowy, wyznaczyć stałe A, B i C, D z układów równań: { A + B = a0 Aα + Bβ = a1, { C = a0 Cα + D = a1. Układy te mają (jednoznacznie wyznaczone(!)) rozwiązania: A = a1 − a0β α − β , B = a0α − a1 α − β ; C = a0, D = a1 − a0α (9.13) (w pierwszym przypadku korzystamy z faktu, że α ̸= β). To kończy dowód. □ Wzory (9.11) i (9.12) wraz z wyznaczonymi stałymi nazywamy wzorami Eulera-Binet’ a. U w a g a. Zauważmy, że pisząc warunek (9.1), nie określiliśmy wyraźnie czym są stałe P, Q, ani czym są wyrazy an badanego ciągu. Umawiamy się w dalszym ciągu, że zarówno 9.2. Metoda Eulera i metoda funkcji tworzących 307 współczynniki P, Q jak i wyrazy początkowe badanego ciągu są elementami pewnego pier- ścienia R. Wówczas, oczywiście, wszystkie wyrazy tego ciągu są elementami pierścienia R, a wielomian charakterystyczny jest wielomianem o współczynnikach w R. Aliści pierwiastki tego wielomianu, których używamy do zapisu wyrazów badanego ciągu, nie muszą należeć do R. Na przykład klasyczny ciąg Fibonacci’ego ma, oczywiście, wszystkie wyrazy będące licz- bami całkowitymi, ale pierwiastki jego wielomianu charakterystycznego nie są nawet liczbami wymiernymi. Wzór Binet’a pokazuje, że za pomocą stosownie dobranych kombinacji liczb nie- wymiernych wyrazić można zwykłe liczby naturalne. Jeszcze zabawniejsza sytuacja ma miejsce dla ciągu rekurencyjnego danego przez warunek an+2 = an+1 − an: Ćwiczenie 9.10 Wyznaczyć wyraz ogólny ciągu danego przez a0 = 1, a1 = 2 i warunek rekurencyjny an+2 = an+1 − an. Pierścień R m o ż e b y ć pierścieniem wielomianów: Ćwiczenie 9.11 Niech A0(X) = 1, A1(X) = X będą danymi wielomianami. Wyznaczyć n-ty wyraz ciągu (An(X)), jeżeli An+2(X) = XAn+1(X) + (1 − X)An(X) dla każdego n ⩾ 0. P r z y k ł a d 1. Ważnym przykładem ciągu rekurencyjnego o wyrazach będących wielomia- nami jest ciąg (Tn(X)) wielomianów zmiennej X zadany przez równanie rekurencyjne Tn+2(X) = 2X · Tn+1(X) − Tn(X) (9.14) i warunki początkowe T0(X) = 1, T1(X) = X. Warunki te wyznaczają jednoznacznie wielo- mian Tn(X) dla każdego n ⩾ 0. Wielomian Tn nazywa się n-tym wielomianem Czeby- szewa. Początkowe wyrazy ciągu wielomianów Czebyszewa: T0(X) = 1, T1(X) = X oraz T2(X) = 2X 2 − 1, T3(X) = 4X 3 − 3X, T4(X) = 8X 4 − 8X 2 + 1, itd. A oto pierwiastki wielomianu charakterystycznego równania rekurencyjnego (9.14): α = X + √X 2 − 1, β = X − √X 2 − 1. Wzory (9.11) i (9.13) dają więc wzór Eulera-Binet’ a na n-ty wielomian Czebyszewa: Tn(X) = 1 2 [ (X + √ X 2 − 1) n + (X − √X 2 − 1)n] . ♦ (9.15) Ćwiczenie 9.12 Udowodnić, że dla dowolnej liczby z ̸= 0 zachodzi równość Tn( 1 2(z + z−1)) = 1 2(zn + z−n). P r z y k ł a d 2. Jako przykład zastosowania powyższego ćwiczenia udowodnimy: Liczba λn := n √ √7 + √ 6 + n √ √7 − √6 jest liczbą niewymierną dla każdego n ∈ N. Rzeczywiście, łatwo sprawdzić, że λn = z + 1 z , gdzie z = n√√ 7 + √6, a liczba 1 2 (zn + 1 zn ) jest równa √7, więc, dzięki C9.12, mamy √7 = Tn( 1 2λn). Gdyby λn była liczbą wymierną, to, wobec tego, że wielomian Tn ma współczynniki całkowite, liczba √7 = Tn( 1 2λn) też byłaby liczbą wymierną. Sprzeczność. Q.e.d. ♦ 308 9. Arytmetyka ciągów rekurencyjnych 9.2.2 Pierścień formalnych szeregów potęgowych Funkcja tworząca danego ciągu (an) (która, ściśle rzecz ujmując, n i e j e s t f u n k c j ą) jest po prostu n a p i s e m postaci: ∞∑ k=0 akX k = a0 + a1X + a2X 2 + . . . + anX n + . . . . Takie napisy (”nieskończone wielomiany”) nazywają się w matematyce formalnymi sze- regami potęgowymi. Deﬁnicja 9.2 Zbiór wszystkich napisów postaci a(X) = ∑∞ k=0 akX k, gdzie ak ∈ K, ozna- czamy symbolem K[[X]] i nazywamy pierścieniem formalnych szeregów potęgowych o współczynnikach z ciała K. W zbiorze tym wprowadzamy naturalne działania dodawania i mnożenia. Oczywistym jest, że każdy wielomian o współczynnikach z ciała K można uważać za for- malny szereg potęgowy, w którym prawie wszystkie (czyli wszystkie z wyjątkiem co najwyżej skończenie wielu) współczynniki są równe zero. Uważamy więc, że K[X] ⊆ K[[X]]. Najważniejszym p o w o d e m takiego u o g ó l n i e n i a pojęcia wielomianu jest m o ż l i w o ś ć o d w r a c a n i a (niektórych) wielomianów o współczynnikach z K. Na przykład, piękne, ”się- gające nieskończoności”, uogólnienie tożsamości nieśmiertelnej: (1 − λX)(1 + λX + λ2X 2 + λ 3X 3 + . . . ) = 1 pokazuje, że wielomian 1 − λX jest elementem odwracalnym w pierścieniu K[[X]]. Możemy więc napisać 1 1 − λX = (1 − λX)−1 = 1 + λX + λ2X 2 + λ3X 3 + . . . = ∑ k⩾0 λ kX k. (9.16) Szereg (9.16) nosi nazwę szeregu Neumanna. ZADANIE 9.5 Udowodnić, że a(X) = ∑ k⩾0 akX k jest elementem odwracalnym w pier- ścieniu K[[X]] wtedy i tylko wtedy, gdy a0 ̸= 0. R o z w i ą z a n i e. Jeżeli istnieje taki (formalny) szereg potęgowy b(X) = ∑ k⩾0 bkX k, że a(X)b(X) = 1, to a0b0 = 1. Stąd a0 ̸= 0. Z drugiej strony, jeżeli a0 ̸= 0, to kładąc b0 = 1 a0 , a następnie kolejno b1 = −a1b0 a0 , b2 = −a1b1 + a2b0 a0 , itd. widzimy, że istnieje taki szereg b(X), że a(X)b(X) = 1. ♦ Ćwiczenie 9.13 Udowodnić, że każdy ideał w pierścieniu K[[X]] jest ideałem głównym. Wskazówka. Zdeﬁniować pojęcie stopnia dolnego formalnego szeregu potęgowego. 9.3. Ciągi Lucas’a 309 9.2.3 Metoda funkcji tworzących Metodę funkcji tworzących objaśnimy na przykładzie ciągu (an) spełniającego równanie (9.1). Inne przykłady poznamy w KOM . Napiszmy funkcję tworzącą dla ciągu (an): a(X) = a0 + a1X + a2X 2 + . . . . Jest to formalny szereg potęgowy, którego współczynnikami są kolejne wyrazy badanego ciągu. Warunki (9.1), jak łatwo widzieć, można zapisać w postaci równości a(X) − a0 − a1X = P (a(X) − a0)X + Qa(X)X 2. Stąd wyliczamy a(X) = a0 + (a1 − P a0)X 1 − P X − QX 2 . (9.17) Ponieważ umiemy ”na piechotę” odwracać wielomiany pierwszego stopnia, porównaj równość (9.16), więc rozłożymy tę funkcję wymierną na ułamki proste, zobacz ustęp 3.4.11. W tym celu rozkładamy mianownik na czynniki nierozkładalne: Ćwiczenie 9.14 Sprawdzić, że jeżeli α, β są pierwiastkami trójmianu X 2 − P X − Q, to zachodzi równość 1 − P X − QX 2 = (1 − αX)(1 − βX). Po rozwiązaniu tego ćwiczenia wyznaczamy takie stałe A, B, że a0 + (a1 − P a0)X 1 − P X − QX 2 = A 1 − αX + B 1 − βX . Ta strategia zakończy się pełnym sukcesem w przypadku, gdy α ̸= β (przypadek, gdy α = β omawiamy w KOM 4.3.2). Stąd, dzięki równości (9.16), otrzymujemy równość: a(X) = A ∑ k⩾0 αkX k + B ∑ k⩾0 βkX k = ∑ k⩾0(Aαk + Bβk)X k, co, po porównaniu współczynników, daje znaną nam już równość (9.11): ak = Aαk + Bβk. Ćwiczenie 9.15 Wykonać te czynności dla przypadku ciągów o wyrazach początkowych b0 = 0, b1 = 1 i wielomianach charakterystycznych X 2 − X + 2 oraz X 2 + 4X + 4. 9.3 Ciągi Lucas’a W zbiorze wszystkich ciągów rekurencyjnych spełniających równanie (9.1), przy założeniu ∆ = P 2 + 4Q ̸= 0, Lucas wyróżnił dwa ciągi mające duże znaczenie w teorii liczb. 310 9. Arytmetyka ciągów rekurencyjnych 9.3.1 Przestrzeń Rek(P, Q) Przyjrzymy się najpierw nieco bliżej zbiorowi Rek(P, Q) wszystkich ciągów (an) o wyrazach z ustalonego ciała K, spełniających równanie rekurencyjne (9.1). Zakładamy też, że P, Q ∈ K. Ćwiczenie 9.16 Udowodnić, że Rek(P, Q) jest p r z e s t r z e n i ą l i n i o w ą nad ciałem K. To znaczy, że jeżeli (an), (bn) ∈ Rek(P, Q), to (an + bn) ∈ Rek(P, Q). Oraz, że (λan) ∈ Rek(P, Q) dla dowolnego λ ∈ K. ZADANIE 9.6 Udowodnić, że Rek(P, Q) jest przestrzenią d w u w y m i a r o w ą. R o z w i ą z a n i e. Teza oznacza, że w przestrzeni Rek(P, Q) istnieje baza dwuelemen- towa. Czyli takie d w a ciągi (un), (vn), że k a ż d y ciąg (an) ∈ Rek(P, Q) jest kombinacją liniową A(un) + B(vn) przy pewnych stałych A, B ∈ K, oraz że stałe A, B są wyznaczone j e d n o z n a c z n i e. To zostało uzasadnione w dowodzie T9.2, gdzie widzieliśmy, że w przypadku ∆ ̸= 0 można przyjąć un = αn, vn = βn, a w przypadku ∆ = 0 można przyjąć un = αn, vn = nαn−1. ♦ Dzięki temu możemy rozwiązać zadanie, którego tezę wykorzystamy w dalszym ciągu: ZADANIE 9.7 Udowodnić, że jeżeli (an) ∈ Rek(P, Q), to istnieją takie stałe Pd, Qd, że ciąg (cn) zadany przez cn = adn+r należy do Rek(Pd, Qd). R o z w i ą z a n i e. Liczymy: cn = adn+r = Aαdn+r + Bβdn+r = Aαr(αd) n + Bβr(βd) n. Kładąc A′ = Aαr, B′ = Bβr i ϕ = αd, ψ = βd widzimy stąd, że cn = A ′ϕ n + B′ψn dla każdego n ∈ Z⩾0. Niech Pd = αd + βd, Qd = −αdβd. Wtedy (cn) ∈ Rek(Pd, Qd). ♦ P r z y k ł a d. Jeżeli (fn) jest klasycznym ciągiem Fibonacci’ego, to zarówno (en) := (f2n) jak i (on) := (f2n+1) spełniają równanie rekurencyjne xn+2 = 3xn+1 − xn. ♦ 9.3.2 Deﬁnicja ciągów Lucas’a W zbiorze (przestrzeni liniowej) Rek(P, Q) wszystkich ciągów spełniających równanie (9.1), przy założeniu α ̸= β (czyli, równoważnie, ∆ ̸= 0), Lucas wyróżnia dwa ciągi. Tworzą one bazę w przestrzeni Rek(P, Q). Deﬁnicja 9.3 Niech α, β będą takie jak wyżej. Określmy un = u(P, Q)n = αn − βn α − β i vn = v(P, Q)n = αn + βn (9.18) dla każdego n ∈ Z⩾0. Ciąg (u(P, Q)n) nazywamy ciągiem Lucas’a wyznaczonym przez parę (P, Q). Ciąg (v(P, Q)n) nazywamy stowarzyszonym ciągiem Lucas’a wyznaczonym przez parę (P, Q). Gdy wiemy jakie stałe P, Q mamy na myśli, piszemy po prostu un i vn. 9.3. Ciągi Lucas’a 311 Ponieważ zarówno (un) jak i (vn) są kombinacjami liniowymi A(αn)+B(βn), więc (zobacz Z9.6) oba należą do przestrzeni Rek(P, Q). Co więcej, ponieważ, jak łatwo sprawdzić, αn = α − β 2 · un + 1 2 · vn, βn = β − α 2 · un + 1 2 · vn, a ciągi (αn), (βn) stanowią b a z ę w przestrzeni Rek(P, Q), więc i ciągi Lucas’a (un), (vn) stanowią bazę w Rek(P, Q). P r z y k ł a d 1. Ciąg Lucas’a (u(1, 1)n) jest, oczywiście, znanym nam (klasycznym) cią- giem Fibonacci’ego. Stowarzyszony z nim ciąg (v(1, 1)n) nazywa się (klasycznym) ciągiem Lucas’a i oznacza zazwyczaj (ln). Zaczyna się on następująco 2, 1, 3, 4, 7, 11, 18, 29, 47, 76, 123, 199, 322, . . . . ♦ P r z y k ł a d 2. Liczby P = 3, Q = −2 dają ciąg Mersenne’a i ciąg Fermat’a: u(3, −2)n = 2 n − 1, v(3, −2)n = 2 n + 1. ♦ Zauważmy, że (przy zadanych P, Q) ciąg Lucas’a (un) = (u(P, Q)n) jest wyznaczony przez warunki początkowe u0 = 0, u1 = 1, zaś stowarzyszony ciąg (vn) = (v(P, Q)n) przez warunki początkowe v0 = 2, v1 = P . 9.3.3 Kilka tożsamości Przytoczymy tu kilka tożsamości wiążących wyrazy ciągów Lucas’a i stowarzyszonych ciągów Lucas’a. Tożsamości dla wyrazów ciągu un są (oczywiście) uogólnieniami analogicznych toż- samości dla wyrazów klasycznego ciągu Fibonacci’ego. Dowody są natychmiastowe i należy je zrobić samodzielnie. Ćwiczenie 9.17 Uzasadnić, że dla dowolnego n ∈ Z⩾0 zachodzą równości αn = un+1 − βun, βn = un+1 − αun, (9.19) αn = Qun−1 + αun, βn = Qun−1 + βun. (9.20) Ćwiczenie 9.18 Udowodnić, że dla dowolnych liczb m, n ∈ Z⩾0 zachodzą równości um+n = umun+1 + Qum−1un, (9.21) um+n = umun − (−Q) num−n, (9.22) 2um+n = umvn + unvm, (9.23) u2n = unvn, (9.24) vm+n = vmvn − (−Q)nvm−n, (9.25) 2vm+n = vmvn + ∆umun, (9.26) v2n = v2 n − 2(−Q) n. (9.27) 312 9. Arytmetyka ciągów rekurencyjnych Ćwiczenie 9.19 Udowodnić tożsamość kwadratową: v2 n − ∆u 2 n = 4(−Q) n. (9.28) Ćwiczenie 9.20 Udowodnić wzór Cassini’ ego: u2 n − un−1un+1 = (−Q)n−1. (9.29) Ćwiczenie 9.21 Udowodnić formuły konwersji : ∆un = vn+1 + Qvn−1, (9.30) vn = un+1 + Qun−1. (9.31) Uogólnionych tożsamości Ces`aro dla ciągu Lucas’a u(P, Q)n dowodzimy wykorzystując tak samo ćwiczenie C9.17, jak w rozwiązaniu zadania Z9.3 wykorzystywaliśmy C9.2: ZADANIE 9.8 Udowodnić, że zachodzą uogólnione tożsamości Ces`aro: ukn = k∑ j=1 ( k j ) Q k−ju k−j n−1uj nuj, (9.32) ukn = k∑ j=1 ( k j ) (−1) j−1uk−j n+1u j nuj. (9.33) R o z w i ą z a n i e. Podnosząc obie strony równości (9.20) do potęgi k, a następnie odejmując stronami, znajdujemy: αkn − βkn = k∑ j=0 (k j )Q k−ju k−j n−1uj n(αj − βj). Wystarczy teraz podzielić obie strony przez α − β i otrzymamy równość (9.32). Składnik sumy odpowiadający wskaźnikowi j = 0 możemy opuścić, bo u0 = 0. Podobnie postępujemy przy dowodzie (9.33). W tym przypadku korzystamy z równości (9.19). ♦ 9.3.4 Podzielność wyrazów ciągów Lucas’a Zajmiemy się tu podzielnością wyrazów un ciągów Lucas’a. Z deﬁnicji D9.3 wiemy, że u0 = 0, u1 = 1, a wszystkie wyrazy un są liczbami całkowitymi, gdy, jak t e r a z zakładamy, P, Q ∈ Z. Poniższe ćwiczenie można rozwiązać przez indukcję, korzystając z (9.21), tak jak w rozwią- zaniu Z9.4 korzystaliśmy z (9.9). Można też skorzystać bezpośrednio z uogólnionej tożsamości Ces`aro (9.32) lub (9.33). Ćwiczenie 9.22 Udowodnić, że jeżeli m, q ⩾ 1, to um|uqm. Założymy teraz dodatkowo, że liczby P i Q są w z g l ę d n i e p i e r w s z e. Przy tym zało- żeniu z łatwością rozwiążemy dwa dalsze ćwiczenia: 9.4. Ilustracja geometryczna 313 Ćwiczenie 9.23 Udowodnić, że NWD (uk, uk+1) = 1 dla dowolnego k ⩾ 0. Ćwiczenie 9.24 Udowodnić, że jeżeli NWD (P, Q) = 1, to dla każdego n ⩾ 1 mamy NWD (un, Q) = 1 i NWD (vn, Q) = 1. Ciąg Lucas’a u(P, Q)n bywa NWD -ciągiem: Ćwiczenie 9.25 Udowodnić, że jeżeli NWD (P, Q) = 1, to NWD (um, un) ∼ uNWD (m, n). (9.34) Rozwiązanie tego ćwiczenia jest prostym uogólnieniem dowodu T9.1. Znaczek ∼ w zbiorze liczb całkowitych oznacza: równy z dokładnością do znaku. Przy okazji rozwiążmy: Ćwiczenie 9.26 Udowodnić, że jeżeli liczby naturalne k > l są względnie pierwsze, to ciąg an = kn − ln jest NWD -ciągiem, co znaczy, że NWD (an, am) = aNWD (n, m) dla dowolnych n, m ∈ N. 9.4 Ilustracja geometryczna Badając ciąg rekurencyjny dany przez (9.1) wygodnie jest patrzeć na stowarzyszony ciąg punk- tów an = (an, an+1) płaszczyzny (w ustalonym prostokątnym układzie współrzędnych). Jasne, że ciąg punktów płaszczyzny (an) wyznacza ciąg (an) i odwrotnie. Okaże się, że ciąg (an) jest c i ą g i e m g e o m e t r y c z n y m o ilorazie będącym macierzą. 9.4.1 Macierze odwzorowań liniowych Rozpatrzymy tu prosty przypadek odwzorowań płaszczyzny R 2: odwzorowania liniowe. Przypomnijmy, że (po ustaleniu prostokątnego układu współrzędnych) każdy punkt w płaszczyzny utożsamiamy z parą (x, y) liczb rzeczywistych (odcięta i rzędna punktu). Deﬁnicja 9.4 Odwzorowaniem liniowym płaszczyzny nazywamy funkcję daną przez F (x, y) = (ax + by, cx + dy), (9.35) gdzie a, b, c, d są ustalonymi liczbami. Takie odwzorowanie będziemy kodować za pomocą macierzy 2 × 2 (czyli tabliczki złożonej z czterech liczb) A = ( a b c d ) . (9.36) W takiej sytuacji mówimy, że A jest macierzą odwzorowania liniowego F i zamiast F (w) piszemy po prostu Aw. W postaci rozpisanej: (a b c d )( x y ) = (ax + by cx + dy ). Dla wygody zapisujemy punkt (wektor) w = (x, y) w postaci k o l u m n o w e j. 314 9. Arytmetyka ciągów rekurencyjnych W zbiorze Mat2×2(R) wszystkich macierzy o dwóch wierszach i dwóch kolumnach wprowa- dzamy działanie mnożenia macierzy. Odpowiada ono składaniu odwzorowań: jeżeli F i G są odwzorowaniami liniowymi zadanymi przez macierze A = ( a b c d ) i B = ( k l m n ) , odpowiednio, to złożenie F ◦ G jest odwzorowaniem liniowym zadanym przez macierz A · B = (a b c d ) · ( k l m n ) := ( ak + bm al + bn ck + dm cl + dn ) . Ćwiczenie 9.27 Sprawdzić to. Ćwiczenie 9.28 Narysować obrazy F (△uvw) trójkąta o wierzchołkach u = (1, 2), v = (−2, 5), w = (3, 7), gdzie F oznacza każde z trzech odwzorowań liniowych danych przez macierze A, B i C z następnego ćwiczenia. Ćwiczenie 9.29 Niech A = ( 1 2 3 4) , B = ( 0 1 −2 3), C = (2 3 3 4). Wyznaczyć iloczyny A · B, B · A i C2 := C · C. Przy wprowadzonych wyżej oznaczeniach, dla każdego n ⩾ 0 zachodzi równość: an+1 = Uan, (9.37) gdzie U jest macierzą U = ( 0 1 Q P ) . (9.38) Ćwiczenie 9.30 Sprawdzić to. Równość (9.37) można interpretować następująco: ciąg (an) jest ciągiem geometrycznym o ilorazie będącym macierzą U. Dzięki tej interpretacji można w postaci zwartej zapisać n-ty wyraz ciągu (an): an = Una0 = ( 0 1 Q P )n (a0 a1 ) . Cała trudność wyznaczenia ciągu danego przez (9.1) sprowadza się do wyznaczenia n-tej potęgi macierzy U = ( 0 1 Q P). W algebrze liniowej poznajemy metodę diagonalizacji macierzy, która pozwala w zwartej postaci obliczać potęgi danej macierzy. Metoda ta jest dokładnie r ó w n o w a ż n a z metodą Eulera i nie będziemy jej tu przedstawiać. Ćwiczenie 9.31 Niech F = (0 1 1 1) będzie macierzą (9.38) dla ciągu Fibonacci’ego. Wyka- zać, że n-ta potęga macierzy F dana jest przez F n = ( fn−1 fn fn fn+1 ) . 9.4. Ilustracja geometryczna 315 9.4.2 Wyznacznik odwzorowania liniowego Wyznacznik odwzorowania liniowego jest bardzo ważną charakterystyką tego odwzorowania: ”czuje” on, czy odwzorowanie jest czy nie jest bijekcją. Deﬁnicja 9.5 Jeżeli F , zadane wzorem (9.35), jest odwzorowaniem liniowym o macierzy A zadanej przez (9.36), to liczbę det F = det A = \f \f \f \fa b c d \f \f \f \f := ad − bc nazywamy wyznacznikiem odwzorowania F lub wyznacznikiem macierzy A. Ćwiczenie 9.32 Sprawdzić, że dla dowolnych macierzy 2 × 2 zachodzi równość det(A · B) = det A · det B. Wywnioskować stąd równość (9.8). Wskazówka. Zobacz C9.31. Ćwiczenie 9.33 Udowodnić, że odwzorowanie liniowe F jest bijekcją wtedy i tylko wtedy, gdy det F ̸= 0. 9.4.3 Pola trójkątów Wyznacznik ma arcyważną interpretację geometryczną. Jest z o r i e n t o w a n ą o b j ę t o ś c i ą. W szczególności, wyznacznik macierzy 2 × 2 jest zorientowanym polem równoległoboku roz- piętego na wektorach kolumnowych. Dla danych dwóch punktów v = (v1, v2) i w = (w1, w2) oznaczmy przez S(v, w) zorien- towane pole trójkąta o wierzchołkach 0 = (0, 0), v = (v1, v2), w = (w1, w2). Z o r i e n t o w a n o ś ć pola oznacza tu, że S(w, v) = −S(v, w) oraz że pole S(v, w) jest nieujemne, gdy wektor −→ 0v musimy obrócić o kąt niewiększy niż 180 ◦ w kierunku przeciwnym do ruchu wskazówek zegara aby ”padł” na wektor −→ 0w. Ćwiczenie 9.34 Udowodnić, że dla danych punktów v = (v1, v2), w = (w1, w2) zachodzi równość S(v, w) = 1 2 \f \f \f \fv1 w1 v2 w2 \f \f \f \f . Ćwiczenie 9.35 Udowodnić, że jeżeli v, w są dwoma punktami, B ∈ Mat2×2, to S(Bv, Bw) = det B · S(v, w). (9.39) 316 9. Arytmetyka ciągów rekurencyjnych 9.4.4 Ogólny wzór Cassini’ego Wzór Cassini’ego (9.8) ma interpretację geometryczną, o której teraz powiemy dwa słowa. Dla uproszczenia zakładamy tu, że rozpatrywane ciągi (an) ∈ Rek(P, Q) są ciągami o wyrazach r z e c z y w i s t y c h (w szczególności P, Q ∈ R). ZADANIE 9.9 Udowodnić, że jeżeli (an) ∈ Rek(P, Q), to dla każdego n ⩾ 0 zachodzi an−1an+1 − a2 n = (−Q) n−1(a0a2 − a2 1). (9.40) R o z w i ą z a n i e. Liczba stojąca po lewej stronie równości (9.40) jest podwojonym po- lem trójkąta △0an−1an. Jest więc ona, na mocy C9.35, równa podwojonemu polu trójkąta △0an−2an−1 pomnożonemu przez det U = −Q. Reszta jest oczywistą indukcją. ♦ Równość (9.40), której przypadkiem szczególnym jest wzór Cassini’ego (9.8), może być nazwana uogólnionym wzorem Cassini’ ego. Ciągi, jakie badamy w tym rozdziale są funkcjami określonymi na zbiorze Z⩾0 nieujemnych liczb całkowitych. Jeżeli a : Z⩾0 −→ C jest takim ciągiem (zgodnie z tradycją piszemy an zamiast a(n), a sam ciąg a oznaczamy symbolem (an)), to dowolna taka funkcja ̃a : Z −→ C, że ̃a(n) = a(n) dla wszystkich n ∈ Z⩾0 nazywa się przedłużeniem ciągu a na Z. Dany ciąg a = (an) może być oczywiście na nieskończenie wiele sposobów przedłużony na Z. Interesujemy się tu jednak tylko takimi przedłużeniami ciągów z Rek(P, Q), które s p e ł n i a j ą równanie (9.1) dla w s z y s t k i c h n ∈ Z. Łatwo się przekonać, że takie przedłużenie klasycznego ciągu Fibonacci’ego istnieje i jest tylko jedno. Jego ”początek” wygląda tak: . . . , 34, −21, 13, −8, 5, −3, 2, −1, 1, 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, . . . Ćwiczenie 9.36 Niech (an) ∈ Rek(P, Q), przy Q ̸= 0. Udowodnić, że wówczas istnieje d o k ł a d n i e j e d n o przedłużenie ciągu (an) na Z. Jeżeli ponadto a0 = 0, to a−n = (−1) n+1Q −nan (9.41) dla każdego n ∈ Z. ZADANIE 9.10 Załóżmy, że ciąg (an)n∈Z spełnia (9.1), przy czym Q ̸= 0 i a0 = 0. Udowodnić, że dla dowolnych m, n ∈ Z zachodzi równość aman+1 + Qam−1an = a1an+m. (9.42) R o z w i ą z a n i e. Rozważmy trójkąt o wierzchołkach 0 = (0, 0), as+t = (as+t, as+t+1), as = (as, as+1). Ponieważ as+t = Usat, as+t+1 = Usat+1, a det U = −Q, więc, na mocy C9.35 i C9.32, S(as+t, as) = (−Q) sS(at, a0). Zatem as+tas+1 − as+t+1as = (−Q)sa1at dla wszystkich s, t ∈ Z. Kładąc tu s = −m, t = n + m i wykorzystując równości (9.41), po uproszczeniu przez (−1)mQ m, dostajemy równość (9.42). ♦ Równość (9.42) jest zapowiadanym uogólnieniem równości (9.9). Dowód tej równości za pomocą standardowego rozumowania indukcyjnego dla n, m ⩾ 0 nie przedstawia żadnych trudności i Czytelnik z łatwością zrobi go samodzielnie. 9.5. Ciągi rekurencyjne modulo p 317 Ćwiczenie 9.37 Ciąg (an) zadany jest przez warunki początkowe a0 = 4, a1 = 10 i równanie rekurencyjne an+2 = 3an+1 + an. Dowieść, że jeśli dla pewnego wskaźnika parzystego n i pewnej liczby pierwszej p zachodzą warunki an ≡ 4 (mod p) i an+1 ̸≡ 2 (mod p), to an+1 ≡ 10 (mod p). 9.5 Ciągi rekurencyjne modulo p W tym paragraﬁe będziemy chcieli powiedzieć parę słów na temat ciągów rekurencyjnych mo- dulo p, gdzie p jest liczbą pierwszą. Przyda się nam do tego celu nowe ciało, którego kon- strukcja jest analogiczna do konstrukcji ciała liczb zespolonych z liczb rzeczywistych. 9.5.1 Warstwy ”zespolone” modulo p Ciało liczb zespolonych C powstaje z ciała liczb rzeczywistych przez dołączenie pierwiastka kwadratowego z −1: C = R( √−1). Powód, dla którego się to robi jest prosty: chodzi o to, by równanie wielomianowe x2 + 1 = 0 miało pierwiastki. Okazuje się, że zysk znacznie przewyższa oczekiwania: po takim rozszerzeniu, nie tylko każde równanie k w a d r a t o w e ma pierwiastki, ale w ogóle k a ż d e równanie wielomianowe ma pierwiastki (Zasadnicze Twierdzenie Algebry!). W sytuacji, którą chcemy teraz omówić, już tak dobrze nie jest. Niech p > 2 będzie ustaloną l i c z b ą p i e r w s z ą n i e p a r z y s t ą, a g u s t a l o n y m pierwiastkiem pierwotnym modulo p. Zbiór wszystkich napisów postaci a + bι, gdzie a, b ∈ Z/p oznaczymy symbolem Fp(ι). Symbol ι gra tu podobną rolę jak jednostka urojona i w teorii liczb zespolonych. Zbiór Fp(ι) ma, jak widać, p2 elementów. W zbiorze Fp(ι) wprowadzamy działanie dodawania (a + bι) + (c + dι) = (a + c) + (b + d)ι i działanie mnożenia (a + bι) · (c + dι) = (ac + bdg) + (ad + bc)ι. Działania w nawiasach po prawych stronach wykonujemy (oczywiście) modulo p. Przy wyko- nywaniu działań w Fp(ι) mamy więc prostą regułę: rób wszystko modulo p pamiętając, że ι2 = g. Utożsamiając napis a + 0ι z warstwą a ∈ Z/p traktujemy ciało Z/p jako podzbiór w Fp(ι). W szczególności w zbiorze Fp(ι) mamy wyróżniony element 0 = 0 + 0ι (”zero” – element neutralny względem dodawania) i 1 = 1+0ι (”jedynkę” – element neutralny względem mnożenia). Ponadto, zamiast 0 + bι piszemy po prostu bι. Łatwo widzieć, że Fp(ι) z tymi elementami wyróżnionymi i wprowadzonymi działaniami jest pierścieniem przemiennym z jedynką. Znamy już zatem dwa pierścienie mające p2 elementów: Fp(ι) i Z/p 2. Musimy wyraźnie podkreślić, że są to radykalnie r ó ż n e pierścienie. 318 9. Arytmetyka ciągów rekurencyjnych P r z y k ł a d. Weźmy p = 3, g = 2. Napiszemy tabliczkę mnożenia w zbiorze niezerowych elementów w F3( √2): · 1 2 ι 1 + ι 2 + ι 2ι 1 + 2ι 2 + 2ι 1 1 2 ι 1 + ι 2 + ι 2ι 1 + 2ι 2 + 2ι 2 2 1 2ι 2 + 2ι 1 + 2ι ι 2 + ι 1 + ι ι ι 2ι 2 2 + ι 2 + 2ι 1 1 + ι 1 + 2ι 1 + ι 1 + ι 2 + 2ι 2 + ι 2ι 1 1 + 2ι 2 ι 2 + ι 2 + ι 1 + 2ι 2 + 2ι 1 ι 1 + ι 2ι 2 2ι 2ι ι 1 1 + 2ι 1 + ι 2 2 + 2ι 2 + ι 1 + 2ι 1 + 2ι 2 + ι 1 + ι 2 2ι 2 + 2ι ι 1 2 + 2ι 2 + 2ι 1 + ι 1 + 2ι ι 2 2 + ι 1 2ι Z tabliczki tej można wyczytać, że każdy niezerowy element w F3(√ 2) jest odwracalny (czyli, że F3( √2) jest ciałem, porównaj D1.10) oraz, że każdy z elementów 1 + ι, 1 + 2ι, 2 + 2ι, 2 + ι jest generatorem ośmioelementowej grupy F3( √2) ∗ = F3( √2) ∖ {0}. ♦ Ćwiczenie 9.38 Sprawdzić to. Ćwiczenie 9.39 Rozwiązać równanie wielomianowe x3 + x2 + ιx + ι = 0 w F3(√ 2). U w a g a. Gdy chcemy wyraźnie zaznaczyć zależność Fp(ι) od wyboru pierwiastka pierwot- nego g, to piszemy Fp(√ g). Zależność od wyboru g n i e j e s t jednak zbyt istotna, dlatego często oznaczamy zbiór Fp(ι) jeszcze prostszym symbolem Fp2. W zbiorze (pierścieniu) Fp(ι) wprowadzimy jeszcze operację sprzęgania w Fp(ι): jeżeli ϕ = a + bι ∈ Fp(ι), to kładziemy ϕ = a − bι. Ćwiczenie 9.40 Przekonać się, że dla dowolnych ϕ, χ ∈ Fp(ι) zachodzą równości ϕ + χ = ϕ + χ, ϕ · χ = ϕ · χ. Ćwiczenie 9.41 Udowodnić, że jeżeli funkcja Φ : Fp(ι) −→ Fp(ι) jest bijekcją spełniającą dwa warunki Φ(α + β) = Φ(α) + Φ(β), Φ(αβ) = Φ(α)Φ(β), to albo Φ(α) = α dla każdego α albo Φ(α) = α dla każdego α. 9.5. Ciągi rekurencyjne modulo p 319 9.5.2 Fp(ι) jest ciałem W dwóch kolejnych twierdzeniach udowodnimy, że Fp(ι) jest c i a ł e m, w którym każdy t r ó j m i a n k w a d r a t o w y o współczynnikach z ciała Z/p ma pierwiastki. TWIERDZENIE 9.3 Zbiór Fp(ι) wraz z wprowadzonymi działaniami jest ciałem. D O W Ó D. Pokażemy, że jeżeli 0 ̸= α = a+bι ∈ Fp(ι), to istnieje taki element α−1 ∈ Fp(ι), że αα−1 = 1. Oznaczmy przez c warstwę odwrotną do a2 − b2g w Z/p i połóżmy α−1 = ac + (−bc)ι. Sprawdzenie, że αα−1 = 1, jest natychmiastowe. Pozostaje do sprawdzenia, że c istnieje, czyli, że a 2 − b2g ̸= 0 w Z/p. Gdyby a2 − b2g = 0, to albo b = 0 i wtedy a = 0, co jest niemożliwe, bo α ̸= 0, albo b ̸= 0 i wtedy (ab−1) 2 = g, co również jest niemożliwe, bo g, jako generator grupy (Z/p)∗, nie jest kwadratem. Zauważmy, że α−1 obliczamy tak jak w przypadku liczb zespolonych: mnożąc licznik i mianownik przez element sprzężony: 1 a + bι = a − bι (a + bι)(a − bι) = a − bι a2 − b2g = a(a2 − b2g)−1 + (−b)(a2 − b2g) −1ι. To kończy dowód ”ciałowości” pierścienia Fp(ι). □ Powodem, dla którego tworzymy ciało Fp( √g) = Fp(ι), jest fakt, że w s z y s t k i e trójmiany kwadratowe aX 2 + bX + c ∈ Fp[X] m a j ą tam pierwiastki: TWIERDZENIE 9.4 Każde równanie kwadratowe ax2 + bx + c = 0, gdzie a, b, c ∈ Z/p, ma pierwiastki w Fp(ι). D O W Ó D. Niech a ̸= 0, b, c ∈ Z/p i niech ∆ = b2 − 4ac ∈ Z/p będzie wyróżnikiem trójmianu kwadratowego aX 2 + bX + c ∈ Z/p[X]. Możliwe są trzy przypadki: (1) (∆ p ) = +1, (2) (∆ p ) = −1, (3) ( ∆ p ) = 0, czyli: ∆ jest r e s z t ą k w a d r a t o w ą modulo p, albo ∆ jest n i e r e s z t ą k w a d r a t o w ą modulo p, albo ∆ jest z e r e m modulo p. W przypadku (1) mamy ∆ = g2k przy pewnym naturalnym k (reszty kwadratowe są, zobacz C5.69, parzystymi potęgami generatora), więc α = (2a) −1(−b + gk), β = (2a) −1(−b − gk) (9.43) są (sprawdźcie!) różnymi pierwiastkami naszego trójmianu. W przypadku (2) mamy ∆ = g2l+1 przy pewnym l ∈ N (niereszty kwadratowe są nieparzystymi potęgami generatora) i α = (2a) −1(−b + glι), β = (2a) −1(−b − glι) (9.44) są (sprawdźcie!!) różnymi pierwiastkami naszego trójmianu. Wreszcie, w przypadku (3), (2a)−1(−b) jest, jak łatwo sprawdzić, pierwiastkiem (podwójnym) naszego trójmianu. □ U w a g a. Zauważmy, że trzy przypadki rozważone w dowodzie są doskonale analogiczne trzem przypadkom: (1) ”delta dodatnia”, (2) ”delta ujemna”, i (3) ”delta równa zero”, dla trójmianu kwadratowego o współczynnikach rzeczywistych. Ćwiczenie 9.42 W którym miejscu istotnym było założenie, że p > 2 ? 320 9. Arytmetyka ciągów rekurencyjnych 9.5.3 Dwa słowa o grupie multyplikatywnej Fp(ι) ∗ Jeżeli K jest dowolnym ciałem, to podzbiór K ∗ jego odwracalnych (czyli niezerowych!) ele- mentów jest grupą względem mnożenia. Nazywamy ją grupą multyplikatywną ciała K. W tym ustępie powiemy parę słów na temat grupy multyplikatywnej ciała Fp(ι). Przypomnijmy, zobacz C1.36, że jeżeli w grupie Γ istnieje taki element γ, że {γk : k ∈ Z} = Γ (w przypadku addytywnym: {kγ : k ∈ Z} = Γ ), to grupę Γ nazywamy grupą cykliczną, a element γ nazywamy generatorem tej grupy. P r z y k ł a d 1. Grupa (Z, +) liczb całkowitych z dodawaniem jest grupą cykliczną i ma (dokładnie) dwa generatory: 1 i −1. Jeżeli m jest taką liczbą naturalną, dla której istnieje pierwiastek pierwotny modulo m, zobacz D5.10, to grupa (Z/m)∗ jest grupą cykliczną. Wiemy, zobacz T5.22, że to ma miejsce dla m równych 2, 4, pe i 2pe. Grupa µn(C) pierwiastków z jedynki stopnia n jest grupą cykliczną. Jej generatorem jest element ω = ωn o najmniejszym dodatnim argumencie, zobacz (3.35). ♦ Ćwiczenie 9.43 Udowodnić, że element ωk grupy µn(C) jest generatorem tej grupy wtedy i tylko wtedy, gdy NWD (k, n) = 1. Porównaj też C5.38. Ćwiczenie 9.44 Udowodnić, że grupa (Z/n, +) klas reszt liczb całkowitych modulo n z dodawaniem modulo n jest grupą cykliczną, a jej generatorami są te i tylko te warstwy k (mod n), dla których NWD (k, n) = 1. Ćwiczenie 9.45 Udowodnić, że grupy (µn(C), ·) i (Z/n, +) są izomorﬁczne, to znaczy, że istnieje bijekcja ϕ : Z/n ←→ µn(C) spełniająca warunek ϕ([k] + [l]) = ϕ([k]) · ϕ([l]) dla wszystkich [k], [l] ∈ Z/n. Ćwiczenie 9.46 Ile generatorów ma grupa cykliczna rzędu n? TWIERDZENIE 9.5 Grupa multyplikatywna Fp(ι) ∗ jest grupą cykliczną. D O W Ó D. W części (1) dowodu T5.22 dowodzimy, że grupa multyplikatywna (Z/p) ∗ jest grupą cykliczną. Ten dowód można, bez istotnych zmian, ”dopasować” do przypadku grupy Fp(ι)∗. Uważny Czytelnik zechce się samodzielnie o tym przekonać. □ Ćwiczenie 9.47 Udowodnić, że jeżeli 0 ̸= α ∈ Fp(ι), to: αp2−1 = 1. (9.45) Równość (9.45) jest analogonem kongruencji (5.11). Mogłaby więc być nazwana małym twierdzeniem Fermat’a w Fp(ι). Wolimy jednak nazwać tak tezę poniższego twierdzenia: TWIERDZENIE 9.6 (Małe Twierdzenie Fermat’ a w Fp(ι)) Dla każdego elementu α ∈ Fp(ι) zachodzi równość: αp = α. (9.46) 9.5. Ciągi rekurencyjne modulo p 321 D O W Ó D. Mamy (a + bι) p = ap + bpι p = a + b(ι 2) p−1 2 ι = a + bg p−1 2 ι = a − bι. Uzasadnienie tych równości jest natychmiastowe: pierwsza wynika z wzoru dwumiennego i C2.50, druga z MTF, trzecia z równości ι 2 = g. Jasne jest też, że g p−1 2 ≡ −1 (mod p). □ Ćwiczenie 9.48 Udowodnić, że αp+1 = αp+1 dla dowolnego α ∈ Fp(ι). U w a g a 1. Kluczowym momentem w części (1) dowodu T5.22, a więc i T9.5, było wy- korzystanie faktu, że niezerowy wielomian o współczynnikach z c i a ł a ma w tym ciele co najwyżej tyle pierwiastków ile wynosi jego stopień, zobacz T3.4. To samo można więc zrobić w przypadku dowolnej s k o ń c z o n e j podgrupy grupy multyplikatywnej dowolnego ciała: TWIERDZENIE 9.5′ Jeżeli K jest ciałem, Λ ⊆ K ∗ jest podgrupą s k o ń c z o n ą grupy multyplikatywnej (niezerowych elementów) ciała K, to Λ jest grupą cykliczną. □ U w a g a 2. Grupa multyplikatywna R∗ ciała liczb rzeczywistych n i e j e s t c y k l i c z n a. Również grupy Q ∗ i C ∗ nie są grupami cyklicznymi. ZADANIE 9.11 Udowodnić, że grupa T liczb zespolonych o module równym 1, zobacz (5.40), nie jest grupą cykliczną. R o z w i ą z a n i e. Niech z ∈ T będzie dowolnym elementem. Pokażemy, że podgrupa (z) generowana przez z n i e jest równa całej grupie T . To wynika z porównania mocy, zobacz KOM . Mianowicie, zbiór (z) jest s k o ń c z o n y (gdy π/Arg z jest liczbą wymierną – udowodnić!) lub n i e s k o ń c z o n y a l e p r z e l i c z a l n y (gdy π/Arg z jest liczbą niewymierną – udowodnić!), natomiast T jest zbiorem nieprzeliczalnym (udowodnić!). ♦ 9.5.4 Wzory Eulera-Binet’a modulo p Pokażemy teraz trzy przykłady wzorów Eulera-Binet’a modulo p. Badamy ciąg rekurencyjny (9.1), tym razem traktując zarówno współczynniki P, Q jak i same wyrazy an jako klasy reszt (liczb całkowitych) modulo p, gdzie p jest ustaloną liczbą pierwszą nieparzystą. Zauważmy po pierwsze, że ciągi takie powstają zazwyczaj jako redukcje modulo p ciągów o wyrazach całkowitych. Zauważmy po drugie, że twierdzenie T9.2 i jego dowód przenoszą się bez żadnych istotnych zmian na rozważany teraz przypadek. Warunek ∆ ̸= 0 należy oczywiście rozumieć modulo p, to znaczy ∆ ̸≡ 0 (mod p). W trzech poniższych przykładach będziemy redukować modulo różne liczby pierwsze p jeden ustalony ciąg o wyrazach całkowitych. Wybraliśmy (bo przyda się nam później) ciąg (bn) spełniający warunki początkowe b0 = 0, b1 = 1 i równanie rekurencyjne bn+2 = bn+1 − 2bn. (9.47) P r z y k ł a d 1. Niech p = 79. Wielomian charakterystyczny X 2 − X + 2 ma wyróżnik ∆ = −7. Sprawdzamy, który z trzech przypadków z T9.4 ma miejsce: ( ∆ 79 ) = (−7 79 ) = ( −1 79 ) ( 7 79 ) = (−1)(−1) ( 79 7 ) = ( 2 7 ) = +1. 322 9. Arytmetyka ciągów rekurencyjnych Widzimy, że ∆R79. Wobec tego równanie charakterystyczne x2 − x + 2 = 0 ma dwa (różne) pierwiastki w Z/79. Używając pierwiastka pierwotnego g = −2 modulo 79, po skończonej ilości mnożeń, znajdujemy kongruencję ∆ = −7 ≡ (−2) 62 (mod 79). Stąd, zobacz (9.43), znajdujemy pierwiastki α = 2 −1(1 + (−2) 31) = 2−1(1 + 25) = 13 (mod 79), β = 2 −1(1 − 25) = −12 (mod 79) równania charakterystycznego w Z/79. Wzory (9.13) dają teraz A = −B = 19. Wobec tego w z ó r Eulera-Binet’a dla ciągu (bn (mod 79)) wygląda tak: bn ≡ 19 · 13 n − 19 · (−12) n (mod 79). ♦ P r z y k ł a d 2. Rozważmy ten sam ciąg (bn) modulo p = 17. Tym razem ( ∆ 17 ) = ( −7 17 ) = ( 10 17 ) = ( 2 17 ) ( 5 17 ) = (+1) ( 17 5 ) = ( 2 5 ) = −1. Zatem ∆N17, więc ∆ (mod 17) jest nieparzystą potęgą generatora (pierwiastka pierwotnego). Rzeczywiście: g3 ≡ 10 (mod 17) dla g = 3. Wybraliśmy g = 3 dzięki naszej tabelce liczb pierwszych (mogliśmy byli też skorzystać z C5.63). Wzory (9.44) dają pierwiastki równania charakterystycznego (pamiętamy, że ι = √3 w F17(ι)): α = 2 −1(1 + 3ι) = 9(1 + 3ι) = 9 − 7ι, β = 2 −1(1 − 3ι) = 9(1 − 3ι) = 9 + 7ι. Wzory (9.13) dają w naszym przypadku: A = (α − β) −1 = (−14ι) −1 = (3ι) −1 = 2ι, B = −A. W z ó r Eulera-Binet’a dla ciągu (bn (mod 17)) wygląda więc tak: bn (mod 17) = 2ι(9 − 7ι)n − 2ι(9 + 7ι) n. ♦ P r z y k ł a d 3. Rozważmy jeszcze ten sam ciąg modulo p = 7. Mamy więc do czynienia z przypadkiem, gdy wielomian charakterystyczny X 2 − X + 2 ma pierwiastek podwójny: α ≡ β ≡ 4 (mod 7). Wzory (9.13) dają więc C = 0, D = 1. Zaś w z ó r Eulera-Binet’a wygląda następująco: bn ≡ 4 n−1n (mod 7). ♦ Ćwiczenie 9.49 Napisać wzory Eulera-Binet’a dla redukcji modulo 5, 23 i 31 klasycznego ciągu Fibonacci’ego. 9.5.5 Okresowość ciągów rekurencyjnych modulo p Powiemy słów parę o zjawisku okresowości ciągów rekurencyjnych modulo p. Ćwiczenie 9.50 Udowodnić, że jeżeli P, Q ∈ Z i (an) ∈ Rek(P, Q) jest całkowitolicz- bowy, to jego redukcja modulo m (to znaczy ciąg warstw (an (mod m))) jest ciągiem okreso- wym (od pewnego miejsca). Ponadto długość okresu jest ⩽ m 2. 9.5. Ciągi rekurencyjne modulo p 323 Ćwiczenie 9.51 Udowodnić, że jeżeli dodatkowo Q jest odwracalna modulo m, to ciąg (an (mod m)) jest czysto-okresowy. Jak długi jest rzeczony okres? Oto odpowiedź częściowa: TWIERDZENIE 9.7 Dana jest liczba pierwsza p > 2. Niech P, Q ∈ Z oraz p ∤ Q. Załóżmy, że ciąg (an) liczb całkowitych spełnia równanie rekurencyjne (9.1). Oznaczmy przez ∆ wyróżnik P 2 + 4Q wielomianu charakterystycznego. Wówczas, (1) jeżeli ∆Rp, to dla każdego n zachodzi an+p−1 ≡ an (mod p), (9.48) (2) jeżeli ∆Np, to dla każdego n zachodzi an+p+1 ≡ −Qan (mod p), (9.49) (3) jeżeli ∆ ≡ 0 (mod p), to dla każdego n zachodzi an+p ≡ 2 −1P an (mod p). (9.50) D O W Ó D. (1) Wiemy, że w tym przypadku istnieją dwa (różne!) pierwiastki α, β ∈ Z/p wielomianu charakterystycznego (9.2) modulo p i istnieją takie elementy A, B ∈ Z/p, że dla każdego n ⩾ 0 zachodzi równość Eulera-Binet’a: an = Aαn + Bβn (9.51) w ciele Z/p. Wobec tego mamy: an+p−1 = Aαn+p−1 + Bβn+p−1 = Aαnαp−1 + Bβnβp−1 = Aαn + Bβn = an. Kluczem jest tu oczywiście równość ϕp−1 = 1 prawdziwa dla n i e z e r o w y c h ϕ ∈ Z/p (jest to doskonale nam znane MTF!). Zauważmy, że założenie p ∤ Q implikuje niezerowość pierwiastków α, β w Z/p. (2) W tym przypadku równanie charakterystyczne ma dwa różne pierwiastki α, β w ciele Fp(ι), przy czym, zobacz wzory (9.44), są one wzajemnie sprzężone: β = α, α = β. Równość (9.51) ma również miejsce, chociaż tym razem stałe A, B są elementami ciała Fp(ι). Wobec tego, na mocy MTF w Fp(ι), zobacz (9.46), mamy: an+p+1 = Aαnαpα + Bβnβpβ = Aαnβα + Bβnαβ = αβ(Aαn + Bβn) = −Qan. (3) W tym przypadku, zobacz T9.4, α = β = 2−1P jest podwójnym pierwiastkiem wielo- mianu charakterystycznego. Istnieją więc takie stałe C, D ∈ Z/p, że zachodzi równość an = Cαn + Dnαn−1 dla każdego n ⩾ 0. Wobec tego an+p = Cαn+p + D(n + p)αn+p−1 = αp(Cαn + Dnαn−1) = αan, na mocy równości αp = α prawdziwej dla każdego α ∈ Z/p (zobacz (5.12)). To kończy dowód równości (9.50), bo α = 2 −1P . □ 324 9. Arytmetyka ciągów rekurencyjnych Łatwo stąd wyciągnąć taki: WNIOSEK Ciąg (an (mod p)) jest okresowy, przy czym długość okresu jest (1) dzielnikiem liczby p − 1, gdy ∆Rp, (2) dzielnikiem liczby k(p + 1), gdy ∆Np. Tu k = rzp(−Q), (3) dzielnikiem liczby lp, gdy ∆ ≡ 0 (mod p). Tu l = rzp(2−1P ). Ćwiczenie 9.52 Udowodnić te tezy. W przypadku (3) należy zauważyć, że l istnieje. Ćwiczenie 9.53 Niech (an) ∈ Rek(1, 1) będzie ciągiem Fibonacci’ego o wyrazach począt- kowych a0 = 2, a1 = 1. Udowodnić, że jeżeli a2k ≡ 2 (mod p), to a2k+1 ≡ 1 (mod p). Ćwiczenie 9.54 Niech p ∈ P>2 i niech (fn) będzie klasycznym ciągiem Fibonacci’ego. Udowodnić, że (1) jeżeli p ≡ ±1 (mod 5), to p|fp−1; (2) jeżeli p ≡ ±2 (mod 5), to p|fp+1. Ćwiczenie 9.55 Udowodnić, że jeżeli p > 5 jest liczbą pierwszą, to zachodzi fp ≡ ( 5 p ) (mod p), gdzie ( 5 p ) jest symbolem Legendre’a. Rozdział 10 Pierścienie kwadratowe Gauss reconnut qu’il n’y a pas de r´esultat simple `a esp´erer en restant dans le domaine des entiers ordinaires et qu’il faut passer aux entiers ”complexes” a + b √−1. (Andr´e Weil w liście do siostry Simone) Dotychczas do badania pierścienia liczb całkowitych używaliśmy pierścieni skończonych Z/m klas reszt liczb całkowitych modulo m. Są to pierścienie ilorazowe pierścienia Z. Obecnie chcemy pokazać jak można wykorzystać pewne nadpierścienie pierścienia Z za- warte w zbiorze (ciele) liczb zespolonych. Ustalmy bezkwadratową liczbę całkowitą D ̸= 1. Przez Q( √D) oznaczamy zbiór wszyst- kich liczb zespolonych postaci α = x + y√ D, (10.1) gdzie x, y ∈ Q. Umawiamy się, że √ D oznacza pierwiastek arytmetyczny (dodatni), gdy D > 0, oraz √D = i √−D, gdy D < 0. Zbiór Q( √D) (czyt. Q rozszerzone o √ D) wraz ze zwykłymi działaniami dodawania i mnożenia nazywamy ciałem kwadratowym . Ćwiczenie 10.1 Uzasadnić, że Q( √D) j e s t ciałem. Jeżeli α = x + y√ D ∈ Q(√ D), to liczbę α′ := x − y√D nazywamy liczbą sprzężoną liczby α. Zauważmy, że α′ = α (sprzężenie zespolone) w przypadku gdy D < 0. Ćwiczenie 10.2 Uzasadnić, że jeżeli α, β ∈ Q( √ D), to α′ + β′ = (α + β) ′, α′ − β′ = (α − β) ′, α′β′ = (αβ)′ oraz α′/β′ = (α/β) ′ dla β ̸= 0. Porównaj C1.22. Liczbę αα′ = x2 − Dy2 oznaczamy symbolem N(α) i nazywamy normą liczby α. Ćwiczenie 10.3 Uzasadnić, że N(α) = 0 wtedy i tylko wtedy, gdy α = 0. Uzasadnić ponadto, że norma jest ś c i ś l e m u l t y p l i k a t y w n a. To znaczy, że dla α, β ∈ Q( √D): N(αβ) = N(α) N(β). (10.2) 326 10. Pierścienie kwadratowe 10.1 Pierścień liczb całkowitych Gaussa Najprostszym przykładem pierścienia kwadratowego jest pierścień liczb całkowitych Gaussa. 10.1.1 Deﬁnicja i podstawowe własności Pierścień liczb całkowitych Gaussa jest podpierścieniem w Q( √−1). Zakładamy, że Czytelnik rozumie geometryczną naturę liczb zespolonych na tyle, że poniższe ćwiczenie jest w stanie rozwiązać w czasie około 2 minut: Ćwiczenie 10.4 Przedstawić liczby i−2013, (1 + i) 8, (1 − i) 8 w postaci a + bi. Wyznaczyć pole czworokąta wypukłego o wierzchołkach 2 − α, 2 − iα, 2 + α, 2 + iα, gdzie α = 3 + 4i. Deﬁnicja 10.1 Liczba zespolona a + bi nazywa się liczbą całkowitą Gaussa, gdy a, b są (zwykłymi) liczbami całkowitymi. Zbiór wszystkich liczb całkowitych Gaussa oznaczamy symbolem Z[ i ] i nazywamy pierścieniem (liczb całkowitych) Gaussa. Ilustracją geometryczną zbioru liczb całkowi- tych Gaussa jest krata Gaussa, o której wspomi- naliśmy już parokrotnie (zobacz też ogólną deﬁ- nicję kraty na płaszczyźnie w ustępie 8.3.1). Na rysunku 10.1 widzimy kratę Gaussa i zazna- czoną grubszymi kółeczkami podkratę genero- waną przez dwie liczby 2 − i, 1 + 2i, oraz jeden z jej obszarów fundamentalnych, zobacz D8.3. Norma liczby całkowitej Gaussa jest kwadra- tem odległości tej liczby od zera. Ćwiczenie 10.5 Udowodnić, że dla danej liczby α ∈ Z[ i ] norma N(α) jest równa polu kwadratu o wierzchołkach 0, α, iα oraz α + iα. Rys. 10.1 Badanie każdego pierścienia zaczynamy od wyznaczenia grupy elementów odwracalnych. ZADANIE 10.1 Wyznaczyć grupę jedności Z[ i ] ∗ w pierścieniu liczb całkowitych Gaussa. R o z w i ą z a n i e. Załóżmy, że ξ = x + yi ∈ Z[ i ] ∗, zobacz D1.8. To oznacza, że istnieje taka liczba η ∈ Z[ i ], że ξη = 1. Wówczas, na mocy (10.2), N(ξ)N(η) = 1, więc N(ξ) = 1, czyli x2 + y2 = 1. To równanie ma cztery rozwiązania: (1, 0), (−1, 0), (0, 1) i (0, −1). Odpowiadają one liczbom 1, −1, i − i, z których każda jest (!) jednością w Z[ i ]. Przeto: Z[ i ] ∗ = {ξ ∈ Z[ i ] : N(ξ) = 1} = {1, i, −1, −i} = {i0, i, i 2, i3}. Widzimy, że jedności w pierścieniu liczb całkowitych Gaussa są punktami kraty Gaussa leżącymi na okręgu jednostkowym (o środku w zerze), zobacz rysunek 10.1. Tworzą one grupę µ4(C) pierwiastków czwartego stopnia z jedynki, zobacz C1.35. ♦ Ćwiczenie 10.6 Uzasadnić, że w pierścieniu Gaussa Z[ i ] nie ma dzielników zera, to zna- czy, że równość αβ = 0 implikuje α = 0 lub β = 0. Wywnioskować stąd prawo skracania: Jeżeli αβ = αγ i α ̸= 0, to β = γ. 10.1. Pierścień liczb całkowitych Gaussa 327 10.1.2 Dzielenie z resztą i podzielność w Z[ i ] Pamiętamy jak duże usługi oddało nam dzielenie z resztą w pierścieniu Z zwykłych liczb całkowitych. Bardzo obiecującym jest fakt, że w pierścieniu liczb całkowitych Gaussa również istnieje możliwość dzielenia z resztą. TWIERDZENIE 10.1 Jeżeli α, β ∈ Z[ i ] i β ̸= 0, to istnieje taka para ϕ, ϱ ∈ Z[ i ], że α = ϕβ + ϱ oraz N(ϱ) < N(β). (10.3) D O W Ó D. Niech α/β = s + ti, gdzie s, t ∈ Q. Wybierzmy takie liczby całkowite k, l, by |s − k| ⩽ 1/2 i |t − l| ⩽ 1/2 i połóżmy ϕ = k + li. Wówczas N(α − ϕβ) = N(β)N(αβ−1 − ϕ) (10.4) Ale N(αβ−1 − ϕ) = N(s + ti − (k + li)) = (s − k) 2 + (t − l) 2 ⩽ 1 4 + 1 4 < 1. To, wobec równości (10.4), daje nierówność N(α − ϕβ) < N(β). Wystarczy więc położyć ϱ = α − ϕβ. □ Występujące w (10.3) liczby ϕ i ϱ nazywamy odpowiednio (niepełnym) ilorazem i resztą z dzielenia α przez β. Należy tu zwrócić uwagę, że, w przeciwieństwie do twierdzenia T2.2, gdzie wykazaliśmy jedyność ilorazu i reszty, tym razem n i e o c z e k u j e m y jednoznaczności. P r z y k ł a d. Niech α = 11−5i, β = 7−i. Wówczas α β = 11 − 5i 7 − i = 41 25 − 12 25i. Zatem kładziemy ϕ = 2 i znajdujemy 11 − 5i = 2(7 − i) + (−3 − 3i), przy czym N(−3 − 3i) = 18 < 50 = N(β). Zauważmy, że możemy napisać również 11 − 5i = (2 − i)(7 − i) + (−2 + 4i), 11 − 5i = 1(7 − i) + (4 − 4i), 11 − 5i = (1 − i)(7 − i) + (5 + 3i) Rys. 10.2 a b b- -1 bi( ) -1 bi+( ) 1 bi+( ) ib - ib 0 - bi( )2 b2 Każda z tych równości jest prawidłowym dzieleniem z resztą w Z[ i ], bowiem N(−2+4i) = 20, N(4 − 4i) = 32 i N(5 + 3i) = 34. Geometryczną treść dzielenia z resztą w pierścieniu Z[ i ] zobaczyć można na rysunku 10.2. Widzimy na nim kratę wszystkich liczb postaci ϕβ (wielokrotności β w pierścieniu Gaussa). Liczba α ”wpada” do jednego kwadratu tej kraty – w naszym przykładzie jest to kwadrat o wierzchołkach β, 2β, (2−i)β i (1−i)β. Wybierając taki 328 10. Pierścienie kwadratowe wierzchołek tego kwadratu, którego odległość od α jest mniejsza od długości boku kwadratu znajdujemy iloraz ϕ (w naszym przykładzie wszystkie cztery wierzchołki są odpowiednie – ale tak, oczywiście, nie musi być zawsze!). Normą reszty ϱ jest kwadrat odległości wybranego wierzchołka od α. ♦ Deﬁnicja 10.2 Jeżeli α, β ∈ Z[ i ], to mówimy, że α dzieli β, gdy istnieje taka liczba ϕ ∈ Z[ i ], że β = ϕα. Piszemy wtedy α|β. Mówimy też w takiej sytuacji, że α jest dzielnikiem β, lub że β jest wielokrotnością α. Jeżeli α ∈ Z[ i ], to zbiór (α) := {ϕα : ϕ ∈ Z[ i ]} (10.5) wszystkich wielokrotności liczby α nazywamy ideałem głównym generowanym przez α. Sprawdzenie, czy dana liczba α ∈ Z[ i ] dzieli daną liczbę β ∈ Z[ i ] jest bardzo proste: znajdujemy iloraz α/β w zbiorze (wszystkich) liczb zespolonych, przedstawiamy go w postaci x + yi i sprawdzamy, czy x, y ∈ Z. Ćwiczenie 10.7 Sprawdzić, że (1 + i)|(3 + 3i), (1 + i)|2, (2 − i)|5, (3 + 4i)|(5 + 10i) oraz (2 − 3i) ∤ (2 + 3i). Ćwiczenie 10.8 Udowodnić, że α|β wtedy i tylko wtedy, gdy α′|β′. Ćwiczenie 10.9 Uzasadnić, że jeżeli α|β w Z[ i ], to N(α)|N(β). Ćwiczenie 10.10 Dowieść, że jeżeli α ̸= 0, to α|α′ wtedy i tylko wtedy, gdy α ∈ Z lub |Re(α)| = |Im(α)| lub α ∈ Zi. [Jasne, że przez Zi oznaczamy {ξ ∈ Z[ i ] : Re(ξ) = 0}, a przez Z oznaczamy tu {ξ ∈ Z[ i ] : Im(ξ) = 0}.] Ćwiczenie 10.11 Sformułować i udowodnić analogony tez (1), (2), (3), (4) z T2.1 w przy- padku Z[ i ]. Wskazówka. (1) powinna zawierać zdanie ”ε|α dla każdego ε ∈ Z[ i ]∗”. Również tezę (3) należy odpowiednio zmodyﬁkować. Deﬁnicja 10.3 Jeżeli α, β ∈ Z[ i ] i istnieje taka jedność ε ∈ Z[ i ]∗, że αε = β, to mówimy, że liczby α i β są stowarzyszone w Z[ i ]. Zapisujemy to tak α ∼ β. Geometrycznie oznacza to, że β da się uzyskać z α przez obrót wokół zera o kąt 0 ◦ , ±90 ◦ lub 180 ◦ . Ćwiczenie 10.12 Udowodnić, że α jest jednością wtedy i tylko wtedy, gdy α ∼ 1. Ćwiczenie 10.13 Uzasadnić, że jeżeli α, β ∈ Z[ i ], to α|β ⇔ (β) ⊆ (α). Wywnioskować stąd, że (α) = (β) ⇔ α ∼ β. Ćwiczenie 10.14 ”Narysować” ideały główne (1 + i), (2), (3 − 2i) w Z[ i ]. Ćwiczenie 10.15 Udowodnić, że jeżeli α ̸= 0, to ideał główny (α) w interpretacji geo- metrycznej jest kratą Λ(α, iα), porównaj D8.2. Już dwa razy deﬁniowaliśmy ideał w pierścieniu: po raz pierwszy w pierścieniu Z (zwykłych) liczb całkowitych (zobacz D2.2), po raz drugi w p i e r ś c i e n i a c h wielomianów K[X] (zobacz D3.12). Zrobimy to po raz trzeci: 10.1. Pierścień liczb całkowitych Gaussa 329 Deﬁnicja 10.4 Podzbiór I ⊆ Z[ i ] nazywamy ideałem, gdy zawiera liczbę 0 oraz spełnia poniższe dwa warunki: (1) jeżeli α ∈ I i β ∈ I, to α + β ∈ I, (2) jeżeli ϕ ∈ Z[ i ] i α ∈ I, to ϕα ∈ I. W preambule do rozdziału 2 wymieniliśmy pięć wniosków, które można wyprowadzić z możliwości wykonywania dzielenia z resztą w pierścieniu Z. Podobną sytuację widzieliśmy w paragraﬁe 3.3 w odniesieniu do pierścieni K[X] wielomianów (jednej zmiennej) o współczyn- nikach w ciele. Najbardziej fundamentalnym z tych wniosków jest fakt dig’owości pierścienia (zobacz T2.3 i T3.11). W pierścieniu Z[ i ] rzecz ma się podobnie: TWIERDZENIE 10.2 Każdy ideał w pierścieniu Z[ i ] jest ideałem głównym. D O W Ó D. Jeżeli I składa się z jednego tylko elementu, czyli I = {0}, to I = (0). Jeżeli I zawiera liczby różne od zera, to zawiera liczbę o n a j m n i e j s z e j n o r m i e d o d a t n i e j (Zasada Minimum!). Niech δ ∈ I będzie taką liczbą. Twierdzimy, że wówczas I = (δ). Aby to zobaczyć sprawdzamy, że (1) (δ) ⊆ I, i (2) I ⊆ (δ). Pierwsze zawieranie jest natychmiasto- wym wnioskiem warunku D10.4(2). Aby uzasadnić zawieranie przeciwne wybierzmy dowolną liczbę α ∈ I. Dzieląc ją z resztą przez δ znajdujemy rozkład α = ϕδ +ϱ. Stąd ϱ = α−ϕδ ∈ I, bo α ∈ I i δ ∈ I. Ale N(ϱ) < N(δ), zatem N(ϱ) = 0, więc ϱ = 0, czyli α = ϕδ. Zatem I ⊆ (δ). □ W kolejnych czterech ćwiczeniach proponujemy Czytelnikowi aby zechciał sprawdzić, że analogony innych, wymienionych w preambule do rozdziału 2, wniosków z dig’owości mają miejsce w pierścieniu liczb całkowitych Gaussa. Oczywiste jest przy tym, że przyjmujemy następującą deﬁnicję: Deﬁnicja 10.5 Załóżmy, że α, β ∈ Z[ i ]. Największym wspólnym dzielnikiem pary (α, β) nazywamy taki w s p ó l n y d z i e l n i k liczb α i β, który jest dzielnikiem k a ż d e g o w s p ó l n e g o d z i e l n i k a tych liczb. Porównaj D2.4 i D3.9. Ćwiczenie 10.16 Udowodnić, że każde dwie (nie równe jednocześnie zero) liczby całkowite Gaussa m a j ą największy wspólny dzielnik i jest on wyznaczony jednoznacznie z dokładnością do relacji stowarzyszenia. Wskazówka. Zobacz T2.4 i T3.11. Dla wskazania, że δ (i każda liczba stowarzyszona z δ) j e s t największym wspólnym dziel- nikiem pary, (α, β) piszemy NWD (α, β) ∼ δ. Mówimy, że α i β są względnie pierwsze w Z[ i ], gdy NWD (α, β) ∼ 1. Ćwiczenie 10.17 Udowodnić, że jeżeli α, β ∈ Z[ i ] nie są jednocześnie równe zero, to największy wspólny dzielnik α i β da się zapisać w postaci kombinacji liniowej αξ + βζ dla pewnych ξ, ζ ∈ Z[ i ]. Wskazówka. Zobacz T2.6 i T3.11. Ćwiczenie 10.18 Sformułować i udowodnić Zasadnicze Twierdzenie Arytmetyki w pier- ścieniu Z[ i ]. Wskazówka. Zobacz T2.7 i T3.12. Ćwiczenie 10.19 Udowodnić, że jeżeli α, β ∈ Z[ i ] oraz αn|βn dla n ⩾ 1, to α|β. Wskazówka. Zobacz Z2.3. 330 10. Pierścienie kwadratowe 10.1.3 Algorytm Euklidesa w Z[ i ] Poznany przez nas algorytm Euklidesa w pierścieniu Z (zobacz T2.11) i w pierścienich K[X] (zobacz C3.29) może być bez żadnych istotnych zmian uzasadniony również w pierścieniu liczb całkowitych Gaussa. We wszystkich tych sytuacjach algorytm Euklidesa pozwala wyznaczyć NWD dwóch elementów za pomocą skończonej ilości dzieleń z resztą. Ćwiczenie 10.20 Uzasadnić, że jeżeli w Z[ i ] zachodzi równość α = ϕβ +ϱ, to D(α, β) = D(β, ϱ). Wskazówka. Zobacz T2.10. Ćwiczenie 10.21 Sformułować i udowodnić algorytm Euklidesa w pierścieniu Z[ i ]. ZADANIE 10.2 Udowodnić, że jeżeli a ∈ Z, to NWD (a + i, a − i) ∼ { 1, gdy 2|a, 1 + i, gdy 2 ∤ a. R o z w i ą z a n i e. Jeżeli a = 2k jest różną od zera liczbą parzystą, to algorytm Euklidesa wygląda następująco: a + i = 1 · (a − i) + 2i, N(2i) < N(a − i), a − i = (−ki) · (2i) − i, N(−i) < N(2i), 2i = (−2) · (−i) + 0. Zatem, w tym przypadku, NWD (a + i, a − i) ∼ −i ∼ 1. Jeżeli a = 2k + 1 jest różną od ±1 liczbą nieparzystą, to algorytm Euklidesa ma postać: a + i = 1 · (a − i) + 2i, N(2i) < N(a − i), a − i = (−ki) · (2i) + (1 − i), N(1 − i) < N(2i), 2i = (−1 + i) · (1 − i) + 0. Skąd, w tym przypadku, NWD (a + i, a − i) ∼ 1 − i ∼ 1 + i. Oczywiste przypadki a = 0 i a = ±1 pozostawiamy Czytelnikowi. ♦ Ćwiczenie 10.22 Wykonać algorytm Euklidesa dla elementów 11 − 5i, 7 − i. 10.1.4 Liczby pierwsze w Z[ i ] Liczbę pierwszą w pierścieniu Z (zwykłych) liczb całkowitych deﬁniujemy w szkole jako taką (dodatnią!) liczbę p ∈ Z, która ma d o k ł a d n i e cztery dzielniki w Z: 1, −1, p, −p, zo- bacz D2.7. To oznacza, że jej jedynymi rozkładami na iloczyn dwóch czynników są rozkłady trywialne: takie, w których jednym z czynników jest element odwracalny. Przyjmijmy taką deﬁnicję: 10.1. Pierścień liczb całkowitych Gaussa 331 Deﬁnicja 10.6 Liczba całkowita Gaussa ν ∈ Z[ i ] nie będąca zerem ani jednością nazywa się liczbą nierozkładalną Gaussa, gdy spełnia warunek: jeżeli ν = αβ, to α ∼ 1 lub β ∼ 1. (10.6) W twierdzeniu T2.15 pokazaliśmy, że liczba pierwsza w Z może być z dokładnością do znaku s c h a r a k t e r y z o w a n a przez warunek (2.16). Wygodnie jest taki warunek przyjąć za d e f i n i c j ę pierwszości. Tak zrobimy teraz: Deﬁnicja 10.7 Liczbę π ∈ Z[ i ] nazywamy liczbą pierwszą Gaussa, gdy N(π) > 1 i spełniony jest warunek: jeżeli π|αβ, to π|α lub π|β. (10.7) P r z y k ł a d. (1) Liczba 2 n i e jest liczbą pierwszą Gaussa. Istotnie, 2|(1 + i)(1 − i), ale 2 ∤ (1 + i) (bo N(2) = 4, N(1 + i) = 2 – porównaj C10.9) oraz 2 ∤ (1 − i). (2) Liczba 3 j e s t liczbą pierwszą Gaussa. Załóżmy bowiem, że 3|αβ dla α, β ∈ Z[ i ]. Wówczas, zobacz C10.9, 9|N(α)N(β). Stąd 3|N(α)N(β), więc 3|N(α) lub 3|N(β), bo 3 jest (zwykłą) liczbą pierwszą, zobacz (2.16). Niech α = a + bi i niech 3|N(α), czyli 3|a2 + b2. Z dowodu T8.2 wiemy, że wówczas 3|a i 3|b. Zatem α = 3a1 + 3b1i = 3(a1 + b1i), więc 3|α. (3) Liczba 5 n i e jest liczbą pierwszą Gaussa. Istotnie 5|(2 + i)(2 − i), ale 5 ∤ (2 + i) oraz 5 ∤ (2 − i), co sprawdzamy przez porównanie norm. ♦ Przed dowodem (bardzo ważnego) twierdzenia T10.3 rozwiążmy takie ćwiczenie: Ćwiczenie 10.23 Udowodnić, że jeżeli ν jest liczbą nierozkładalną w Z[ i ], to dla danego α ∈ Z[ i ], albo ν|α, albo NWD (ν, α) ∼ 1. Wskazówka. Zobacz C2.32 i C3.35. TWIERDZENIE 10.3 Liczba całkowita Gaussa nie będąca zerem ani jednością jest liczbą nierozkładalną Gaussa wtedy i tylko wtedy, gdy jest liczbą pierwszą Gaussa. D O W Ó D. (=⇒) Niech ν będzie liczbą nierozkładalną Gaussa i niech ν|αβ. Mamy wykazać, że ν|α lub ν|β. To jest oczywistym wnioskiem z C10.23: gdyby ν ∤ α, to musiałoby być NWD (α, ν) ∼ 1, więc, na mocy ZTA, zobacz C10.18, ν|β. (⇐=) Załóżmy, że π jest liczbą pierwszą w Z[ i ] i że π = αβ jest jej rozkładem na iloczyn w Z[ i ]. Wówczas π|α lub π|β. Niech π|α, czyli niech α = πγ dla pewnego γ ∈ Z[ i ]. Stąd π · 1 = π = πγβ, więc, na mocy prawa skracania, 1 = γβ. Zatem β jest jednością. □ Ćwiczenie 10.24 Udowodnić, że π jest liczbą pierwszą Gaussa wtedy i tylko wtedy, gdy liczba sprzężona π′ jest liczbą pierwszą Gaussa. Ćwiczenie 10.25 Uzasadnić, że jeżeli N(ξ) ∈ P, to ξ jest liczbą pierwszą Gaussa. Ćwiczenie 10.26 Udowodnić, że liczba pierwsza p ∈ P jest liczbą pierwszą Gaussa wtedy i tylko wtedy, gdy p ≡ 3 (mod 4). 332 10. Pierścienie kwadratowe Ćwiczenie 10.27 Jeżeli π1, π2 są liczbami pierwszymi Gaussa i π1|π2, to π1 ∼ π2. Jako zastosowanie T10.3 pokażemy teraz, pochodzący od Dedekinda, piękny dowód twier- dzenia Fermat’a-Eulera T8.1. S Z Ó S T Y D O W Ó D TFE. Niech p ≡ 1 (mod 4) będzie liczbą pierwszą. Wiemy (zobacz I uzupełnienie PWRK), że istnieje a ∈ Z, dla którego p|a2 + 1, czyl p|(a + i)(a − i) w Z[ i ]. Ale p ∤ (a + i) i p ∤ (a − i). Rzeczywiście, gdy p|(a ± i), to a ± i = p(k + li), więc ±1 = pl, co jest niemożliwe. Wnosimy stąd, że p nie spełnia warunku (10.7). N i e j e s t w i ę c l i c z b ą p i e r w s z ą G a u s s a. Wobec tego p nie jest liczbą nierozkładalną Gaussa. Przeto istnieje taki rozkład p = αβ, że N(α) > 1 i N(β) > 1. Stąd, na mocy (10.2): N(p) = p2 = N(α)N(β). A ponieważ N(α), N(β) ̸= 1, więc p = N(α) = x2 + y2. □ U w a g a. Przytoczony dowód twierdzenia Fermat’a-Eulera mógłby stanowić wystarczającą nagrodę za pracę włożoną w poznanie elementarnych własności pierścienia Z[ i ]. Ponadto pokazuje on, że wyjście z prostej rzeczywistej (le domaine des entiers ordinaires), gdzie ”żyją” zwykłe liczby całkowite i przejście na płaszczyznę zespoloną (passer aux entiers ”complexes” a+b√−1), gdzie ”mieszkają” liczby całkowite Gaussa, może być p r z y d a t n e w badaniu tych pierwszych. Już w początkach XIX wieku Gauss zrozumiał, że przejście to jest n i e z b ę d n e (qu’il faut passer ). Pamiętajmy jednak, że ważne dla nas są te zwykłe liczby całkowite i tylko nadzieja lepszego ich oglądu pcha nas w dziedziny zespolone. 10.1.5 Twierdzenie o jednoznaczności rozkładu w Z[ i ] W ustępie 2.3.2 udowodniliśmy twierdzenie T2.16 o istnieniu i jednoznaczności rozkładu liczb naturalnych na czynniki pierwsze. Z tego twierdzenia wynika natychmiast istnienie (i jedno- znaczność, z dokładnością do porządku czynników) rozkładów postaci 2.4.1 (RK) niezerowych liczb całkowitych (zwykłych!). Podobnie, w twierdzeniu T3.14 pokazujemy jednoznaczność rozkładu na czynniki nierozkładalne w pierścieniach wielomianów jednej zmiennej nad ciałem. Analogicznie rzecz się ma w pierścieniu liczb całkowitych Gaussa: TWIERDZENIE 10.4 Każda niezerowa i nie będąca jednością liczba całkowita Gaussa α da się zapisać w postaci iloczynu liczb pierwszych Gaussa: α = π1π2 · . . . · πs. (10.8) Ponadto przedstawienie takie jest jednoznaczne w takim sensie: Jeżeli α = ν1ν2 · . . . · νt jest również przedstawieniem liczby α w postaci iloczynu liczb pierwszych Gaussa, to s = t i, po ewentualnym przenumerowaniu, π1 ∼ ν1, π2 ∼ ν2, . . . , πs ∼ νs. D O W Ó D. Czytelnik, który zrozumiał poprzednie dowody (czy ich szkice) nie powinien mieć najmniejszych trudności z samodzielnym przedstawieniem dowodu obecnie. Można też przeczytać dowód ogólniejszego twierdzenia w następnym paragraﬁe. □ P r z y k ł a d 1. Rozkład 2 = (1 + i)(1 − i) jest rozkładem na iloczyn liczb pierwszych Gaussa. To wynika z C10.25, bo N(1 + i) = N(1 − i) = 2 ∈ P. Ten rozkład zapisujemy często 10.1. Pierścień liczb całkowitych Gaussa 333 w postaci kanonicznej 2 = (−i)(1 + i)2 dodając odpowiedni czynnik odwracalny. Widzimy, że 2 traktowana jako liczba całkowita Gaussa jest stowarzyszona z kwadratem liczby pierwszej Gaussa, chociaż sama n i e j e s t kwadratem. ♦ P r z y k ł a d 2. Jeżeli p ∈ P i p ≡ 1 (mod 4), to, jak już pięciokrotnie udowodniliśmy, istnieją takie x, y ∈ N, że p = x2 + y2. Jasne, że w takim przypadku p = (x + yi)(x − yi) (10.9) jest rozkładem na iloczyn liczb pierwszych Gaussa. Dzięki udowodnionej w T10.4 jednoznacz- ności rozkładu łatwo jeszcze raz rozwiązać zadanie Z8.2. Mianowicie, każde inne przedstawienie p = x2 1 + y2 1 daje rozkład p = (x1 + y1i)(x1 − y1i) na iloczyn czynników pierwszych (w Z[ i ]). Jednoznaczność rozkładu daje więc jedną z równości x1 + y1i = i k(x + yi) przy k = 0, 1, 2 lub 3, albo x1 + y1i = i k(x − yi) przy k = 0, 1, 2 lub 3. ♦ Wzmocnimy teraz tezę zadania Z10.2: ZADANIE 10.3 Dana jest liczba całkowita Gaussa α = a + bi. Niech NWD (a, b) = d w pierścieniu Z i niech a = da1, b = db1. Udowodnić, że wówczas NWD (α, α′) ∼ { d, gdy a1 ̸≡ b1 (mod 2), (1 + i)d, gdy a1 ≡ b1 (mod 2). (10.10) R o z w i ą z a n i e. Przedstawmy a = da1, b = db1. Niech δ będzie wspólnym dzielnikiem liczb a1+b1i, a1−b1i. Wtedy δ dzieli sumę i różnicę tych liczb: δ|2a1 i δ|2b1i. Ale a1x+b1y = 1 dla pewnych x, y ∈ Z. Stąd widzimy, że δ dzieli 2a1x − 2b1i · yi = 2. Czyli δ|2. Zatem δ ∼ 1 lub δ ∼ 1 + i lub δ ∼ 2. Ostatni przypadek nie może zachodzić (!). Łatwo sprawdzić, że (1 + i)|(u + wi) wtedy i tylko wtedy, gdy u ≡ w (mod 2). Istotnie, u ≡ w (mod 2) wtedy i tylko wtedy, gdy układ równań x − y = u, x + y = w ma rozwiązanie w liczbach całkowitych, czyli wtedy i tylko wtedy, gdy u + wi = (x + yi)(1 + i). Jasne, że to kończy rozwiązanie. ♦ Ilustracją wykorzystania jednoznaczności rozkładu w pierścieniu Gaussa Z[ i ] jest dowód znanego nam już opisu wszystkich trójek pitagorejskich. Zaczniemy od triku, porównaj T2.19, który teraz ma postać: Ćwiczenie 10.28 Jeśli iloczyn dwóch względnie pierwszych liczb w Z[ i ] jest k-tą potęgą pewnej liczby w Z[ i ], to każdy z czynników jest s t o w a r z y s z o n y z k-tą potęgą. Korzystając z tego triku udowodnimy jeszcze raz: TWIERDZENIE 10.5 Jeżeli trójka (a, b, c) liczb całkowitych względnie pierwszych speł- nia równanie Pitagorasa x2 + y2 = z2, to a = ±(u 2 − v2), b = ±2uv, c = ±(u2 + v2), (z ewentualną zamianą miejscami a i b) przy pewnych całkowitych względnie pierwszych u, v różnej parzystości. 334 10. Pierścienie kwadratowe D O W Ó D. Zapisujemy równość a2 + b2 = c2 w postaci iloczynowej (a + ib)(a − ib) = c2 w Z[ i ]. Udowodnimy, że czynniki a + ib i a − ib są względnie pierwsze w Z[ i ]. Z Z10.3 wiemy, że to jest równoważne z warunkiem a ̸≡ b (mod 2), który, jak łatwo sprawdzić, zachodzi. Wobec tego dzięki trikowi z ćwiczenia C10.28, możemy zapisać: a + ib = ε(u + iv) 2, gdzie ε = ±1, ±i. Czyli a = ±(u2 − v2), b = ±2uv lub a = ±2uv, b = ±(u 2 − v2). Wtedy też, oczywiście, c = ±(u2 + v2). □ ZADANIE 10.4 Udowodnić, że równanie y2 = x3 − 1 (10.11) nie ma rozwiązań w niezerowych liczbach całkowitych. R o z w i ą z a n i e. Oczywiście (x, y) = (1, 0) jest rozwiązaniem. Łatwo sprawdzić, że y ≡ 0 (mod 2). Gdyby bowiem y = 2v + 1, to x = 2u i wtedy 4v2 + 4v + 2 = 8u3, co nie jest możliwe. Jeżeli 2|y, to przepisując (10.11) w postaci: (y + i)(y − i) = x3, widzimy, dzięki Z10.2, że czynniki y + i i y − i są względnie pierwsze w Z[ i ]. Korzystając teraz z triku możemy napisać (przy pewnej jedności ε ∈ Z[ i ]∗) y + i = ε3(a + bi)3 = (c + di) 3. (10.12) Korzystamy tu z faktu, że każda jedność w Z[ i ] jest sześcianem (sprawdźcie!). Porównując części urojone znajdujemy 1 = 3c2d − d3 = d(3c2 − d 2). Zatem albo d = 1, 3c2 − d 2 = 1 albo d = −1, 3c2 − d2 = −1. W drugim przypadku mamy c = 0, a pierwszy przypadek zajść nie może(!). Kładąc w (10.12) c = 0, d = −1 znajdujemy więc jedyne rozwiązanie równania (10.11) w liczbach całkowitych: x = 1, y = 0. ♦ Ćwiczenie 10.29 Suma dwóch kwadratów bywa trzecią potęgą. Na przykład 2 2 +22 = 2 3, 2 2 + 112 = 5 3, 18 2 + 262 = 10 3. Wskazać nieskończenie wiele takich przykładów. Wyznaczyć wszystkie rozwiązania równania x2 + y2 = z3 w liczbach całkowitych. Ćwiczenie 10.30 Zbadać równanie x2 + y2 = zn przy dowolnym n. Ćwiczenie 10.31 Dane są względnie pierwsze liczby całkowite a, b. Załóżmy, że liczba pierwsza p dzieli a2 + b2. Udowodnić, że jeżeli NWD (p, a + bi) ∼ x + yi, to p = x2 + y2. C10.31 pozwala za pomocą algorytmu Euklidesa w pierścieniu Z[ i ] znajdować przedsta- wienia liczb pierwszych w postaci sumy dwóch kwadratów. Pokażemy to w przykładzie: 10.1. Pierścień liczb całkowitych Gaussa 335 P r z y k ł a d. Ten przykład pochodzi z [ 3 ]. Wiemy, że każdy dzielnik pierwszy p liczby 2 36 + 1 przystaje do 1 modulo 4, bo (218)2 ≡ −1 (mod p), więc (−1)Rp. Ponieważ 2 36 + 1 = 38737 · 433 · 241 · 17 jest rozkładem na czynniki pierwsze (!), a jednocześnie 2 36 + 1 = (2 12) 3 + 1 = (2 12 + 1)(224 − 2 12 + 1) = 17 · 241 · ((2 12 − 1) 2 + 212), więc 38737|4095 2 + 642. Poszukamy NWD (38737, 4095 + 64i) w pierścieniu Z[ i ]: 38737 = 9 · (4095 + 64i) + (1882 − 576i) 4095 + 64i = (2 + i) · (1882 − 576i) − (245 + 666i) 1882 − 576i = (−3i) · (245 + 666i) − (116 − 159i) 245 + 666i = (−2 + 3i) · (116 − 159i) + 0 Widzimy, że NWD (38737, 4095 + 64i) ∼ 116 − 159i. Zatem 38737 = 1162 + 159 2. Rozkłady pozostałych czynników na sumy kwadratów są (z powodu ich małości) proste: 433 = 122 + 172 oraz 241 = 42 + 152 i 17 = 12 + 42. ♦ 10.1.6 Rozkład liczb pierwszych wymiernych w Z[ i ] Pokażemy teraz jak wyglądają rozkłady liczb p ∈ P (nazywamy je, dla odróżnienia od liczb pierwszych Gaussa, liczbami pierwszymi wymiernymi) na czynniki pierwsze w Z[ i ]. Niech p ∈ P będzie liczbą pierwszą (wymierną). Liczba ta, traktowana jako element Z[ i ], ma rozkład kanoniczny p = επe1 1 πe2 2 · . . . · πes s , gdzie ε ∼ 1, (10.13) na czynniki pierwsze (= nierozkładalne) w Z[ i ] (kanoniczność rozkładu oznacza, podobnie jak w rozdziale 2, że czynniki πi są parami niestowarzyszone). Wówczas, zobacz (10.2), p2 = N(p) = N(ε)N(π1) e1N(π2) e2 · . . . · N(πs)es. Stąd wnioskujemy, że s ⩽ 2. Wobec tego a priori zachodzi jedna z trzech możliwości: (1) p = επ2 1, (2) p = επ1π2, (3) p = επ1. Wiemy z poprzednich rozważań, że każda z tych możliwości zachodzi. Konkretnie: TWIERDZENIE 10.6 Rozkład (10.13) liczb pierwszych p ∈ P w Z[ i ] ma postać: (1) 2 = (−i)(1 + i)2, (2) p = (x + iy)(x − iy), gdzie x + iy ̸∼ x − iy, gdy p ≡ 1 (mod 4), (3) p = p, gdy p ≡ 3 (mod 4). □ W ten sposób wskazaliśmy nieskończenie wiele liczb pierwszych Gaussa. Ale czy wszystkie? Okazuje się, że (z dokładnością do stowarzyszenia) t a k. To wynika z poniższego zadania: ZADANIE 10.5 Udowodnić, że jeżeli π ∈ Z[ i ] jest liczbą pierwszą Gaussa, to istnieje d o k ł a d n i e j e d n a taka wymierna liczba pierwsza p, że π|p w Z[ i ]. R o z w i ą z a n i e. Uzasadnimy najpierw, że π może dzielić co najwyżej jedną liczbę pierw- szą wymierną. Gdyby π|p i π|q, dla różnych p, q ∈ P, to, ponieważ pa + qb = 1 dla pewnych 336 10. Pierścienie kwadratowe a, b ∈ Z ⊆ Z[ i ], więc liczba π byłaby dzielnikiem 1, co jest niemożliwe. W istocie pokazali- śmy, że π nie może dzielić dwóch liczb całkowitych względnie pierwszych. Popatrzmy teraz na normę N(π). To jest liczba naturalna > 1, zobacz D10.6. Jako taka, zobacz T2.14, dzieli się przez pewną liczbę pierwszą p. Mamy więc N(π) = ππ′ = pa (10.14) dla pewnego a ∈ Z. Wobec tego π|pa. Ponieważ π jest liczbą pierwszą Gaussa, więc π|p lub π|a. Jeżeli π|p, to dobrze. Załóżmy więc, że π|a. Wówczas a = πα dla pewnego α ∈ Z[ i ]. Stąd π′a = π′πα = N(π)α = apα, więc π′ = pα (na mocy prawa skracania, bo a ̸= 0). Ale π′, jako liczba pierwsza Gaussa jest nierozkładalna, więc α ∼ 1 (bo N(p) = p2 ̸= 1). Zatem π′ ∼ p, więc też π = π′′ ∼ p′ = p i, oczywiście, π|p. ♦ Deﬁnicja 10.8 Jeżeli π jest liczbą pierwszą Gaussa, a p ∈ P jest jedyną taką wymierną liczbą pierwszą, że π|p, to mówimy, że π leży nad p. Ćwiczenie 10.32 Udowodnić, że jeżeli liczba pierwsza Gaussa π leży nad liczbą pierwszą wymierną p, to N(π) = p lub N(π) = p2. 10.2 Pierścienie kwadratowe Pierścień Z[ i ] liczb całkowitych Gaussa jest najprostszym przykładem pierścienia kwadra- towego. Jest on podpierścieniem ciała kwadratowego Q(i) = Q( √−1). Łatwo wykazać, że zachodzi równość Q(i) ∩ I = Z[ i ]. Rzeczywiście, liczba α = a + bi ∈ Q(i) jest pierwiast- kiem unormowanego wielomianu X 2 − 2aX + a2 + b2 ∈ Q[X]. Wielomian ten, będący, przy b ̸= 0, wielomianem minimalnym liczby α, ma współczynniki całkowite wtedy i tylko wtedy, gdy a, b ∈ Z. Czytelnik z łatwością to sprawdzi. Podobnie, zbiór Q( √D) ∩ I, czyli zbiór tych elementów ciała kwadratowego Q(√ D), które jednocześnie są liczbami algebraicznymi całkowitymi, jest p i e r ś c i e n i e m, zob. T6.6. Takie pierścienie (przy różnych bezkwadratowych D ̸= 1) nazywamy pierścieniami kwadratowymi. Można (podobnie jak powyżej dla przypadku D = −1) wykazać zbiór Q( √D) ∩ I daje się opisać następująco: Jeżeli D ̸= 1 jest bezkwadratową liczbą całkowitą, to oznaczamy τD :=  | | 1 + √ D 2 , gdy D ≡ 1 (mod 4), √D, gdy D ≡ 2, 3 (mod 4). (10.15) Deﬁnicja 10.9 Dla danej bezkwadratowej liczby całkowitej D ̸= 1 określamy Z[τD] := {x + yτD : x, y ∈ Z}. (10.16) Określony w ten sposób zbiór Z[τD] nazywamy pierścieniem kwadratowym wyznaczonym przez liczbę D. Gdy D > 0, to pierścień Z[τD] nazywamy rzeczywistym pierścieniem kwadratowym (jasne, że wówczas Z[τD] ⊂ R), gdy zaś D < 0, to urojonym pierścieniem kwadratowym. 10.2. Pierścienie kwadratowe 337 Ćwiczenie 10.33 Udowodnić, że jeżeli x1, y1, x2, y2 ∈ Q, to x1 +y1τD = x2 +y2τD wtedy i tylko wtedy, gdy x1 = x2 i y1 = y2. Ćwiczenie 10.34 Udowodnić, że jeżeli α ∈ Z[τD], to α′ ∈ Z[τD]. Udowodnić też, że jeżeli α = x + yτD ∈ Z[τD], to norma N(α) = αα′ jest równa N(α) =    x2 − Dy2, gdy D ≡ 2, 3 (mod 4), x2 + xy + 1 − D 4 y2, gdy D ≡ 1 (mod 4). Wywnioskować stąd, że liczba N(α) jest liczbą całkowitą dla każdego α ∈ Z[τD]. Ponadto, N(α) = 0 wtedy i tylko wtedy, gdy α = 0. 10.2.1 Jedności w Z[τD] Istnieje proste kryterium, za pomocą którego rozpoznajemy jedności (= elementy odwracalne, zobacz D1.8) w pierścieniach kwadratowych Z[τD]. W dalszym ciągu używamy oznaczeń wpro- wadzonych we wstępie do tego rozdziału. TWIERDZENIE 10.7 α ∈ Z[τD]∗ wtedy i tylko wtedy, gdy |N(α)| = 1. D O W Ó D. Załóżmy, że α ∈ Z[τD] jest odwracalny i że αβ = 1. Wówczas N(α)N(β) = N(αβ) = N(1) = 1. Stąd N(α) = ±1. Odwrotnie, jeżeli N(α) = ±1, to 1/α = ±α′, więc α jest odwracalny (w pierścieniu Z[τD]!). □ Ćwiczenie 10.35 Udowodnić, że grupa jedności Z[τD]∗ w urojonym pierścieniu kwadrato- wym jest grupą skończoną. Konkretnie: Z[τ−3] ∗ = {1, τ−3, τ 2 −3, τ 3 −3, τ 4 −3, τ 5 −3} oraz Z[τ−1]∗ = {1, τ−1, −1, τ 3 −1}, i Z[τD]∗ = {−1, +1} dla D < 0 i D ̸= −1, −3. Ćwiczenie 10.36 Niech (1+√ 2) n = an+bn√2, gdzie an, bn ∈ Z. Udowodnić, że an+bnτ2 jest jednością w Z[τ2] dla każdego n ∈ Z. 10.2.2 Dzielenie z resztą w Z[τD] W pierścieniu Z liczb całkowitych (zobacz T2.2), w pierścieniach K[X] wielomianów jednej zmiennej o współczynnikach w ciele (zobacz T3.3), a także w pierścieniu Z[ i ] (zobacz T10.1) istnieje możliwość d z i e l e n i a z r e s z t ą. Istnieją i inne pierścienie kwadratowe, w których daje1 się dzielić z resztą. Opowiemy teraz o tym. Niech α, β ∈ Z[τD], przy czym β ̸= 0. Chcielibyśmy podzielić z resztą α przez β. To znaczy, chcielibyśmy móc napisać (prawdziwe) równość i nierówność: α = ϕβ + ϱ, |N(ϱ)| < |N(β)| (10.17) dla pewnych ϕ, ϱ ∈ Z[τD]. 1Chodzi o to, by reszta ϱ w równości α = ϕβ + ϱ była w jakimś d o b r y m sensie mniejsza niż dzielnik β. 338 10. Pierścienie kwadratowe Deﬁnicja 10.10 Jeżeli dla dowolnych α, β ∈ Z[τD], β ̸= 0 istnieją ϕ, ϱ ∈ Z[τD] speł- niające warunki (10.17), to pierścień kwadratowy Z[τD] nazywa się pierścieniem normowo- euklidesowym. Udowodnimy lemat podający kryterium normowej euklidesowości Z[τD]: LEMAT 10.1 Niech D ̸= 0 będzie liczbą całkowitą bezkwadratową. Wówczas, pierścień Z[τD] jest normowo-euklidesowy wtedy i tylko wtedy, gdy dla dowolnych liczb wymiernych x, y istnieje taki element ϕ ∈ Z[τD], że |N(x + y√D − ϕ)| < 1. (10.18) D O W Ó D. (=⇒) Załóżmy, że Z[τD] jest normowo-euklidesowy i niech x, y ∈ Q. Sprowa- dzamy do wspólnego mianownika: x = s/w, y = t/w dla s, t, w ∈ Z. Wówczas s + t √D, w ∈ Z[τD]. Ponieważ w ̸= 0, więc, zgodnie z (10.17), możemy napisać: s + t√ D = ϕw + ϱ, |N(ϱ)| < |N(w)|, dla pewnych ϕ, ϱ ∈ Z[τD]. Wówczas |N(x + y√ D − ϕ)| = \f \f \f \f \fN (s + t√ D w − ϕ )\f \f \f \f \f = \f \f \fN ( ϱ w )\f \f \f = |N(ϱ)| |N(w)| < 1. (⇐=) Niech α, β ∈ Z[τD], β ̸= 0. Rozważmy liczbę zespoloną α/β i przedstawmy (mnożąc licznik i mianownik przez β′) ją w postaci α β = x + y√D, gdzie x, y ∈ Q. Niech ϕ ∈ Z[τD] spełnia nierówność (10.18). Wtedy dla ϱ = α − ϕβ: |N(ϱ)| = \f \f \f \fN(β)N ( α β − ϕ )\f \f \f \f = |N(β)| · |N(x + y√ D − ϕ)| < |N(β)| i, oczywiście, α = ϕβ + ϱ. □ Dzięki temu kryterium rozwiążemy: ZADANIE 10.6 Dowieść, że pierścień Z[τD] jest pierścieniem normowo-euklidesowym dla D = −1, −2, −3, −7, −11 oraz dla D = 2, 3, 5, 6. R o z w i ą z a n i e. Przypadek D = −1 jest już nam znany, zobacz T10.1. Równie łatwo można rozprawić się z przypadkami D = −2, 2, 3. Ponieważ −2, 2, 3 ̸≡ 1 (mod 4), więc τ = √−2, √2, √3 w tych przypadkach. Stosujemy lemat L10.1: dla danej liczby x + yτ , gdzie x, y ∈ Q, wybierzmy takie a, b ∈ Z, by |x − a| ⩽ 1/2 i |y − b| ⩽ 1/2. Niech ϕ = a + bτ . Wówczas |N(x + yτ − ϕ)| = |N((x − a) + (y − b)τ )| = |(x − a) 2 − τ 2(y − b)2| ⩽ 3 4 < 1. 10.2. Pierścienie kwadratowe 339 Zbadamy teraz przypadek D = 5. Dla danych x, y ∈ Q wybieramy a, b ∈ Z tak, by |2x − a| ⩽ 1 i |2y − b| ⩽ 1/2 oraz a ≡ b (mod 2). Chwila zastanowienia pokazuje, że to jest możliwe. Kładąc ϕ = (a + b√5)/2 mamy |N(x + y√ 5 − ϕ)| = \f \f \f \f \f (x − a 2 )2 − 5 (y − b 2 )2\f \f \f \f \f ⩽ 5 16 < 1. P r z y p a d k i D = −3, −7, −11 badamy ”rysunkowo”. Rzecz polega na tym, że urojone pierścienie kwadratowe Z[τD], dla D < 0, w naturalny sposób utożsamiamy z kratami Λ(1, τD) (rzeczywiste pierścienie kwadratowe również można utożsamiać z kratami w płaszczyźnie, jest to jednak trudniejsze i nie będziemy tego tu robić). Rozważymy przypadek D = −11. Przy- padki D = −3, −7 bada się tak samo (pro- ściej!). Na rysunku obok widzimy kratę Λ(1, τ ), gdzie τ = (1 + √−11)/2. Każdy punkt ψ tej kraty jest środkiem sześciokąta składającego się z tych i tylko tych punktów płaszczyzny, których odległość od ψ jest niewiększa niż odległość od wszystkich innych punktów kraty. Łatwo spraw- dzić, że cały taki sześciokąt zawarty jest w kole o środku ψ i promieniu 1. Ponieważ każdy punkt x + y√−11 wpada do (co najmniej) jednego sze- ściokąta, więc widzimy, że środek ϕ tego sześcio- kąta spełnia nierówność (10.18). To wynika z faktu, że |N(ψ)| (dla ψ = x+y√ D, przy D < 0) jest kwadratem z w y k ł e j odległości liczby ze- spolonej ψ od 0. t 10 t1+ Rys. 10.3 Pozostał nam jeszcze do zbadania p r z y p a d e k D = 6. Załóżmy, wbrew tezie, że Z[τ6] nie jest pierścieniem normowo-euklidesowym. Wówczas, wobec lematu L10.1, istnieją takie liczby s, t ∈ Q, że |(s − x)2 − 6(t − y) 2| ⩾ 1 (10.19) dla dowolnych x, y ∈ Z. Wybierzmy takie liczby całkowite a i b, by |s − a| ⩽ 1 2, |t − b| ⩽ 1 2 (10.20) i oznaczmy przez K liczbę (s − a) 2 − 6(t − b) 2. Nierówności (10.20) dają oszacowanie −3/2 ⩽ K ⩽ 1/4, zaś nierówność (10.19) przy x = a, y = b daje K ⩾ 1 lub K ⩽ −1. Stąd −3 2 ⩽ K ⩽ −1. (10.21) Możliwe są dwa przypadki i) 0 ⩽ s − a ⩽ 1 2, ii) − 1 2 ⩽ s − a ⩽ 0. (10.22) 340 10. Pierścienie kwadratowe W przypadku (10.22i) połóżmy w nierówności (10.19) x = a − 1, y = b. Mamy wówczas 1 ⩽ |(s − a + 1)2 − 6(t − b) 2| = |K + 2(s − a) + 1|. (10.23) Dodając 2(s − a) + 1 do obu stron nierówności (10.21) otrzymamy, po uwzględnieniu (10.22i), −1 2 ⩽ −3 2 + 2(s − a) + 1 ⩽ K + 2(s − a) + 1 ⩽ 2(s − a) ⩽ 1. Nierówność ta może, wobec (10.21) i (10.23), zachodzić tylko, gdy K = −1 i s − a = 1/2. W przypadku (10.22ii) połóżmy w nierówności (10.19) x = a + 1, y = b. Mamy wówczas 1 ⩽ |(s − a − 1) 2 − 6(t − b) 2| = |K − 2(s − a) + 1|. (10.24) Dodając −2(s − a) + 1 do obu stron nierówności (10.21) otrzymamy, po uwzględnieniu nierówności (10.22ii), −1 2 ⩽ −3 2 − 2(s − a) + 1 ⩽ K − 2(s − a) + 1 ⩽ −2(s − a) ⩽ 1. Nierówność ta może, wobec (10.21) i (10.24), zachodzić tylko, gdy K = −1 i s − a = −1/2. Widzimy więc, że w obu przypadkach (10.22) mamy |s − a| = 1/2 i K = −1. Wówczas −1 = K = 1 4 − 6(t − b)2, skąd (t − b) 2 = 5/24, co jest niemożliwe, bo t, b ∈ Q. Uzyskana sprzeczność kończy rozumowanie. ♦ Ćwiczenie 10.37 Udowodnić, że istnieje d o k ł a d n i e pięć urojonych pierścieni kwadra- towych, które są normowo-euklidesowe. Są to te Z[τD], dla których D = −1, −2, −3, −7, −11. Wyznaczenie wszystkich rzeczywistych normowo-euklidesowych pierścieni kwadratowych jest dużo trudniejsze. Ostateczny wynik uzyskano dopiero w połowie XX wieku: TWIERDZENIE 10.8 Istnieje d o k ł a d n i e szesnaście rzeczywistych pierścieni kwadrato- wych Z[τD], które są normowo-euklidesowe. Są to te pierścienie Z[τD], dla których D = 2, 3, 5, 6, 7, 11, 13, 17, 19, 21, 29, 33, 37, 41, 57 i 73. □ Ćwiczenie 10.38 Dowieść, że rzeczywisty pierścień kwadratowy Z[τ13] jest pierścieniem normowo-euklidesowym. 10.2.3 Podzielność, NWD i ideały w Z[τD] Zdeﬁniujemy (znane nam już w kontekście pierścienia Z, pierścieni K[X] i pierścienia liczb całkowitych Gaussa) podstawowe pojęcia dotyczące podzielności. Przyjmujemy następujące deﬁnicje: Deﬁnicja 10.11 (Porównaj D2.1, D3.6 i D10.2.) Jeżeli α, β są elementami pierścienia Z[τD], to mówimy, że α dzieli β, gdy istnieje taki element ϕ ∈ Z[τD], że β = ϕα. Pi- szemy wtedy α|β. Mówimy też w takiej sytuacji, że α jest dzielnikiem β, lub że β jest wielokrotnością α. Jeżeli α ∈ Z[τD], to zbiór (α) := {ϕα : ϕ ∈ Z[τD]} (10.25) wszystkich wielokrotności α nazywamy ideałem głównym generowanym przez α. 10.2. Pierścienie kwadratowe 341 Ćwiczenie 10.39 Sformułować i udowodnić analogony tez (1), (2), (3) i (4) z T2.1 w przypadku dowolnego Z[τD]. Wskazówka. Porównaj Z3.14 i C10.11. Ćwiczenie 10.40 Dowieść, że α|β ⇒ N(α)|N(β). (Wynikanie ⇐ n i e zachodzi!) Deﬁnicja 10.12 (Porównaj D3.7 i D10.3.) Jeżeli α, β ∈ Z[τD] i istnieje taka jedność ε ∈ Z[τD]∗, że αε = β, to mówimy, że elementy α i β są stowarzyszone w Z[τD]. Zapisujemy to tak α ∼ β. Ćwiczenie 10.41 Udowodnić, że relacja stowarzyszenia jest relacją równoważności. Ćwiczenie 10.42 Dowieść, że α ∈ Z[τD]∗ wtedy i tylko wtedy, gdy α ∼ 1. Ćwiczenie 10.43 Uzasadnić, że jeżeli α ∼ β w Z[τD], to |N(α)| = |N(β)|. Deﬁnicja 10.13 Niech dane będą dwa, nie równe jednocześnie zero, elementy α, β ∈ Z[τD]. Element δ ∈ Z[τD] nazywamy największym wspólnym dzielnikiem pary α, β, gdy spełnione są poniższe warunki: (1) δ|α i δ|β, (2) jeżeli γ|α i γ|β, to γ|δ. Piszemy wtedy δ ∼ NWD (α, β) lub, po prostu, NWD (α, β) = δ. O elementach α, β mówimy, że są względnie pierwsze, gdy NWD (α, β) ∼ 1. Ćwiczenie 10.44 Udowodnić, że jeżeli istnieje NWD (α, β), to jest on wyznaczony z do- kładnością do stowarzyszenia j e d n o z n a c z n i e. Ćwiczenie 10.45 Załóżmy, że Z[τD] jest pierścieniem normowo-euklidesowym. Wzoru- jąc się na T2.11 (por. też C3.29), opisać algorytm Euklidesa wyznaczania największego wspólnego dzielnika w Z[τD]. Musimy tu wyraźnie zaznaczyć, że istnienie NWD jest raczej w y j ą t k i e m niż regułą. Przykłady zobaczymy wkrótce. Deﬁnicja 10.14 (Porównaj D2.2, D3.8 i D10.4.) Podzbiór I ⊆ Z[τD] nazywamy ide- ałem, gdy zawiera liczbę 0 oraz spełnia poniższe dwa warunki: (1) jeżeli α ∈ I i β ∈ I, to α + β ∈ I, (2) jeżeli ϕ ∈ Z[τD] i α ∈ I, to ϕα ∈ I. Ćwiczenie 10.46 Udowodnić, że dla dowolnych α, β ∈ Z[τD] zbiór (α, β) := {αξ + βζ : ξ, ζ ∈ Z[τD]} jest ideałem w Z[τD]. Nazywamy go ideałem generowanym przez elementy α, β. Deﬁnicja 10.15 Pierścień bez dzielników zera, w którym każdy ideał jest ideałem głównym nazywa się dziedziną ideałów głównych, w skrócie dig’iem. 342 10. Pierścienie kwadratowe Udowodnimy teraz, że każdy (pamiętamy, że jest ich 21) normowo-euklidesowy pierścień kwadratowy jest dig’iem: TWIERDZENIE 10.9 Jeżeli Z[τD] jest normowo-euklidesowy, I jest ideałem w Z[τD], to istnieje taki element δ ∈ Z[τD], że zachodzi równość I = (δ). D O W Ó D. Dowód jest niewielką modyﬁkacją dowodu T2.3. Jeżeli I jest ideałem zerowym, to I = (0), więc I jest ideałem głównym. Jeżeli zaś I zawiera elementy różne od zera, to zawiera taki element δ, dla którego |N(δ)| jest najmniejsze. Twierdzimy, że wówczas I = (δ). Istotnie, jeżeli α ∈ I, to, zgodnie z (10.17), mamy α = ϕδ + ϱ. Stąd, po pierwsze ϱ = α − ϕδ ∈ I, a po drugie |N(ϱ)| < |N(δ)|, więc ϱ = 0. Zatem α = ϕδ ∈ (δ). Wykazaliśmy w ten sposób, że I ⊆ (δ). Ponieważ zawieranie odwrotne (δ) ⊆ I jest oczywiste, więc mamy równość I = (δ). Czyli każdy ideał jest ideałem głównym. □ 10.2.4 Dig’owość pierścieni kwadratowych Okazuje się, że pierścień kwadratowy Z[τD] może być dziedziną ideałów głównych nawet w przypadku, gdy nie jest on pierścieniem euklidesowym. TWIERDZENIE 10.10 Istnieje d o k ł a d n i e 9 urojonych pierścieni kwadratowych Z[τD] będących dig’ami. Są to te, dla których −D = 1, 2, 3, 7, 11, 19, 43, 67, 163. □ U w a g a 1. Dowód twierdzenia T10.10 jest trudny. Sprawdzenie dig’owości wymienionych pierścieni nie przekracza naszych możliwości (zrobiliśmy to dla pierwszych pięciu przypadków!). Dużo trudniej wykazać, że (poza wymienionymi) więcej dig’ów wśród urojonych pierścieni kwadratowych n i e m a. U w a g a 2. Istnieje d u ż o (być może nawet nieskończenie wiele) rzeczywistych pierścieni kwadratowych, które są dig’ami. Poza wymienionymi w T10.8 są to na przykład te, dla których D = 14, 22, 29, 31, 33, 38, 43, 46, 47, ... . Liczb bezkwadratowych 1 < D ⩽ 197 jest 120, wśród nich występuje 67 takich, dla których Z[τD] jest dziedziną ideałów głównych (z czego, jak wiemy, 16 pierścieni euklidesowych). 10.2.5 Wnioski z dig’owości W tym ustępie wypiszemy kilka wniosków z dig’owości pierścienia. Są one takie: (1) każda para elementów ma NWD , (2) NWD danych elementów pisze się w postaci kombinacji liniowej tych elementów, (3) prawdziwe jest Zasadnicze Twierdzenie Arytmetyki, (4) każdy element nierozkładalny jest elementem pierwszym, (5) zachodzi twierdzenie o istnieniu i jednoznacz- ności rozkładu na czynniki nierozkładalne. Ćwiczenie 10.47 Prześledzić dokładnie jak analogony powyższych tez były udowodnione w pierścieniu Z liczb całkowitych i w pierścieniu K[X] wielomianów o współczynnikach w K. TWIERDZENIE 10.11 Jeżeli pierścień Z[τD] jest dziedziną ideałów głównych, to każda para niezerowych elementów w Z[τD] m a największy wspólny dzielnik. Ponadto, największy wspólny dzielnik pary α, β ∈ Z[τD] daje się zapisać w postaci αξ + βζ dla pewnych elementów ξ, ζ ∈ Z[τD]. 10.2. Pierścienie kwadratowe 343 D O W Ó D. [Dowód jest prostym uogólnieniem dowodu twierdzenia T2.4.] Załóżmy, że Z[τD] jest dig’iem i weźmy dwa niezerowe elementy α, β ∈ Z[τD]. Rozważmy ideał (α, β) := {αϕ + βψ : ϕ, ψ ∈ Z[τD]} pierścienia Z[τD]. Ponieważ jest on (jak każdy ideał w Z[τD]) ideałem głównym, więc istnieje taki element δ ∈ Z[τD], że (α, β) = (δ). Twierdzimy, że δ ∼ NWD (α, β). Sprawdzamy, że spełniony jest warunek D10.13(1): Zauważmy, że α = α · 1 + β · 0 ∈ (α, β), więc α ∈ (δ), czyli δ|α. Podobnie sprawdzamy, że δ|β. Sprawdzamy, że spełniony jest warunek D10.13(2): Ponieważ δ = δ · 1 ∈ (δ), więc δ = αξ +βζ dla pewnych ξ, ζ ∈ Z[τD]. Stąd, jeżeli γ|α i γ|β, czyli α = γσ i β = γϑ dla pewnych σ, ϑ ∈ Z[τD], to δ = αξ + βζ = (γσ)ξ + (γϑ)ζ = γ(σξ + ϑζ). Skąd γ|δ. □ Ćwiczenie 10.48 Udowodnić, że w dowolnym pierścieniu euklidesowym prawdziwe jest Zasadnicze Twierdzenie Arytmetyki: Jeżeli α|βγ i NWD (α, β) ∼ 1, to α|γ. Deﬁnicja 10.16 (Porównaj D3.11 i D10.7.) Element ν ∈ Z[τD] nie będący zerem ani jednością nazywa się elementem nierozkładalnym w Z[τD], gdy spełnia warunek: jeżeli ν = αβ, to α ∼ 1 lub β ∼ 1. (10.26) Ćwiczenie 10.49 Uzasadnić, że jeżeli σ ∈ Z[τD] jest takim elementem, że |N(σ)| jest liczbą pierwszą, to σ jest elementem nierozkładalnym. Ćwiczenie 10.50 Załóżmy, że Z[τD] jest dig’iem. Udowodnić, że jeżeli ν ∈ Z[τD] jest elementem nierozkładalnym, to dla dowolnego elementu α ∈ Z[τD] zachodzi dokładnie jedna z możliwości: ν|α albo NWD (α, ν) ∼ 1. Wskazówka. Zobacz C10.23. Deﬁnicja 10.17 (Porównaj D10.6.) Element π ∈ Z[τD] nie będący ani zerem ani jedno- ścią nazywa się elementem pierwszym w Z[τD], gdy spełnia warunek: jeżeli π|αβ, to π|α lub π|β. (10.27) Ćwiczenie 10.51 Udowodnić, że jeżeli element pierwszy jest dzielnikiem innego elementu pierwszego, to elementy te są stowarzyszone. Czyli: jeżeli π1|π2, to π1 ∼ π2. Ćwiczenie 10.52 Udowodnić, że każdy element pierwszy w Z[τD] jest elementem nieroz- kładalnym. Wskazówka. Porównaj część (⇐=) dowodu T10.3. Zauważmy, że nie korzystamy tu z dig’owości pierścienia Z[τD]. Ćwiczenie 10.53 Udowodnić, że jeżeli Z[τD] jest dig’iem, to każdy element nierozkła- dalny w Z[τD] jest elementem pierwszym. Wskazówka. Porównaj część (=⇒) dowodu T10.3. Zauważmy jak ważną rolę gra tu dig’owość Z[τD]. 344 10. Pierścienie kwadratowe U w a g a. Elementy nierozkładalne zazwyczaj n i e s ą elementami pierwszymi. P r z y k ł a d. Rozważmy element 2 w pierścieniu Z[τ−5]. Sprawdzimy, że jest to element nierozkładalny. Załóżmy, że zachodzi równość 2 = (a + b√−5)(c + d√ −5). Wówczas również 2 = (a − b√ −5)(c − d √−5) (bo sprzężenie iloczynu równe jest iloczynowi sprzężeń). Mnożąc te dwie równości stronami otrzymamy 4 = (a2 + 5b2)(c2 + 5d2), co jest możliwe tylko, gdy a = ±1, b = 0, c = ±2, d = 0 lub a = ±2, b = 0, c = ±1, d = 0. Zatem albo a + b√ −5, albo c + d √−5 jest jednością. Z drugiej strony 2 nie jest elementem pierwszym w Z[τ−5]. Istotnie: 2|(1 + √−5)(1 − √ −5), ale, jak łatwo sprawdzić, 2 ∤ (1 + √−5) oraz 2 ∤ (1 − √−5). ♦ Ponieważ w dig’ach każdy element nierozkładalny jest elementem pierwszym, więc z powyżej pokazanego przykładu wnosimy, że pierścień Z[τ−5] n i e j e s t dig’iem. Można to też zobaczyć bezpośrednio: Ćwiczenie 10.54 Udowodnić, że zbiór I = {2ϕ + (1 − √ −5)ψ : ϕ, ψ ∈ Z[τ−5]} jest niegłównym(!) ideałem w pierścieniu Z[τ−5]. 10.2.6 Związek z formami kwadratowymi Arytmetyka pierścienia Z[τD] może być wykorzystana do badania form kwadratowych. W tym ustępie powiemy słów kilka o tym jak się to robi. Podstawową jest tu obserwacja, że norma elementu x + yτD ∈ Z[τD] jest, zgodnie z C10.34, wartością pewnej formy kwadratowej na parze (x, y). Deﬁnicja 10.18 Niech D ̸= 1 będzie liczbą całkowitą bezkwadratową. Zdeﬁniujmy: fD(X, Y ) = { X 2 − DY 2, gdy D ≡ 2, 3 (mod 4), X 2 + XY + 1 4(1 − D) Y 2, gdy D ≡ 1 (mod 4). (10.28) Tak zdeﬁniowaną formę fD(X, Y ) nazywamy formą kanoniczną wyznaczoną przez liczbę bezkwadratową D. Będziemy teraz zakładać, że Z[τD] jest dziedziną ideałów głównych. Wiemy, że istnieje 21 liczb bezkwadratowych D, dla których Z[τD] jest pierścieniem normowo-euklidesowym. W każdym z tych pierścieni nierozkładalność jest r ó w n o w a ż n a pierwszości, zobacz C10.52 i C10.53. Dzięki tej równoważności mogliśmy podać w ustępie 10.1.4 piękny dowód twierdzenia Fermat’a-Eulera. Taki sam argument zastosować można w pozostałych 20 przypadkach: TWIERDZENIE 10.12 Niech D będzie taką bezkwadratową liczbą całkowitą, że w pier- ścieniu Z[τD] każdy element nierozkładalny jest elementem pierwszym. Niech p > 2 będzie taką liczbą pierwszą, że DRp. Wówczas forma kanoniczna fD(X, Y ) przedstawia (właściwie) co najmniej jedną z liczb p, −p. 10.2. Pierścienie kwadratowe 345 D O W Ó D. Niech DRp, czyli niech a2 ≡ D (mod p) dla pewnego a ̸≡ 0 (mod p). Mamy więc równość a2 − D = pu dla pewnego u ∈ Z, którą możemy zapisać tak: pu = (a + √D)(a − √D). Równość tę zapisujemy (w zależności od reszty z dzielenia D przez 4) w jednej z postaci: pu = { (a − 1 + 2τD)(a + 1 − 2τD), gdy D ≡ 1 (mod 4), (a + τD)(a − τD), gdy D ≡ 2, 3 (mod 4), (10.29) zobacz (10.15). Stąd widzimy, że p dzieli iloczyn dwóch czynników w pierścieniu Z[τD]. Ale p n i e dzieli żadnego z czynników tego iloczynu. Istotnie, gdyby p|(a−1+2τD), czyli a−1+2τD = p(b + cτD) dla pewnego b + cτD ∈ Z[τD], to zachodziłaby równość 2 = pc, zobacz C10.33. Ponieważ p > 2, więc to jest niemożliwe. Podobnie sprawdzamy, że p nie dzieli (w Z[τD] (!)) innych czynników w rozkładzie (10.29). Wobec tego p nie jest elementem pierwszym w Z[τD]. Ponieważ zakładamy, że w Z[τD] każdy element nierozkładalny jest elementem pierwszym, a p nie jest pierwszy, więc p nie jest nierozkładalny. Zatem istnieją takie α, β ∈ Z[τD], że p = αβ i α ̸∼ 1, β ̸∼ 1. Wtedy p2 = |N(p)| = |N(α)| · |N(β)| i |N(α)| ̸= 1, |N(β)| ̸= 1. Niech α = x + yτD. Wówczas p = |N(α)| = { |x2 + xy + 1 4(1 − D)y2|, gdy D ≡ 1 (mod 4), |x2 − Dy2|, gdy D ≡ 2, 3 (mod 4) } = |fD(x, y)|, patrz C10.34 i (10.28). To kończy dowód. □ Ćwiczenie 10.55 Wyprowadzić z powyższego nowy dowód T8.6 (⇐=). P r z y k ł a d 1. Rozwiążemy teraz jeszcze raz ćwiczenie C8.10: Niech p ∈ P i niech p ≡ 1, 7 (mod 12). Wówczas, zobacz (5.85), a2 ≡ −3 (mod p) dla pewnego a ∈ Z. Więc p|(a +√−3)(a − √−3) w Z[τ−3]. Łatwo jednak sprawdzić, że p ∤ (a ± √ −3). Zatem p n i e jest elementem pierwszym w Z[τ−3], więc nie jest też elementem nierozkładalnym (zobacz C10.53). Wobec tego istnieją takie α, β ∈ Z[τ−3], że p = αβ i α ̸∼ 1, β ̸∼ 1. Wtedy p2 = N(p) = N(α)N(β) i N(α) ̸= 1, N(β) ̸= 1. Niech α = a + bτ−3. Wówczas p = N(α) = a2 + ab + b2, zobacz C10.34. W ten sposób znowu(?) rozwiązaliśmy ćwiczenie C8.23. Zauważmy teraz, że suma a2 + ab + b2 jest równa ( a − b 2 )2 + 3 ( a + b 2 )2 = ( a + b 2 )2 + 3 ( b 2 )2 = (a 2 + b)2 + 3 (a 2 )2 , porównaj P3 z ustępu 8.4.2. Stąd widać, że jeżeli w równości p = a2 +ab+b2 obie liczby a, b są nieparzyste, to kładąc x = (a − b)/2, y = (a + b)/2 mamy przedstawienie p = x2 + 3y2. Jeżeli b jest parzyste, to kładziemy x = a + b/2, y = b/2, jeżeli zaś a jest parzyste, to kładziemy x = a/2 + b, y = a/2 i znów mamy przedstawienie p = x2 + 3y2, x, y ∈ Z. ♦ Ćwiczenie 10.56 Wykorzystując fakt, że pierścień Z[τ−7] jest pierścieniem normowo- euklidesowym udowodnić, że każda liczba pierwsza p ≡ 1, 9, 11, 15, 23, 25 (mod 28) da się przedstawić w postaci x2 + 7y2. Zobacz też C8.24. 346 10. Pierścienie kwadratowe Ćwiczenie 10.57 Udowodnić, że jeżeli p > 2 jest taką liczbą pierwszą, że (−11)Rp, to p da się przedstawić w postaci x2 + xy + 3y2. Udowodnić też, że wówczas liczba 4p da się przedstawić w postaci x2 + 11y2. Zastanowić się nad charakteryzacją tych liczb pierwszych, które dają się przedstawić przez formę X 2 + 11Y 2. Również rzeczywiste normowo-euklidesowe pierścienie kwadratowe można wykorzystać dla przedstawiania liczb pierwszych przez formy kwadratowe: P r z y k ł a d 2. Wyznaczymy wszystkie liczby pierwsze p ̸= 2, 5, które dają się przedstawić przez formę X 2 − 5Y 2. Załóżmy, że zachodzi równość ±p = x2 − 5y2 dla pewnych liczb całkowitych x, y. Wówczas(!) p ∤ y. Mnożąc kongruencję x2 ≡ 5y2 (mod p) przez odwrotność y−1 (mod p), zobacz D5.3, mamy (xy−1)2 ≡ 5 (mod p). I widzimy, że 5Rp. Czyli że (5|p) = +1. Ale, zobacz 5.7.5 U2, (5|p) = (p|5). Wobec tego p ≡ ±1 (mod 5). Odwrotnie, załóżmy, że p ≡ ±1 (mod 5). Wtedy +1 = (p|5) = (5|p). Czyli 5Rp. Z twierdzenia T10.12 wnosimy więc, że |f5(a, b)| = |a2 + ab − b2| = p dla pewnych a, b ∈ Z. Ponadto suma a2 + ab − b2 jest równa ( 3a − b 2 )2 − 5 ( a − b 2 )2 = (3a + 4b 2 )2 − 5 ( a + 2b 2 )2 = ( 2a + b 2 )2 − 5 ( b 2 )2 . Stąd widać, że jeżeli w równości p = |a2 + ab − b2| obie liczby a, b są nieparzyste, to kładąc x = (3a − b)/2, y = (a − b)/2 mamy przedstawienie p = |x2 − 5y2|. Gdy a jest parzyste, to kładziemy x = (3a + 4b)/2, y = (a + 2b)/2, gdy zaś b jest parzyste, to kładziemy x = (2a + b)/2, y = b/2 i znów mamy przedstawienie p = |x2 − 5y2|, x, y ∈ Z. Na koniec zauważmy, że (2x + 5y) 2 − 5(x + 2y) 2 = −(x2 − 5y2). To pozwala nam dać wyczerpującą o d p o w i e d ź: Jeżeli p ≡ ±1 (mod 5) jest liczbą pierwszą, to istnieją takie liczby całkowite x, y, że x2 − 5y2 = p i takie liczby całkowite x1, y1, że x2 1 − 5y2 1 = −p. Odwrotnie, jeżeli p = |x2 − 5y2| jest liczbą pierwszą i p ̸= 5, to p ≡ ±1 (mod 5). ♦ Ćwiczenie 10.58 Udowodnić, że jeżeli równanie x2 − 5y2 = n ma rozwiązanie, to ma nieskończenie wiele rozwiązań. Ćwiczenie 10.59 Scharakteryzować zbiór {x2 − 5y2 : x, y ∈ Z}. Wskazówka. Zobacz T8.2 i tożsamość Brahmagupty (8.1). P r z y k ł a d 3. Przypatrzymy się teraz formie X 2 − 6Y 2. Zgodnie z ﬁlozoﬁą tego ustępu wykorzystujemy pierścień Z[τ6]. Wiemy, że jest on normowo-euklidesowy, zobacz Z10.6. Zatem każdy element nierozkładalny w Z[τ6] jest pierwszy. Dzięki prawu wzajemności sprawdzamy, że 6Rp wtedy i tylko wtedy, gdy p ≡ 1, 5, 19, 23 (mod 24). Wobec tego, jeżeli p jest liczbą pierwszą z jednego z ciągów (24t + 1), (24t + 5), (24t + 19) lub (24t + 23), to istnieje taka liczba a ∈ Z, że p|a2 − 6, czyli p|(a + √ 6)(a − √ 6) w pierścieniu Z[τ6]. Sprawdzenie, że p ∤ (a ± √6) w Z[τ6], jest natychmiastowe. Zatem p nie jest elementem pierwszym w Z[τ6]. Nie jest więc też elementem nierozkładalnym. Przeto istnieje rozkład p = (a + b√6)(c + d√6), w którym |N(a + b√6)| ̸= 1 i |N(c + d √6)| ̸= 1. Podobnie jak wyżej znajdujemy stąd, że |N(a + b√6)| = p. Więc a2 − 6b2 = ±p. Teraz należy odróżnić dwa przypadki: (1) p ≡ 1, 19 (mod 24), (2) p ≡ 5, 23 (mod 24). 10.2. Pierścienie kwadratowe 347 W przypadku (1) nie może zachodzić równość a2 − 6b2 = −p, co łatwo sprawdzić redukując modulo 6. Byłoby wtedy −1, −19 ≡ 5 ≡ a2 (mod 6), co jest niemożliwe (bo kwadratami modulo 6 są 0, 1, 4, 3). Zachodzi więc równość x2 − 6y2 = p dla pewnych x, y ∈ Z. W przypadku (2) nie może zachodzić równość a2 − 6b2 = p, co łatwo sprawdzić redukując modulo 6. Byłoby wtedy 5, 23 ≡ 5 ≡ a2 (mod 6), co jest niemożliwe. Zachodzi więc równość x2 − 6y2 = −p dla pewnych x, y ∈ Z. ♦ Ćwiczenie 10.60 Sprawdzić, że jeżeli para (x, y) ∈ Z × Z jest rozwiązaniem równania x2 − 6y2 = n, to również para (5x + 12y, 2x + 5y) jest rozwiązaniem tego równania. Ćwiczenie 10.61 Opisać liczby całkowite przedstawiane przez formę X 2 − 13Y 2. 10.2.7 Jednoznaczność rozkładu Pierścienie normowo-euklidesowe są dziedzinami z jednoznacznością rozkładu: TWIERDZENIE 10.13 Jeżeli pierścień Z[τD] jest pierścieniem normowo-euklidesowym, to każdy niezerowy i nie będący jednością element α da się przedstawić w postaci iloczynu α = ν1ν2 · . . . · νs, (10.30) elementów nierozkładalnych. Ponadto, przedstawienie (10.30) jest j e d n o z n a c z n e w tym sensie, że jeżeli dla elementów nierozkładalnych µi, zachodzi równość α = µ1µ2 · . . . · µt, (10.31) to t = s i, po ewentualnym przenumerowaniu, ν1 ∼ µ1, ν2 ∼ µ2, . . . , νs ∼ µs. D O W Ó D. Dowód jest natychmiastowym uogólnieniem dowodów twierdzeń T2.16 i T3.14. Najpierw dowodzimy analogonu twierdzenia T2.14, czyli że każdy nie będący jednością niezerowy element dzieli się przez jakiś element nierozkładalny. Załóżmy n i e w p r o s t, że w zbiorze Z[τD] ∖ (Z[τD]∗ ∪ {0}) istnieją elementy, które n i e są podzielne przez elementy nierozkładalne. Spośród wszystkich takich elementów wybierzmy taki element α, dla którego |N(α)| jest najmniejsze (Zasada Minimum!). Ponieważ α nie jest nierozkładalny (bo każdy element dzieli się przez siebie), więc można zapisać go w postaci iloczynu βγ, gdzie β, γ ̸∈ Z[τD]∗. Ale wtedy |N(α)| = |N(β)| · |N(γ)| i, wobec tego, że |N(β)|, |N(γ)| > 1, |N(β)| < |N(α)|. Zatem β, a więc i α, dzieli się przez element nierozkładalny. S p r z e c z n o ś ć. Dzięki temu możemy udowodnić i s t n i e n i e rozkładu (10.30). Robi się to znowu nie wprost i znowu korzystając z Zasady Minimum. Gdyby istniały złe elementy nie dające się zapisać w postaci (10.30), to istniałby zły element α, dla którego |N(α)| jest najmniejsze. Wówczas, na mocy poprzedniej części ν1|α dla pewnego elementu nierozkładalnego ν1. Zatem α = ν1β dla pewnego β. Wtedy |N(α)| = |N(ν1)| · |N(β)|, skąd widzimy, że |N(β)| < |N(α)|, bo |N(ν1)| > 1. I, jeżeli |N(β)| = 1, to β jest jednością, więc α ∼ ν1, czyli α = α jest rozkładem typu (10.30). Jeżeli zaś |N(β)| > 1, to |N(β)| < |N(α)|, więc β może być przedstawiony w postaci iloczynu ν2·. . .·νs elementów nierozkładalnych. Stąd α = ν1ν2·. . .·νs. S p r z e c z n o ś ć. Dowód j e d n o z n a c z n o ś c i rozkładu można przeprowadzić niemal tak samo jak odpo- wiedni fragment dowodu T2.16: zakładając, że istnieją złe elementy mające istotnie różne 348 10. Pierścienie kwadratowe rozkłady na iloczyn czynników nierozkładalnych, przypuśćmy, że α jest złym elementem, dla którego |N(α)| jest najmniejsze i (10.30) i (10.31) są istotnie różnymi rozkładami. Wtedy ν1|µ1µ2 · . . . · µt. Wykorzystamy teraz fakt, że k a ż d y element nierozkładalny jest elemen- tem pierwszym, zobacz T10.9 i C10.53. Skoro element pierwszy ν1 dzieli iloczyn, to musi dzielić któryś z czynników. Przenumerowując, możemy uznać, że ν1|µ1. Ale µ1 też jest elementem pierwszym, więc, na mocy C10.51, µ1 = ν1ε, gdzie ε ∈ Z[τD]∗. Dzięki temu do- stajemy równość ν1ν2 · . . . · νs = ν1εµ2 · . . . · µt. Skąd, po uproszczeniu przez ν1, mamy ν2 · . . . · νs = (εµ2) · . . . · µt =: β. Ponieważ |N(β)| = |N(α)|/|N(ν1)| < |N(α)|, więc β ma jed- noznaczny rozkład na czynniki nierozkładalne. Wobec tego, po ewentualnym przenumerowaniu, ν2 ∼ µ2, . . . , νs ∼ µs i s = t. □ Pokażemy przykład wykorzystania jednoznaczności rozkładu w Z[τ−11]: P r z y k ł a d. Znajdziemy rozwiązania równania y2 = x3 − 11 (10.32) w liczbach całkowitych. Technika poszukiwania rozwiązań jest taka sama jak w zadaniu Z10.4. Załóżmy, że para (x, y) jest rozwiązaniem. Wówczas w pierścieniu Z[τ−11] zachodzi równość (y + √−11)(y − √−11) = x3. (10.33) Oznaczmy δ = NWD (y + √−11, y − √−11). Liczba δ, jako dzielnik liczb y + √ −11 i y − √−11, jest dzielnikiem ich sumy i różnicy: δ|2y i δ|2 √ −11. Ponieważ 2 i √ −11 są elementami nierozkładalnymi w Z[τ−11], zobacz Z10.7 i C10.62, więc, na mocy jednoznaczności rozkładu, mamy tylko cztery możliwe przypadki: (1) δ ∼ 1, (2) δ ∼ 2, (3) δ ∼ √ −11, (4) δ ∼ 2 √−11. Pokażemy, że w rzeczywistości zachodzi tylko przypadek (1). W przypadkach (3) i (4) mamy bowiem √ −11|δ, więc √ −11|2y, skąd 11|4y2, zobacz C10.40, zatem 11|y. Wówczas równość (10.32) pokazuje, że 11|x i daje 11 2y1 = 113x1 − 11, co jest niemożliwe. Również przypadek (2) nie ma miejsca. Jeżeli bowiem 2|y ± √ −11, czyli 2|y ∓ 1 ± 2τ , to 2|y ± 1. (Piszemy w skrócie τ = τ−11, wobec czego √−11 = 2τ − 1.) I równość (10.33) możemy napisać w postaci ( y − 1 2 + τ ) (y + 1 2 − τ ) = 2x3 1, z której wynika (dzięki nierozkładalności, czyli pierwszości liczby 2 (!)), że 2 dzieli co najmniej jeden czynnik z lewej strony. Ale, jeżeli 2|a + bτ , to 2|b. Mamy więc sprzeczność. Pozostał nam do zbadania p r z y p a d e k δ ∼ 1. Korzystamy z triku. [Czytelnik z łatwością sformułuje i udowodni prawdziwość triku w każdej dziedzinie z jednoznacznością rozkładu, por. T2.19 i C10.28.] Dzięki niemu możemy napisać y + √ −11 = y − 1 + 2τ = (a + bτ ) 3 = A + Bτ, gdzie A = a3 − 9ab2 − 3b3, B = 3a2b + 3ab2 − 2b3, co łatwo sprawdzić, bo τ 2 = τ − 3 i τ 3 = −3 − 2τ . Wystarczy teraz rozwiązać równanie 2 = B = b(3a2 + 3ab − 2b2). Dzięki jednoznaczności rozkładu w pierścieniu Z badamy tylko cztery przypadki: b = ±1, ±2. I znajdujemy rozwiązania (a, b) = (0, −1), (1, −1), (1, 2), (−3, 2). Te wartości dają kolejno y = A + 1 = −4, 4, −58, 58. Widzimy stąd, że (x, y) = (3, ±4), (15, ±58) są wszystkimi rozwiązaniami równania (10.32). ♦ 10.2. Pierścienie kwadratowe 349 ZADANIE 10.7 Udowodnić, że jeżeli D ≡ 5 (mod 8), to liczba 2 traktowana jako ele- ment pierścienia kwadratowego Z[τD] jest elementem nierozkładalnym. R o z w i ą z a n i e. Załóżmy, że 2 = αβ = (a + bτ )(c + dτ ), gdzie τ = τD, jest rozkładem elementu 2 na iloczyn. Wówczas 2 = α′β′ = (a + bτ ′)(c + dτ ′), zobacz C10.2. Mnożąc te dwie równości stronami dostajemy 4 = N(α)N(β) = (a2 + ab − (2s + 1)b2)(c2 + cd − (2s + 1)d2), gdzie położyliśmy D = 8s+5, zobacz C10.34. Chcemy uzasadnić, że |N(α)| = 1 lub |N(β)| = 1. Wystarczy w tym celu udowodnić, że żaden z dwóch czynników po prawej stronie powyższej równości n i e może być równy ±2. To wynika z prostej analizy parzystości: jeżeli a ≡ b ≡ 0 (mod 2), to a2 + ab − (2s + 1)b2 jest liczbą podzielną przez 4 (więc ̸= ±2), a w pozostałych trzech przypadkach a2 + ab − (2s + 1)b2 jest liczbą nieparzystą (więc ̸= ±2). ♦ Ćwiczenie 10.62 Uzasadnić, że jeżeli |D| jest liczbą pierwszą, to √D jest elementem nierozkładalnym w pierścieniu Z[τD]. 10.2.8 Pierścienie Z[τ−2], Z[τ−3] i Z[τ−5] Powiemy teraz kilka słów o nazwanych w tytule ustępu pierścieniach kwadratowych. Dwa pierw- sze są przykładami pierścieni z jednoznacznością rozkładu. Trzeci jest przykładem pierścienia b e z jednoznaczności rozkładu. Pierścień Eulera Z[ √−2 ] Poznamy bliżej pierścień Z[τ−2]. Ponieważ Euler używał tego pierścienia rozwiązując równanie y2 = x3 − 2, więc proponujemy nazwę: pierścień Eulera. Ponieważ −2 ≡ 2 (mod 4), więc, zgodnie z (10.15), pierścień Z[τ−2] składa się ze wszystkich liczb postaci a + b√−2, gdzie a, b ∈ Z. Używamy więc również oznaczenia Z[ √−2 ]. Ćwiczenie 10.63 Uzasadnić, że Z[ √ −2 ] ∗ jest grupą dwuelementową {−1, +1}. ZADANIE 10.8 Rozwiązać równanie y2 = x3 − 2 w liczbach całkowitych. R o z w i ą z a n i e. Załóżmy, że para (x, y) ∈ Z × Z jest rozwiązaniem. Łatwo sprawdzić, że wówczas y jest liczbą nieparzystą [gdy y = 2u, to x = 2v, więc 2u2 = 4v3 − 1 co jest niemożliwe]. Piszemy w skrócie τ = τ−2 = √ −2. W pierścieniu Z[ √−2 ] mamy rozkład (y + τ )(y − τ ) = x3. (10.34) Wykażemy, że czynniki y + τ i y − τ są względnie pierwsze w Z[ √−2 ]. Załóżmy, że δ ∈ Z[ √−2 ] jest wspólnym dzielnikiem czynników y + τ i y − τ tego rozkładu. Wówczas δ dzieli ich różnicę: δ|2τ . Ale 2τ = −τ 3 jest rozkładem na czynniki nierozkładalne w Z[ √−2 ] (sprawdźcie!). Na mocy jednoznaczności rozkładu widzimy stąd, że δ ∼ τ k przy pewnym k = 0, 1, 2, 3. Gdy k > 0, to τ |y + τ , więc τ |y, stąd N(τ )|N(y), czyli 2|y2, co jest niemożliwe, bo y ≡ 1 (mod 2). Wobec tego δ ∼ 1. Teraz możemy zastosować trik w pierścieniu 350 10. Pierścienie kwadratowe Z[ √−2 ], zobacz C10.64. Ponieważ lewa strona równości (10.34) jest iloczynem czynników względnie pierwszych, więc każdy z czynników jest stowarzyszony z sześcianem: y + τ = (a + bτ ) 3 dla pewnego a + bτ ∈ Z[ √−2 ]. Możemy napisać równość, ponieważ każda jedność w Z[ √−2 ] jest sześcianem (!). Porównując części urojone obu stron tej równości mamy: 1 = 3a2b − 2b3. Stąd b = ±1. Jeżeli b = 1, to a = ±1. Jeżeli b = −1, to −1 = −3a2, co jest niemożliwe. Mamy stąd jedyne rozwiązania x = 3, y = ±5. ♦ Ćwiczenie 10.64 Sformułować i udowodnić trik w Z[ √−2 ]. Ćwiczenie 10.65 Spróbujcie rozwiązać w liczbach całkowitych równanie y2 = xp − 2 dla paru innych (może dla wszystkich?) wykładników pierwszych p. Na rysunku 10.4 pokazujemy pierścień Z[ √−2 ]. Grubszymi kółeczkami zaznaczyli- śmy ideał (główny, bo w Z[ √−2 ] każdy ideał jest główny!) (1 + 2√−2). Cały pierścień Z[ √−2 ] jest kratą Λ(1, √−2). Wskazany ideał jest kratą Λ(4 − √−2, 1 + 2√−2). Zaznaczono równoległobok podstawowy kraty. Ćwiczenie 10.66 Uzasadnić, że każdy ideał w Z[ √−2 ] jest kratą p o d o b n ą do kraty (1) = Λ(1, √−2). Ćwiczenie 10.67 Udowodnić, że pole równo- ległoboku podstawowego dowolnego ideału (α) jest 1 1 _ Rys. 10.4 równe N(α) √2. Zauważyć też, że ta teza jest równoważna faktowi, że w każdym równoległo- boku podstawowym ideału (α) leży dokładnie N(α) − 1 punktów kraty (1) nie należących do kraty (α). Zobaczmy jak rozkładają się liczby pierwsze p ∈ P na czynniki nierozkładalne w Z[ √ −2 ]: ZADANIE 10.9 Dowieść, że rozkład (10.30) liczby p ∈ P w Z[ √−2 ] ma postać: (1) 2 = −√ −2 √ −2, (2) p = (x + y√−2)(x − y√ −2) gdy p ≡ 1, 3 (mod 8), (3) p = p, gdy p ≡ 5, 7 (mod 8). R o z w i ą z a n i e. Ponieważ N( √−2) = N(− √−2) = 2, więc elementy ±√−2 są nieroz- kładalne w Z[ √−2 ], zobacz C10.49. Równość p = (x+y√−2)(x−y√ −2) dla p ≡ 1, 3 (mod 8) znamy z T8.6 (zobacz też C10.55). Pozostała nam do wykazania nierozkładalność liczb pierw- szych p ≡ 5, 7 (mod 8) w pierścieniu Z[ √−2 ]. Załóżmy, że taką liczbę pierwszą da się rozłożyć na czynniki w Z[ √−2 ]. Niech p = αβ będzie rozkładem. Wówczas p = α′β′, bo p′ = p, 10.2. Pierścienie kwadratowe 351 a sprzężenie iloczynu równe jest iloczynowi sprzężeń. Stąd p2 = αβ · α′β′ = N(α)N(β) i, jeżeli N(α) ̸= 1, N(β) ̸= 1, to p = N(α) i p = N(β). Jeżeli więc α = a + b√−2, to p = N(α) = a2 + 2b2. Stąd, jak to już wielokrotnie robiliśmy, wnioskujemy, że (−2)Rp, czyli p ≡ 1, 3 (mod 8). Sprzeczność. ♦ Pierścień Eisensteina Przyjrzyjmy się teraz bliżej pierścieniowi Z[τ−3]. Nazywamy go pierścieniem Eisensteina na cześć Eisensteina, który używał go do badania reszt sześciennych. Elementy pierścienia Z[τ−3] zwane też liczbami całkowitymi Eisensteina two- rzą piękną kratę. Na rysunku 10.5 oznaczy- liśmy τ = τ−3, ω = τ 2, λ = τ + 1. Widzimy ”siatkę” rombów, której węzły tworzą ideał główny (λ). Widzimy też romb podstawowy ideału (λ2). Jasne, że krata (λ) jest obrazem kraty (1) wzglę- dem podobieństwa spiralnego będącego zło- żeniem jednokładności o skali √ 3 i obrotu o kąt 30 ◦ . Podobnie, z kraty (λ) powstaje krata (λ 2), z kraty (λ2) powstaje krata (λ3), itd. Łatwo widzieć, że krata (λ 4) po- krywa się z kratą (9). wlt 0 l 2 l 3 l 4 Rys. 10.5 Ćwiczenie 10.68 ”Narysować” ideały główne (τ ), (2 − 3ω) w pierścieniu Eisensteina. Ćwiczenie 10.69 Uzasadnić, że Z[τ−3] = Z[ ω ]. Ćwiczenie 10.70 Korzystając z równości N(x + yτ ) = x2 + xy + y2 udowodnić, że grupa Z[ ω ]∗ jedności pierścienia Eisensteina składa się ze wszystkich pierwiastków szóstego stopnia z jedynki. Zobacz rysunek 10.5. Ćwiczenie 10.71 Udowodnić, że iloczyn liczb całkowitych, z których każda jest postaci x2 + xy + y2 jest również liczbą tej postaci. Napisać odpowiednią tożsamość algebraiczną. Ćwiczenie 10.72 Udowodnić, że λ jest liczbą pierwszą Eisensteina. I że 3 = −ωλ 2 jest rozkładem liczby Eisensteina 3 na czynniki nierozkładalne w pierścieniu Z[ ω ]. Jeżeli α, β i µ są liczbami całkowitymi Eisensteina, to zapis α ≡ β (mod µ) oznacza, że µ|α − β, porównaj D5.1. Tak określona relacja kongruencji modulo µ ma wszystkie własności z twierdzenia T5.1. To znaczy, że jest relacją równoważności zgodną z działaniami dodawania i mnożenia (takiego zwrotu używamy dla powiedzenia, że kongru- encje można dodawać i mnożyć stronami). 352 10. Pierścienie kwadratowe Ćwiczenie 10.73 Uzasadnić to. Wykazać również, że jeżeli µ1 ∼ µ2, to kongruencja α ≡ β (mod µ1) jest równoważna kongruencji α ≡ β (mod µ2). Ćwiczenie 10.74 Udowodnić, że jeżeli α ∈ Z[ ω ], to zachodzi dokładnie jedna z kongruen- cji: α ≡ 0 (mod λ), α ≡ 1 (mod λ) lub α ≡ 2 ≡ −1 (mod λ). Wskazówka. To doskonale widać na rysunku 10.5, gdzie rozpoznajemy romby o wierzchołkach w punktach kraty (λ). Wewnątrz każdego takiego rombu leżą dwa punkty kraty Eisensteina (1) = Z[ ω ]. Na przykład w rombie o wierzchołkach 0, λ, 3, λ leżą punkty 1, 2, a w rombie o wierzchołkach 0, λ, √−3, ω − 1 leżą punkty ω, τ . Widzimy stąd, że jeżeli α ∈ Z[ ω ], to również zachodzi dokładnie jedna z kongruencji α ≡ 0 (mod λ), α ≡ ω (mod λ) lub α ≡ τ (mod λ). Tezę poniższego zadania wykorzystamy w ustępie 11.2.3: ZADANIE 10.10 Udowodnić, że jeżeli α ∈ Z[ ω ] i λ ∤ α, to α3 ≡ ±1 (mod 9). R o z w i ą z a n i e. Ponieważ α ̸≡ 0 (mod λ), więc, na mocy poprzedniego ćwiczenia, α ≡ ω (mod λ) lub α ≡ τ (mod λ). Zapiszmy więc w pierwszym przypadku α = βλ + ω, a w drugim przypadku α = βλ + τ dla pewnego β ∈ Z[ ω ]. W pierwszym przypadku mamy: α3 = (βλ + ω) 3 = λ 3β3 + 3β2λ 2ω + 3βλω2 + ω3. Stąd, ponieważ ω3 = 1, λ 2 = 3τ , a ω2 = −τ , mamy α3 − 1 = 3τ λβ3 + 9β2τ ω − 3βλτ = 3τ λβ(β2 − 1) − 9β2 = 3τ λ [β(β − 1)(β + 1)] − 9β2. Ponieważ (dokładnie) jeden z czynników iloczynu w nawiasie kwadratowym jest podzielny przez λ, a λ 2 = 3τ , więc widać stąd, że 9|α3 − 1. W przypadku gdy α ≡ τ (mod λ) sprawdzamy analogicznie, że α3 − τ 3 = α3 + 1 jest podzielne przez 9. ♦ Zobaczymy jak rozkładają się liczby pierwsze p ∈ P na czynniki nierozkładalne w Z[ ω ]. Ćwiczenie 10.75 Dowieść, że rozkład (10.30) liczby p ∈ P w Z[ ω ] ma postać: (1) 3 = −ωλ 2, (2) p = (x + yω)(x + yω2) gdy p ≡ 1 (mod 3), (3) p = p, gdy p ≡ 2 (mod 3). Pierścień Dedekinda Pierścień Z[τ−5] nazwiemy pierścieniem Dedekinda. Warto się dowiedzieć czegoś na jego te- mat. Jest on bowiem przykładem pierścienia kwadratowego, który n i e j e s t dziedziną ideałów głównych i nie ma w nim jednoznaczności rozkładu elementów na czynniki nierozkładalne. Na rysunkach 10.6 przedstawiamy ilustracje trzech ideałów w pierścieniu Dedekinda. Na rysunku 10.6a widzimy ideał g ł ó w n y I = (2 + √ −5). Elementy tego ideału są iloczynami (2 + √−5)α, gdzie α ∈ Z[τ−5]. To znaczy, że I jest obrazem I = M2+ √5i(Z[τ−5]) kraty Dedekinda względem podobieństwa spiralnego M2+ √5i. Wobec tego ideał I (jako podzbiór płaszczyzny) jest p o d o b n y do (1) = Z[τ−5]. Ogólniej: Jeżeli D < 0, to wszystkie niezerowe ideały główne w pierścieniu Z[τD] są podobne. W pierścieniu Dedekinda istnieją ideały n i e g ł ó w n e, zobacz C10.54. Na rysunkach 10.6b i 10.6c pokazujemy dwa takie ideały: I2 = (2, 1 + √ −5) i I3 = (3, 1 + √−5). 10.2. Pierścienie kwadratowe 353 Ćwiczenie 10.76 Udowodnić, że podobieństwo spiralne Mϕ, gdzie ϕ = (1 + √−5)/2 przeprowadza ideał (kratę) I2 na ideał (kratę) I3. Rys. 10.6a Rys. 10.6b Rys. 10.6c ZADANIE 10.11 Udowodnić, że w pierścieniu Dedekinda istnieją dokładnie dwa kształty ideałów niezerowych. To znaczy, że jeżeli I jest niegłównym ideałem w Z[τ−5], to istnieje taka liczba zespolona ψ, że Mψ(I) = (2, 1 + √ −5). R o z w i ą z a n i e. Niech I będzie niezerowym ideałem w Z[ √−5]. Załóżmy, że ideał I nie jest ideałem głównym. Pamiętając dowód twierdzenia T8.3, wybierzmy niezerowy element α ∈ I najbliższy punktu (liczby) 0. Wówczas wszystkie punkty xα + yτ α, gdzie x, y ∈ Z, kraty Λ = Λ(α, τ α) należą do ideału I. Łatwo sprawdzić, że Λ = (α). Ponieważ założyliśmy, że ideał I nie jest ideałem głównym, więc do I należą elementy ξ n i e należące do Λ. Niech ξ = xα + yτ α ∈ I ∖ Λ będzie dowolnym elementem ideału I n i e na- leżącym do Λ = (α). Wybierzmy takie liczby całkowite k, l, by |x − k| ⩽ 1/2 i |y − l| ⩽ 1/2. Wówczas ζ := kα + lτ α = (k + lτ )α ∈ (α) ⊂ I. Wobec tego β := ξ − ζ = (x − k)α + (y − l)τ α należy do I i leży w prostokącie P = {xα + yτ α : |x| ⩽ 1 2, |y| ⩽ 1 2}. Wierzchołki tego prostokąta ozna- czyliśmy na rysunku 10.7 literą X. Ponieważ α jest najbliższym 0 punk- tem ideału I, więc β leży na zewnątrz b ta 2b Rys. 10.7 ta- a- 0 a X X X X Y Y - ta-( )1 -ta1( ) ta+1 )( - ta1( ) koła D(0, |α|) lub na okręgu tego koła. Wobec tego β leży gdzieś w jednym z dwóch za- cieniowanych trapezików krzywoliniowych w prostokącie P. Pokażemy, że β może być tylko jednym z wierzchołków prostokąta P. Aby to zobaczyć rozważmy element 2β ∈ I. Widać 354 10. Pierścienie kwadratowe gołym okiem, że jego odległość od pewnego punktu γ ideału (α) jest mniejsza(!) niż |α|. Wtedy γ − 2β ∈ I i |γ − 2β| < |α|, co, wobec wyboru α, jest możliwe tylko gdy γ − 2β = 0. Więc β jest albo jednym z wierzchołków X, albo jednym ze środków Y = ±τ α/2. Gdyby jednakże β = τ α/2, to τ β + 3α = α/2 byłby elementem ideału I bliższym 0 niż α. Po- dobnie sprawdzamy, że β ̸= −τ α/2. Wobec tego β jest jednym z wierzchołków X. Jasne, że wówczas pozostałe wierzchołki X również należą do I (jeżeli β jest ”górnym” wierzchołkiem na rysunku, to pozostałymi wierzchołkami są β − α, β − τ α i β − α − τ α). Widzimy więc, że ideał niegłówny I jest sumą teoriomnogościową ideału głównego (α) ge- nerowanego przez element najbliższy 0 i zbioru środków wszystkich prostokątów o wierzchoł- kach ϕα, ϕα + α, ϕα + τ α, ϕα + α + τ α, gdzie ϕ jest elementem pierścienia Dedekinda. Łatwo się przekonać, że wobec tego jest on podobny do I2 z rysunku 10.6b, na którym widzimy sumę teoriomnogościową ideału głównego (2) i zbioru środków wyznaczonych przez niego prostoką- tów. [Na rysunku 10.6c również możemy dostrzec sumę teoriomnogościową ideału głównego (1 + √−5) i zbioru środków odpowiednich prostokątów.] ♦ Fakt, że w pierścieniu Dedekinda istnieją ideały niegłówne jest oczywiście ściśle związany z faktem, że pierścień ten n i e j e s t dziedziną z jednoznacznością rozkładu: Ćwiczenie 10.77 Uzasadnić, że element 6 pierścienia Z[τ−5] ma dwa istotnie różne roz- kłady na iloczyn elementów nierozkładalnych: 6 = 2·3 = (1+√ −5)(1−√ −5). Znaleźć jeszcze inne przykłady niejednoznaczności rozkładu w pierścieniu Z[τ−5]. U w a g a. Niezerowy ideał I w urojonym pierścieniu kwadratowym jest kratą w płasz- czyźnie. Z dowodu twierdzenia T8.3 wiemy, że ta krata jest postaci Λ(α, β), gdzie α jest najbliższym od 0 elementem ideału I, a β jest najbliższym od 0 elementem ideału I, który nie leży na prostej l0α. Takie dwa elementy α, β wyznaczają formę kwadratową f (X, Y ) = (αX + βY )(α′X + β′Y ) = N(α)X 2 + (αβ′ + βα′)XY + N(β)Y 2. (10.35) Ćwiczenie 10.78 Napisać formy kwadratowe wyznaczone przez ideały pokazane na rysun- kach 10.6. Porównać otrzymane wyniki z wierszem ∆ = −20 w tabelce z ustępu 8.4.4. Ćwiczenie 10.79 Wskazać trzy parami niepodobne ideały w pierścieniu Z[τ−23]. 10.3 Teoria podzielności w dig’ach W tym paragraﬁe, który ma charakter pewnego podsumowania i jednocześnie wstępu do teorii pierścieni, opiszemy krótko teorię podzielności w dziedzinach ideałów głównych. Okaże się, że jeżeli dany pierścień R jest dig’iem, to w pierścieniu tym zachodzi twierdzenie o istnieniu i jednoznaczności rozkładu na czynniki nierozkładalne. 10.3.1 Dziedziny całkowitości Zaczniemy od ogólnych uwag na temat pierścieni, w których nie ma dzielników zera. Deﬁnicja 10.19 Pierścień R nazywa się dziedziną całkowitości, gdy nie ma w nim dzielników zera, co oznacza, że jeżeli α, β ∈ R oraz αβ = 0, to α = 0 lub β = 0. 10.3. Teoria podzielności w dig’ach 355 P r z y k ł a d. Pierścień Z liczb całkowitych jest dziedziną całkowitości. Dziedzinami cał- kowitości są wszystkie ciała, zobacz C1.19. Również pierścienie K[X] wielomianów jednej zmiennej o współczynnikach w ciele są dziedzinami całkowitości, zobacz C3.32. Pierścień Z/m klas reszt liczb całkowitych modulo m jest dziedziną całkowitości wtedy i tylko wtedy, gdy jest ciałem, czyli wtedy i tylko wtedy, gdy m jest liczbą pierwszą, zob. T5.11 i C1.20. ♦ Ćwiczenie 10.80 Udowodnić, że w dowolnych dziedzinach całkowitości prawdziwe jest prawo skracania: Jeżeli dla α, β, γ ∈ R zachodzi równość αβ = αγ i α ̸= 0, to β = γ. Ćwiczenie 10.81 Udowodnić, że jeżeli R jest dziedziną całkowitości, to pierścień R[X] wielomianów jednej zmiennej o współczynnikach w R jest dziedziną całkowitości. Wywnio- skować stąd, że pierścień wielomianów n zmiennych o współczynnikach w ciele jest dziedziną całkowitości. Ćwiczenie 10.82 Udowodnić uogólnienie twierdzenia T3.4: Jeżeli f (X) ∈ R[X] jest wielomianem stopnia n ⩾ 1 o współczynnikach w dziedzinie całkowitości R, to w R istnieje co najwyżej n pierwiastków wielomianu f (X). 10.3.2 Relacja podzielności. Relacja stowarzyszenia W dalszym ciągu R oznaczać będzie dowolną dziedzinę całkowitości. Przypomnijmy, że przez R ∗ oznaczamy zbiór (grupę!) jedności, czyli elementów odwracalnych pierścienia R. Deﬁnicja 10.20 Jeżeli α, β ∈ R, to mówimy, że α dzieli β, gdy istnieje takie γ ∈ R, że β = α · γ. Piszemy wtedy α|β. Mówimy też w takiej sytuacji, że α jest dzielnikiem β, lub że β jest wielokrotnością α. Jeżeli α ∈ R, to zbiór (α) := {αϕ : ϕ ∈ R} wszystkich wielokrotności elementu α nazywamy ideałem głównym generowanym przez α. ZADANIE 10.12 Sformułować i udowodnić analogony tez (1), (2), (3), (4) z T2.1 w przypadku dowolnych dziedzin całkowitości. R o z w i ą z a n i e. Pewnego komentarza wymaga tylko teza (3), której prawidłowe sformu- łowanie jest następujące: (3a) jeżeli α|β i β|α, to istnieje taka jedność (= element odwracalny) ε, że α = εβ. Dowód jest prosty: Niech β = αγ i α = βδ dla pewnych γ, δ ∈ R. Wówczas β · 1 = β = αγ = (βδ)γ = β(δγ). Jeżeli β ̸= 0, to, dzięki prawu skracania, zobacz C10.80, 1 = δγ, więc δ ∈ R ∗ i wystarczy położyć ε = δ. Jeżeli zaś β = 0, to α = βγ = 0 · γ = 0, zobacz Z1.6(1), więc α = 1 · β. ♦ Ćwiczenie 10.83 Udowodnić, że jeżeli α, β ∈ R, a ε, η ∈ R ∗, to α|β wtedy i tylko wtedy, gdy εα|ηβ. Z ćwiczenia C10.83 widzimy, że jedności pierścienia R są, z punktu widzenia podzielności, ”bytami nieistotnymi”. Wobec tego przyjmujemy: 356 10. Pierścienie kwadratowe Deﬁnicja 10.21 Niech R będzie dziedziną całkowitości. Elementy α, β ∈ R nazywamy stowarzyszonymi, gdy istnieje taka jedność ε ∈ R ∗, że α = εβ. Zapisujemy to tak: α ∼ β. Ćwiczenie 10.84 Uzasadnić, że relacja stowarzyszenia ∼ jest relacją równoważności, to znaczy, zobacz KOM , że (1) α ∼ α; (2) α ∼ β ⇒ β ∼ α; (3) α ∼ β, β ∼ γ ⇒ α ∼ γ. Ćwiczenie 10.85 Udowodnić, że α jest jednością wtedy i tylko wtedy, gdy α ∼ 1. Ćwiczenie 10.86 Uzasadnić, że jeżeli α, β ∈ R, to α|β ⇐⇒ (β) ⊆ (α). Wywnioskować stąd, że (α) = (β) ⇔ α ∼ β. 10.3.3 Ideał. Dziedzina ideałów głównych Deﬁnicja ideału w dowolnym pierścieniu naśladuje odpowiednie deﬁnicje w przypadku pierścieni Z, zobacz D2.2, i K[X], zobacz D3.8. Deﬁnicja 10.22 Niepusty podzbiór I ⊆ R nazywamy ideałem w pierścieniu R, gdy (1) jeżeli α, β ∈ I, to α ± β ∈ I, (2) jeżeli ϕ ∈ R i α ∈ I, to ϕα ∈ I. Ćwiczenie 10.87 Udowodnić, że każdy ideał główny w R jest ideałem. Ćwiczenie 10.88 Udowodnić, że pierścień R jest ciałem wtedy i tylko wtedy, gdy zawiera t y l k o dwa ideały, ideał zerowy {0} = (0) i ideał (1) = R. Deﬁnicja 10.23 Nie będąca ciałem dziedzina całkowitości R nazywa się dziedziną ide- ałów głównych (w skrócie dig), gdy każdy ideał w R jest ideałem głównym. P r z y k ł a d. Znamy już nieskończenie wiele dig’ów. Obok pierścienia Z liczb całkowitych, patrz T2.3, i pierścieni Q[X], R[X] i C[X] wielomianów jednej zmiennej o współczynnikach wymiernych, rzeczywistych i zespolonych odpowiednio, są to pierścienie Fp[X] wielomianów o współczynnikach w ciele Fp = Z/p dla każdej liczby pierwszej p, zobacz T3.10. Jeszcze jedną serię dig’ów otrzymujemy biorąc pierścienie wielomianów Fp2[X] o współczynnikach w ciałach Fp2 = Fp(ι), zobacz T9.3. Każdy z 21 pierścieni kwadratowych będących pierścieniami normowo-euklidesowymi jest dig’iem, zobacz T10.9. ♦ Ćwiczenie 10.89 Dowieść, że pierścień Z[X] wielomianów jednej zmiennej o współczyn- nikach całkowitych n i e jest dig’iem. Wskazówka. Zbiór wszystkich wielomianów o współczyn- nikach całkowitych i parzystym wyrazie wolnym j e s t ideałem w Z[X]. 10.3. Teoria podzielności w dig’ach 357 10.3.4 Największy wspólny dzielnik Deﬁnicja największego wspólnego dzielnika elementów danej d z i e d z i n y c a ł k o w i t o ś c i na- śladuje znane nam już deﬁnicje NWD w pierścieniu Z liczb całkowitych czy w pierścieniach K[X] wielomianów jednej zmiennej o współczynnikach z ciała K. Deﬁnicja 10.24 Niech R będzie dziedziną całkowitości. Niech dane będą dwa, nie równe jednocześnie zero, elementy α, β ∈ R. Element δ ∈ R nazywamy największym wspólnym dzielnikiem pary α, β, gdy spełnione są poniższe warunki: (1) δ|α i δ|β, (2) jeżeli γ|α i γ|β, to γ|δ. Piszemy wtedy δ ∼ NWD (α, β) lub, po prostu, NWD (α, β) = δ. O elementach α, β mówimy, że są względnie pierwsze, gdy 1 ∼ NWD (α, β). Ćwiczenie 10.90 Udowodnić, że jeżeli istnieje największy wspólny dzielnik danych elementów w R, to jest on wyznaczony jednoznacznie z dokładnością do stowarzyszenia. Musimy tu w y r a ź n i e zaznaczyć, że największy wspólny dzielnik zazwyczaj n i e istnieje. Zachodzi jednakże ważne uogólnienie twierdzenia T2.4, porównaj też T3.11 i T10.11: TWIERDZENIE 10.14 Jeżeli pierścień R jest dziedziną ideałów głównych, to każda para niezerowych elementów w R m a największy wspólny dzielnik. Ponadto, największy wspólny dzielnik pary α, β ∈ R można zapisać w postaci αϕ + βψ dla pewnych elementów ϕ, ψ ∈ R. D O W Ó D. Weźmy dwa niezerowe elementy α, β ∈ R i rozważmy ideał (α, β) := {αϕ + βψ : ϕ, ψ ∈ R} pierścienia R. Ponieważ jest on (jak każdy ideał w R) ideałem głównym, więc istnieje taki element δ ∈ R, że (α, β) = (δ). Twierdzimy, że δ ∼ NWD (α, β). Sprawdzamy, że spełniony jest warunek (1) deﬁnicji D10.24. Zauważmy w tym celu, że α = α · 1 + β · 0 ∈ (α, β), więc α ∈ (δ), czyli α = δ · ϕ i ostatecznie δ|α. Podobnie sprawdzamy, że δ|β. Z drugiej strony δ = δ · 1 ∈ (δ), więc δ = αϕ0 + βψ0 dla pewnych ϕ0, ψ0 ∈ A. Stąd, jeżeli γ|α i γ|β, to δ = αϕ0 + βψ0 = (γρ)ϕ0 + (γτ )ψ0 = γ(ρϕ0 + τ ψ0), czyli γ|δ, więc i warunek (2) deﬁnicji D10.24 jest spełniony. □ 10.3.5 Elementy nierozkładalne i pierwsze w R Liczba pierwsza jest (dodatnim) nierozkładalnym elementem pierścienia Z: każdy jej rozkład na czynniki jest trywialny w tym sensie, że wszystkie czynniki tego rozkładu z wyjątkiem jednego są odwracalne. Wygodnie jest przyjąć ogólną deﬁnicję: Deﬁnicja 10.25 Niech R będzie daną dziedziną całkowitości. Element ν ∈ R nie będący zerem ani jednością nazywa się elementem nierozkładalnym w R, gdy spełnia warunek: jeżeli ν = αβ, to α ∈ R ∗ lub β ∈ R ∗. (10.36) 358 10. Pierścienie kwadratowe To oznacza, że elementy nierozkładalne mają ”mało” dzielników: każdy dzielnik elementu nie- rozkładalnego ν jest albo jednością albo jest stowarzyszony z ν. Liczba pierwsza ma bardzo w a ż n ą własność: jeżeli dzieli iloczyn, to dzieli jeden z czyn- ników tego iloczynu (zobacz T2.15). Tę własność przyjmuje się za własność charakteryzującą elementy pierwsze: Deﬁnicja 10.26 Niech R będzie daną dziedziną całkowitości. Element π ∈ R nie będący ani zerem ani jednością nazywa się elementem pierwszym w R, gdy ma własność: jeżeli π|αβ, to π|α lub π|β. (10.37) Ćwiczenie 10.91 Udowodnić, że jeżeli element pierwszy jest dzielnikiem innego elementu pierwszego, to elementy te są stowarzyszone. Czyli: jeżeli π1|π2, to π1 ∼ π2. W d o w o l n e j dziedzinie całkowitości zachodzi: TWIERDZENIE 10.15 Element pierwszy (w danej dziedzinie całkowitości) jest elementem nierozkładalnym. D O W Ó D. Załóżmy, że element pierwszy π jest iloczynem: π = αβ. Wówczas (zamie- niając ewentualnie α i β) możemy założyć, że π|α, czyli że α = πγ dla pewnego γ ∈ R. Stąd mamy π(1 − γβ) = 0, zatem, ponieważ π ̸= 0, mamy 1 = γβ, czyli β ∈ R ∗. □ Elementy nierozkładalne zazwyczaj n i e są elementami pierwszymi, zob. 10.2.5 P. Jednakże: TWIERDZENIE 10.16 Jeżeli pierścień R jest dig’iem, to w tym pierścieniu każdy element nierozkładalny jest elementem pierwszym. D O W Ó D. Niech ν ∈ R będzie elementem nierozkładalnym w pierścieniu R. Niech ν|αβ i niech ν ∤ α. Wiemy, że w R każda para elementów ma największy wspólny dzielnik, zobacz T10.14. Niech więc δ = NWD (ν, α). Ponieważ δ, jako dzielnik elementu nierozkładalnego ν, spełnia δ ∼ ν lub δ ∼ 1, a nie może być stowarzyszony z ν (bo wtedy ν|α!), więc δ ∼ 1. Stąd, na mocy T10.14, zachodzi równość 1 = νϕ + αψ dla pewnych elementów ϕ, ψ. Mnożąc tę równość obustronnie przez β znajdujemy podzielność ν|β. To kończy dowód. □ 10.3.6 Jednoznaczność rozkładu w dig’ach W tym ustępie pokażemy jak z dig’owości pierścienia wynika, że jest on dziedziną z jedno- znacznością rozkładu na czynniki nierozkładalne. W dotychczasowych dowodach twierdzeń o jednoznaczności rozkładu, zob. T2.16, T3.14, T10.4 i T10.13, ważną rolę grała Zasada Minimum. Można ją było zastosować, bo w badanych tam pierścieniach mieliśmy metodę porównywania ”wielkości” elementów. W pierścieniu Z porównywaliśmy elementy za pomocą wartości bezwzględnej |n|, w pierścieniach K[X] za pomocą stopnia wielomianu, a w pierścieniach kwadratowych za pomocą modułu normy |N(α)|. W przypadku ogólnego dig’u substytutem Zasady Minimum jest poniższy lemat: 10.3. Teoria podzielności w dig’ach 359 LEMAT 10.2 Jeżeli R jest dziedziną ideałów głównych, a I1 ⊂ I2 ⊂ I3 ⊂ . . . (10.38) jest dowolnym ciągiem ideałów w pierścieniu R, przy czym inkluzje są ścisłe, to ciąg ten jest skończony. D O W Ó D. Oznaczmy przez I sumę teoriomnogościową ⋃ Ik. Łatwo sprawdzić, że I jest ideałem w R. Jeżeli bowiem α, β ∈ I, to α ∈ Ij i β ∈ Ik dla pewnych j, k. Wtedy oba elementy α, β należą do Imax(j, k), więc α ± β ∈ Imax(j, k) ⊆ I. Jeszcze łatwiej sprawdzamy zachodzenie warunku (2) z deﬁnicji D10.24. Skoro I jest ideałem, a każdy ideał w R jest główny, więc istnieje takie α ∈ R, że I = (α). Wtedy α ∈ I, czyli α ∈ Ik dla pewnego k. Wówczas I = (α) ⊆ Ik ⊆ I. Zatem ciąg (10.38) kończy się na wyrazie Ik. □ Pierścień, w którym każdy wstępujący łańcuch ideałów (taki jak (10.38)) jest skończony, nazywa się pierścieniem noetherowskim (od nazwiska Emmy N¨other). Jak widać z powyż- szego lematu wszystkie dig’i są pierścieniami noetherowskimi. Noetherowskość pierścienia jest tą jego własnością, która pozwala do pewnego stopnia zastąpić Zasadę Minimum. Oto jak to się robi w dowodzie analogonu twierdzenia T2.14: TWIERDZENIE 10.17 Jeżeli R jest dig’iem i α ∈ R ∖ (R ∗ ∪ {0}), to istnieje element nierozkładalny dzielący α. D O W Ó D. Jeżeli α jest nierozkładalny, to α|α i koniec. Jeżeli nie, to niech α = α1β, gdzie α1, β ̸∈ R ∗. Wówczas, na mocy C10.86, (α) ⊆ (α1). Łatwo zobaczyć, że ta inkluzja jest ścisła. Gdyby bowiem (α) = (α1), to, znowu na mocy C10.86, α ∼ α1, więc α1β = α = α1ε dla pewnej jedności ε. Stąd, na mocy prawa skracania, zobacz C10.80, β = ε, co jest niemożliwe. Mamy więc ścisłą inkluzję (α) ⊂ (α1) między ideałami w R. Jeżeli teraz α1 jest elementem nierozkładalnym, to α1|α i koniec. Jeżeli zaś α1 nie jest elementem nierozkładalnym, to możemy postąpić z nim tak samo jak przed chwilą postąpiliśmy z α. Wówczas znajdziemy kolejną ścisłą inkluzję (α1) ⊂ (α2). Postępując tak dalej znajdziemy ciąg ścisłych inkluzji (α) ⊂ (α1) ⊂ (α2) ⊂ . . . ⊂ (αk), którego, wobec L10.2, już n i e da się przedłużyć. W ten sposób znajdzie się element nieroz- kładalny αk będący, patrz C10.86, dzielnikiem α. □ Jeszcze raz zobaczymy jak ”działa” noetherowskość w dowodzie istnienia rozkładu na iloczyn elementów nierozkładalnych: TWIERDZENIE 10.18 Dziedzina ideałów głównych jest pierścieniem, w którym każdy niezerowy i nie będący jednością element da się jednoznacznie (z dokładnością do porządku czynników i relacji stowarzyszenia) rozłożyć na iloczyn elementów nierozkładalnych. D O W Ó D. Zaczynamy od dowodu i s t n i e n i a. Bierzemy α ∈ R ∖ (R ∗ ∪ {0}). Twier- dzimy, że istnieją takie elementy nierozkładalne ν1, ν2, . . . , νs w R, że zachodzi równość α = ν1ν2 · . . . · νs. (10.39) 360 10. Pierścienie kwadratowe Aby to uzasadnić znajdujemy nierozkładalny dzielnik ν1 elementu α. Taki istnieje na mocy T10.17. Zapisujemy α = ν1α1 i szukamy nierozkładalnego dzielnika elementu α1. To się uda jeżeli α1 nie jest odwracalny. Jeżeli ν2|α1, czyli α1 = ν2α2, to szukamy nierozkładalnego dzielnika elementu α2. I tak dalej. Podobnie jak w poprzednim dowodzie dostaniemy w ten sposób ciąg ścisłych inkluzji (α) ⊂ (α2) ⊂ (α3) ⊂ . . . ⊂ (αs), którego nie da się przedłużyć. W świetle powiedzianego wyżej, niemożność dalszego przedłu- żania tego ciągu oznacza, że αs jest jednością (i wtedy (αs) = (1) = R). To kończy dowód istnienia rozkładu (10.39). Dowód j e d n o z n a c z n o ś c i można poprowadzić za pomocą Zasady Minimum. Załóżmy n i e w p r o s t, że istnieją takie złe elementy w R ∖ (R ∗ ∪ {0}), które mają dwa różne rozkłady. Niech α będzie takim złym elementem, który oprócz rozkładu (10.39) ma jeszcze rozkład α = µ1µ2 · . . . · µt na iloczyn elementów nierozkładalnych, przy czym tak, że rozkłady te są ”sumarycznie” naj- krótsze, czyli z najmniejszym s + t. Po ewentualnym przenumerowaniu, możemy założyć, że ν1|µ1, bo ν1 jest elementem pierwszym, zobacz T10.16. Wobec tego ν1 ∼ µ1, zobacz C10.91, i możemy ”skrócić” przez ν1, zobacz C10.80. Dostaniemy wtedy równość ν2·. . .·νs = (εµ2)·. . .·µt o mniejszej sumarycznej długości. Sprzeczność. □ U w a g a. Zwróćmy uwagę, że dla istnienia rozkładu ważna jest n o e t h e r o w s k o ś ć pier- ścienia, a dla jednoznaczności rozkładu ważna jest pierwszość elementów nierozkładalnych. 10.4 Jedności rzeczywiste Wiemy, że grupa jedności (= elementów odwracalnych) w urojonych pierścieniach kwadrato- wych jest grupą dwuelementową {−1, +1}, z wyjątkiem przypadków D = −1, −3, zobacz C10.35. Zajmiemy się więc jednościami w rzeczywistych pierścieniach kwadratowych. 10.4.1 Lemat o równaniu x2 − Dy2 = 1 Dla opisania grupy elementów odwracalnych w rzeczywistych pierścieniach kwadratowych wy- korzystamy lemat dotyczący rozwiązań w liczbach rzeczywistych równania x2 − Dy2 = 1, (10.40) gdzie D jest daną liczbą rzeczywistą dodatnią. W dalszym ciągu √D oznacza pierwiastek arytmetyczny (dodatni). LEMAT 10.3 Jeżeli pary (u1, v1), (u2, v2) ∈ R × R są takimi rozwiązaniami równania (10.40), że zachodzą nierówności 1 ⩽ u1 + v1√D < u2 + v2√D, (10.41) to 0 < u1 < u2. 10.4. Jedności rzeczywiste 361 D O W Ó D. Fakt, że (u1, v1) i (u2, v2) są rozwiązaniami równania (10.40) daje równości u1 − v1√D = 1 u1 + v1√D , u2 − v2√D = 1 u2 + v2√D . Nierówności (10.41) dają więc 0 < u2 − v2√ D < u1 − v1√D ⩽ 1. (10.42) Lewa nierówność (10.41) i prawa nierówność (10.42) dają u1−v1√D ⩽ u1+v1√D, skąd v1 ⩾ 0. Podobnie, u2 − v2√D < 1 < u2 + v2√D daje nierówność v2 > 0. Wobec tego, nierówności 0 < u2 − v2√D < u1 − v1√D dają u2 > 0 i u1 > 0. Dodając teraz środkową z nierówności (10.42) do prawej nierówności (10.41) dostajemy u1 + u2 + (v1 − v2) √D < u2 + u1 + (v2 − v1) √D, skąd 2(v2 − v1)√ D > 0, czyli v2 − v1 > 0. Wreszcie, równość u 2 2 − Dv2 2 = u 2 1 − Dv2 1, czyli u 2 2 − u 2 1 = D(v2 2 − v2 1) daje, wobec poprzednio udowodnionych nierówności, tezę: 0 < u1 < u2. □ 10.4.2 Jedności fundamentalne W każdym rzeczywistym pierścieniu kwadratowym istnieje n i e s k o ń c z e n i e wiele jedności, a wśród nich jedna wyróżniona jedność, zwana jednością fundamentalną, czyli taka, która w sposób opisany w poniższym twierdzeniu generuje wszystkie pozostałe. Będziemy zapisywać elementy pierścienia Z[τD] w postaci a + b√D 2 , (10.43) gdzie a, b ∈ Z oraz a ≡ b (mod 2). Ćwiczenie 10.92 Udowodnić, że zapis (10.43) elementu pierścienia Z[τD] istnieje i jest jednoznaczny. TWIERDZENIE 10.19 W rzeczywistym pierścieniu kwadratowym Z[τD] istnieje taka jed- ność η, że każda jedność w tym pierścieniu jest postaci ±ηn, gdzie n ∈ Z. D O W Ó D. Z twierdzenia T10.7 wiemy, że ε ∈ Z[τD] jest jednością wtedy i tylko wtedy, gdy |N(ε)| = 1. Zatem jedności mogą mieć normę równą 1 lub −1. Zajmiemy się najpierw jednościami o n o r m i e 1. Dwie takie jedności istnieją w każdym pierścieniu kwadratowym. Są to 1 i −1. Będziemy je nazywali jednościami trywialnymi. Aby wykazać, że istnieją, poza trywialnymi, jeszcze jakieś inne jedności, powołamy się na WT7.13. Wybierając dowolne parzyste k ⩾ 2 w równości (7.30) widzimy, że istnieje nieskończenie wiele rozwiązań równania (10.40) w liczbach naturalnych. Każde takie rozwiązanie (a, b) wyznacza element ε = a + b√D ∈ Z[τD] będący nietrywialną jednością. Wówczas jedna (i tylko jedna) z czterech jedności ε, 1/ε, −ε, −1/ε jest liczbą większą od 1. Wobec tego, i s t n i e j ą j e d n o ś c i w i ę k s z e o d 1. Uzasadnimy teraz, że każdy ściśle malejący ciąg jedności ε1 > ε2 > ε3 > . . . > 1 (10.44) 362 10. Pierścienie kwadratowe jest skończony. To jest prostym wnioskiem z L10.3. Istotnie, niech εk = ak + bk√D 2 , gdzie ak, bk ∈ Z, ak ≡ bk (mod 2). Wówczas nierówności (10.44), na mocy L10.3, dają nierów- ności a1 2 > a2 2 > a3 2 > . . . > 0, co, wobec zasady minimum, oznacza skończoność ciągu. Wynika stąd, że istnieje dokładnie jedna najmniejsza, większa od 1, jedność w Z[τD]. Oznaczmy ją σ. Weźmy teraz d o w o l n ą jedność ε > 1 o normie 1. Wówczas, wobec tego, że ciąg (σn) jest ciągiem rosnącym do nieskończoności, mamy σk ⩽ ε < σk+1 dla pewnego k ∈ N. Mnożąc te nierówności przez liczbę dodatnią σ−k otrzymamy nierówności równoważne 1 ⩽ εσ−k < σ. Stąd, wobec minimalności σ, mamy 1 = εσ−k, czyli ε = σk, k ∈ N. (10.45) Widzimy więc, że każda większa niż 1 jedność o normie 1 jest równa σk dla pewnego k ∈ N. Jeżeli teraz jedność ε o normie 1 spełnia nierówność 0 < ε < 1, to 1/ε jest jednością (o normie 1) większą od 1. Zatem 1/ε = σk przy pewnym k ∈ N. Stąd ε = σ−k, k ∈ N. (10.46) Z równości (10.45) i (10.46) widzimy, że wszystkie d o d a t n i e jedności ε o normie 1 są postaci σk, k ∈ Z. Jeżeli wreszcie ε jest jednością ujemną o normie 1, to −ε jest dodatnia i, wobec powyższego, jest postaci −ε = σk. Ostatecznie więc, wszystkie jedności o normie 1 są postaci ±σk, k ∈ Z. Załóżmy teraz, że w Z[τD] i s t n i e j ą jedności o normie równej −1. Niech ε będzie pewną jednością o normie −1. Wówczas jedność ε2 ma normę 1, jest więc postaci ±σk. Ponieważ ε2 jako kwadrat liczby rzeczywistej jest liczbą dodatnią, więc mamy ε2 = σk. Twierdzimy, że k nie jest liczbą parzystą. Gdyby k = 2l, to mielibyśmy ε = ±σl i ε miałaby normę 1. Zatem k = 2l + 1. Połóżmy γ = εσ−l. Jedność γ ma normę −1. Ponadto γ2 = σ. Niech teraz ε będzie dowolną jednością w Z[τD]. Jeżeli N(ε) = 1, to ε = ±σk = ±γ2k. Jeżeli zaś N(ε) = −1, to εγ jest jednością o normie +1, więc εγ = ±σk = ±γ2k, skąd ε = ±γ2k−1. Widzimy więc, że jeżeli wszystkie jedności w Z[τD] mają normy równe 1, to każda z nich jest postaci ±σk, k ∈ Z. Jeżeli zaś w Z[τD] istnieją jedności o normie −1, to każda jedność jest postaci ±γk, k ∈ Z. Aby zakończyć dowód wystarczy więc położyć η = σ w pierwszym przypadku i η = γ w drugim. □ Jedność, której istnienie właśnie wykazaliśmy, nazywamy jednością fundamentalną (rze- czywistego) pierścienia kwadratowego Z[τD]. P r z y k ł a d 1. Najczęściej ”używaną” jednością (poza jednościami ±1) jest jedność 1+√2 pierścienia kwadratowego Z[τ2]. Jest ona jednością fundamentalną tego pierścienia. 10.4. Jedności rzeczywiste 363 P r z y k ł a d 2. Przytoczona niżej tabelka podaje parę dalszych przykładów. Podajemy w niej, dla bezkwadratowych 2 ⩽ D ⩽ 41, jedności fundamentalne w pierścieniach Z[τD]. Pokazujemy też typ odpowiedniego pierścienia kwadratowego. ♦ Jedności fundamentalne i typ Z[τD] dla 2 ⩽ D ⩽ 41 D Jedność fundamentalna η N(η) D Jedność fundamentalna η N(η) 2 1 + √2 −1 22 197 + 42√22 +1 3 2 + √3 +1 23 24 + 5√23 +1 5 1 2 + 1 2 √ 5 −1 26 5 + √26 −1 6 5 + 2√6 +1 29 5 2 + 1 2 √29 −1 7 8 + 3√7 +1 30 11 + 2√30 +1 10 3 + √10 −1 31 1520 + 273√31 +1 11 10 + 3√11 +1 33 23 + 4√33 +1 13 3 2 + 1 2 √13 −1 34 35 + 6√34 +1 14 15 + 4√14 +1 35 6 + √35 +1 15 4 + √15 +1 37 6 + √37 −1 17 4 + √17 −1 38 37 + 6√38 +1 19 170 + 39√19 +1 39 25 + 4√39 +1 21 5 2 + 1 2 √21 +1 41 32 + 5√41 −1 P r z y k ł a d 3. Pokażemy zastosowanie faktu istnienia jedności fundamentalnej w pierście- niu Z[τ5]. W ćwiczeniu C3.17 proponowaliśmy wyznaczenie ”dużych” rozwiązań równania x2 + y2 + 1 = 3xy (10.47) w liczbach naturalnych. Teraz chcemy wyznaczyć w s z y s t k i e rozwiązania tego równania w liczbach całkowitych. Zapiszmy to równanie w postaci równoważnej: (2x − 3y)2 − 5y2 = −4. Równość tę zapisujemy w postaci normowej: N ( 2x − 3y 2 + y 2 √5 ) = −1. Szukamy więc wszystkich jedności o normie −1 w pierścieniu Z[τ5]. Ponieważ η = 1 2 + 1 2√5 jest tam jednością fundamentalną, więc widzimy, że para (x, y) jest rozwiązaniem (10.47) wtedy i tylko wtedy, gdy 2x − 3y 2 + y 2 √5 = ± ( 1 2 + 1 2 √ 5 )2k+1 , przy pewnym k ∈ Z. Lub, równoważnie, 2x − 3y + y√ 5 = ±(3 + √5) k(1 + √5) 2k . Czytelnik, który odczuwa niedosyt z takiej postaci odpowiedzi proszony jest o jej poprawienie. W przypadku nie dających się przezwyciężyć trudności, niech czeka do ustępu poświęconego równaniu indyjskiemu. ♦ 364 10. Pierścienie kwadratowe 10.4.3 Pierścienie typu (−1) i (+1) Rozstrzygnięcie czy w danym pierścieniu kwadratowym rzeczywistym istnieją jedności o normie −1 nie jest łatwe. Powiemy teraz dwa słowa na ten temat. Rozróżnimy dwie kategorie rzeczywistych pierścieni kwadratowych: pierścienie typu (−1), w których istnieją jedności o normie równej −1 i pierścienie typu (+1), w których wszystkie jedności mają normę równą 1. P r z y k ł a d 1. Najczęściej używaną jednością w zadaniach OM jest jedność 1 + √2 pier- ścienia Z[τ2]. Jej norma N(1 + √ 2) = −1. Pierścień Z[τ2] jest więc typu (−1). Ogólniej, jeżeli D = n2 + 1 dla n ∈ N, to pierścień Z[τD] jest pierścieniem typu (−1). Równość n2 − D · 1 2 = −1 pokazuje bowiem, że n + √n2 + 1 jest jednością o normie −1 w pierścieniu Z[τn2+1]. ♦ P r z y k ł a d 2. Pierścień Z[τ3] jest pierścieniem typu (+1). Rzeczywiście, gdyby element a+b√ 3 miał normę −1, to a2 −3b2 = −1 co, po zredukowaniu modulo 3, dałoby kongruencję fałszywą a2 ≡ −1 (mod 3). ♦ Ćwiczenie 10.93 Udowodnić, że jeżeli istnieje taka liczba pierwsza p ≡ 3 (mod 4), że p|D, to pierścień Z[τD] jest pierścieniem typu (+1). (D jest bezkwadratowa!). ZADANIE 10.13 Udowodnić, że jeżeli p ≡ 1 (mod 4) jest liczbą pierwszą, to istnieją takie liczby naturalne u, w, że u2 − pw2 = −1. R o z w i ą z a n i e. Niech x2 − py2 = 1 i niech x > 1 będzie najmniejsze możliwe. Wówczas 1 ≡ x2 − py2 ≡ x2 − y2 (mod 4). Stąd, wobec znanych kongruencji x2, y2 ≡ 0, 1 (mod 4), widzimy, że x ≡ 1 (mod 2) i y ≡ 0 (mod 2). Niech y = 2z. Wtedy x − 1 2 · x + 1 2 = pz2. (10.48) Ponieważ liczby (naturalne) (x − 1)/2, (x + 1)/2 różnią się o 1, więc są względnie pierwsze. Ponieważ liczba pierwsza p dzieli ich iloczyn, więc dzieli jedną z nich. Pokażemy, że p n i e dzieli czynnika (x−1)/2. Gdyby tak było, to mielibyśmy równość (x−1)/2p·(x+1)/2 = z2, która, na mocy triku T2.19, pozwalałaby napisać (x−1)/2p = b2, (x+1)/2 = a2 dla pewnych naturalnych a, b. Stąd dostalibyśmy równość a2 − pb2 = (x + 1)/2 − (x − 1)/2 = 1. Czyli rozwiązanie (a, b) równania x2 − py2 = 1 z mniejszym x. Wobec tego p dzieli czynnik drugi z lewej strony równości (10.48). Możemy więc zastosować trik do równości (x − 1)/2 · (x + 1)/2p = z2. Dostaniemy (x − 1)/2 = u2, (x + 1)/2p = w2 dla pewnych naturalnych u, w. Wówczas pw2 − u 2 = 1, więc u 2 − pw2 = −1. ♦ Ćwiczenie 10.94 Udowodnić, że Z[τ34] jest pierścieniem typu (+1). Rozdział 11 Równania diofantyczne Diophante (∆ι´oϕαντ oς) a sˆu manier tellement les inconnues ou l’innconue, que le quarr´e et les plus hautes puissances de cette inconnue disparaissent de l’´equation, et qu’il ne reste que l’innconue au premier degr´e. (J. le Rond D’Alembert) Równania diofantyczne są centralnym tematem teorii liczb. My ograniczymy się tu do opowiedzenia o paru ideach i paru konkretnych przypadkach szukania rozwiązań (całkowitych lub wymiernych) równań diofantycznych. 11.1 Metody podstawowe Opiszemy tu pokrótce, za pomocą przykładów, podstawowe metody rozwiązywania równań diofantycznych. Polegają one na wykorzystaniu nierówności, wykorzystaniu desantu nieskoń- czonego, wykorzystaniu kongruencji i wykorzystaniu jednoznaczności rozkładu. 11.1.1 Wykorzystanie nierówności W zbiorze liczb całkowitych (i naturalnych) mamy zadane (pochodzące ze zbioru liczb rzeczy- wistych) u p o r z ą d k o w a n i e – relację mniejszości ⩽. Mimo, że jest ona strukturą o b c ą arytmetyce (zajmującej się głównie podzielnością) jest często wykorzystywana w teorii równań diofantycznych, na przykład do ograniczania zbioru potencjalnych rozwiązań. P r z y k ł a d 1. Rozważmy równanie x2 + x + 1 = y2. Pytamy o jego rozwiązalność w liczbach całkowitych. Dla x > 0 mamy x2 < x 2 + x + 1 < x 2 + 2x + 1 = (x + 1)2. Widzimy, że dla każdego x ∈ N liczba x2 + x + 1 leży (ściśle) między dwoma kolejnymi kwadratami. N i e j e s t więc kwadratem i nie może być równa y2. Podobnie, gdy x < −1, (x + 1)2 < x 2 + x + 1 < x 2. I znowu x2 + x + 1 leży między dwoma kolejnymi kwadratami, więc n i e jest kwadratem. Pozostały dwa przypadki: x = 0 (wtedy y = ±1) i x = −1 (wtedy również y = ±1). ♦ 366 11. Równania diofantyczne Ćwiczenie 11.1 Dowieść, że jedynymi rozwiązaniami równania x3 + 8x2 − 6x + 8 = y3 w liczbach całkowitych nieujemnych są pary (x, y) = (0, 2), (9, 11). Ćwiczenie 11.2 Rozwiązać w Z równanie x4 + y2 = x3 + y. Wskazówka. Udowodnić, że równanie u2 + au + b = 0, a, b ∈ Z, ma rozwiązania całkowite wtedy i tylko wtedy, gdy ∆ = a2 − 4b jest kwadratem liczby całkowitej. ZADANIE 11.1 Rozwiązać w liczbach naturalnych równanie 1 x + 1 y + 1 z = 1. R o z w i ą z a n i e. Załóżmy, że 0 < x ⩽ y ⩽ z. Wówczas 1 = 1 x + 1 y + 1 z ⩽ 3 x, skąd x ⩽ 3. Ponieważ, oczywiście, x ̸= 1, więc x = 2 lub x = 3. Oba te przypadki badamy kolejno. Jeżeli x = 2, to mamy 2 y ⩾ 1 y + 1 z = 1 2 . Stąd y ⩽ 4. Badamy kolejno przypadki y = 2 (co jest niemożliwe), y = 3 (co daje z = 6) i y = 4 (co daje z = 4). Jeżeli zaś x = 3, to mamy 2 y ⩾ 1 y + 1 z = 2 3 , skąd y ⩽ 3. Wówczas y = 3 i z = 3. Ostatecznie, rozwiązaniami są trójki (2, 3, 6), (2, 4, 4), (3, 3, 3) i wszystkie ich permutacje. ♦ Ćwiczenie 11.3 Udowodnić, że równanie 1 x1 + 1 x2 + . . . + 1 x2000 = 1 ma skończenie wiele rozwiązań w liczbach naturalnych. 11.1.2 Metoda zstępowania Metoda zstępowania, zwana też desantem (nieskończonym), opiera się na (pokrewnej Za- sadzie Minimum) obserwacji, że każdy ściśle malejący ciąg liczb naturalnych jest s k o ń c z o n y. Metodę tę już spotykaliśmy (zob. 3.2.7 U2, czy Z5.5). Rozpropagował ją Fermat, zobacz na przykład dowód T11.1. W ustępach 11.2.3 i 11.6.4 pokażemy dwa piękne desanty Eulera. Istotę metody pokazują poniższe przykłady i zadania. P r z y k ł a d. Chcemy udowodnić, że jeżeli liczba naturalna D nie jest n-tą potęgą liczby naturalnej, to n√D nie jest liczbą wymierną. Załóżmy w tym celu nie wprost, że n√D jest liczbą wymierną i przedstawmy ją w postaci n√D = a/b, gdzie a, b ∈ N. Wówczas a n = Dbn. Wybierzmy taką liczbą pierwszą p, że n ∤ vp(D), zobacz C2.44. Niech vp(a) = l. Równość an = Dbn, na mocy C2.43.1, daje: nl = vp(an) = vp(Dbn) = vp(D) + vp(bn). Stąd wnosimy, że vp(bn) ̸= 0, czyli p|bn, więc p|b. Ponadto, l ̸= 0. Kładąc a = pa1 i b = pb1 dostajemy, 11.1. Metody podstawowe 367 po podzieleniu przez pn, równość an 1 = Dbn 1 . Jednocześnie a + b > a1 + b1. Możemy teraz z parą (a1, b1) postąpić tak samo. W ten sposób, przy założeniu, że n√D jest liczbą wymierną, możemy zbudować nieskończony i ściśle malejący ciąg a + b > a1 + b1 > a2 + b2 > . . . liczb naturalnych, co jest niemożliwe. ♦ ZADANIE 11.2 Rozwiązać równanie x3 + 9y3 = 3z3 w liczbach całkowitych. R o z w i ą z a n i e. Jasne, że trójka (0, 0, 0) jest rozwiązaniem. Załóżmy, że (a, b, c) jest n i e z e r o w y m rozwiązaniem równania. Wówczas 3|a3, więc 3|a. Kładąc a = 3a1, znajdu- jemy, po podzieleniu przez 3, równość 9a3 1 + 3b3 = c3. Stąd 3|c3, czyli 3|c. Kładąc tym razem c = 3c1 i znów dzieląc przez 3 otrzymamy 3a3 1 + b3 = 9c3 1. Stąd, podobnie jak wyżej, 3|b. Kładąc b = 3b1 otrzymujemy (jeszcze raz dzieląc przez 3): a 3 1 + 9b3 1 = 3c3 1. Wobec tego trójka (a1, b1, c1) jest r o z w i ą z a n i e m naszego równania. Przy tym |a1| + |b1| + |c1| < |a| + |b| + |c|. Nierówność tu jest ostra, bo co najmniej jedna z liczb a, b, c jest różna od zera. Możemy teraz wykonać analogiczne manipulacje na (niezerowej(!)) trójce (a1, b1, c1). To prowadzi do sprzeczności (bo n i e istnieje ściśle malejący nieskończony ciąg liczb naturalnych). ♦ Ćwiczenie 11.4 Udowodnić, że równanie x2 + y2 = 3z2 nie ma niezerowych rozwiązań w liczbach całkowitych. A nawet niezerowych rozwiązań w liczbach wymiernych. Ćwiczenie 11.5 Udowodnić, że jeżeli p ⩾ 5 jest liczbą pierwszą, a n liczbą naturalną, to równanie x3 + y3 = pn nie ma rozwiązań w liczbach naturalnych x, y. Wskazówka. Rozłożyć: x3 + y3 = (x + y)(x2 − xy + y2), i zastosować desant względem n. 11.1.3 Wykorzystanie kongruencji Kongruencje dostarczają całego (nieskończonego!) szeregu warunków koniecznych rozwiązal- ności danego równania diofantycznego (w liczbach całkowitych). Warunki te dają ograniczenia jakie muszą spełniać liczby całkowite, które ”chcą” być rozwiązaniami badanego równania. Czasami te ograniczenia są tak silne, że żadne liczby całkowite nie są rozwiązaniami równania. ZADANIE 11.3 Rozwiązać równanie 2 x − 1 = y2 w liczbach całkowitych. R o z w i ą z a n i e. Mamy oczywiste rozwiązania (x, y) = (0, 0), (1, 1), (1, −1). Zauwa- żamy, że x nie może być ujemne. Jeżeli zaś x ⩾ 2, to liczba 2 x − 1 przystaje do 3 (mod 4), a żadna taka liczba nie jest kwadratem. ♦ ZADANIE 11.4 Udowodnić, że równanie x2 + 4 = y5 nie ma rozwiązań w Z. R o z w i ą z a n i e. Popatrzmy co się dzieje modulo 11. Wiemy, że y5 ≡ 0, ±1 (mod 11), zobacz C5.11. Z drugiej strony, x2 + 4 ≡ 4, 5, 8, 2, 9, 7 (mod 11), bo kwadratami modulo 11 są: 0, 1, 4, 9, 5, 3. Zatem x2 + 4 ̸≡ y5 (mod 11) dla dowolnych x, y ∈ Z. ♦ U w a g a. Warto zwrócić uwagę na moduł 11 w powyższym rozwiązaniu. Jego wybór jest związany z faktem, że (11 − 1)/2 = 5, czyli z możliwością zastosowania ćwiczenia C5.11. 368 11. Równania diofantyczne Ćwiczenie 11.6 Uzasadnić, że równanie (x + 1)5 + (y + 2)5 + (z + 3)5 = (x − 1)5 + (y − 2) 5 + (z − 3)5 + 2016 nie ma rozwiązań w liczbach całkowitych. Wskazówka. Skorzystać z (5.12). ZADANIE 11.5 Wykazać, że równanie 8x3 + 9y3 + 11z3 = 6xyz (11.1) ma tylko jedno rozwiązanie w liczbach całkowitych. R o z w i ą z a n i e. Zauważmy najpierw, że jeżeli którakolwiek z niewiadomych x, y, z jest równa 0, to pozostałe również są równe 0. Na przykład, jeżeli z = 0, to 8x3 + 9y3 = 0. I wtedy x = y = 0 (gdyby y ̸= 0, to 3√9 = (−2x)/y co, jak wiemy z 11.1.2 P, jest niemożliwe). Znajdujemy więc rozwiązanie trywialne (oczywiste) (0, 0, 0) równania (11.1). Pokażemy, że innych rozwiązań w liczbach całkowitych n i e m a. Załóżmy, że (x, y, z), z ̸= 0, jest rozwiązaniem. Redukując (11.1) modulo 7 mamy x3 + 2y3 + 4z3 ≡ −xyz (mod 7). (11.2) Niech k = v7(z) będzie wykładnikiem 7-adycznym liczby z. I niech k > 0. Wtedy (11.2) daje x3 + 2y3 ≡ 0 (mod 7). Ale x3, y3 ≡ ±1, 0 (mod 7), zobacz znów C5.11. Zatem x3 + 2y3 ≡ 0 (mod 7) jest możliwe tylko, gdy x3 ≡ y3 ≡ 0 (mod 7). Czyli, gdy x = 7x1, y = 7y1 i, również, z = 7z1 dla pewnych x1, y1, z1 ∈ Z. Wówczas (11.1), po podzieleniu przez 7 3, daje x3 1 + 2y3 1 + 4z3 1 = 6x1y1z1. Otrzymana trójka (x1, y1, z1) jest więc rozwiązaniem równania (11.1), przy czym v7(z1) = k − 1. Jeżeli teraz k − 1 > 0, to rozumujemy tak samo. W ten sposób po k krokach znajdziemy rozwiązanie (a, b, c) równania (11.1), w którym 7 ∤ c. Oznaczmy wówczas przez d odwrotność c modulo 7, zobacz T5.5. Mnożąc kongruencję (11.2) dla x = a, y = b, z = c przez d3 znajdujemy −u3 − 2w3 − 4 ≡ uw (mod 7), (11.3) gdzie u = ad, w = bd. Gdy teraz u ≡ 0 (mod 7), to (11.3) daje 2w3 + 4 ≡ 0 (mod 7), co jest niemożliwe. Podobnie niemożliwe jest w ≡ 0 (mod 7). Pozostały nam do rozpatrzenia cztery przypadki (wszystkie kongruencje modulo 7): (1) u 3, w3 ≡ 1. Wówczas 0 ≡ uw, sprzeczność. (2) u 3 ≡ 1, w3 ≡ −1. Wówczas 4 ≡ uw, więc 1 ≡ 4 3 ≡ u 3w3, sprzeczność. (3) u 3 ≡ −1, w3 ≡ 1. Wówczas 2 ≡ uw, więc 1 ≡ 2 3 ≡ u 3w3, sprzeczność. (4) u 3, w3 ≡ −1. Wówczas −1 ≡ uw, więc −1 ≡ (−1) 3 ≡ u 3w3, sprzeczność. ♦ Często wykorzystujemy wiedzę pozwalającą nam odróżniać reszty kwadratowe od niereszt kwadratowych modulo m: ZADANIE 11.6 Rozwiązać w liczbach całkowitych równanie y2 = x3 + 11. R o z w i ą z a n i e. Załóżmy, że para (x, y) jest rozwiązaniem. Redukujemy modulo 4. Ponieważ y2 ≡ 0, 1 (mod 4), więc x3 ≡ y2 − 11 ≡ 1, 2 (mod 4). To jest możliwe tylko dla x ≡ 1 (mod 4), bo 0 3 ≡ 2 3 ≡ 0 (mod 4), a 3 3 ≡ 3 (mod 4). Wobec tego x ≡ 1 (mod 4). Mamy y2 + 16 = x3 + 27 = (x + 3)(x2 − 3x + 9). 11.1. Metody podstawowe 369 Ponieważ x2 − 3x + 9 jest liczbą naturalną większą od 1 i, przy x ≡ 1 (mod 4), daje resztę 3 z dzielenia przez 4, więc istnieje liczba pierwsza p ≡ 3 (mod 4) dzieląca x2 − 3x + 9, a zatem i y2 + 16. (Gdy wszystkie dzielniki pierwsze liczby d o d a t n i e j są postaci 4t + 1, to i sama ta liczba jest postaci 4t + 1.) W takim razie y2 ≡ −16 (mod p). To jednakże jest niemożliwe, bo (−16|p) = (−1|p)(4 2|p) = (−1|p) = −1 dla p ≡ 3 (mod 4). Zatem badane równanie nie ma rozwiązań w liczbach całkowitych. ♦ Ćwiczenie 11.7 Udowodnić, że równania y2 = x3 − 5 i y2 = x3 + 23 nie mają rozwiązań w liczbach całkowitych. Ćwiczenie 11.8 Udowodnić, że jeżeli trójka (x, y, z) liczb całkowitych jest rozwiązaniem równania x2+3+y = 6yz, to y < 0. Wskazówka. Jasne, że y ̸= 0. Równość x2+3 = y(6z−1), dla y > 0, pokazuje, że 6z − 1 > 0 i (−3)Rp dla każdego pierwszego dzielnika p|6z − 1. Teraz zobacz (5.85) i zauważ, że iloczyn liczb postaci 6t + 1 jest liczbą tej postaci. 11.1.4 Wykorzystanie jednoznaczności rozkładu Postać iloczynowa (multyplikatywna) równania jest zwykle pożądana. Umożliwia ona wyko- rzystanie jednoznaczności rozkładu na czynniki nierozkładalne (jeżeli w danej sytuacji taka jednoznaczność ma miejsce). ZADANIE 11.7 Rozwiązać w liczbach całkowitych równanie 2 x + 1 = y2. R o z w i ą z a n i e. Przechodzimy do równoważnej postaci multyplikatywnej 2 x = (y + 1)(y − 1) (11.4) i wykorzystujemy jednoznaczność rozkładu na czynniki pierwsze w Z. Z tej jednoznaczności wynika, że oba czynniki po prawej stronie (11.4) są potęgami dwójki lub minus potęgami dwójki. Zatem y + 1 = ±2 k, y − 1 = ±2 l, gdzie k, l ∈ Z⩾0 i k + l = x. Odejmując stronami znajdujemy równość 2 = ±2 k − (±2 l), co jest możliwe tylko dla k = 2, l = 1 lub k = 1, l = 2. Ostatecznie: x = 3, y = ±3 są jedynymi rozwiązaniami. ♦ Ćwiczenie 11.9 Rozwiązać w liczbach całkowitych równanie 2 x + y2 = z2. Przypomnijmy stosowany już przez nas TRIK Jeżeli α, β, γ są elementami dziedziny z jednoznacznością rozkładu R, i w R zachodzi równość α · β = γk, a przy tym elementy α, β są względnie pierwsze, to elementy α i β są stowarzyszone z k-tymi potęgami, to znaczy, że istnieją takie jedności ε, η ∈ R∗ i elementy ϕ, ψ ∈ R, że α = ε · ϕ k oraz β = η · ψk. Równie łatwa w dowodzie jest teza następującego ćwiczenia: 370 11. Równania diofantyczne Ćwiczenie 11.10 Udowodnić, że jeżeli dla liczb naturalnych x, y, u, w zachodzi równość xy = uw, to istnieją takie liczby naturalne a, b, m, n, że zachodzą równości x = am, y = bn, u = an, w = bm i przy tym liczby m, n są względnie pierwsze. (Twierdzenie Eulera o czterech liczbach.) Ćwiczenie 11.11 Uogólnić to twierdzenie na przypadek dowolnego pierścienia z jedno- znacznością rozkładu. Pokażemy teraz na przykładach jak to działa. ZADANIE 11.8 Rozwiązać w liczbach naturalnych równanie 1 x + 1 y = 1 z . R o z w i ą z a n i e. Równanie to jest równoważne równaniu (x − z)(y − z) = z2. Chciałoby się teraz skorzystać z triku, ale czynniki po lewej stronie tej równości nie muszą być względnie pierwsze. Niech d = NWD (x − z, y − z). Wtedy d2|z2, czyli d|z. Stąd x − z d · y − z d = ( z d )2 . Teraz już możemy zastosować trik. Otrzymujemy x − z d = a2, y − z d = b2, gdzie ab = z d. Wobec tego (x, y, z) = (da(a + b), db(a + b), dab). Sprawdzenie, że każda taka trójka jest rozwiązaniem, nie przedstawia trudności. ♦ Ćwiczenie 11.12 Udowodnić, że wszystkie rozwiązania równania 1 x2 + 1 y2 = 1 z2 w liczbach naturalnych dane są przez x = d(u 2 + v2)(u2 − v2), y = d(u 2 + v2) · 2uv, z = d(u2 − v2) · 2uv, gdzie u, v są względnie pierwsze różnej parzystości, u > v, a d ⩾ 1 jest dowolną liczbą naturalną. Ponadto można zamienić miejscami x i y. Już parę razy spotkaliśmy równanie Bachet’a y2 = x3 + B, (11.5) gdzie B jest ustaloną liczbą całkowitą (zobacz Z10.4 dla B = −1, 10.2.7 P dla B = −11, Z10.8 dla B = −2, Z11.6 dla B = 11 oraz C11.7 dla B = −5 i B = 23). Rozważymy teraz przypadek B = −4. Dla zbadania tego przypadku równania Bachet’a wykorzystamy (podobnie jak w przypadku B = −1) jednoznaczność rozkładu w pierścieniu Gaussa Z[ i ]. ZADANIE 11.9 Wyznaczyć wszystkie rozwiązania równania y2 = x3 − 4 (11.6) w liczbach całkowitych. 11.2. Wielkie Twierdzenie Fermat’a 371 R o z w i ą z a n i e. Załóżmy najpierw, że (x, y) jest rozwiązaniem z n i e p a r z y s t y m y. Wówczas równość (11.6) zapisujemy w pierścieniu Z[ i ] w postaci iloczynowej: (y + 2i)(y − 2i) = x3. Wiemy, że NWD (y + 2i, y − 2i) = 1, zobacz (10.10). Wobec tego trik w pierścieniu Z[ i ] pozwala napisać y +2i = (a+bi)3 dla pewnych a, b ∈ Z. Stąd 2 = 3a2b−b3. Sprawdzamy ko- lejne możliwe wartości b = ±1, ±2. Dostajemy cztery rozwiązania (a, b) = (±1, 1), (±1, −2). Pierwsze dwie z tych par dają parzyste y = a3 − 3ab2, więc nie są dla nas interesujące. Pozo- stałe dwie z tych par dają y = ±11. Wówczas x = 5. Mamy więc dwa rozwiązania równania (11.6) z nieparzystym y: (x, y) = (5, 11), (5, −11). Załóżmy teraz, że y jest p a r z y s t e. Wówczas również x jest parzyste. Kładąc y = 2y1 i x = 2x1 dostajemy więc y2 1 = 2x3 1 − 1, czyli y1 jest nieparzyste i (y1 + i)(y1 − i) = 2x3 1. (11.7) Tym razem NWD (y1 + i, y1 − i) ∼ 1 + i, zobacz Z10.2. Ponieważ 2 = (1 + i)(1 − i), więc możemy podzielić obustronnie równość (11.7) przez 2. Otrzymamy iloczyn dwóch w z g l ę d n i e p i e r w s z y c h czynników równy sześcianowi w Z[ i ]: x3 1 = y1 + i 1 + i · y1 − i 1 − i = (u + 1 − ui) · (u + 1 + ui), gdzie y1 = 2u + 1. Dzięki trikowi możemy napisać równość u + 1 − ui = (a + bi) 3 dla pewnych a, b ∈ Z. Więc u + 1 = a3 − 3ab2 i −u = 3a2b − b3. Stąd 1 = (u + 1) − u = (a3 − 3ab3) + (3a2b − b3) = (a − b)(a2 + ab + b2) + 3ab(a − b). Zatem a − b = a2 + 4ab + b2 = ±1. Łatwo znajdujemy wszystkie możliwe a, b. I ostatecznie y = ±2 oraz x = 2. ♦ Ćwiczenie 11.13 Udowodnić, że jeżeli y2 = x5 − 1 i x, y ∈ Z, to y = 0. Ćwiczenie 11.14 Dana jest liczba pierwsza p > 3. Udowodnić, że jeżeli y2 = xp − 1 dla pewnych liczb całkowitych x, y, to y = 0. 11.2 Wielkie Twierdzenie Fermat’a Najsłynniejszym równaniem diofantycznym (a właściwie, najsłynniejszą serią równań diofan- tycznych) jest równanie xn + yn = zn. (11.8) Około 1 1640 Pierre de Fermat sformułował (i twierdził, że umie udowodnić) następujące: 1Dokładniejsza data nie jest znana. Na marginesie swojego egzemplarza, wydanej przez Bachet’a w 1621, Arytmetyki Diofantosa, Fermat zapisał słynne zdanie: Nie można podzielić sześcianu na dwa sześciany ani czwartej potęgi na dwie czwarte potęgi, ani ogólnie żadnej potęgi wyższej niż druga na dwie takie same potęgi; znalazłem naprawdę zadziwiający dowód, który nie zmieści się na tym zbyt wąskim marginesie. 372 11. Równania diofantyczne WIELKIE TWIERDZENIE FERMAT’a Jeżeli trójka (x, y, z) liczb całkowitych jest rozwiązaniem równania (11.8) przy n ⩾ 3, to xyz = 0. Fermat podał dowód w przypadku n = 4, reprodukujemy go poniżej. Prawdopodobieństwo, że podobnymi metodami da się udowodnić twierdzenie dla dowolnego n, jest z n i k o m e. Pró- bowały tego dziesiątki matematyków – dwie takie próby pokażemy w ustępach 11.2.2 i 11.2.3, i tysiące fermatowców – każdy wydział matematyczny na świecie otrzymywał wiele listów z ”dowodami” wielkiego twierdzenia. Teza WTF okazała się p r a w d z i w ą w roku 1994, kiedy to Wiles’owi udało się zwieńczyć wysiłki poprzedników (Taniyamy, Shimury, Frey’a, Serre’a, Ribeta, Taylora i innych). O ich strategii dowodu twierdzenia Fermat’a nie możemy tu (z braku miejsca i wiedzy) opowiedzieć. Zobacz [ 9 ]. Ćwiczenie 11.15 Uzasadnić, że WTF wystarczy udowodnić dla n = 4 i dla n = p, gdzie p jest dowolną nieparzystą liczbą pierwszą. 11.2.1 Twierdzenia Fermat’a Rozpatrzymy teraz przypadek n = 4. Poniżej przedstawiony dowód pochodzi w istocie od Fermat’a, który pokazał nam, na czym polega m e t o d a n i e s k o ń c z o n e g o d e s a n t u. TWIERDZENIE 11.1 Równanie x4 + y4 = z4 nie ma rozwiązań w liczbach naturalnych. Więcej: równanie x4 + y4 = z2 (11.9) nie ma rozwiązań w liczbach naturalnych. D O W Ó D. Załóżmy, nie wprost, że trójka (a, b, c) liczb naturalnych jest rozwiązaniem tego równania. Pokażemy jak można z trójki (a, b, c) skonstruować nową trójkę (a1, b1, c1), która również jest rozwiązaniem (11.9), przy czym 0 < c1 < c. Jasne, że w ten sposób uzyskamy sprzeczność. Procedura konstruowania rozwiązania (a1, b1, c1) z danego rozwiązania (a, b, c) jest dwu- krokowa. K r o k p i e r w s z y wykonujemy, gdy liczby a i b nie są względnie pierwsze. Jeżeli d > 1 jest wspólnym dzielnikiem liczb a i b, to d4|c2, więc d2|c i trójka (a1, b1, c1) =( a d , b d, c d2 ) jest rozwiązaniem (11.9) z mniejszym z. W k r o k u d r u g i m zakładamy więc, że NWD (a, b) = 1. Wówczas (a2, b2, c) jest pierwotnym rozwiązaniem równania Pitagorasa, więc, jak wiemy, istnieją takie liczby względnie pierwsze u, v, że a2 = 2uv, b 2 = u2 − v2, c = u 2 + v2, (po ewentualnej zamianie a na b). Ponadto, liczby u, v są różnej parzystości. Łatwo zobaczyć, że w tej sytuacji v jest parzysta. Gdyby bowiem v była nieparzysta, a u parzysta, to byłoby b2 = u 2 − v2 ≡ 0 − 1 ≡ 3 (mod 4), co jest niemożliwe. Oznaczając v = 2w widzimy, że (a 2 )2 = uw, co, wobec względnej pierwszości u i w, na mocy triku T2.19, daje u = c2 1, w = d2, 11.2. Wielkie Twierdzenie Fermat’a 373 gdzie c1 i d są liczbami względnie pierwszymi, przy czym c1 ≡ 1 (mod 2). Równość b2 = u2 − v2 możemy teraz zapisać w postaci (2d2)2 + b2 = c4 1, gdzie 2d2 i b2 są względnie pierwsze. Stąd znów znajdujemy 2d 2 = 2mn, c 2 1 = m 2 + n2 (11.10) dla pewnych względnie pierwszych m, n. Jeszcze raz stosujemy trik do równości d2 = mn i dostajemy m = a2 1 i n = b2 1. Druga z równości (11.10) daje więc a4 1 + b4 1 = c2 1. I znów znaleźliśmy rozwiązanie równania (11.9) z mniejszym z, bo, oczywiście, c1 < c. □ Widzimy więc, że suma niezerowych bikwadratów (= czwartych potęg) nigdy nie jest kwadratem (a tym bardziej bikwadratem!). Również różnica różnych niezerowych bikwadratów nie jest nigdy kwadratem: Ćwiczenie 11.16 Udowodnić, że równanie x4 − y4 = z2 (11.11) nie ma rozwiązań w niezerowych liczbach całkowitych. Wskazówka. Zakładając to co trzeba założyć, uzasadnić kolejne wynikania: x4 − y4 = z2, więc x2 = a2 + b2, y2 = 2ab, z = a2 − b2, więc a = c2 − d2, b = 2cd, więc y2 = 4cd(c2 − d2), więc c = e 2, d = f 2, c2 − d2 = g2, więc e 4 − f 4 = g2 i (e, f ) ≺ (x, y). ZADANIE 11.10 Udowodnić, że jeżeli w trójkącie prostokątnym wszystkie boki mają długość całkowitą, to pole tego trójkąta n i e j e s t k w a d r a t e m l i c z b y c a ł k o w i t e j. (Zadanie Fermat’ a) R o z w i ą z a n i e. Niech a, b ∈ N oznaczają długości przyprostokątnych, a c ∈ N długość przeciwprostokątnej danego trójkąta prostokątnego. Załóżmy, że pole S = 1 2ab tego trójkąta jest kwadratem: 1 2ab = d2. Dodając do obu stron równości a2 + b2 = c2 liczbę ±2ab = ±(2d) 2 znajdujemy (a + b) 2 = c2 + (2d) 2, oraz (a − b) 2 = c2 − (2d) 2. Mnożymy te dwie równości stronami. To daje c4 − (2d) 4 = (a2 − b2) 2. Ponieważ a ̸= b (dlaczego?) więc znaleźliśmy niezerowe rozwiązanie równania (11.11). Sprzeczność. ♦ Ćwiczenie 11.17 Udowodnić, że równanie x4 + y4 = 2z2 ma tylko trywialne rozwiązania (x, y, z) = (a, a, a 2), gdzie a ∈ Z. Wskazówka. Jeżeli x > y, to 2u = x2 + y2, 2v = x2 − y2 są parzyste. Wówczas u2 + v2 = z2 i u 2 − v2 = (u + v)(u − v) = (xy)2. Stąd u4 − v4 = □ (jest kwadratem). 374 11. Równania diofantyczne 11.2.2 Twierdzenie Sophie Germain Zgodnie z ćwiczeniem C11.15 zajmujemy się równaniem (11.8) dla n = p > 2. W czasie prób dowodu WTF rozróżniono dwa przypadki: tak zwany przypadek I, gdy zakładamy dodatkowo, że p ∤ xyz i tak zwany przypadek II, gdy p|xyz. Przypadek I jest zdecydowanie łatwiejszy w badaniu. Sophie (Zoﬁa) Germain uzyskała całkowicie elementarnymi metodami największy w jej czasach progres na drodze dowodu przypadku I WTF. LEMAT 11.1 Załóżmy, że q = 2n + 1 > 3 jest liczbą pierwszą. Jeżeli (przy dowolnym wyborze znaków) zachodzi kongruencja an ± bn ± cn ≡ 0 (mod q), to abc ≡ 0 (mod q). D O W Ó D. Załóżmy, nie wprost, że abc ̸≡ 0 (mod q). Wtedy a, b, c ̸≡ 0 (mod q). Z ćwiczenia C5.11 wiemy więc, że an ≡ ±1 (mod q), bn ≡ ±1 (mod q) i cn ≡ ±1 (mod q). Zatem 0 ≡ an ± bn ± cn ≡ ±1 ± 1 ± 1 ≡ ±1, ±3 (mod q). Sprzeczność. □ TWIERDZENIE 11.2 (Twierdzenie Sophie Germain) Załóżmy, że p jest liczbą pierw- szą Sophie Germain (zob. 5.7.8 U1). Załóżmy, że dla liczb całkowitych x, y, z zachodzi równość xp + yp = zp. (11.12) Wówczas xyz ≡ 0 (mod p). D O W Ó D. Załóżmy nie wprost, że istnieją takie x, y, z ∈ Z, że zachodzi równość (11.12) i że x ̸≡ 0 (mod p), y ̸≡ 0 (mod p) i z ̸≡ 0 (mod p). Pisząc równość (11.12) w postaci xp + yp + (−z)p = 0 i dzieląc x, y, −z przez NWD (x, y, −z) znajdujemy p i e r w o t n ą trójkę a, b, c, dla której ap + bp + cp = 0 i, oczywiście, p ∤ abc. Korzystamy teraz z tożsamości nieśmiertelnej (1.8) i piszemy: (−a) p = (b + c)(bp−1 − bp−2c + . . . − bcp−2 + cp−1). (11.13) Pokażemy, że czynniki stojące po prawej stronie tej równości są względnie pierwsze. Załóżmy w tym celu, że pewna liczba pierwsza r dzieli czynnik (b + c). Wtedy c ≡ −b (mod r), więc drugi czynnik jest sumą p składników, z których każdy przystaje do bp−1 modulo r. Gdyby więc drugi czynnik był również podzielny przez r, to musiałoby być r|pbp−1. Ponieważ jednak r ∤ b (gdy r|b, to, ponieważ r|(b + c), r|c, więc i r|a, co jest niemożliwe wobec pierwotności trójki a, b, c), więc r|p, czyli r = p. Wobec tego p|(−a)p, skąd p|a, co zostało wykluczone. [Zauważmy, że dla dowodu względnej pierwszości czynników z prawej strony równości (11.13) mogliśmy byli powołać się na Z2.B6.] Trik pokazuje więc, że czynnik (b + c) iloczynu (11.13) jest p-tą potęgą (pamiętamy, że p jest liczbą nieparzystą, więc −u p = (−u)p) liczby całkowitej. Podobnie pokazujemy, że również liczby (c + a) i (a + b) są p-tymi potęgami liczb całkowitych. Mamy więc b + c = A p, c + a = Bp, a + b = C p (11.14) dla pewnych liczb całkowitych A, B, C. Równość ap + bp + cp = 0 pociąga kongruencję ap + bp + cp ≡ 0 (mod q), z której dzięki lematowi L11.1 wnosimy, że q|abc. Zatem q dzieli (co najmniej) jedną z liczb a, b, c. B e z o g r a n i c z e n i a ogólności rozważań możemy założyć, że q|a. Wtedy q|Bp + C p − Ap, bo, jak 11.2. Wielkie Twierdzenie Fermat’a 375 widać z równości (11.14), Bp +C p −A p = 2a. Mamy więc Bp +C p −A p ≡ 0 (mod q), co, znowu dzięki L11.1, daje q|ABC. Stąd wnosimy, że q|A (gdy q|B, to q|Bp − a, więc q|c, co jest niemożliwe, bo a, c są względnie pierwsze; gdy zaś q|C, to, podobnie, q|b, co jest niemożliwe, bo a, b są względnie pierwsze). Wróćmy teraz do równości (11.13). Drugi czynnik z prawej strony tej równości również jest p-tą potęgą. Oznaczmy go Ep. Mamy zatem (−a) p = A p · Ep. Ponieważ czynniki A p, Ep są względnie pierwsze, a q|Ap, więc q ∤ Ep. Czyli q ∤ E. Wobec tego (zobacz C5.11) Ep ≡ ±1 (mod q). Ale q|A p, czyli c ≡ −b (mod q), więc Ep = bp−1 − bp−2c + . . . − bcp−2 + cp−1 ≡ pbp−1 (mod q). Otrzymujemy stąd ±1 ≡ pbp−1 (mod q). Jednocześnie trzecia z równości (11.14) pokazuje, że b ≡ C p (mod q) (bo q|a, czyli q|C p − b). Wiemy, że q ∤ C, więc (jeszcze raz zobacz C5.11) C p ≡ ±1 (mod q). Czyli b ≡ ±1 (mod q), skąd bp−1 ≡ 1 (mod q), bo p − 1 jest parzyste. Mamy zatem sprzeczność: ±1 ≡ p (mod q). □ Ćwiczenie 11.18 Niech p > 2 będzie liczbą pierwszą Sophie Germain (zob. 5.7.8 U1). Udowodnić, że równanie xp + 2yp + 5zp = 0 nie ma rozwiązań w liczbach całkowitych. Ćwiczenie 11.19 Udowodnić, że jeżeli x7 + y7 = z7 dla liczb całkowitych x, y, z, to 7|xyz. Wskazówka. Wykorzystać liczbę pierwszą q = 29 = 4 · 7 + 1. 11.2.3 Metoda Eulera dowodu WTF(3) Leonhard Euler ”prawie” udowodnił WTF(3) (Wielkie Twierdzenie Fermata dla wykładnika n = 3). Pomysł Eulera dowodu WTF(3) polegał na wykorzystaniu arytmetyki pierścienia Z[√ −3] = {a + b√ −3 : a, b ∈ Z}. Pierścień ten jednak ma poważną wadę: n i e jest dziedziną z jednoznacznością rozkładu. Wady tej nie ma, jak wiemy, większy od Z[√ −3], pierścień Eisensteina Z[τ−3]. Okaże się, że równanie x3 + y3 + z3 = 0 nie ma rozwiązań nie tylko w niezerowych liczbach całkowitych, ale również w niezerowych liczbach Eisensteina. W trakcie dowodu tego faktu korzystamy swobodnie z oznaczeń i wyników omówionych w ustępie 10.2.8. Załóżmy, że α, β, γ ∈ Z[ ω ] ∖ {0} i że zachodzi równość α3 + β3 + γ3 = 0, (11.15) przy czym NWD (α, β, γ) ∼ 1. Dzieląc ewentualnie przez NWD możemy tak założyć. (1) Udowodnimy najpierw, że jedna i tylko jedna z liczb α, β, γ dzieli się przez λ. To wy- nika z Z10.10: gdyby żadna z liczb α, β, γ nie była podzielna przez λ, to byłoby α3, β3, γ3 ≡ ±1 (mod 9) skąd dostalibyśmy nieprawdę ±1 ± 1 ± 1 ≡ 0 (mod 9). Wobec tego co najmniej jedna z liczb α, β, γ jest podzielna przez λ. Gdyby dwie z nich były podzielne przez λ, to, wobec równości (11.15), i trzecia byłaby podzielna przez λ, co jest niemożliwe, bo założyliśmy względną pierwszość. Niech γ = λ kδ i λ ∤ δ. Możemy więc zapisać (11.15) w postaci α3 + β3 = ελ3kδ3, (11.16) gdzie ε jest jednością (tu ε = −1) oraz λ ∤ α, λ ∤ β, λ ∤ δ, i k ∈ N. 376 11. Równania diofantyczne (2) Wykażemy teraz, że k w równości (11.16) spełnia warunek k ⩾ 2. Istotnie, dzięki Z10.10 wiemy, że α3, β3, δ3 ≡ ±1 (mod 9). Załóżmy, nie wprost, że k = 1 i zredukujmy równość (11.16) modulo 9. Dostaniemy kongruencję postaci ±1 ± 1 ≡ ±ελ 3 (mod 9). Łatwo sprawdzić, że to jest niemożliwe przy żadnym wyborze znaków i jedności ε (proponujemy Czytelnikowi zobaczenie tego na rysunku 10.5). (3) Zapiszemy teraz równość (11.16) w postaci iloczynowej (α + β)(α + ωβ)(α + ω2β) = ε(λkδ)3, (11.17) zob. C11.20(1). Ponieważ liczba pierwsza Eisensteina λ (zobacz C10.72) dzieli prawą stronę tej równości więc dzieli co najmniej jeden z czynników strony lewej. Z ćwiczenia C11.20(2) wiemy, że te czynniki przystają do siebie modulo λ. Wobec tego λ dzieli każdy z tych trzech czynników. Co więcej, zobacz C11.20(3), największym wspólnym dzielnikiem każdej pary tych czynników jest λ. Wobec tego jeden z tych czynników dzieli się przez λ 3k−2, a dwa pozostałe dzielą się przez λ. (4) Dzieląc więc przez λ 3 obie strony równości (11.17) dostajemy równość α + β λ · α + ωβ λ · α + ω2β λ = ε(λ k−1δ)3, (11.18) przy czym czynniki z lewej strony są (parami) względnie pierwsze. Ponieważ ich iloczyn jest stowarzyszony z sześcianem, więc każdy z czynników jest stowarzyszony z sześcianem (trik !). Mamy zatem równości: α + β λ = ε1α3 1, α + ωβ λ = ε2β3 1, α + ω2β λ = ε3γ3 1, (11.19) gdzie ε1, ε2, ε3 są pewnymi jednościami. Ponadto (ewentualnie przemianowując) możemy uwa- żać, że λ ∤ α1, λ ∤ β1 i λ k−1|γ1. (5) Wykorzystamy teraz twierdzenie ”o strażakach” T3.20. Daje ono równość ε1α3 1 + ωε2β3 1 + ω2ε3γ3 1 = 1 λ ( α + ωα + ω2α + β + ω2β + ω4β) = 0. Przenosząc wyraz ω2ε3γ3 1 na drugą stronę i mnożąc obustronnie przez ε−1 1 dostajemy: α3 1 + ε4β3 1 = ε5(λk−1δ1) 3 (11.20) gdzie ε4, ε5 są pewnymi jednościami. Położyliśmy tu γ1 = λ k−1δ1. (6) Z punktu (2) wiemy, że k − 1 ⩾ 1. Redukując równość (11.20) modulo λ3 otrzymamy więc ±1 ± ε4 ≡ 0 (mod λ3), czyli ε4 ≡ ±1 (mod λ 4). Rzut oka na rysunek 10.5 przekonuje nas, że to jest możliwe tylko, gdy ε4 = ±1. Więc ε3 4 = ε4. Wobec tego równość (11.20) może być zapisana tak: α3 1 + (ε4β1) 3 = ε5λ 3(k−1)δ3 1. Dostaliśmy więc równość postaci (11.16) z tą różnicą, że k jest zamienione na k − 1. Powyższe rozważania pozwalają udowodnić WTF(3): TWIERDZENIE 11.3 Jeżeli x, y, z ∈ Z i zachodzi równość x3 + y3 = z3, to xyz = 0. □ 11.2. Wielkie Twierdzenie Fermat’a 377 Ćwiczenie 11.20 (1) Udowodnić tożsamość x3 +y3 = (x+y)(x+ωy)(x+ω2y). Porównać z tożsamością (3.41). (2) Udowodnić, że dla dowolnych α, β ∈ Z[ ω ] zachodzą kongruencje α + β ≡ α + ωβ ≡ α + ω2β (mod λ). (3) Udowodnić, że dla czynników z lewej strony równości (11.17) zachodzi: NWD (α+β, α+ωβ) ∼ NWD (α+β, α+ω2β) ∼ NWD (α+ωβ, α+ω2β) ∼ λ. (4) Uzasadnić, że λ4 ∼ 9 w Z[ ω ]. Ćwiczenie 11.21 Udowodnić T11.3. Ćwiczenie 11.22 Jeżeli x, y, w ∈ Q spełniają równanie x3 + y3 = w3, to xyw = 0. Ćwiczenie 11.23 Uzasadnić, że 1 001 000 nie jest sześcianem liczby naturalnej. Ćwiczenie 11.24 Rozwiązać w liczbach wymiernych równanie 3y2 = 2x3 −4. Wskazówka. Zauważyć, że jest ono równoważne równaniu (2 + y)3 + (2 − y) 3 = 8x3. Ćwiczenie 11.25 Niech f (X) = X 18 − 8X 9. Udowodnić, że jeżeli u ̸= w są liczbami wymiernymi, to f (u) ̸= f (w). 11.2.4 Równanie x3 + y3 + z3 = w3 Z C11.22 wiemy, że niezerowy sześcian liczby wymiernej n i e może być sumą dwóch niezero- wych sześcianów liczb wymiernych. Pokażemy za Eulerem, że istnieje mnóstwo niezerowych wymiernych sześcianów będących sumami trzech niezerowych wymiernych sześcianów. Załóżmy, że liczby wymierne x, y, z i w spełniają równanie x3 + y3 + z3 = w3. (11.21) Jeżeli przy tym z ̸= w, to możemy powyższą równość zapisać w postaci x + y w − z = w2 + wz + z2 x2 − xy + y2 = N(w + zτ ) N(x − yτ ) = N(P + Qτ ) = P 2 + P Q + Q2 =: N, (11.22) gdzie τ = τ−3. Jasne, że N oznacza tu normę w Q( √−3), patrz (10.2) i C10.34. Oznaczyliśmy tu przez P + Qτ iloraz (w + zτ )/(x − yτ ) w Q( √−3), więc P, Q ∈ Q. Równość w + zτ = (P + Qτ )(x − yτ ) daje, na mocy C10.33, równości P x + Qy = w i Qx − (P + Q)y = z. Zapisując równość (11.22) w postaci x + y = N w − N z otrzymujemy więc układ równości:  | | P x + Qy = w, Qx − (P + Q)y − z = 0, x + y + N z = N w. Rozwiązujemy ten układ względem x, y, z. Dostajemy: x = [(P + 2Q)N − 1]w N 2 + Q − P , y = [(Q − P )N + 1]w N 2 + Q − P , z = [N 2 − (P + 2Q)]w N 2 + Q − P . 378 11. Równania diofantyczne Oznaczmy jeszcze M = w(N 2 + Q − P )−1. Wówczas mamy:  ||| ||| x = [(P + 2Q)N − 1] M, y = [(Q − P )N + 1] M, z = [N 2 − (P + 2Q)] M, w = [N 2 + (Q − P )] M. Kładąc w tych równościach dowolne wymierne wartości M, P, Q (pamiętając cały czas, że N = P 2 + P Q + Q 2) dostajemy (wszystkie) rozwiązania wymierne równania (11.21). Możemy powiedzieć, że otrzymaliśmy t r z y p a r a m e t r o w ą rodzinę rozwiązań wymiernych równania (11.21). Kładąc tu P = Q = λ i M = 1 znajdujemy j e d n o p a r a m e t r o w ą rodzinę rozwiązań całkowitoliczbowych równania (11.21): dla każdego λ ∈ Z czwórka (x, y, z, w) = (9λ 3 − 1, 1, 9λ4 − 3λ, 9λ4) (11.23) jest rozwiązaniem (11.21) w liczbach całkowitych. U w a g a. Nie należy sądzić, że w ten sposób uzyskamy wszystkie rozwiązania równania (11.21) w Z! Ćwiczenie 11.26 Kładąc λ = −1 w równościach (11.23) odnajdujemy równość Rama- nujana: 1 3 + 123 = 9 3 + 103. Ramanujan (w pamięci(?)) sprawdził, że liczba 1729 jest n a j m n i e j s z ą liczbą naturalną, którą da się przedstawić w postaci sumy dwóch sześcianów liczb naturalnych na dwa r ó ż n e sposoby. Czy potraﬁcie to uzasadnić na kartce? 11.3 Równanie Ramanujana Pokażemy tu rozwiązanie problemu Ramanujana z roku 1913. Pierwsze (nieco inne niż niżej przytoczone) rozwiązanie tego problemu pochodzi od Nagella (1948). Rozwiązanie, które przy- taczamy poniżej wykorzystuje jednoznaczność rozkładu w pierścieniu Z[τ−7]. Ponadto, ważną w nim rolę grają ciągi rekurencyjne. TWIERDZENIE 11.4 Jedynymi rozwiązaniami równania Ramanujana y2 + 7 = 2 m (11.24) w liczbach całkowitych są pary (y, m) = (±1, 3), (±3, 4), (±5, 5), (±11, 7), (±181, 15). D O W Ó D. Podstawową metodą w dowodzie jest rozkład lewej strony na czynniki w pier- ścieniu Z[τ−7]. Pierścień Z[τ−7] jest pierścieniem normowo-euklidesowym, zobacz Z10.6. Jest więc dziedziną z j e d n o z n a c z n o ś c i ą r o z k ł a d u na czynniki nierozkładalne, zobacz T10.13. W dalszym ciągu piszemy w skrócie τ = τ−7. Oznaczmy przez τ liczbę sprzężoną z τ . Przypomnijmy, że τ + τ = 1, τ · τ = 2 i τ 2 = τ − 2, τ 2 = τ − 2. (11.25) Załóżmy, że para (y, m) jest rozwiązaniem równania Ramanujana. Wówczas y ∈ Z jest, oczywiście, liczbą nieparzystą. Niech y = 2x + 1. Oznaczmy ξ = y + √−7 2 = x + τ. 11.3. Równanie Ramanujana 379 Wówczas w Z[τ ] zachodzi równość ξ · ξ = 2 n = τ n · τ n (11.26) gdzie n = m − 2. Ponieważ rozkład 2 = τ · τ jest rozkładem na (niestowarzyszone!) czynniki nierozkładalne więc, dzięki jednoznaczności rozkładu, mamy ξ = ±τ k · τ l, i (wobec tego) ξ = ±τ k · τ l. Wymnażając stronami i porównując z (11.26), widzimy, że k + l = n. Gdyby k, l > 0, to mielibyśmy ξ = ±τ τ · τ k−1τ l−1 = ±2 · τ k−1τ l−1, co jest niemożliwe, bo ξ nie dzieli się przez 2 (sprawdzić!). Zatem k = n, l = 0 lub k = 0, l = n. Widzimy więc, że τ n = ±(x + τ ) lub τ n = ±(x + τ ) = ±(x + 1 − τ ). Wobec tego, jeżeli para (y, m) = (2x + 1, n + 2) jest rozwiązaniem równania Ramanujana, to w zapisie liczby τ n ∈ Z[τ ], w postaci τ n = an + bnτ, (11.27) gdzie an, bn ∈ Z (a taki zapis, jak wiemy, jest jednoznaczny) zachodzi równość bn = ±1. Odwrotnie, jeżeli przy pewnym a ∈ Z i przy pewnym n ∈ N zachodzi równość τ n = a ± τ , to sprzęgając i wymnażając stronami znajdujemy 2 n+2 = 4τ nτ n = 4(a ± τ )(a ± τ ) = 4(a2 ± a(τ + τ ) + τ τ ) = (2a ± 1) 2 + 7, czyli rozwiązanie (2a ± 1, n + 2) równania Ramanujana. Musimy się więc bliżej przyjrzeć liczbom całkowitym bn wyznaczonym przez (11.27). Mno- żąc tę równość stronami przez τ i korzystając z równości τ 2 = τ − 2 znajdujemy zależności an+1 = −2bn i bn+1 = an + bn. Stąd z łatwością sprawdzamy, że bn+2 = bn+1 − 2bn (11.28) dla każdego n ⩾ 0. Ponadto, b0 = 0 i b1 = 1. W lemacie L11.2 dowodzimy, że |bn| = 1 dla n = 1, 2, 3, 5, 13 i tylko dla takich n. To daje wymienione rozwiązania równania (11.24). I to są w s z y s t k i e r o z w i ą z a n i a tego równania. □ Udowodnimy więc: LEMAT 11.2 Jedynymi wyrazami ciągu (bn) zadanego przez (11.28) i warunki począt- kowe b0 = 0, b1 = 1, takimi że |bn| = 1, są wyrazy b1 = b2 = 1 i b3 = b5 = b13 = −1. D O W Ó D. Wśród początkowych wyrazów: 0, 1 , 1 , −1 , −3, −1 , 5, 7, −3, −17, −11, 23, 45, −1 , −91, −89, 93, 271, 85 ciągu (bn) znajdujemy pięć przypadków wystąpienia wyrazu równego ±1: b1 = b2 = 1 i b3 = b5 = b13 = −1. 380 11. Równania diofantyczne Będziemy teraz dowodzić, że, poza wskazanymi, w ciągu (bn) n i e w y s t ę p u j ą ż a d n e inne wyrazy równe ±1. Łatwo uzasadnić, że poza b1, b2 nie ma więcej wyrazów równych +1. Istotnie, redukując ciąg (bn) modulo 64, dostajemy: 0, 1, 1, −1, −3, −1, (5, 7, 61, 47, 53, 23, 45, −1 , 37, 39, 29, 15, 21, 55, 13, 31) czyli ciąg (nieczysto) okresowy (okres wzięliśmy w nawias) o okresie długości 16. Wnosimy stąd, że jedyne wartości n, dla których bn = 1 to n = 1, 2. Ponadto b3 = b5 = −1, a jedyne n > 5, dla których wyraz bn m o ż e być równy −1 to n postaci 16k + 13. Udowodnimy dwoma sposobami, że k = 0 jest jedyną wartością k, dla której b16k+13 = −1. S p o s ó b 1. W tym sposobie, który pochodzi z pracy A. Schinzel, J. Browkin Sur les nom- bres de Mersenne qui sont triangulaires, wykorzystamy fakt, że ciąg (bn) jest ciągiem Lucas’a (u(1, −2)n), w szczególności, że ma on własność podzielności (zob. C9.22): m|n =⇒ bm|bn. (11.29) Rozważmy ciąg (ck (mod 17)) dany przez ck = b16k+13. Żmudny (choć prosty) rachunek pokazuje, że (ck (mod 17)) : ( −1 , −5, 0, 5, 1, 2, −4, 4, −2), . . . . Widzimy stąd, że ciąg (ck (mod 17)) jest ciągiem czysto-okresowym o okresie długości 9, a −1 występuje na początku okresu. Wobec tego ck ≡ −1 (mod 17) wtedy i tylko wtedy, gdy k = 9m. Co oznacza, że bn = −1, n ⩾ 13 =⇒ n = 144m + 13. (11.30) Rozważmy teraz ciąg (dp) = (b3p+1 (mod 79)). Nieco mniej żmudny (choć równie prosty) rachunek pokazuje, że (dp (mod 79)) : (1, −3, 7, −11, −1 , 14, 17, −39, −20, 17, −4, −37, −20), . . . . Widzimy stąd, że ciąg (dp (mod 79)) jest ciągiem czysto-okresowym o okresie długości 13, a −1 występuje na piątym miejscu tego okresu. Wobec tego dp ≡ −1 (mod 79) wtedy i tylko wtedy, gdy p = 4 + 13q. Co oznacza, że bn = −1, n ⩾ 13 =⇒ n = 39q + 13. Ponieważ 144m + 13 = 39q + 13 wtedy i tylko wtedy, gdy 48m = 13q, czyli wtedy i tylko wtedy, gdy m = 13r, więc widzimy, że bn (dla n ⩾ 13) może być równy −1 tylko gdy n = 13(144r + 1). Załóżmy więc, że istnieje taka liczba naturalna r, że b13(144r+1) = −1. Wówczas, na mocy (11.29), b144r+1|(−1). Zatem b144r+1 = −1 (bo, jak wiemy, b144r+1 ̸= 1 dla r ⩾ 1). To jest jednak sprzeczne z (11.30). □ S p o s ó b 2. Zauważmy przede wszystkim, że ciąg (bn) jest ciągiem Lucas’a (u(1, −2)n), zobacz D9.3. To oznacza, że bn = αn − βn α − β , (11.31) gdzie α = τ, β = τ spełniają warunki (11.25). Równości (9.19), po przyjęciu n = 4 i n = 12, dają: α4 = −1 + 3β, β4 = −1 + 3α, α12 = −1 − 45β, β12 = −1 − 45α. (11.32) 11.3. Równanie Ramanujana 381 Za pomocą tych równości udowodnimy dwie tożsamości b4k+1 = (−1) k − 6 k∑ j=2 (k j ) (−1)k−j3 j−1bj−1, (11.33) b12k+1 = (−1) k + 90 k∑ j=2 (k j )(−1)k−j(−45) j−1bj−1 (11.34) dla k ⩾ 1. Robi się to podobnie jak przy dowodzie tożsamości Ces`aro w Z9.8: α12k+1 = (α12)kα = (−1 − 45β)kα = (−1)kα + k∑ j=1 (k j ) (−1)k−j(−45β) jα = = (−1) kα − 90 k∑ j=1 ( k j ) (−45) j−1βj−1. Ostatnia równość wynika z równości αβ = 2. Analogicznie: β12k+1 = (−1)kβ − 90 k∑ j=1 ( k j ) (−45) j−1αj−1. Odejmując ostatnie dwie równości stronami, dzieląc przez α − β i korzystając z (11.31) otrzy- mamy (11.34). Zauważmy, że składnik odpowiadający j = 1 możemy opuścić, bo b0 = 0. Podobnie dowodzimy równości (11.33). Załóżmy teraz, że dla pewnego s ⩾ 1 zachodzi równość b16s+13 = −1 i połóżmy k = 4s + 3 w równości (11.33). Wówczas −1 = b16s+13 = b4k+1 = (−1)4s+3 − 6 4s+3∑ j=2 (4s + 3 j ) (−1) 4s+3−j3 j−1bj−1. Stąd 0 = 4s+3∑ j=2 ( 4s + 3 j ) (−1)j−13 j−1bj−1. Po podzieleniu przez 3 i wykorzystaniu równości b1 = b2 = 1 zapiszemy to w postaci (4s + 3 2 ) − 3 ( 4s + 3 3 ) = 4s+3∑ j=4 (4s + 3 j ) (−1) j−13 j−2bj−1, czyli (−2s)(4s + 3)(4s + 2) = 4s+3∑ j=4 ( 4s + 3 j )(−1) j−13 j−2bj−1. 382 11. Równania diofantyczne Ta równość po podzieleniu przez (4s + 3)(4s + 2) i wykorzystaniu prostych własności symbolów dwumiennych Newtona (zobacz tak zwane tożsamości pochłaniania, KOM ) daje −2s = 4s+3∑ j=4 ( 4s + 1 j − 2 )(−1)j−1bj−1 3 j−2 j(j − 1). Dzięki C2.47, z łatwością sprawdzamy, że wykładnik 3-adyczny sumy po prawej stronie jest ⩾ 1. To dowodzi, że 3|s. Widzimy więc, że jeżeli b16s+13 = −1 przy pewnym s ⩾ 1, to s = 3t. Aby skończyć dowód musimy więc jeszcze udowodnić, że przy t ⩾ 1 n i e może zachodzić równość b48t+13 = −1. Załóżmy więc, nie wprost, że b48t+13 = −1 przy pewnym t ⩾ 1 i połóżmy k = 4t + 1 w równości (11.34). Otrzymamy −1 = b48t+13 = b12k+1 = (−1)4k+1 + 90 4t+1∑ j=2 ( 4t + 1 j ) (−1) 4t+1−j(−45) j−1bj−1. Stąd 0 = 4t+1∑ j=2 ( 4t + 1 j )(−1)4t+1−j(−45) j−1bj−1. Po oczywistych uproszczeniach i podzieleniu przez 45 zapiszemy to w postaci równoważnej: − (4t + 1 2 ) = 4t+1∑ j=3 ( 4t + 1 j )45 j−2bj−1. Dzieląc obustronnie przez 4t(4t + 1)/2, podobnie jak przed chwilą, znajdujemy −1 = 2 4t+1∑ j=3 ( 4t − 1 j − 2 )bj−1 45 j−2 j(j − 1), co jest niemożliwe, bo wykładnik 5-adyczny prawej strony jest ⩾ 1. □ Ćwiczenie 11.27 Wykorzystać podane w przykładach P1 i P2 z ustępu 9.5.4 wzory Eulera- Binet’a dla (znacznego) skrócenia czasu żmudnych rachunków (nie) wykonanych w sposobie 1 dowodu lematu L11.2. Ćwiczenie 11.28 Podnieść pierwiastki 6 (mod 8) i 3 (mod 8) równania x2 − x + 2 = 0 w Z/8 do pierwiastków (2 13 −90) (mod 214) i (2 13 +91) (mod 214) tego samego równania w Z/2 14. Napisać wzór Eulera-Binet’a dla redukcji ciągu (bn) modulo 2 14. Spróbować wykorzystać ten wzór dla jeszcze jednego dowodu lematu L11.2. Ćwiczenie 11.29 Wyznaczyć wszystkie liczby trójkątne, które są jednocześnie liczbami Mersenne’a Mn = 2 n − 1. Ćwiczenie 11.30 Zbadać równanie y2 + 11 = 3 n. Ćwiczenie 11.31 Zbadać równanie y2 + 1 = 5 n. 11.4. Równanie indyjskie 383 11.4 Równanie indyjskie W całym paragraﬁe D oznacza liczbę naturalną nie będącą kwadratem. Równanie x2 − Dy2 = 1 (11.35) będziemy nazywali równaniem indyjskim. U w a g a. Euler omyłkowo nazwał równanie (11.35) równaniem Pella i pod tą nazwą funkcjonuje ono w literaturze (matematycznej), mimo że Pell w ogóle się nim nie zajmował. 2 Najuczciwszą nazwą dla tego równania byłaby nazwa równanie Brahmagupty-Bhaskary [znany z geometrii Brahmagupta (VII wiek!) tysiąc lat przed Bachetem podał dowód T2.12, umiał wyznaczyć wszystkie rozwiązania równania x2 − 92y2 = 1, stosując do tego celu tożsamość (8.1); późniejszy o pół tysiąclecia Bhaskara wzmocnił różne wyniki swojego poprzednika – rozwiązanie równania x2 − 61y2 = 1 jest jego zasługą]. Ćwiczenie 11.32 Uzasadnić następującą równość Bhaskary √ a ± √b = √ a + √ a2 − b 2 ± √ a − √a2 − b 2 . 11.4.1 Twierdzenie podstawowe Udowodnimy tu twierdzenie Lagrange’a o istnieniu rozwiązań równania indyjskiego. Zauważmy przede wszystkim, że jeżeli D = d2 jest kwadratem, to lewa strona równania (11.35) rozkłada się na czynniki w Z: x2 − Dy2 = (x + dy)(x − dy). Analiza równania (11.35) w tym przypadku jest trywialna i sprowadza się do rozpatrzenia dwóch układów równań { x + dy = 1 x − dy = 1 lub { x + dy = −1 x − dy = −1 W dalszym ciągu będziemy więc zakładać, że D nie jest kwadratem. Niemniej rozkład lewej strony na czynniki będzie nadal bardzo użyteczny. Chodzi o rozkład (x + y√D)(x − y√D) w pierścieniu kwadratowym Z[τD]. Jasne, że para (x, y) jest rozwiązaniem równania indyjskiego (11.35) wtedy i tylko wtedy, gdy norma elementu x + y√D ∈ Z[τD] jest równa 1. TWIERDZENIE 11.5 Jeżeli D > 1 jest liczbą naturalną nie będącą kwadratem, to rów- nanie indyjskie (11.35) ma nieskończenie wiele rozwiązań w liczbach całkowitych. Ponadto, i s t n i e j e taka liczba α = a1 + b1√ D, gdzie a1, b1 ∈ N, że k a ż d e rozwiązanie równania (11.35) ma postać (±an, ±bn), gdzie liczby całkowite an, bn dostajemy z równości αn = an + bn√D. (11.36) 2Byłoby uczciwszym mówić w tym miejscu o równaniu Fermat’a, który prawdopodobnie znał jakąś ogólną metodę rozwiązywania (jakże inaczej mógłby wiedzieć, że najmniejszym nietrywialnym (tzn. takim, że y ̸= 0) rozwiązaniem równania x2 − 61y2 = 1 jest para (1 766 319 049, 226 153 980)?) 384 11. Równania diofantyczne D O W Ó D. Istnienie nieskończenie wielu rozwiązań równania indyjskiego wywnioskować można natychmiast z równości (7.30), wybierając takie k ∈ N, żeby ks ≡ 0 (mod 2). W ten sposób twierdzenia dowodził Lagrange. Poniżej przedstawiamy konkurencyjne rozumowanie Dirichlet’a. Zaczniemy od lematu: LEMAT 11.3 Istnieje liczba naturalna m, dla której istnieją takie dwie różne pary (h1, k1) i (h2, k2) liczb naturalnych względnie pierwszych, że |h 2 1 − Dk2 1| = |h 2 2 − Dk2 2| = m oraz h1 ≡ h2 (mod m), k1 ≡ k2 (mod m). D o w ó d l e m a t u. Wiemy z T7.4, że istnieje n i e s k o ń c z e n i e w i e l e ułamków nieskra- calnych h k , dla których \f \f \f \fh k − √D\f \f \f \f < 1 2k2 . Dla każdego takiego ułamka mamy \f \f \f \fh k + √D\f \f \f \f = \f \f \f \f h k − √D + 2√D\f \f \f \f ⩽ \f \f \f \fh k − √D\f \f \f \f + 2√D < 1 2k2 + 2√ D ⩽ 1 + 2√D. Oznaczmy M = 1 2 + √D. Wówczas, dla każdego rozważanego ułamka h k zachodzi |h 2 − Dk2| = k2 \f \f \f \fh k − √D\f \f \f \f · \f \f \f \fh k + √D\f \f \f \f < k2 · 1 2k2 · \f \f \f \fh k + √D\f \f \f \f = 1 2 \f \f \f \f h k + √D\f \f \f \f ⩽ M. Stąd wynika, że istnieje taka liczba naturalna m ⩽ M , że dla nieskończenie wielu par (h, k) liczb naturalnych względnie pierwszych zachodzi równość |h 2 − Dk2| = m. Rozważając teraz m 2 + 1 takich par i powołując się na zasadę szuﬂadkową, widzimy, że znajdą się takie dwie r ó ż n e pary (h1, k1) i (h2, k2), które spełniają warunki lematu. □ Przechodzimy do d o w o d u twierdzenia. Weźmy pary (h1, k1) i (h2, k2), których istnienie zapewnia nasz lemat, i rozważmy liczby x = h1h2 − Dk1k2 m , y = −h1k2 + h2k1 m . Twierdzimy, że zachodzi równość |x2 − Dy2| = 1, przy czym x ∈ Z, y ∈ Z̸=0. Sprawdzenie, że x, y ∈ Z jest natychmiastowe. Dla dowodu równości |x2 −Dy2| = 1 oznaczmy ϕ = h1 +k1√D, ψ = h2 + k2√D. Wówczas |N(ϕ)| = |N(ψ)| = m i, jak łatwo sprawdzić, ϕ · ψ′ = mx + my√D. Korzystając z (10.2), mamy zatem m 2 = |N(ϕ)N(ψ)| = |(ϕψ′)(ϕψ′)′| = |(mx + my√D)(mx − my√D)| = m 2|x2 − Dy2|. Stąd |x2 − Dy2| = 1. Ponadto, y ̸= 0, bo h1k2 ̸= h2k1 (równość h1k2 = h2k1, wobec względnej pierwszości par (h1, k1), (h2, k2), dawałaby równość h1 = h2 i k1 = k2, co jest niemożliwe). Mamy więc x2 − Dy2 = 1 lub x2 − Dy2 = −1. W pierwszym przypadku para (x, y) jest n i e t r y w i a l n y m (to znaczy takim, że y ̸= 0) rozwiązaniem równania (11.35). Jeżeli zaś x2 − Dy2 = −1, to, jak łatwo sprawdzić, para (x2 + Dy2, 2xy) jest nietrywialnym rozwiązaniem równania (11.35). W każdym więc razie widzimy, że równanie indyjskie (11.35) m a r o z w i ą z a n i a n i e t r y w i a l n e. 11.4. Równanie indyjskie 385 Ze wszystkich nietrywialnych rozwiązań (x, y), dla których x > 1, y > 0, wybierzmy teraz rozwiązanie z n a j m n i e j s z y m x. Oznaczmy to rozwiązanie (a1, b1). Oznaczmy też α = a1 + b1√ D, β = a1 − b1√D (= α′ = 1 α ) . Liczby α i β są (rzeczywistymi) liczbami dodatnimi, przy czym α > 1, β < 1 i αβ = 1. Ponieważ α > 1, więc ciąg (αn) jest ciągiem rosnącym do nieskończoności. Niech teraz (u, v) będzie dowolnym takim rozwiązaniem równania (11.35), że u, v ∈ N. Wówczas liczba ϕ = u+v√ D jest liczbą rzeczywistą większą od 1. Więc istnieje d o k ł a d n i e j e d e n wykładnik n ∈ N, dla którego zachodzą nierówności αn ⩽ ϕ < αn+1. Mnożąc je przez liczbę (dodatnią) βn otrzymamy nierówności równoważne 1 ⩽ ϕβn < α = a1 + b1√D. Jeżeli teraz zapiszemy (jednoznacznie!) liczbę ϕβn w postaci a + b√ D, a, b ∈ Z, to, a2 − Db2 = N(a + b√D) = N(ϕβn) = N(ϕ)N(β) n = 1, patrz (10.2). Zatem para (a, b) jest (dodatnim) rozwiązaniem równania (11.35). Jednocześnie, na mocy L10.3 z ustępu 10.4.1, a < a1, co, wobec minimalności a1, jest możliwe tylko gdy a = 1. Stąd wynika, że 1 = ϕβn, czyli ϕ = αn co dowodzi równości (11.36). □ U w a g a. Rozwiązanie (a1, b1) równania (11.35) nazywa się rozwiązaniem fundamen- talnym. Można udowodnić, że najefektywniejszą metodą otrzymywania rozwiązań fundamen- talnych równania indyjskiego jest metoda wynikająca z równości (7.30). Mianowicie: jeżeli długość s okresu w rozwinięciu (7.29) jest liczbą parzystą, to rozwiązaniem fundamentalnym jest para (Ps−1, Qs−1); jeżeli zaś s jest liczbą nieparzystą, to rozwiązaniem fundamentalnym jest para (P2s−1, Q2s−1). Trzecia i czwarta kolumna w tabelce z ustępu 7.3.1 pokazują rozwią- zanie fundamentalne odpowiedniego równania indyjskiego (o ile w piątej kolumnie występuje +1; przypadek, gdy występuje tam −1 omówimy w ustępie o równaniu anty-indyjskim). Równanie indyjskie pojawia się w różnych zadaniach. Oto trzy przykłady: ZADANIE 11.11 Wyznaczyć wszystkie trójkąty o bokach, których długości są kolejnymi liczbami naturalnymi i polu będącym liczbą całkowitą. R o z w i ą z a n i e. Niech n − 1, n, n + 1 będą długościami boków pewnego trójkąta (n ∈ Z⩾3). Ponieważ pół -obwód takiego trójkąta wynosi 3n 2 , więc, na mocy wzoru Herona, pole dane jest przez S = √( 3n 2 ) (3n 2 − (n − 1) ) (3n 2 − n) (3n 2 − (n + 1)) = n 4 √3n2 − 12. Aby S było liczbą całkowitą n musi być liczbą parzystą (gdy n jest liczbą nieparzystą, to 3n2 − 12 ≡ 3 (mod 4), nie jest więc kwadratem). Połóżmy więc n = 2x. Wówczas mamy S = x√ 3x2 − 3. Ćwiczenie C2.19 poucza nas, że w takim przypadku 3x2 − 3 jest kwadratem (liczby całkowitej). Oczywiście kwadratem liczby S x podzielnej przez 3. Oznaczając y = S 3x znajdujemy równość x2 − 3y2 = 1. Rozwiązaniem fundamentalnym tego równania jest para (2, 1). Widzimy więc, że najmniejszym poszukiwanym trójkątem jest trójkąt o bokach 3, 4, 5 i polu 6. Kolejnymi są: trójkąt 13, 14, 15 o polu 84 i trójkąt 51, 52, 53 o polu 1170. ♦ 386 11. Równania diofantyczne Ćwiczenie 11.33 Wyznaczyć wszystkie takie n ∈ N, że n(n + 1)/3 jest kwadratem. Ćwiczenie 11.34 Rozwiązać równanie (x + 1)3 − x3 = y2 w liczbach całkowitych. 11.4.2 Interpretacje Opowiemy tu o dwóch sposobach myślenia o równaniu indyjskim. Związek z ciągami rekurencyjnymi Niech, przy ustalonym D > 1 bezkwadratowym, para (A, B) = (a1, b1) będzie rozwiązaniem fundamentalnym równania indyjskiego (11.35). Wynikająca z (11.36) równość an+1 + bn+1√D = (A + B√ D)(an + bn√D) po wymnożeniu i wykorzystaniu niewymierności √D, daje układ równości { an+1 = Aan + BDbn, bn+1 = Ban + Abn. Z tego układu równości rekurencyjnych wnioskujemy, że oba ciągi (an) i (bn) są elementami zbioru Rek(2A, −1), czyli że oba spełniają równanie rekurencyjne xn+2 = 2Axn+1 − xn. (11.37) Istotnie, an+2 = Aan+1 + BDbn+1 = Aan+1 + BD(Ban + Abn) = Aan+1 + B2Dan + A · BDbn = Aan+1 + B2Dan + A(an+1 − Aan) = 2Aan+1 − (A2 − B2D)an = 2Aan+1 − an. Tak samo sprawdzamy, że (bn) ∈ Rek(2A, −1). Warunkami początkowymi dla tych ciągów są: a0 = 1, a1 = A oraz b0 = 0, b1 = B, odpowiednio. Zauważmy, że wyróżnik wielomianu charakterystycznego równania rekurencyjnego (11.37) jest równy 4B2D. Istotnie, 4A 2 − 4 = 4(A2 − 1) = 4B2D. ZADANIE 11.12 Wyznaczyć dwie najmniejsze wartości s ∈ N, dla których liczby 7s + 1 i 42s + 7 są jednocześnie kwadratami liczb naturalnych. R o z w i ą z a n i e. Załóżmy, że 42s + 7 = x2 i 7s + 1 = y2, x, y > 0. Wówczas x2 − 6y2 = 1. (11.38) Co oznacza, że para (x, y) jest dodatnim rozwiązaniem równania indyjskiego (11.35) z D = 6. O tym równaniu wiemy, że ma rozwiązanie fundamentalne (5, 2) odpowiadające liczbie α = 5 + 2√6. Z twierdzenia T11.5 i opisanego związku z ciągami rekurencyjnymi, wnosimy, że (x, y) = (an, bn) dla pewnego n, gdzie ciągi (an) i (bn) spełniają to samo równanie 11.4. Równanie indyjskie 387 rekurencyjne xn+2 = 10xn+1 − xn, przy czym: a0 = 1, a1 = 5 oraz b0 = 0, b1 = 2. Musimy wyznaczyć takie dwa najmniejsze indeksy n, by b2 n − 1 ≡ 0 (mod 7). Dla takich n, wobec równości (11.38), mamy też a2 n − 7 ≡ 0 (mod 42) i s = b2 n − 1 7 = a2 n − 7 42 są poszukiwanymi wartościami s. Zredukujmy ciąg (bn) modulo 7: bn (mod 7) : 0, 2, 6 , 2, 0, 5, 1 , 5, 0, 2, . . . . Ciąg zredukowany jest okresowy, porównaj T9.7. Widzimy stąd, że pierwszymi dwoma indek- sami n, dla których b2 n ≡ 1 (mod 7) są n = 2 i n = 6. Odpowiednie wartości s: s = s2 = b2 2 − 1 7 = 57, s = s6 = b2 6 − 1 7 = 192060 2 − 1 7 = 5 269 577 657. Tej drugiej wartości zapewne nie byłoby łatwo znaleźć metodą prób i błędów... . ♦ Interpretacja geometryczno-algebraiczna: Hiperbola z mnożeniem Równanie indyjskie x2 − Dy2 = 1 jest równaniem hiperboli HD o asymptotach x = ± √Dy. Rozwiązania tego równania (w interpretacji geometrycznej) są punktami kratowymi, przez które przechodzi ta hiperbola. Jest rzeczą bardzo interesującą i niezwykłą, że taka hiperbola prze- chodzi przez nieskończenie wiele punktów kratowych. Na rysunku 11.1 widzimy sześć punktów kra- towych na hiperboli H2. Punkt F = (3, 2) jest rozwiązaniem fundamentalnym równania x2 − 2y2 = 1. W zbiorze HD określimy działanie ∗: (x, y) ∗ (u, v) = (xu + Dyv, xv + yu). Ćwiczenie 11.35 Udowodnić, że powyższa formuła zadaje działanie w zbiorze HD i że dzia- łanie to jest ł ą c z n e i p r z e m i e n n e, a punkt (1, 0) jest elementem neutralnym. Rys. 11.1 F Ćwiczenie 11.36 Udowodnić, że element (x, y)′ = (x, −y) jest elementem odwrotnym do elementu (x, y). Wywnioskować stąd, że (HD, ∗) jest grupą. Ćwiczenie 11.37 Niech H+ D = {(x, y) : x2 − Dy2 = 1, x > 0} oznacza ”prawą” gałąź hiperboli HD. Udowodnić, że H+ D jest podgrupą w (HD, ∗). 388 11. Równania diofantyczne 11.4.3 Równanie anty -indyjskie Niech D ∈ N nie będzie kwadratem. Nieco żartobliwą nazwę równanie anty-indyjskie: x2 − Dy2 = −1 (11.39) będziemy w dalszym ciągu traktować poważnie. Na rysunku 11.2 mamy hiperbolę o równaniu x2 − 2y2 = −1 i osiem punktów kratowych na niej. Punkt F ′ = (1, 1) jest generatorem. Ćwiczenie 11.38 Udowodnić, że jeżeli para (u1, v1) jest rozwiązaniem równania anty- indyjskiego (11.39), to para (un, vn) wyznaczona z równości (u1 + v1√ D) n = un + vn√D jest, przy n parzystym, rozwiązaniem równania indyjskiego (11.35), a przy n nieparzystym, rozwiązaniem równania anty-indyjskiego (11.39). Rys. 11.2 F` W tym sensie rozwiązania równania anty-indyjskiego są bardziej ”fundamentalne” niż rozwią- zania równania indyjskiego. Ich wadą jest to, że n i e z a w s z e i s t n i e j ą. P r z y k ł a d 1. Ponieważ (1 + √2) 7 = 239 + 169√2, a para (1, 1) jest rozwiązaniem równania x2 − 2y2 = −1, więc i para (239, 169) jest rozwiązaniem tego równania. ♦ P r z y k ł a d 2. Weźmy D = 8. Jasne, że (3, 1) jest rozwiązaniem równania indyjskiego. Jest to rozwiązanie fundamentalne. Odpowiednie równanie anty-indyjskie nie ma rozwiązań. Istotnie, gdyby x2 − 8y2 = −1, to x2 ≡ −1 (mod 4), co jest niemożliwe. ♦ U w a g a. Można udowodnić, że równanie anty-indyjskie (11.39) ma rozwiązania wtedy i tylko wtedy, gdy liczba s (długość okresu) występująca w równości (7.29) jest nieparzysta. W takim przypadku rozwiązaniem fundamentalnym równania (11.39) jest para (Ps−1, Qs−1). W tabelce z ustępu 7.3.1 zaznaczono ten przypadek znakiem −1 w piątej kolumnie. Ciekawym wyzwaniem dla młodego matematyka byłoby podanie arytmetycznej charakteryzacji tych liczb D, dla których s jest liczbą nieparzystą. ZADANIE 11.13 Wyznaczyć wszystkie trójkąty prostokątne o długościach boków będą- cych liczbami całkowitymi i takimi, że jedna przyprostokątna jest o 1 dłuższa od drugiej. R o z w i ą z a n i e. Oznaczmy przez u długość krótszej przyprostokątnej, a przez y długość przeciwprostokątnej. Wówczas u2 + (u + 1) 2 = y2 czyli (2u + 1) 2 − 2y2 = −1. Widzimy więc, że szukamy wszystkich rozwiązań (x, y) równania anty-indyjskiego x2 − 2y2 = −1, (11.40) w których x jest nieparzyste (i > 1!). Ponieważ rozwiązaniem fundamentalnym równania (11.40) jest para (1, 1), więc wszystkie rozwiązania (xk, yk) znajdujemy z równości (1 + √2) 2k+1 = (1 + √2)(3 + 2√2) k = xk + yk√ 2. 11.4. Równanie indyjskie 389 Jasne więc, że xk+1 = 3xk + 4yk. Zatem xk+1 ≡ xk ≡ . . . ≡ x1 ≡ 3 (mod 2) jest liczbą nieparzystą dla każdego k. ♦ Ćwiczenie 11.39 Udowodnić, że istnieje nieskończenie wiele takich liczb naturalnych n, dla których n2+1|n!. Wskazówka. Równanie n2−5k2 = −1 ma nieskończenie wiele rozwiązań. 11.4.4 Ogólne równanie indyjskie Nie będziemy dowodzić żadnych twierdzeń na temat ogólnego równania indyjskiego (11.41). W jednym zadaniu pokażemy tylko przykładowy sposób postępowania z takimi równaniami. Ogólnym równaniem indyjskim nazwiemy równanie P x2 − Qy2 = R, (11.41) gdzie P, Q ∈ N, są liczbami bezkwadratowymi, R ∈ Z. U w a g a 1. Oznaczmy NWD (P, Q) = d. Wówczas, jeżeli d ∤ R, to równanie (11.41) na pewno n i e m a rozwiązań w liczbach całkowitych x, y. Jeżeli zaś d|R, to dzieląc obustronnie przez d, otrzymamy równanie r ó w n o w a ż n e P ′x2 − Q ′y2 = R′, gdzie P ′, Q′ są względnie pierwsze. Możemy więc od początku zakładać, że w równaniu (11.38) współczynniki P, Q są względnie pierwsze. U w a g a 2. Jedno konkretne rozwiązanie równania (11.41) powinniśmy znaleźć ”na pie- chotę”, czyli po prostu o d g a d n ą ć. Pewną pomocą mogą tu służyć wzory (2.12). U w a g a 3. Załóżmy teraz, że R = ±1. Wówczas, jeżeli jeden ze współczynników P, Q jest równy 1, to mamy do czynienia z równaniem indyjskim lub anty-indyjskim. Niech więc P, Q ̸= 1. W takiej sytuacji główną sztuczką podczas rozwiązywania naszego równania jest sprowadzanie lewej strony do postaci normowej: P x2 − Qy2 = (x√ P + y√ Q)(x√P − y√ Q). (11.42) Ćwiczenie 11.40 Zakładamy, że P, Q są względnie pierwszymi liczbami naturalnymi bez- kwadratowymi. Uzasadnić, że jeżeli n ∈ N jest wykładnikiem p a r z y s t y m, to dla dowolnych całkowitych a, b zachodzą równości: (a√P + b√ Q) n = An + Bn√P Q, (a√P − b√ Q) n = An − Bn√ P Q, przy pewnych całkowitych An = An(a, b), Bn = Bn(a, b). Jeżeli zaś n ∈ N jest wykładnikiem n i e p a r z y s t y m, to dla dowolnych całkowitych a, b zachodzą równości: (a√P + b√ Q) n = Cn√P + Dn√ Q, (a√P − b√ Q) n = Cn√P − Dn√ Q, przy pewnych całkowitych Cn = Cn(a, b), Dn = Dn(a, b). 390 11. Równania diofantyczne Powyższe uwagi i ćwiczenie można zobaczyć w działaniu w poniższym zadaniu: ZADANIE 11.14 Udowodnić, że równanie 7x2 − 3y2 = 67 ma nieskończenie wiele roz- wiązań w liczbach całkowitych x, y. R o z w i ą z a n i e. Zgodnie z U2, zgadujemy jedno rozwiązanie: 7 · 5 2 − 3 · 6 2 = (5 √7 + 6√ 3)(5 √ 7 − 6 √3) = 67. Również równanie pomocnicze 7x2 − 3y2 = 1 ma łatwe do odgadnięcia rozwiązanie: 7 · 2 2 − 3 · 3 2 = (2 √7 + 3√3)(2 √7 − 3 √ 3) = 1. Korzystając z ćwiczenia C11.40, łatwo wykazać, że jeżeli, przy dowolnym k ∈ N, przedstawimy liczbę (5 √7 + 6√ 3)(2 √ 7 + 3√3) 2k−1 w postaci Uk√7 + Vk√3, gdzie Uk, Vk ∈ N, to para (Uk, Vk) jest rozwiązaniem równania 7x2 − 3y2 = 67. Ponadto, Uk → ∞. ♦ 11.4.5 Kilka zadań Proponujemy jeszcze kilka zadań ”na” równanie indyjskie (lub podobne). Ćwiczenie 11.41 Niech (an), (bn) będą dwoma ciągami wyznaczonymi przez warunki a1 = 3, b1 = 2 i rekurencję { an+1 = 3an + 4bn, bn+1 = 2an + 3bn. Udowodnić, że dla każdego n zachodzi równość an + 2bn = ⌊(an + bn) √ 2 ⌋. Ćwiczenie 11.42 Wyznaczyć najmniejszą liczbę n a t u r a l n ą n, dla której liczby 19n+1 i 95n + 1 są kwadratami liczb całkowitych. Ćwiczenie 11.43 Udowodnić, że równanie x2 + y2 + z2 + 2xyz = 1 ma nieskończenie wiele rozwiązań w takich liczbach całkowitych x, y, z, że |x|, |y|, |z| ⩾ 2011. Ćwiczenie 11.44 Istnieje nieskończenie wiele n ∈ N takich, że 3n + 1 i n + 1 są kwadra- tami. Udowodnić, że jeżeli nk jest k-tą taką liczbą, to nknk+1 + 1 również jest kwadratem. Ćwiczenie 11.45 W urnie jest n kul białych i m kul czarnych. Prawdopodobieństwo, że dwie wyciągnięte losowo kule są tego samego koloru wynosi dokładnie 1 2. Wyznaczyć możliwe wartości m, n. Ćwiczenie 11.46 Wyznaczyć nieujemne m, n, dla których ( n m ) = ( n−1 m+1 ) . 11.5. Punkty wymierne na prostych i na stożkowych 391 Ćwiczenie 11.47 Wyznaczyć rozwiązania w liczbach całkowitych układu równań { 2uv − xy = 16, xv − uy = 12. Wskazówka. Zauważyć, że 16 2 − 2 · 12 2 = −32. Ćwiczenie 11.48 Czy średnia kwadratowa liczb 1, 2, . . . , n może być liczbą całkowitą? Wskazówka. Zobacz C1.2.1. Ćwiczenie 11.49 Rozwiązać w liczbach naturalnych (1 + x2)(1 + y2) = 1 + z2. Ćwiczenie 11.50 Wyznaczyć liczby naturalne a, b, dla których ab|a2 + b2 + 1. Ćwiczenie 11.51 Trzywyrazowy ciąg arytmetyczny (1, 8, 15) ma taką własność, że ilo- czyn każdych dwóch wyrazów jest postaci x2 − 1. Wyznaczyć inne takie ciągi. Ćwiczenie 11.52 Rozważmy kongruencję indyjską x2 − Dy2 ≡ 1 (mod m). Oznaczmy przez I(D, m) zbiór wszystkich rozwiązań takiej kongruencji (w Z/m × Z/m). Wprowa- dzić strukturę grupową w zbiorze I(D, p). Czy grupa ta jest cykliczna? Udowodnić, że |I(D, pn)| = pn−1|I(D, p)|. Ćwiczenie 11.53 Rozwiązać równanie x3 − 3y3 = 1 w liczbach całkowitych. Wskazówka. Zapisać to równanie w postaci (x − 1)(x − ω)(x − ω2) = −ωλ 2y3, zob. C10.75, i postępować według wzoru z ustępu 11.2.3 dla dowodu, że jedynym rozwiązaniem jest rozwiązanie trywialne (x, y) = (1, 0). 11.5 Punkty wymierne na prostych i na stożkowych W tym paragraﬁe zajmiemy się rozwiązaniami równań diofantycznych postaci ϕ(x, y) = 0, gdzie ϕ(X, Y ) jest wielomianem o współczynnikach wymiernych. Mnożąc obie strony tego równania przez wspólny mianownik wszystkich współczynników otrzymamy r ó w n o w a ż n e równanie o współczynnikach całkowitych. Odtąd zakładamy więc, że ϕ(X, Y ) ∈ Z[X, Y ]. Jeżeli ϕ jest takim wielomianem, a R jest pierścieniem, to oznaczamy N (ϕ; R) = {(x, y) ∈ R × R : ϕ(x, y) = 0}. W szczególności N (ϕ; Q) oznacza zbiór rozwiązań równania ϕ(x, y) = 0 w liczbach wymier- nych, a N (ϕ; Z) zbiór rozwiązań tego równania w liczbach całkowitych. Ćwiczenie 11.54 Niech ϕ(X, Y ) = X 2 + Y 2 − 1. Opiszcie zbiory N (ϕ; R), N (ϕ; Q), N (ϕ; Z), N (ϕ; Z/7), N (ϕ; Z/8) i, jeżeli wystarczy wam wyobraźni, N (ϕ; C). W dalszym ciągu ograniczymy się do badania wielomianów ϕ stopnia pierwszego, drugiego i (w paragraﬁe 11.6) trzeciego. Będziemy się zajmowali głównie rozwiązaniami w y m i e r n y m i. 392 11. Równania diofantyczne Równania stopnia pierwszego Przypadek deg ϕ = 1 jest bardzo prosty. Niech ϕ(X, Y ) = aX + bY + c ∈ Z[X, Y ] będzie wielomianem stopnia pierwszego o współ- czynnikach całkowitych. Równanie ϕ(x, y) = ax + by + c = 0 (11.43) jest, jak to dobrze wiemy, r ó w n a n i e m p r o s t e j na płaszczyźnie. Zbiór N (ϕ; R) jest więc prostą. Jego podzbiór N (ϕ; Q) rozwiązań wymiernych jest, w tej interpretacji, zbiorem punktów o obu współrzędnych wymiernych, przez które ta prosta przechodzi. ZADANIE 11.15 Opisać punkty wymierne na prostej o równaniu (11.43). R o z w i ą z a n i e. Opis, o który nam chodzi jest tak zwanym opisem parametrycznym. Otrzymujemy go, w tym przypadku, bardzo prosto. Załóżmy, że (x0, y0) jest dowolnym punk- tem wymiernym leżącym na tej prostej. Taki punkt łatwo znaleźć. Gdy b ̸= 0, to wystarczy wziąć (x0, y0) = ( 0, − c b ). Wówczas { xλ = x0 + bλ yλ = y0 − aλ (11.44) jest, oczywiście, szukanym opisem parametrycznym zbioru (w s z y s t k i c h) punktów wymier- nych na badanej prostej. To znaczy, że każdy punkt wymierny leżący na tej prostej jest postaci (xλ, yλ) dla pewnego λ ∈ Q i odwrotnie, równości (11.44) pozwalają każdej liczbie wymiernej λ przyporządkować punkt wymierny (xλ, yλ) na prostej. ♦ W T2.12 opisaliśmy zbiór N (ϕ; Z). Wiemy więc, że jest on niepusty wtedy i tylko wtedy, gdy NWD (a, b)|c. Wzory (2.12) stanowią opis parametryczny tego zbioru. Równania stopnia drugiego Teraz zajmiemy się ogólnym równaniem stopnia drugiego dwóch zmiennych, ale będziemy po- szukiwać r o z w i ą z a ń w y m i e r n y c h. Niech dany będzie wielomian stopnia 2 dwóch zmiennych: ϕ(X, Y ) = aX 2 + bXY + cY 2 + dX + eY + f ∈ Z[X, Y ]. (11.45) Zbiór wszystkich rzeczywistych rozwiązań równania ϕ(x, y) = 0, czyli zbiór N (ϕ; R) = {(x, y) ∈ R2 : ϕ(x, y) = 0} jest krzywą na płaszczyźnie. Taka krzywa nazywa się krzywą stożkową. W zależności od współczynników a, b, . . . , f może to być elipsa (w szczególnym przypadku: okrąg), parabola lub hiperbola. Możemy też mieć do czynienia z przypadkami z d e g e n e r o w a n y m i: krzywa może być w istocie parą prostych lub jedną prostą. Czasami (na płaszczyźnie rzeczywistej) może to być zbiór jednopunktowy, a nawet zbiór pusty. P r z y k ł a d 1. Jasne, że jeżeli wielomian ϕ rozkłada się na iloczyn wielomianów pierwszego stopnia: ϕ(X, Y ) = (aX + bY + c)(pX + qY + r), to krzywa N (ϕ; R) jest sumą teorio- mnogościową prostych o równaniach ax + by + c = 0 i px + qy + r = 0. ♦ 11.5. Punkty wymierne na prostych i na stożkowych 393 Ćwiczenie 11.55 Naszkicować krzywe N (ϕ; R) dla poniższych wielomianów ϕ(X, Y ): 1. ϕ(X, Y ) = X 2 + 2Y 2 − 2X + 16Y + 24, 2. ϕ(X, Y ) = Y 2 − 3X − 2Y − 2, 3. ϕ(X, Y ) = XY − 2X + Y − 5, 4. ϕ(X, Y ) = 2X 2 + XY − Y 2 + 3Y − 2, 5. ϕ(X, Y ) = X 2 + 4XY + 4Y 2 + 2X + 4Y + 1, 6. ϕ(X, Y ) = X 2 + Y 2 − 2X + 4Y + 5, 7. ϕ(X, Y ) = 2X 2 − 2XY + 5Y 2 + 1. Ćwiczenie 11.56 Udowodnić, że na okręgu o równaniu x2 + y2 = 3 nie leży ani jeden punkt wymierny. Ogólniej: jeżeli p jest liczbą pierwszą i p ≡ 3 (mod 4), to na okręgu o równaniu x2 + y2 = p nie leży ani jeden punkt wymierny. A co gdy p ≡ 1 (mod 4)? Widzimy, że w przypadku niezdegenerowanych krzywych drugiego stopnia (stożkowych) sytuacja jest inna niż w przypadku krzywych pierwszego stopnia (czyli prostych). Tam, wy- mierność współczynników gwarantowała niepustość zbioru N (ϕ; Q), tu, n i e g w a r a n t u j e. Jednakże, gdy zbiór N (ϕ; Q) zawiera choćby jeden element, to zawiera ich nieskończenie wiele i, co więcej, można je (prawie) wszystkie opisać parametrycznie. Mówi o tym poniższe: TWIERDZENIE 11.6 Niech ϕ(X, Y ) ∈ Z[X, Y ] będzie takim wielomianem drugiego stopnia, że N (ϕ; R) jest stożkową niezdegenerowaną. Załóżmy, że zbiór N (ϕ; R) zawiera punkt w y m i e r n y (czyli że N (ϕ; Q) ̸= ∅). Wówczas zbiór ten zawiera nieskończenie wiele punktów wymiernych. Ponadto, istnieje parametryczny opis prawie całego zbioru N (ϕ; Q). D O W Ó D. Załóżmy, że A = (k, l) jest punktem krzywej N (ϕ; R). Prowadzimy przez punkt A wszystkie proste. Każda taka prosta pλ (z wyjątkiem prostej x = k) ma równanie postaci y − l = λ(x − k), gdzie λ ∈ R jest dowolnym parametrem. Wyznaczamy drugi punkt (xλ, yλ) przecię- cia prostej pλ z krzywą N (ϕ; R). To, oczy- p l llx y,( ) Rys. 11.3 A = ( )k ,l wiście, oznacza, że wyznaczamy drugie, obok (k, l), rozwiązanie układu równań { ax2 + bxy + cy2 + dx + ey + f = 0, y − l = λ(x − k). Podstawiając y = λ(x − k) + l do pierwszego równania, otrzymamy równanie kwadratowe z parametrem λ (jeżeli, co zakładamy w dalszym ciągu, a + bλ + cλ 2 ̸= 0) o niewiadomej x: [ a + bλ + cλ2] x2 + [d + bl + (2cl − bk + e)λ + 2ckλ 2] x + c(l − kλ) 2 + e(l − kλ) + f = 0. O tym równaniu wiemy, że ma ono pierwiastek równy k. Drugi pierwiastek xλ wyznaczamy ze wzoru Vi`ete’a: k + xλ = −d + bl + (−bk + 2cl + e)λ + 2ckλ 2 a + bλ + cλ2 . 394 11. Równania diofantyczne Następnie wyznaczamy yλ (z równości yλ = λ(xλ − k) + l). Dostaniemy ostatecznie:  || || xλ = −(ak + bl + d) − (2cl + e)λ + ckλ 2 a + bλ + cλ2 , yλ = al − (2ak + d)λ − (cl + bk + e)λ2 a + bλ + cλ2 . (11.46) Zapamiętywanie wzorów (11.46) nie jest celowe – w każdym konkretnym przypadku wypro- wadzamy odpowiednie wzory od początku, pamiętając jedynie sposób postępowania. Otrzy- maliśmy w ten sposób opis parametryczny (prawie) wszystkich punktów krzywej N (ϕ; R): Gdy parametr λ przebiega zbiór R, to punkt (xλ, yλ) przebiega wszystkie punkty krzywej N (ϕ; R), z ewentualnym wyjątkiem drugiego punktu przecięcia prostej x = k z krzywą. Dotychczas nie wykorzystywaliśmy wymierności punktu (k, l). Wobec tego, opis postaci (11.46) jest możliwy dla każdej stożkowej niezdegenerowanej przechodzącej przez znany punkt (k, l). My interesujemy się teraz elementami zbioru N (ϕ; Q) p u n k t ó w w y m i e r n y c h krzywej o równaniu ϕ(x, y) = 0. Załóżmy więc, że punkt A = (k, l) ma obie współrzędne wymierne (i leży na krzywej N (ϕ; R)). Wówczas wszystkie proste pλ (przechodzące przez A) i mające w y m i e r n y współczynnik kierunkowy λ przecinają krzywą (po raz drugi) w punkcie (xλ, yλ) o o b u w s p ó ł r z ę d n y c h w y m i e r n y c h. I odwrotnie: jeżeli punkt B = (c, d) ∈ N (ϕ; Q) jest punktem wymiernym, to prosta AB ma wymierny współczynnik kierunkowy. Czytelnik łatwo uzasadni oba powyższe stwierdzenia. □ Ilustracją twierdzenia T11.6 jest (nasz) trzeci sposób wyznaczania trójek pitagorejskich: ZADANIE 11.16 Wyznaczyć trójki pitagorejskie. R o z w i ą z a n i e. Niech (a, b, c) będzie niezerową trójką pitagorejską. Wówczas punkt (x, y) = (a/c, b/c) jest punktem wymiernym dodatniej ćwiartki okręgu o równaniu x2 + y2 = 1. Czyli jest drugim punktem przecięcia prostej pλ o równa- niu y = λ(x + 1) z okręgiem jednostkowym, zobacz rysu- nek 11.4, gdzie widzimy, że λ = tg ϕ jest współczynnikiem kierunkowym. Jej drugi punkt przecięcia z okręgiem ma, jak łatwo sprawdzić, współrzędne p l llx y,( ) Rys. 11.4 ( ),1 0 _ j x = xλ = (1 − λ2)/(1 + λ 2), y = yλ = (2λ)/(1 + λ2). Ponieważ x = a/c, y = b/c więc otrzymamy stąd a 1−λ2 = c 1+λ2 = b 2λ. Oznaczając przez µ wspólną wartość tych trzech ułamków dostaniemy: a = (1 − λ 2) µ, b = 2λµ, c = (1 + λ2) µ. Jeżeli 0 < λ < 1 i µ > 0 są liczbami wymiernymi, to powyższe wzory dają wszystkie do- datnie w y m i e r n e trójki pitagorejskie. Ponieważ interesują nas trójki pitagorejskie (liczb naturalnych), więc połóżmy λ = t/s (ułamek nieskracalny), t, s ∈ N. Wówczas dostajemy a = (s2 − t 2)µ′, b = 2stµ′, c = (s2 + t 2)µ′, 11.5. Punkty wymierne na prostych i na stożkowych 395 gdzie µ′ = µ/s 2. Oznaczmy d = NWD (s2 − t2, 2st, s2 + t 2). Wiemy, zobacz C11.57, że d = 1 lub d = 2. W przypadku d = 1 widać, że s ̸≡ t (mod 2), µ′ ∈ N, więc dostajemy trójkę pierwotną, gdy µ′ = 1. W przypadku d = 2 widać, że s ≡ t ≡ 1 (mod 2) i wówczas, kładąc u = (s + t)/2, v = (s − t)/2, widzimy, że (s2 − t 2)/2 = 2uv, st = u2 − v2, (s2 + t2)/2 = u2 + v2, więc, przy µ′ = 1/2, dostajemy trójkę pierwotną jak w T2.20. ♦ Ćwiczenie 11.57 Uzasadnić, że jeżeli liczby całkowite s, t są względnie pierwsze, to naj- większym wspólnym dzielnikiem liczb s2 − t 2, 2st, s2 + t 2 jest 1 lub 2. Taką samą technikę zastosujmy w kolejnym zadaniu: ZADANIE 11.17 Wyznaczyć wszystkie trójki kwadratów liczb wymiernych tworzące ciąg arytmetyczny. R o z w i ą z a n i e. Szukamy (wszystkich) takich liczb wymier- nych a, b, c > 0, dla których c2−a2 = b2−c2, czyli a2+b2 = 2c2, więc równoważnie: (a c )2 + ( b c )2 = 2, p l llx y,( ) Rys. 11.5 ( ),1 __ 1 __ co oznacza, że punkt (a/c, b/c) jest punktem wymiernym na dodatniej części okręgu o rów- naniu x2 + y2 = 2. Widzimy punkt wymierny (−1, −1) leżący na tym okręgu. Wyznaczamy interesujące nas punkty wymierne zgodnie z wyłożoną techniką: Prosta pλ przechodząca przez (−1, −1) ma równanie y = λx + λ − 1. Oznaczymy drugi punkt przecięcia tej prostej z okręgiem x2 + y2 = 2 przez (xλ, yλ). Punkt (xλ, yλ) znajdujemy wyznaczając drugie, obok (−1, −1), rozwiązanie układu równań { x2 + y2 = 2 y = λx + λ − 1 (11.47) Podstawiając λx + λ − 1 w miejsce y w pierwszym z tych równań i porządkując, otrzymamy (λ 2 + 1)x2 + 2λ(λ − 1)x + (λ − 1) 2 − 2 = 0. Wiemy, że to równanie kwadratowe względem x ma pierwiastek −1 (bo para (−1, −1) jest rozwiązaniem układu (11.47)). Drugi pierwiastek xλ, na mocy wzoru Vi`ete’a, spełnia więc równość (−1) · xλ = ((λ − 1) 2 − 2)/(λ2 + 1). Wobec tego xλ = −λ 2 + 2λ + 1 λ2 + 1 , yλ = λ2 + 2λ − 1 λ2 + 1 . Stąd, podobnie jak w rozwiązaniu Z11.16, a = (−λ 2 + 2λ + 1)µ, c = (λ 2 + 1)µ, b = (λ 2 + 2λ − 1)µ, (11.48) gdzie λ ∈ ( √2 − 1; √ 2 + 1 ), a µ jest dowolną liczbą wymierną (dodatnią). Zauważmy, że λ = 1 wyznacza stały ciąg arytmetyczny a2 = b2 = c2. ♦ 396 11. Równania diofantyczne Ćwiczenie 11.58 Opisać wszystkie trójki a2, b2, c2 kwadratów liczb c a ł k o w i t y c h two- rzące ciąg arytmetyczny. Ćwiczenie 11.59 Wyznaczyć wszystkie rozwiązania równania x2 + 5y2 = 6z2 w Z. Ćwiczenie 11.60 Udowodnić, że istnieje nieskończenie wiele parami niepodobnych trójką- tów o bokach długości całkowitej i jednym z kątów o mierze 60 ◦ . Powiemy jeszcze dwa słowa na temat m o m e n t u k l u c z o w e g o: skąd wziąć jeden punkt wymierny w N (ϕ; R)? Wiemy, że takiego punktu może w ogóle nie być (zobacz na przykład C2.66)! Gdy istnieją punkty wymierne, to czasami udaje się je wykryć. Kryterium, za pomocą którego można w skończonej liczbie kroków rozstrzygnąć czy takie punkty istnieją, pochodzi od Legendre’a: TWIERDZENIE 11.7 (Twierdzenie Legendre’ a) Załóżmy, że a, b, c ∈ Z są parami względnie pierwszymi liczbami bezkwadratowymi różnych znaków. Wówczas równanie ax2 + by2 + cz2 = 0 ma niezerowe rozwiązanie w liczbach całkowitych wtedy i tylko wtedy, gdy (−ab)R|c|, (−ac)R|b|, (−bc)R|a|. ▶ Dowód implikacji (⇐=) jest dość trudny. Ale: Ćwiczenie 11.61 Udowodnić implikację (=⇒) twierdzenia Legendre’a. W poniższym przykładzie zobaczymy jak to działa. P r z y k ł a d 2. Rozważmy wielomian ϕ(X, Y ) = 23X 2 + 8XY + 17Y 2 − 48X − 54Y + 50. Wykażemy, że zbiór N (ϕ; Q) jest p u s t y. Aby to zobaczyć przesuniemy najpierw układ współrzędnych tak, by w nowym układzie współrzędnych nasza krzywa miała równanie (dru- giego stopnia, oczywiście) bez wyrazów stopnia pierwszego. Analitycznie oznacza to, że szu- kamy takich stałych α, β, dla których wielomian ϕ(U + α, V + β) zmiennych U, V nie ma wyrazów stopnia pierwszego. Wyznaczymy takie stałe w ogólnym przypadku (11.45). Mamy: ϕ(U + α, V + β) = ϕ(α, β) + (d + 2aα + bβ)U + (e + bα + 2cβ)V + aU 2 + bU V + cV 2. Wystarczy więc rozwiązać układ równań { 2aα + bβ = −d, bα + 2cβ = −e. Ten układ ma rozwiązanie α = 2cd − be ∆ , β = 2ae − bd ∆ , 11.5. Punkty wymierne na prostych i na stożkowych 397 gdzie ∆ = b2 − 4ac. Trzeba tu, oczywiście, mieć pewność, że ∆ ̸= 0. W naszym przypadku mamy więc α = 4 5, β = 7 5. Ponadto ϕ ( 4 5, 7 5) = −7. Stąd widzimy, że (x0, y0) ∈ N (ϕ; Q) wtedy i tylko wtedy, gdy (x0 − 4 5, y0 − 7 5) ∈ N (ψ; Q), gdzie ψ(X, Y ) = 23X 2 + 8XY + 17Y 2 − 7. Chcemy się teraz pozbyć wyrazu ”mieszanego” 8XY . W metrycznej geometrii analitycznej robi się to za pomocą stosownego obrotu. Jednakże, ponieważ po obrocie punkty wymierne zazwyczaj przestają być wymiernymi, a my chcemy mieć kontrolę nad wymiernością punktów, więc musimy się uciec do wymiernego przekształcenia liniowego (to znaczy zadanego przez macierz o wyrazach wymiernych). Robi się to przez standardową procedurę uzupełniania do p e ł n e g o k w a d r a t u: 23ψ(X, Y ) = (23X + 4Y ) 2 + 15 · (5Y ) 2 − 161. Widzimy stąd, że jeżeli (x0, y0) ∈ N (ϕ; Q), to ( 23 ( x0 − 4 5 ) + 4 (y0 − 7 5 ) , 5 (y0 − 7 5 )) = (23x0 + 4y0 − 24, 5y0 − 7) ∈ N (χ; Q), gdzie χ(X, Y ) = X 2 + 15Y 2 − 161. Gdyby jednak punkt wymierny (u/w, v/w) należał do N (χ; Q), to mielibyśmy u2 + 15v2 − 161w2 = 0. Ale, jak łatwo sprawdzić, 161N15, więc, na mocy T11.7, mamy sprzeczność. ♦ Ćwiczenie 11.62 Sprawdzić, że stożkowa 7x2 + 22xy − 2y2 + 2x + 16y − 9 = 0 przechodzi przez nieskończenie wiele punktów wymiernych. Przy okazji rozwiążemy interesujące zadanie z LXIV OM3: ZADANIE 11.18 Załóżmy, że wielomian f (X) ∈ Z[X] wyznacza funkcję różnowarto- ściową na Q. Czy stąd wynika, że również funkcja wyznaczona przez f (X) na R jest różno- wartościowa? R o z w i ą z a n i e. Mówiąc inaczej: czy jeżeli f (x) ̸= f (y) dla wszystkich x ̸= y ∈ Q, to f (x) ̸= f (y) dla wszystkich x ̸= y ∈ R? Odpowiedź: n i e. Niech f (X) będzie wielomianem o współczynnikach całkowitych. Wówczas (zobacz dowód T3.1) f (x) − f (y) = (x − y)H(x, y), gdzie H jest wielomianem dwóch zmiennych o współczynnikach całkowitych. Załóżmy, że f (x) − f (y) ̸= 0 dla wszystkich x ̸= y ∈ Q. Wobec powyższej równości oznacza to, że H(x, y) ̸= 0 dla wszystkich takich par (x, y) ∈ Q × Q, że x ̸= y. Równoważnie: równanie diofantyczne H(x, y) = 0 nie ma rozwiązań wymiernych poza przekątną x = y. Jeżeli jedno- cześnie równanie H(x, y) = 0 będzie miało choćby jedno rozwiązanie (x, y) ∈ R 2 z x ̸= y, to będziemy mieli przykład wielomianu różnowartościowego na Q, ale nieróżnowartościowego na R. Wystarczy więc przyjrzeć się możliwym wielomianom H(X, Y ). Weźmy f (X) = X 3 +aX. Wówczas f (x) − f (y) = x3 + ax − y3 − ay = (x − y)(x2 + xy + y2 + a). 3Konkurencyjne rozwiązanie wyczytać można z ćwiczenia C11.25 398 11. Równania diofantyczne Czyli H(X, Y ) = X 2+XY +Y 2+a. Załóżmy, że para (u/w, v/w) jest rozwiązaniem równania H(x, y) = 0 w Q2. Wtedy u2 + uv + v2 + aw2 = 0, skąd (2u + v) 2 + 3v2 + 4aw2 = 4(u 2 + uv + v2 + aw2) = 0. (11.49) Wybierzmy teraz taką liczbę całkowitą ujemną a, by (−4a)N3 (każde a = −2 − 3n, przy n ∈ Z+, jest dobre! – w rozwiązaniu ﬁrmowym przyjęto a = −2) . Wtedy równanie (11.49) nie ma rozwiązań całkowitych. Więc na elipsie H(x, y) = 0 nie ma punktów wymiernych. Ale jest tam oczywiście ”mnóstwo” punktów rzeczywistych! ♦ 11.6 Krzywe sześcienne W tym paragraﬁe powiemy parę słów na temat rozwiązywania w liczbach wymiernych (lub całkowitych) równań ϕ(x, y) = 0, gdzie wielomian ϕ(X, Y ) ∈ Q[X, Y ] ma stopień 3. Ogólny wielomian trzeciego stopnia dwóch zmiennych ma postać ϕ(X, Y ) = aX 3 + bX 2Y + cXY 2 + dY 3 + eX 2 + f XY + gY 2 + hX + iY + j, (11.50) gdzie a, b, . . . , j są stałymi współczynnikami (wymiernymi) i a2 + b2 + c2 + d2 > 0. 11.6.1 Postać normalna. Przykłady W przykładzie P2 z poprzedniego ustępu pokazaliśmy metodę redukcji ogólnego równania dru- giego stopnia ϕ(x, y) = 0 do postaci prostszej Au 2 + Bv2 + C = 0. Uzyskuje się to przez stosowne podstawienia aﬁniczne postaci x = au+bv +p, y = cu+dv +q. Również w przypadku sześciennym istnieją metody redukcji równań do prostszej postaci. Odpowiednie podstawienia są w tym przypadku przekształceniami rzutowymi, zobacz GEO . Nie będziemy tu pokazywać ogólnych metod takich redukcji. Tytułem przykładu rozważymy równanie Fermat’a przy n = 3: P r z y k ł a d 1. Spróbujmy ”wyzerować wyraz v3” w równaniu u3 + v3 = 1. Załóżmy, że para (u, v) ∈ Q × Q jest rozwiązaniem tego równania. Wtedy u + v ̸= 0. Połóżmy u = v1 u1 , v = 1 − v1 u1 ⇐⇒ u1 = 1 u + v , v1 = u u + v . (11.51) Wówczas u3 + v3 = 1 wtedy i tylko wtedy, gdy 1 − 3v1 + 3v2 1 = u3 1 ⇔ 3 (v1 − 1 2 )2 = u3 1 − 1 4 ⇔ (9v1 − 9 2 )2 = (3u1)3 − 27 4 . Możemy dokonać kolejnego podstawienia (tym razem aﬁnicznego): u2 = 3u1, v2 = 9v1 − 9 2 . (11.52) Otrzymamy zależność v2 2 = u3 2 − 27 4 . Aby uzyskać (równoważne) równanie o współczynnikach całkowitych mnożymy obustronnie przez 64 = 26. Kładąc wtedy x = 4u2, y = 8v2 otrzymamy: y2 = x3 − 432. (11.53) 11.6. Krzywe sześcienne 399 Podstawienia (11.52) i (11.51) pozwalają napisać: x = 12 u + v , y = 36 u − v u + v ⇐⇒ u = 36 + y 6x , v = 36 − y 6x . (11.54) Podsumowując możemy powiedzieć: (u, v) jest rozwiązaniem równania u 3 +v3 = 1 wtedy i tylko wtedy, gdy para (12/(u+v), 36(u−v)/(u+v)) jest rozwiązaniem równania y2 = x3 −432. I odwrotnie: para (x, y) jest rozwiązaniem równania y2 = x3 − 432 wtedy i tylko wtedy, gdy para ((36 + y)/6x, (36 − y)/6x) jest rozwiązaniem równania u 3 + v3 = 1. Co więcej, przekształcenia (11.54) mają własność biwymierności: (x, y) ∈ Q × Q wtedy i tylko wtedy, gdy (u, v) ∈ Q × Q. Po rozwiązaniu ćwiczenia C11.25 wiemy, że jedynymi wymiernymi rozwiązaniami równania u 3+v3 = 1 są pary (1, 0) i (0, 1). Wobec tego, jedynymi wymiernymi rozwiązaniami równania Bachet’a (11.53) są pary (12, 36) i (12, −36). ♦ Postać (11.53) równania x3 + y3 = 1 jest przykładem tak zwanej postaci normalnej. Ogól- niej: mówimy, że równanie sześcienne C : y2 = ax3 + bx2 + cx + d (11.55) jest (binarnym) równaniem sześciennym w postaci normalnej. Zbiór rozwiązań takiego rów- nania w liczbach całkowitych (odpowiednio: wymiernych, rzeczywistych czy zespolonych) bę- dziemy, zgodnie z tradycją, oznaczać symbolem C(Z) (odpowiednio: C(Q), C(R) czy C(C)). Zbiór ten nazywamy zbiorem punktów całkowitych (odpowiednio: punktów wymiernych, punktów rzeczywistych czy punktów zespolonych) krzywej C. Rys. 11.6 a b c d y x 2 3 += 9y x 2 3 = x 2y x 2 3 += 3 x x 2+y x 2 3 += 6 8) ) ) ) Na rysunku 11.6 pokazujemy przykładowe kształty zbiorów punktów rzeczywistych krzy- wych o równaniach postaci (11.55). Krzywe wyobrażone na rysunkach 11.6a) i 11.6b) są krzy- wymi osobliwymi, pozostałe dwie są nieosobliwe. Pokażemy kilka przykładów zadań teorioliczbowych lub geometryczno-teorioliczbowych, które prowadzą do równań diofantycznych postaci (11.55). 400 11. Równania diofantyczne P r z y k ł a d 2. Pytanie Eulera: Czy istnieje trójkąt prostokątny o bokach i środkowych długości wymiernej? Niech oznaczenia będą standardowe (zobacz GEO ). Jak wiemy z GEO WT2.26 (lub z twierdzenia Pitagorasa w △AA1C) zachodzi równość 4m 2 a = a2 + 4b2. Połóżmy x = a2 b2 , y = 2acma b3 . (11.56) Rys. 11.4 a b c d 2 2 3 3 - = = = y x 2 3 += 9y x 2 3 = x 2y x 2 3 += 3 x x 2+y x 2 3 += 6 8) ) ) ) A B C B1 C1A1 Rys. 11.7 Wówczas y2 = ( 2acma b3 )2 = a 2 b2 · a2 + b2 b2 · a2 + 4b2 b2 = x(x + 1)(x + 4). Widzimy stąd, że każdy trójkąt prostokątny o bokach i środkowych długości wymiernej wyzna- cza (za pomocą równości (11.56)) parę (x, y) liczb wymiernych będącą rozwiązaniem równania y2 = x3 + 5x2 + 4x. Przyglądając się bliżej krzywej C : y2 = x3 + 5x2 + 4x (11.57) można udowodnić, zobacz na przykład [4], że zbiór C(Q) jest zbiorem siedmioelementowym: {(−4, 0), (−1, 0), (0, 0), (−2, 2), (−2, −2), (2, 6), (2, −6)}. Jasne, że żaden z tych elemen- tów nie odpowiada trójkątowi prostokątnemu o bokach wymiernych. Wobec tego odpowiedź na postawione pytanie Eulera jest n e g a t y w n a. ♦ P r z y k ł a d 3. Pytanie Fermat’ a: Czy istnieją czterowyrazowe niestałe ciągi arytme- tyczne o wyrazach będących kwadratami liczb wymiernych? Załóżmy, że a2, c2, b2, d2 jest takim ciągiem. Wówczas, zobacz (11.48), a = (−λ 2 + 2λ + 1)µ, c = (λ 2 + 1)µ, b = (λ 2 + 2λ − 1)µ, dla pewnych λ, µ ∈ Q. Oraz d2 = 2b2 − c2. Zatem (d/µ) 2 = 2(−λ 2 + 2λ − 1) 2 − (λ 2 + 1)2. Oznaczmy y1 = d/µ i (ze względów ”estetycznych”) x1 = λ. Mamy więc zależność: y2 1 = x4 1 + 8x3 1 + 2x2 1 − 8x1 + 1. (11.58) Otrzymaliśmy więc równanie y2 1 = f (x1), które jest ”prawie postaci” (11.55). Różnica polega na tym, że nasz wielomian f (X) jest stopnia 4, a chcemy mieć wielomian stopnia 3. Aby to osiągnąć postępujemy następująco: Załóżmy, że (x1, y1) jest rozwiązaniem równania (11.58). Oznaczmy x2 = y1 − x2 1 − 4x1. Wówczas x2 jest liczbą w y m i e r n ą i zachodzi równość y1 = x2 + x2 1 + 4x1. Stąd i z równości (11.58) mamy x4 1 + 8x3 1 + 2x2 1 − 8x1 + 1 = y2 1 = x2 2 + x4 1 + 16x2 1 + 2x2 1x2 + 8x1x2 + 8x3 1, czyli 2x2 1 − 8x1 + 1 = x2 2 + 16x2 1 + 2x2 1x2 + 8x1x2. Widzimy więc, że liczba x1 ∈ Q spełnia równanie o współczynnikach wymiernych: 2(7 + x2)x2 1 + 8(1 + x2)x1 + x2 2 − 1 = 0. (11.59) 11.6. Krzywe sześcienne 401 Rozważamy teraz dwa przypadki: (1) x2 = −7, albo (2) x2 ̸= −7. W pierwszym przypadku równość (11.59) daje x1 = 1, czyli λ = 1, co, jak wiemy, prowadzi do s t a ł e g o ciągu arytmetycznego. Załóżmy więc, że x2 ̸= −7. Wówczas x1 jest wymiernym pierwiastkiem równania kwadra- towego (11.59) o współczynnikach wymiernych i wyróżniku równym ∆ = 64(1 + x2) 2 − 8(7 + x2)(x2 2 − 1). Wiadomo (udowodnić to!), że równanie kwadratowe o współczynnikach wymiernych ma pier- wiastki wymierne wtedy i tylko wtedy, gdy jego wyróżnik jest kwadratem liczby wymiernej. Czyli wtedy i tylko wtedy, gdy równanie y2 2 = ∆ ma rozwiązania wymierne. W naszym przy- padku oznacza to, że równanie y2 2 = −8x3 2 + 8x2 2 + 136x2 + 120 ma rozwiązania wymierne. Otrzymaliśmy więc postać (11.55) równania sześciennego. Możemy jeszcze ją nieco zmodyﬁkować. Ponieważ prawa strona rozkłada się na czynniki −8(x2 + 1)(x2 + 3)(x2 − 5) = 64 (− x2 2 − 1 2) ( − x2 2 − 3 2) ( − x2 2 + 5 2) , więc, kładąc y = y2 8 i x = − x2 2 − 3 2, znajdujemy y2 = x(x + 1)(x + 4), czyli (11.57). ♦ Ćwiczenie 11.63 Znając wszystkie wymierne punkty (na) krzywej (11.57) (zobacz P2) udowodnić, że nie istnieją niestałe ciągi arytmetyczne o wyrazach będących kwadratami liczb wymiernych. P r z y k ł a d 4. Pytanie: Czy istnieją trójkąty prostokątne o bokach długości wymiernej i polu będącym liczbą całkowitą? Załóżmy, że a, b i c są długościami przyprostokątnych i przeciwprostokątnej takiego trójkąta, a n jest jego polem. To oznacza, że trójka (a, b, c) jest elementem zbioru An = {(a, b, c) ∈ Q 3 : ab = 2n, a2 + b2 = c2}. (11.60) Określimy na zbiorze An funkcję ϕ przyjmującą wartości w Q × Q: ϕ(a, b, c) = ( −nb a + c , 2n2 a + c ) =: (x, y). (11.61) Łatwo sprawdzić, że tak określona para (x, y) liczb wymiernych spełnia równanie En : y2 = x3 − n 2x, (11.62) zobacz C11.64. Wobec tego każdy trójkąt prostokątny o bokach długości wymiernej i polu równym n wyznacza punkt wymierny o dodatniej rzędnej (na) krzywej En. ♦ Ćwiczenie 11.64 Sprawdzić, że jeżeli (a, b, c) ∈ An, (x, y) = ϕ(a, b, c) jest parą okre- śloną przez (11.61), to punkt (x, y) należy do En(Q), czyli jest punktem wymiernym krzywej danej przez równanie (11.62). 402 11. Równania diofantyczne Ćwiczenie 11.65 Niech n ∈ N i niech Tn := En(Q) ∖ {(0, 0), (n, 0), (−n, 0)}. Udowod- nić, że funkcja ψ : Tn −→ Q 3 dana wzorem ψ(x, y) = ( n 2 − x2 y , −2nx y , n2 + x2 y ) przyjmuje wartości w zbiorze An i jest funkcją odwrotną funkcji ϕ zadanej przez (11.61). Czyli, że ϕ ◦ ψ = Id i ψ ◦ ϕ = Id. Liczbę naturalną n będącą polem trójkąta prostokątnego o bokach długości wymiernej nazywa się liczbą kongruentną. Ćwiczenie C11.65 poucza nas, że liczba naturalna n jest liczbą kongruentną wtedy i tylko wtedy, gdy krzywa En ma nietrywialne (to znaczy o niezerowej rzędnej) punkty wymierne. Oczywiście n = 6 jest liczbą kongruentną, zobacz najprostszy trójkąt pitagorejski (3, 4, 5). Ćwiczenie 11.66 Rozważyć trójkąt o bokach długości 3/2, 20/3 i 41/6. Uzasadnić, że n = 5 jest liczbą kongruentną. Jaki punkt wymierny na krzywej E5 odpowiada wskazanemu trójkątowi? Ćwiczenie 11.67 Punkt (41 2/7 2, 29520/7 3) leży na krzywej E31. Sprawdzić. Wyznaczyć trójkąt prostokątny wymierny o polu równym 31. Ćwiczenie 11.68 Udowodnić, że żaden kwadrat nie jest liczbą kongruentną. W dwóch poniższych ćwiczeniach zobaczymy jeszcze dwa pytania prowadzące do badania zbioru punktów wymiernych na krzywych sześciennych: Ćwiczenie 11.69 Chcemy odpowiedzieć na pytanie: Czy iloczyn kolejnych dwóch liczb całkowitych może być równy iloczynowi kolejnych czterech liczb całkowitych? Do jakiego rów- nania postaci (11.55) prowadzi nas próba odpowiedzi na to pytanie? Ćwiczenie 11.70 Chcemy odpowiedzieć na pytanie: Czy trzy sześciany liczb naturalnych mogą tworzyć niestały ciąg arytmetyczny? Do jakiego równania postaci (11.55) prowadzi nas próba odpowiedzi na to pytanie? 11.6.2 Krzywe eliptyczne Krzywe sześcienne o równaniu (11.55) dzielą się na dwie kategorie: krzywe eliptyczne i krzywe osobliwe. Możliwe kształty krzywych osobliwych zobaczyć można na rysunkach 11.6a i 11.6b, zaś możliwe kształty krzywych eliptycznych, na rysunkach 11.6c i 11.6d. Deﬁnicja 11.1 Krzywą C o równaniu (11.55), gdzie a, b, c, d ∈ Z, a ̸= 0, oraz wielomian aX 3 + bX 2 + cX + d n i e ma pierwiastków wielokrotnych, nazywamy krzywą eliptyczną. Gdy wielomian aX 3 + bX 2 + cX + d ma pierwiastek wielokrotny, krzywą (11.55) nazywamy osobliwą. Problem wyznaczania punktów wymiernych na krzywej (11.55), dla której wielomian aX 3 + bX 2 + cX + d ma wymierny pierwiastek wielokrotny, jest łatwo rozwiązywalny: 11.6. Krzywe sześcienne 403 Ćwiczenie 11.71 Załóżmy, że wielomian trzeciego stopnia f (X) ∈ Q[X] ma wymierny pierwiastek podwójny lub potrójny. Opisać wszystkie punkty wymierne na krzywej C : y2 = f (x). Wskazówka. Jeżeli x0 jest pierwiastkiem wielokrotnym wielomianu f (X), to rozważmy wszystkie proste przechodzące przez punkt (x0, 0) i znajdźmy drugi punkt przecięcia takich prostych z krzywą C. Jasne, że równanie (11.55) można zapisać w postaci (ay) 2 = (ax) 3 + a 2bx2 + a 2cx + a2d. Badanie punktów wymiernych krzywej C : y2 = ax3+bx2+cx+d jest więc równoważne badaniu punktów wymiernych krzywej C1 : y2 1 = x3 1 + b1x2 1 + c1x1 + d1. Podstawiając x1 = x2 − b1/3, tak jak w ustępie 3.3.4, dostajemy postać zredukowaną y2 1 = x3 2 + Ax2 + B. W dalszym ciągu będziemy więc mówić o krzywej eliptycznej E : y2 = x3 + Ax + B. (11.63) Przypomnijmy, zobacz (3.50), że liczbę ∆ = (27)−1(27B2 + 4A 3) nazywamy wyróżnikiem trójmianu sześciennego X 3 + AX + B. ZADANIE 11.19 Udowodnić, że warunek ∆ ̸= 0 jest równoważny warunkowi, że wielo- mian X 3 + AX + B nie ma pierwiastków wielokrotnych. R o z w i ą z a n i e. Teza wynika natychmiast z tożsamości 27∆ = (X 3 + AX + B)(27B − 18AX) + (3X 2 + A)(4A2 − 9BX + 6AX 2). Tożsamość ta jest wynikiem zastosowania algorytmu Euklidesa do wielomianu X 3 + AX + B i jego pochodnej 3X 2 + A. Zobacz też C6.7. ♦ Na rysunkach 11.6c i 11.6d widzimy przybliżone kształty (zbioru punktów rzeczywistych) krzywych eliptycznych. Rysunek 11.6c dotyczy przypadku, gdy wielomian f (X) = X 3+AX+B ma trzy różne pierwiastki rzeczywiste (to zachodzi, gdy ∆ > 0), rysunek 11.6d, przypadku, gdy f (X) ma tylko jeden pierwiastek rzeczywisty (to zachodzi, gdy ∆ < 0). Niestety, w przeciwieństwie do przypadku krzywych stopnia drugiego, czy (niektórych) krzy- wych osobliwych stopnia trzeciego, n i e d y s p o n u j e m y żadną metodą łatwej (to znaczy a l g e b r a i c z n e j) parametryzacji krzywej E(R) (ani jej zbioru punktów wymiernych E(Q)). Ale już u Diofantosa znaleźć można zaczątki metody znajdowania nowych punktów krzywej, gdy znamy już pewne takie punkty. O tej metodzie powiemy w następnym ustępie. 11.6.3 Metoda siecznych-stycznych Omówioną poniżej metodę wyznaczania nowych punktów krzywej ϕ(x, y) = 0, gdzie wielomian ϕ(X, Y ) jest postaci (11.50), gdy znamy już pewne jej punkty, wymyślono już w starożytności. Metodę tę nazywamy metodą siecznych-stycznych. Jej działanie pokażemy w zadaniach. Zobaczymy najpierw jak działa metoda siecznych. 404 11. Równania diofantyczne ZADANIE 11.20 Wyznaczyć dziesięć rozwią- zań równania y2 = x3 + 9 w liczbach całkowitych. Wyznaczyć jeszcze parę rozwiązań wymiernych. R o z w i ą z a n i e. Kilka rozwiązań łatwo odgad- nąć. Na przykład (0, ±3), (3, ±6). Mając te cztery punkty na krzywej o równaniu x3 − y2 + 9 = 0 mo- żemy spróbować znaleźć inne punkty na tej krzy- wej. Wybieramy punkty (0, 3) i (3, 6) i prowa- dzimy przez nie prostą. Prosta przechodząca przez te punkty ma równanie y = x + 3, jej trzeci punkt przecięcia z krzywą ma odciętą będącą trzecim (obok x = 0 i x = 3) pierwiastkiem równania (x + 3) 2 = x3 + 9. Czyli trzecim pierwiastkiem równania x3 − x2 − 6x = 0. 12 _( ), 3)(0, ( ),3 6 Rys. 11.8 A _( ),3 6 Na mocy wzoru Vi`ete’a mamy więc 0 + 3 + x = 1, skąd x = −2. Zatem y = −2 + 3 = 1. Znaleźliśmy więc nowe dwa punkty całkowite (−2, 1), i (−2, −1) na naszej krzywej. Drugi punkt otrzymujemy dzięki symetrii krzywej względem osi Ox. Zróbmy taką sztuczkę jeszcze raz, tym razem startując od punktów (0, −3) i (3, 6). Prosta przechodząca przez te punkty ma równanie y = 3x − 3, jej trzeci punkt przecięcia z krzywą ma odciętą będącą trzecim (obok x = 0 i x = 3) pierwiastkiem równania (3x − 3)2 = x3 + 9. Czyli trzecim pierwiastkiem równania x3 − 9x2 + 18x = 0. Na mocy wzoru Vi`ete’a mamy więc 0 + 3 + x = 9, skąd x = 6. Zatem y = 3 · 6 − 3 = 15. W ten sposób znajdujemy kolejne dwa punkty całkowite na badanej krzywej: (6, 15) i (6, −15). Stosując sztuczkę do punktów (3, −6) i (6, 15) znajdujemy ”niebanalne” rozwiązania (40, 253), (40, −253). Dotychczas mieliśmy szczęście: znajdowaliśmy rozwiązania całkowite. Tak jednak zdarza się raczej wyjątkowo. Zastosujmy naszą sztuczkę do punktów P = (−2, 1) i Q = (3, −6). Prosta lP Q ma równanie y = − 7 5x − 9 5. Stąd, podobnie jak wyżej, znajdujemy trzeci punkt przecięcia tej prostej z krzywą E(R): A = ( 24 25, − 393 125). Tym razem wyznaczyliśmy w y m i e r n y punkt naszej krzywej. Czytelnik zechce samodzielnie zastosować sztuczkę startując od punktów (6, 15) i (40, 253). ♦ Na rysunku 11.9 pokazujemy metodę siecznych. [Znacze- nie punktu P ⊕ Q będzie wyjaśnione później.] Jeżeli punkty P, Q leżą na krzywej, to trzeci punkt przecięcia prostej lP Q z tą krzywą oznaczamy P · Q. Zastosowaną w powyższym rozwiązaniu metodę siecznych opisujemy tak: prowadzimy prostą przez dwa dane punkty na badanej krzywej i wyznaczamy trzeci punkt przecięcia tej prostej z krzywą. Rys. 11.6 a b c d 2 2 3 3 - = = = y x 2 3 += 9y x 2 3 = x 2y x 2 3 += 3 x x 2+y x 2 3 += 6 8) ) ) ) a b c d y x 2 3 += 9y x 2 3 = x 2y x 2 3 += 3 x x 2+y x 2 3 += 6 8) ) ) ) P P Q P QQ Rys. 11.9 11.6. Krzywe sześcienne 405 Ćwiczenie 11.72 Udowodnić, że jeżeli punkty wymierne P, Q leżą na krzywej o równaniu ϕ(x, y) = 0, gdzie ϕ(X, Y ) jest postaci (11.50), to punkt P · Q (jeżeli istnieje) jest punktem wymiernym. Gdy dysponujemy tylko jednym punktem na krzywej i nie możemy zastosować metody siecznych, nie traćmy nadziei. Gdy dwa punkty, przez które prowadzimy sieczną, pokrywają się, słusznym jest uważać, że odpowiednia prosta sieczna staje się prostą s t y c z n ą. Z rachunku różniczkowego wiemy, że równanie prostej stycznej do krzywej o równaniu ϕ(x, y) = 0 w punkcie (x0, y0) leżącym na tej krzywej ma postać: ϕ ′ x(x0, y0) · (x − x0) + ϕ ′ y(x0, y0) · (y − y0) = 0, (11.64) gdzie ϕ ′ x(x0, y0) oznacza wartość pochodnej (cząstkowej) wielomianu ϕ jako wielomianu zmien- nej x (przy ustalonym y = y0) w punkcie x0. Oczywiście ϕ ′ y(x0, y0) oznacza wartość po- chodnej (cząstkowej) wielomianu ϕ jako wielomianu zmiennej y (przy ustalonym x = x0) w punkcie y0. Należy podkreślić, że równanie (11.64) jest równaniem prostej wtedy i tylko wtedy, gdy co najmniej jedna z liczb ϕ ′ x, ϕ′ y jest r ó ż n a od 0. Punkt P = (x0, y0), w którym obie pochodne ϕ′ x(x0, y0), ϕ′ y(x0, y0) są równe 0 nazywa się punktem osobliwym krzywej ϕ(x, y) = 0. Punkt (0, 0) jest punktem osobliwym zarówno krzywej z rysunku 11.6a jak i krzywej z rysunku 11.6b. Ćwiczenie 11.73 Udowodnić, że krzywa o równaniu (11.55) m a punkty osobliwe wtedy i tylko wtedy, gdy wielomian aX 3 + bX 2 + cX + d ma pierwiastki wielokrotne. Na rysunku 11.10 pokazujemy metodę stycznych. Jeżeli P jest punktem krzywej, to ”trzeci” punkt przecięcia prostej stycz- nej lP z tą krzywą oznaczamy P · P . Metodę stycznych opisujemy tak: prowadzimy prostą styczną w danym punkcie badanej krzywej i wyznaczamy ”trzeci” punkt przecięcia tej prostej z krzywą. Ćwiczenie 11.74 Wykaż, że jeśli P jest punktem wymier- nym krzywej o równaniu ϕ(x, y) = 0, gdzie ϕ jest postaci (11.50), to punkt P · P , jeśli istnieje, jest punktem wymiernym. Rys. 11.6 a b c d 2 2 3 3 - = = = y x 2 3 += 9y x 2 3 = x 2y x 2 3 += 3 x x 2+y x 2 3 += 6 8) ) ) ) a b c d y x 2 3 += 9y x 2 3 = x 2y x 2 3 += 3 x x 2+y x 2 3 += 6 8) ) ) ) c x x 2+y x 2 3 += 6 8) P P P P P Rys. 11.10 =2P ZADANIE 11.21 Wiemy z Z10.8, że równanie y2 = x3 − 2 ma tylko dwa rozwiązania w liczbach całkowitych: (3, ±5). Wyznaczyć kilka innych punktów wymiernych (na) krzywej eliptycznej Bachet’a B(−2) : y2 = x3 − 2. R o z w i ą z a n i e. Mamy znaleźć różne od (3, ±5) punkty zbioru B(−2)(Q). Rozważmy prostą styczną do naszej krzywej w punkcie P = (3, 5). Z (11.64) wiemy, że ma ona równanie 27(x − 3) − 10(y − 5) = 0. (11.65) Jej punkty przecięcia z naszą krzywą mają więc odcięte będące pierwiastkami równania x3 − 729 100x2 + 837 50 x − 1161 100 = 0. (11.66) 406 11. Równania diofantyczne Ponieważ punkt (3, 5) jest podwójnym punktem przecięcia prostej (11.65) z badaną krzywą, więc równanie (11.66) ma (co zresztą łatwo(?) sprawdzić bezpośrednio) pierwiastek podwójny x1 = x2 = 3. Trzeci pierwiastek (czyli odciętą poszukiwanego trzeciego punktu przecięcia) znajdujemy za pomocą jednego z dwóch wzorów Vi`ete’a: x1 + x2 + x3 = 729 100 lub x1x2x3 = 1161 100 . Dostajemy x3 = 129 100. Rzędną y3 wyznaczamy z równania stycznej (11.65): y3 = 383 1000. Zna- leźliśmy więc nowy punkt wymierny Q = ( 129 100, 383 1000) na badanej krzywej. Powyższą sztuczkę możemy teraz zastosować do punktu Q. ♦ Ćwiczenie 11.75 Zrobić to. Ćwiczenie 11.76 Zastosować metodę stycznych do znanych punktów wymiernych na krzy- wej Bachet’a B(−432) : y2 = x3 − 432, zobacz 11.6.1 P1. Ćwiczenie 11.77 Wyznaczyć rozwiązanie (49, 840) równania y2 = 6x3 − 6x znając oczy- wiste rozwiązania (±1, 0), (0, 0) i (2, ±6). 11.6.4 Równania y2 = x 3 + 1 i y2 = x 3 − 1 Rozważymy teraz kolejne równanie Bachet’a: B(1) : y2 = x3 + 1. (11.67) Na rysunku 11.11 mamy krzywą o równaniu (11.67) i pięć oczywistych punktów całkowitych. Są to (−1, 0), (0, ±1) i (2, ±3). Również roz- wiązanie poniższego ćwiczenia łatwo dostrzec na tym rysunku: Ćwiczenie 11.78 Zastosować metodę siecznych-stycznych do równania y2 = x3 + 1. Czy dostajemy w ten sposób jakieś nowe rozwiązania w liczbach wymiernych? Ustęp ten poświęcimy na wyjaśnienie braku sukcesu w powyższym ćwiczeniu. Dowiedziemy mianowicie (za pomocą nieco zmodyﬁkowanego rozumowania Eulera), że na krzywej (11.67) nie ma więcej punktów wymiernych. Rys. 11.11 W trakcie dowodu twierdzenia T11.8 będziemy korzystać z najprostszych własności pier- ścienia Eisensteina. W szczególności z tezy poniższego lematu: LEMAT 11.4 Jeżeli α ∈ Z[ ω ] jest takim elementem pierścienia Eisensteina, że N(α) jest kwadratem (w Z), to α = kβ2 dla pewnego k ∈ Z i pewnego β ∈ Z[ ω ]. 11.6. Krzywe sześcienne 407 D O W Ó D. Teza wynika łatwo z jednoznaczności rozkładu w Z[ ω ] i faktu, że każda jedność w Z[ ω ] jest kwadratem lub minus kwadratem. Istotnie, każda jedność jest potęgą parzystą τ 2k = (τ k) 2 lub potęgą nieparzystą τ 2k+1 = τ 3τ 2k−2 = −(τ k−1)2. [Używamy tu oznaczeń z ustępu 10.2.8.] Niech α = ε · q1q2 · . . . · qr · λd · πe1 1 πe2 2 · . . . · πes s będzie rozkładem α na czynniki nierozkładalne w Z[ ω ]. Tu ε jest jednością, qi oznaczają liczby pierwsze ≡ 2 (mod 3), a πj oznaczają elementy pierwsze leżące nad liczbami pierwszymi pj ≡ 1 (mod 3). Wówczas N(α) = q2 1q2 2 · . . . · q2 r · 3 d · pe1 1 pe2 2 · . . . · pes s . Ponieważ N(α) jest kwa- dratem, więc widzimy, że wykładniki d i e1, e2, . . . , es są parzyste. Wystarczy więc położyć β = η · 3 d/2πe1/2 1 πe2/2 2 · . . . · πes/2 s , gdzie η2 = ±ε i k = ±q1q2 · . . . · qr. □ TWIERDZENIE 11.8 Równanie (11.67) ma dokładnie pięć rozwiązań w liczbach wymier- nych. Są to (−1, 0), (0, ±1), (2, ±3). D O W Ó D. Załóżmy, że m n , m, n ∈ Z, jest takim ułamkiem, że para (x, y), x = m n jest wymiernym rozwiązaniem równania (11.67) przy pewnym y ∈ Q. Wówczas, po pomnożeniu przez n4, dostajemy (n2y) 2 = n(m + n)[m2 − mn + n 2]. (11.68) Oznaczmy przez E(m, n) prawą stronę powyższej równości. Równość (11.68) będziemy zapi- sywać w postaci E(m, n) = □, zaznaczając w ten sposób, że wartość formy Eulera E(m, n) jest kwadratem (liczby całkowitej). Jasne, że E(−m, −n) = E(m, n). Zatem każda para (m, n) ∈ Z × Z̸=0, dla której E(m, n) = □ = d2 wyznacza rozwiązania ( m n , ± d n2 ) równa- nia (11.67). Zauważmy, że rozwiązania (−1, 0), (0, ±1), (2, ±3) pochodzą od par (m, n) należących do zbioru Ω0 = {(1, −1), (−1, 1), (0, 1), (0, −1), (2, 1), (−2, −1)}. Odpowiednie wartości formy Eulera to E(±1, ∓1) = 0, E(0, ±1) = 1, E(±2, ±1) = 9. Oznaczmy Ω□ = {(m, n) ∈ Z × Z̸=0 : NWD (m, n) = 1 oraz E(m, n) = □}. Wiemy, że Ω0 ⊆ Ω□. Udowodnimy, za pomocą d e s a n t u wymyślonego przez Eulera, że w istocie zachodzi równość Ω0 = Ω□. To zakończy dowód twierdzenia. Załóżmy nie wprost, że istnieje (m, n) ∈ Ω□ ∖ Ω0. Desant Eulera polega na wskazaniu pary (m1, n1) ∈ Ω□ ∖ Ω0, dla której E(m1, n1) < E(m, n). Czytelnik oczywiście widzi, że to prowadzi do sprzeczności. Konstrukcję pary (m1, n1) przeprowadzamy różnie dla dwóch przypadków: (1) m + n ≡ 0 (mod 3) i (2) m + n ̸≡ 0 (mod 3). W przypadku (1) połóżmy 3n1 = m + n i m1 = n − n1. Wówczas, jak łatwo sprawdzić, E(m, n) = 9 E(m1, n1). Jasne, że stąd wynika: E(m1, n1) = □, NWD (m1, n1) = 1 i E(m1, n1) < E(m, n). 408 11. Równania diofantyczne W przypadku (2) konstrukcja pary (m1, n1) jest trudniejsza. Zaczynamy od uwagi, że czynniki n, m + n i m2 − mn + n2 formy Eulera są w tym przypadku parami względnie pierwsze, zobacz C11.79, i dodatnie, więc, na mocy triku, każdy z nich jest kwadratem: n = a 2, m + n = b2, m 2 − mn + n 2 = c2. (11.69) Ostatnia z tych równości mówi, że norma N(m + nω) jest kwadratem (liczby całkowitej). Wobec tego, na mocy L11.4 możemy zapisać równość m + nω = k(s + tω)2. Stąd m = k(s2 − t 2), n = k(2st − t 2). Ponieważ NWD (m, n) = 1, więc k = ±1. Jednocześnie 1 ≡ b2 = m + n = k[(s + t) 2 − 3t 2] ≡ k(s + t)2 ≡ k (mod 3). Zatem k = 1, więc m = s2 − t2, n = 2st − t 2. (11.70) Uzyskaną równość b2 = (s + t) 2 − 3t2 zapisujemy w postaci (s + t) 2 = b2 + 3t 2 = N(b + t √−3). Ponadto, skoro norma liczby b + t √−3 ∈ Z[ ω ] jest kwadratem, więc, znów na mocy L11.4, b + t √−3 = lβ2 dla pewnych l ∈ Z i β = 1 2(u + v√−3) ∈ Z[ ω ]. Stąd b = l ( u 2 − 3v2 4 ) , t = l · uv 2 . (11.71) Zatem (s + t) 2 = b2 + 3t2 = l2 ( u 2 − 3v2 4 )2 + 3l2 (uv 2 )2 = l2 ( u2 + 3v2 4 )2 . Wobec tego (a) s + t = l (u2 + 3v2 4 ) lub (b) s + t = (−l) ( u 2 + 3v2 4 ) . (11.72) W przypadku (a) mamy E(u − v, v) =v(u − v + v)[(u − v) 2 − (u − v)v + v2] = uv[u2 + 3v2 − 3uv] =2t l [ 4(s + t) l − 6t l ] = 2t l2 (4s − 2t) = 4t l2 · n t = ( 2a l )2 , gdzie trzecia równość wynika z drugiej równości (11.71) i pierwszej równości (11.72), piąta równość wynika z drugiej równości (11.70), a ostatnia równość wynika z pierwszej równości (11.69). W przypadku (11.72)(b) mamy, jak łatwo sprawdzić, E(u + v, −v) = ( 2a l )2 . 11.6. Krzywe sześcienne 409 Oznaczmy d = NWD (u, v). Wówczas, kładąc m1 = (u − v)/d, n1 = v/d w przypadku (11.72)(a), i m1 = (u + v)/d, n1 = (−v)/d w przypadku (11.72)(b), dostajemy równość E(m1, n1) = ( 2a d2l )2 = □. Trzeba jeszcze sprawdzić, że E(m1, n1) < E(m, n) = a2b2c2. Zostawiamy to Czytelnikowi. □ Ćwiczenie 11.79 Udowodnić, że jeżeli NWD (m, n) = 1 i m + n ̸≡ 0 (mod 3), to czynniki iloczynu (11.68) są parami względnie pierwsze. Ćwiczenie 11.80 Rozważyć formę E′(m, n) := E(m, −n) i udowodnić, że na krzywej B(−1) : y2 = x3 − 1 leży tylko jeden punkt wymierny (1, 0). 11.6.5 Dodawanie punktów krzywej eliptycznej Okazuje się, że w zbiorze E(C) punktów zespolonych krzywej eliptycznej, uzupełnionym o jeden d o d a t k o w y punkt, można wprowadzić działanie dodawania ⊕, względem którego zbiór ten staje się g r u p ą a b e l o w ą. Dodawanie ⊕ deﬁniujemy za pomocą opisanej w ustępie 11.6.3 metody siecznych-stycznych. Również podzbiory E(R) i E(Q) punktów rzeczywistych i wymiernych są grupami względem działania ⊕. Opiszemy teraz rzeczone działanie dodawania punktów. Będziemy to robić w zbiorze E(R) punktów rzeczywistych krzywej E zadanej przez równanie (11.63). (Robimy tak dla wygody Czytelnika, którego nie chcemy przerażać zespoloną płaszczyzną rzutową. Formalnie rzecz ujmując wszystko jest również prawdą dla punktów zespolonych.) Wprowadzimy parę oznaczeń. 1. Odciętą punktu P oznaczamy przez x(P ), a rzędną przez y(P ); 2. Dla danego punktu P ∈ R 2 przez P ′ oznaczymy punkt, którego współrzędnymi są x(P ′) = x(P ), y(P ′) = −y(P ) (P ′ jest więc odbiciem punktu P w osi Ox); 3. Dla danych dwóch punktów P, Q ∈ E(R) symbolem P · Q oznaczamy trzeci punkt przecięcia prostej lP Q z krzywą E(R); 4. Przez O oznaczymy punkt idealny, w którym przecinają się wszystkie proste pionowe x = s. Znający podstawy geometrii płaszczyzny rzutowej wiedzą, że O jest kierunkiem osi Oy. Ponieważ nasza krzywa jest coraz bardziej ”pionowa”, więc naturalnym jest uważać, że prze- chodzi ona przez punkt O. Uznajemy, że punkt O jest punktem całkowitym, w szczególności, wymiernym. Ponadto kładziemy O′ = O; 5. Deﬁniujemy sumę P ⊕ Q punktów P, Q ∈ E(R) wzorem (zobacz rysunki 11.9 i 11.10) P ⊕ Q = (P · Q) ′. Jasne, że jeżeli P ∈ E(R), to P ′ ∈ E(R). Jasnym też być powinno, że O · P = P ′. 410 11. Równania diofantyczne Ćwiczenie 11.81 Przekonać się, że punkt O jest elementem neutralnym dodawania ⊕. Nazywamy go więc zerem. Przekonać się również, że dla dowolnego punktu P zachodzi równość P ⊕ P ′ = O. Zatem, P ′ jest elementem przeciwnym do P . Regułę tworzenia sumy punktów na krzywej (11.63) można streścić następująco: suma trzech punktów, w których prosta przecina krzywą wynosi 0. Wyprowadzimy teraz wzory na odciętą x(P1⊕P2) i rzędną y(P1⊕P2) sumy dwóch punktów na krzywej eliptycznej. Możliwe są cztery przypadki położenia punktów P1, P2: 1. Jeżeli P1 ̸= P2 ∈ E(R) są dwoma punktami mającymi tę samą odciętą, to, oczywiście, uważamy, że P1 · P2 = O. Wobec tego, w tym przypadku mamy P1 ⊕ P2 = O′ = O. 2. Niech P1 = (k1, l1), P2 = (k2, l2) ∈ E(R), x(P1) ̸= x(P2), będą punktami krzywej (11.63). Poprowadźmy przez te punkty prostą lP1P2. Jej równanie, jak wiadomo, ma postać y = λ(x − k1) + l1, gdzie λ = l2 − l1 k2 − k1 . Oznaczmy przez (k3, l3) trzeci punkt przecięcia tej prostej z krzywą E(R). Aby wyznaczyć k3 znajdujemy trzeci, obok k1 i k2 pierwiastek równania x3 − (λx + l1 − λk1) 2 + Ax + B = 0. Dzięki wzorowi Vi`ete’a mamy k1 + k2 + k3 = λ 2. Wobec tego    x(P1 ⊕ P2) = λ2 − x(P1) − x(P2), y(P1 ⊕ P2) = λ (x(P1) − x(P1 ⊕ P2)) − y(P1). (11.73) Jasne, że y(P1 ⊕ P2) = −l3 wyznaczamy z równości l3 = λ(k3 − k1) + l1. Zauważmy, że może się zdarzyć, że P1 · P2 = P2 (lub P1 · P2 = P1). W takiej sytuacji prosta lP1P2 jest styczna do krzywej w punkcie P2 (lub P1). 3. Niech teraz P1 = P2 = P = (k, l) i y(P ) ̸= 0. Ponieważ jest intuicyjnie jasne, że prosta sieczna lP Q, dla ustalonego punktu P ∈ E(R) i zmiennego, zbieżnego do P , punktu Q ∈ E(R), jest zbieżna do prostej lP stycznej do krzywej E w punkcie P , więc wyznaczymy trzeci punkt przecięcia stycznej lP z krzywą. Znający pochodne z łatwością sprawdzą, że prosta lP ma równanie y = λ(x − k) + l, gdzie λ = 3k2 + A 2l . Wobec tego, podobnie jak wyżej (korzystając ze wzoru Vi`ete’a), znajdujemy    x(P ⊕ P ) = λ 2 − 2x(P ) y(P ⊕ P ) = λ(x(P ) − x(P ⊕ P )) − y(P ). (11.74) 11.6. Krzywe sześcienne 411 4. Gdy P1 = P2 = P i y(P ) = 0, to kładziemy P1 ⊕ P2 = O, bo prosta styczna jest ”pionowa”. Formuły (11.73) pochodzą w zasadzie od Diofantosa (w zupełnie innej notacji, oczywiście), a Bachet de M´eziriac wykrył formuły duplikacji (11.74) na długo przed powstaniem teorii krzywych eliptycznych. Interpretacja tych wzorów w ramach teorii grup jest zasługą Poincar´e’go, który zdeﬁniował dodawanie punktów na krzywej eliptycznej i udowodnił poniższe ważne: TWIERDZENIE 11.9 (Twierdzenie Poincar´e’ go) Zbiór E(R) ∪ {O} z działaniem ⊕ jest grupą abelową. Jeżeli A, B w równaniu (11.63) są liczbami wymiernymi, to E(Q) ∪ {O} z działaniem ⊕ jest grupą abelową (podgrupą grupy (E(R) ∪ {O}, ⊕)). □ Jedynie trudnym momentem w dowodzie tego twierdzenia jest dowód, że wprowadzone działanie dodawania punktów jest d z i a ł a n i e m ł ą c z n y m. U w a g a. Zauważmy na koniec, że jeżeli A, B w równaniu (11.63) są liczbami całkowitymi i dane jest dowolne ciało K, to można rozważać zbiór K-punktów krzywej E (czyli zbiór takich rozwiązań (x, y) równania (11.63), że x, y ∈ K). Jasne, że zbiór K-punktów krzywej E oznaczamy symbolem E(K). Możemy, w szczególności, za K wybrać któreś ze znanych nam ciał skończonych. Na przy- kład, gdy K = Z/p dla danej liczby pierwszej p ̸= 2, 3, to wzory (11.73) i (11.74) deﬁniujące działanie dodawania ⊕ zachowują swoją moc. W ten sposób powstaje grupa E(Z/p) ∪ {O}. Grupy E(Z/p) ∪ {O} i, ogólniej, E(Fpn) ∪ {O}, mają zastosowanie w kryptograﬁi, zobacz na przykład [3] i [18]. Ćwiczenie 11.82 Napisać tabelkę grupy (E(Z/7) ∪ {O}, ⊕) dla krzywej E : y2 = x3 + 5x + 4. Rozdział 12 Kilka wiadomości dodatkowych Mr Jacq. Bernoulli [...] avou¨e, que malgr´e toutes les peines, qu’il s’etoit donn´ees, il n’avoit pˆu venir `a bout, de sorte que [...] grands Maˆιtres dans cette mati`ere, ont ´et´e extrˆemement surpris, quand je leur annon¸cois que j’avois trouv´e la somme de cette serie [...] (Leonhard Euler) Opowiemy tu o paru jeszcze, występujących w matematyce olimpijskiej, tematach, więcej lub mniej związanych z teorią liczb. 12.1 Część całkowita i ułamkowa liczby rzeczywistej Pokażemy tu parę zadań dotyczącej części całkowitej i części ułamkowej liczb rzeczywistych. 12.1.1 Podstawowe własności Każdą liczbę rzeczywistą x przedstawiamy jednoznacznie w postaci sumy pewnej liczby całko- witej i pewnej nieujemnej liczby rzeczywistej mniejszej niż 1. Mówimy odpowiednio o części całkowitej i części ułamkowej liczby x. Deﬁnicja 12.1 Część całkowita liczby x ∈ R to jedyna taka liczba całkowita ⌊x⌋, że ⌊x⌋ ⩽ x < ⌊x⌋ + 1. Część całkowitą liczby x nazywa się (ostatnio) również podłogą liczby x. Częścią ułam- kową liczby x nazywamy ”naddatek” x − ⌊x⌋. Oznaczamy ją {x}. Jasne jest, że dla dowolnej liczby rzeczywistej x, przedstawienie jej w postaci x = n + α, gdzie n ∈ Z oraz α ∈ [ 0; 1 ), jest j e d n o z n a c z n e. Tu, oczywiście, n = ⌊x⌋, α = {x}. Elementarne własności tych pojęć zebrane są w poniższym ćwiczeniu: 12.1. Część całkowita i ułamkowa liczby rzeczywistej 413 Ćwiczenie 12.1 Udowodnić, że dla dowolnych liczb rzeczywistych x, x1, x2, . . . , xm: 1. x − 1 < ⌊x⌋ ⩽ x, 2. x ∈ Z ⇐⇒ x = ⌊x⌋ ⇐⇒ {x} = 0, 3. dla x > 0, do przedziału [ 1; x ] należy dokładnie ⌊ x m ⌋ wielokrotności liczby m ∈ N, 4. ⌊n + x⌋ = n + ⌊x⌋ dla dowolnego n ∈ Z, 5. ⌊x1 + x2 + . . . + xm⌋ − ⌊x1⌋ − ⌊x2⌋ − . . . − ⌊xm⌋ ∈ {0, 1, . . . , m − 1}, 6. ⌊ ⌊x⌋ b ⌋ = ⌊x b ⌋ dla b ∈ N. Oto jeszcze kilka ćwiczeń z częścią całkowitą liczb rzeczywistych: Ćwiczenie 12.2 Udowodnić, że dla dowolnej liczby rzeczywistej x i dowolnej liczby natu- ralnej n zachodzi tożsamość Hermite’ a ⌊x⌋ + ⌊x + 1 n ⌋ + ⌊x + 2 n ⌋ + . . . + ⌊x + n − 1 n ⌋ = ⌊nx⌋ . Ćwiczenie 12.3 Udowodnić, że dla każdej liczby naturalnej n zachodzi równość ⌊ n + 1 2 ⌋ + ⌊ n + 2 4 ⌋ + ⌊ n + 4 8 ⌋ + . . . + ⌊ n + 2k 2k+1 ⌋ + . . . = n. Ćwiczenie 12.4 Udowodnić, że dla dowolnej liczby naturalnej n zachodzi równość ⌊√n + 1 + √ n⌋ = ⌊√4n + 2⌋. Ćwiczenie 12.5 Udowodnić, że dla dowolnej liczby naturalnej n liczba ⌊(5 + √ 19) n⌋ jest nieparzysta. Wskazówka. (5 − √19) n < 1 dla każdego n > 1. Ćwiczenie 12.6 Udowodnić, że dla dowolnej liczby naturalnej n zachodzi równość ⌊√ n⌋ + ⌊ 3√n ⌋ + ⌊ 4√n⌋ + . . . + ⌊ n√n⌋ = ⌊log2 n⌋ + ⌊log3 n⌋ + ⌊log4 n⌋ + . . . + ⌊logn n⌋ . Ćwiczenie 12.7 Udowodnić, że równanie ⌊x⌋ + ⌊2x⌋ + ⌊4x⌋ + ⌊8x⌋ + ⌊16x⌋ + ⌊32x⌋ = m, przy m = 2010 ma nieskończenie wiele rozwiązań, a przy m = 2011 nie ma rozwiązań w liczbach rzeczywistych x. Ćwiczenie 12.8 Udowodnić, że dla dowolnych względnie pierwszych liczb naturalnych a, b zachodzi równość a−1∑ k=1 ⌊ kb a ⌋ = (a − 1)(b − 1) 2 . 414 12. Kilka wiadomości dodatkowych 12.1.2 Twierdzenie Beatty’ego Interesującą własność części całkowitej znajdujemy w twierdzeniu Beatty’ego-Banga. Dla danej liczby rzeczywistej γ połóżmy Sγ = {⌊nγ⌋ : n ∈ N}. Zbiór Sγ nazywa się czasami spektrum liczby rzeczywistej γ. Przy tym oznaczeniu mamy: TWIERDZENIE 12.1 (Beatty, Bang ) Niech α i β będą dwiema ściśle dodatnimi licz- bami rzeczywistymi. Wówczas zbiory Sα, Sβ stanowią rozbicie zbioru N liczb naturalnych (to znaczy Sα ∪Sβ = N i Sα ∩Sβ = ∅) wtedy i tylko wtedy, gdy α i β są liczbami niewymiernymi spełniającymi warunek 1 α + 1 β = 1. D O W Ó D. Zauważmy przede wszystkim, że m ∈ Sγ wtedy i tylko wtedy, gdy istnieje takie k ∈ N, że m γ ⩽ k < m γ + 1 γ , (12.1) przy czym, gdy γ jest liczbą niewymierną, to obie nierówności są ścisłe. (⇐=) Załóżmy, że dla α /∈ Q, β /∈ Q zachodzi równość 1 α + 1 β = 1 i załóżmy, nie wprost, że m ∈ Sα ∩ Sβ. Wówczas, na mocy (12.1), m α < k < m α + 1 α oraz m β < l < m β + 1 β dla pewnych naturalnych k, l. Dodając te nierówności stronami i korzystając z równości 1 α + 1 β = 1 dostajemy m < k + l < m + 1, co jest niemożliwe. Ta sprzeczność dowodzi, że Sα ∩ Sβ = ∅. Pokażemy teraz, że Sα ∪ Sβ = N. Załóżmy, nie wprost, że liczba naturalna m nie należy ani do Sα ani do Sβ. To, na mocy (12.1), oznacza, że ani w przedziale ( m α ; m α + 1 α ) , ani w przedziale ( m β ; m β + 1 β ) nie ma ż a d n e j liczby naturalnej. Jednocześnie, dłuższe przedziały ( m α ; m α + 1 ) i ( m β ; m β + 1 ), z których każdy ma długość 1 i końce niewymierne, zawierają liczby całkowite. Istnieją więc s, t ∈ N należące do prawych części tych przedziałów: m α + 1 α < s < m α + 1, m β + 1 β < t < m α + 1. Dodając te nierówności stronami dostajemy m + 1 < s + t < m + 2, 12.1. Część całkowita i ułamkowa liczby rzeczywistej 415 co jest niemożliwe. Ta sprzeczność dowodzi, że Sα ∪ Sβ = N. (=⇒) Odwrotnie, załóżmy, że zbiory Sα, Sβ stanowią rozbicie zbioru N. Ustalmy liczbę naturalną k i rozważmy zbiór Ak = {1, 2, . . . , k}. Wówczas, jak łatwo sprawdzić, |Ak ∩ Sα| = ⌊ k α ⌋ , |Ak ∩ Sβ| = ⌊ k β ⌋ . Ale, Ak ∩ Sα i Ak ∩ Sβ są rozłączne, więc ⌊ k α ⌋ + ⌊ k β ⌋ = k. (12.2) Oznaczmy 1 α + 1 β = 1 + ε. Wówczas, korzystając z C12.1.3, mamy dzięki (12.2), k ⩽ ⌊k(1 + ε)⌋ = k + ⌊kε⌋ ⩽ k + 1, czyli 0 ⩽ ⌊kε⌋ ⩽ 1 dla każdego k ∈ N. Jasne, że stąd ε = 0. Trzeba jeszcze wykazać, że α (i β) są niewymierne. To jest proste ćwiczenie, zobacz C12.9. □ Ćwiczenie 12.9 Udowodnić, że jeżeli α ∈ Q>0 i 1/α + 1/β = 1, to Sα ∩ Sβ ̸= ∅. ZADANIE 12.1 Załóżmy, że ”odsiewamy” liczby naturalne następująco: wybieramy a1 = 1 i odrzucamy a1 + 1 = 2. Następnie wybieramy następną liczbę a2 = 3 i odrzucamy a2 + 2 = 5. Następną osiągalną (to znaczy nie wybraną i nie odrzuconą) liczbą jest a3 = 4, więc odrzucamy a3 + 3 = 7. I tak dalej. Widzimy, że wybranymi początkowymi liczbami są 1, 3, 4, 6, 8, 9, 11, 12, 14, . . . . Znaleźć formułę wyrażającą an. R o z w i ą z a n i e. Zauważmy, że szukamy takiego ciągu (an), że ciągi (an) i (an+n) tworzą rozbicie zbioru N. Z twierdzenia Beatty’ego-Banga wiemy, że ciągi ⌊τ n⌋ i ⌊τ n⌋+n = ⌊(τ +1)n⌋ tworzą rozbicie N, gdy 1 τ + 1 τ +1 = 1. Ale wówczas τ jest złotą liczbą τ = (1 + √ 5)/2. Zatem an = ⌊τ n⌋. ♦ 12.1.3 Zadania z częścią ułamkową Pokażemy parę twierdzeń o części ułamkowej liczb rzeczywistych. ZADANIE 12.2 Udowodnić, że istnieje nieskończenie wiele liczb naturalnych n, dla któ- rych zachodzi nierówność podwójna 1 2n √2 < {n√2} < 1 + ε 2n√ 2 , gdzie ε > 0 jest ustaloną liczbą rzeczywistą. Ponadto, nierówność lewa zachodzi dla wszystkich liczb naturalnych n. 416 12. Kilka wiadomości dodatkowych R o z w i ą z a n i e. Udowodnimy najpierw lewą nierówność. Dla danej liczby n ∈ N oznaczmy m = ⌊n√ 2⌋. Wówczas m < n√2. Równość nie może zachodzić, bo √ 2 jest liczbą niewy- mierną. Zatem 1 ⩽ 2n 2 − m2 = (n √2 − m)(n √2 + m) = {n√2}(n√2 + m) < {n√ 2} · 2n√2. To dowodzi nierówności lewej. Niech teraz (ms, ns)s⩾0 będzie ciągiem dodatnich rozwiązań równania anty-indyjskiego m 2 − 2n2 = −1. (Wiemy z ustępu 11.4.4, że liczby ms, ns otrzymuje się z równości (1 + √2) 2s+1 = ms + ns√2, s = 0, 1, 2, . . . .) Ponieważ ciąg (ns) rośnie (szybko!) do nieskończoności, więc dla danej liczby ε > 0, nierówność ns > ( 1 + 1 ε ) · 1 2 √2 zachodzi dla wszystkich s ⩾ sε. Łatwo stąd wywnioskować, że dla n = ns, przy s ⩾ sε, zachodzi nierówność prawa. ♦. Pokażemy teraz, że jeżeli α jest liczbą niewymierną, to części ułamkowe liczb nα, n ∈ N, leżą gęsto w przedziale [ 0; 1 ]. ZADANIE 12.3 Udowodnić, że jeżeli α ∈ R jest liczbą niewymierną, to dla dowolnych liczb 0 ⩽ s < t ⩽ 1 istnieje taka liczba naturalna n, że s ⩽ {nα} ⩽ t. R o z w i ą z a n i e. Oznaczmy ε = t − s. Korzystając z T7.4 znajdujemy taką liczbę k ∈ N, by były spełnione nierówności |kα − h| < 1 2k oraz 1 2k < ε (12.3) przy pewnym h ∈ Z. Stąd kα = h + δ, gdzie |δ| < ε. Jeżeli δ > 0, to wybierzmy liczbę naturalną l spełniającą nierówności s δ < l < t δ (taki wybór jest możliwy, bo t δ − s δ > 1) i kładziemy n = lk. Wówczas nα = lh + lδ, skąd {nα} = lδ ∈ [ s; t ]. Jeżeli zaś δ < 0, to wybierzmy l ∈ N, dla której 1 − t −δ < l < 1 − s −δ i połóżmy n = lk. Wówczas, jak łatwo sprawdzić, {nα} = 1 + lδ ∈ [ s; t ]. ♦ 12.2. Zapis pozycyjny liczb 417 Ćwiczenie 12.10 Udowodnić, że do przedziału [ s; t ] należy w istocie nieskończenie wiele (każda inna) liczb {nα}. Ćwiczenie 12.11 Niech α ∈ R ∖ Q. Udowodnić, że w zbiorze Sα = {⌊nα⌋ : n ∈ N} da się wskazać 2015 liczb będących wyrazami ciągu arytmetycznego. Czy istnieją niestałe nieskończone ciągi arytmetyczne o wyrazach ze zbioru Sα? Okazuje się, że jeżeli α jest liczbą niewymierną, to części ułamkowe liczb nα, dla n ∈ N, są r ó w n o m i e r n i e r o z ł o ż o n e w odcinku [ 0; 1 ]. Mówi o tym poniższe, udowodnione przez Bohla, Sierpińskiego i Weyla (niezależnie w latach 1909-1910): TWIERDZENIE 12.2 (twierdzenie o ekwipartycji ) Jeżeli α jest liczbą niewymierną, to ciąg części ułamkowych {nα} jest jednostajnie rozłożony w przedziale [ 0; 1 ]. To oznacza, że dla dowolnych 0 ⩽ s < t ⩽ 1 zachodzi równość lim n→∞ |{k ∈ N : 1 ⩽ k ⩽ n, s ⩽ {kα} ⩽ t}| n = t − s. □ 12.2 Zapis pozycyjny liczb Jak wiadomo, od czasów ”arabskich” liczby naturalne (a potem również wymierne dodatnie i rzeczywiste dodatnie) zapisujemy w tak zwanym systemie pozycyjnym o danej podstawie. Podstawą jest w początkowych stadiach studiów matematycznych liczba 10, potem 2 i wreszcie dowolna, większa od 1, liczba naturalna m. Ustalamy liczbę naturalną m > 1. Elementy zbioru Cm = {0, 1, 2, . . . , m − 1} (12.4) nazywamy cyframi m-kowymi. 12.2.1 Zapis pozycyjny liczb naturalnych Zapis pozycyjny liczb naturalnych w systemie o podstawie m znany jest od szkoły podstawowej (przynajmniej dla m = 10 i m = 2). Mianowicie, dla danej liczby naturalnej N tworzymy ciąg cyfr m-kowych a0(N ), a1(N ), a2(N ), . . . , następująco: ak = ak(N ) ∈ Cm jest j e d y n ą taką cyfrą, że a0 + a1m + a2m 2 + . . . + akm k ≡ N (mod m k+1) (12.5) dla k = 0, 1, 2, . . . . Ćwiczenie 12.12 Uzasadnić, że kongruencje (12.5) wyznaczają j e d n o z n a c z n i e ciąg (ak) cyfr m-kowych liczby naturalnej N . Ćwiczenie 12.13 Udowodnić, że dla dowolnych N ∈ N i k ∈ Z⩾0 zachodzi równość ak(N ) = ⌊ N mk ⌋ − m ⌊ N mk+1 ⌋ . (12.6) 418 12. Kilka wiadomości dodatkowych Ćwiczenie 12.14 Udowodnić, że jeżeli N jest liczbą naturalną, to wyrazy ciągu (ak(N )) są równe zero od pewnego miejsca i zachodzi równość N = ∑ k⩾0 ak(N )mk. (12.7) ZADANIE 12.4 Dana jest liczba naturalna n ̸= 0. Udowodnić, że pewna wielokrotność qn, q ∈ N, liczby n ma w zapisie dziesiętnym wyłącznie cyfry 0 i 1. R o z w i ą z a n i e. Rozwiązanie jest prostym zastosowaniem zasady szuﬂadkowej. Rozważmy ciąg 1, 11, 111, 1111, . . . . Jeżeli weźmiemy n+1 początkowych wyrazów tego ciągu, to wśród nich znajdą się dwa dające tę samą resztę z dzielenia przez n. Jasne, że jeżeli odejmiemy mniejszy z nich od większego, to różnica spełnia postawione żądania. ♦ ZADANIE 12.5 Udowodnić, że istnieje nieskończenie wiele potęg 2, w zapisie dziesięt- nym których występuje cyfra 7. R o z w i ą z a n i e. Udowodnimy nieco więcej: istnieje nieskończenie wiele potęg 2, których zapis dziesiętny zaczyna się od cyfry 7. Wiemy z C12.11, że istnieje nieskończenie wiele takich liczb naturalnych n, że log 7 ⩽ {n log 2} < log 8. [Używamy tu logarytmu dziesiętnego.] Dodając ⌊n log 2⌋ dostajemy ⌊n log 2⌋ + log 7 ⩽ n log 2 < ⌊n log 2⌋ + log 8, czyli 7 · 10 k ⩽ 2 n < 8 · 10 k, dla nieskończenie wielu n (k = ⌊n log 2⌋). Ta nierówność, oczywiście, pokazuje, że w zapisie dziesiętnym liczby 2 n na pierwszym (od lewej strony) miejscu występuje cyfra 7. ♦ U w a g a. Tak samo, oczywiście, dowodzimy, że cyfra a ∈ {1, 2, . . . , 9} jest pierwszą cyfrą liczby 2 n, gdy część ułamkowa {n log 2} leży w przedziale [log a, log(a + 1)[. Warto to porównać z twierdzeniem T12.2. Otrzymamy interesujący w n i o s e k h e u r y s t y c z n y: ”prawdopodobieństwo”, że liczba 2 n zaczyna się cyfrą a wynosi log(a+1)−log a = log ( 1 + 1 a ) . W szczególności, potęgi dwójki ”chętniej” zaczynają się od cyfry 1 niż od cyfry 2, itd. Ćwiczenie 12.15 Udowodnić, że każda liczba naturalna ma wielokrotność, w zapisie m- kowym której występuje każda z cyfr 0, 1, . . . , m − 1. Ćwiczenie 12.16 Udowodnić, że nie istnieje taka liczba naturalna, która zmniejsza się 35-krotnie, gdy zetrzemy jej początkową cyfrę (w zapisie dziesiętnym). Ćwiczenie 12.17 n-cyfrowa liczba naturalna jest równa średniej arytmetycznej n! liczb uzyskanych z niej przez możliwe permutacje jej cyfr. Wyznaczyć wszystkie liczby o tej własno- ści. Ćwiczenie 12.18 Niech a0 + a1p + a2p2 + . . . + akpk będzie zapisem liczby naturalnej n w systemie p-kowym, gdzie p jest liczbą pierwszą. Udowodnić, że vp(n!) = n − a0 − a1 − a2 − . . . − ak p − 1 . Ćwiczenie 12.19 Udowodnić, że istnieje nieskończenie wiele potęg 2008, w zapisie dzie- siętnym których występują kolejno cyfry 2, 0, 0, 9. 12.2. Zapis pozycyjny liczb 419 12.2.2 Zapis pozycyjny liczb rzeczywistych W szkole utożsamiamy liczbę rzeczywistą z punktem osi liczbowej. Nazwiemy to inter- pretacją geometryczną liczb rzeczywistych. Istnieje, i również jest używana w matematyce szkolnej, interpretacja arytmetyczna liczb rzeczywistych d o d a t n i c h. W tej interpretacji utożsamia się dodatnią liczbę rzeczywistą α z jej zapisem pozycyjnym (zazwyczaj dziesiętnym), czyli z takim ciągiem (ak)k⩽n cyfr, że α = ∑ k⩽n ak10 k = an10 n + an−110 n−1 + an−210 n−2 + . . . . Uogólnimy i nieco uściślimy taki sposób myślenia o liczbach rzeczywistych. K o n s t r u k c j a liczb rzeczywistych przedstawiona jest na przykład w [ 10 ] lub w RIN . Ustalmy liczbę naturalną m > 1. Opowiemy najpierw o zapisie pozycyjnym liczb α ∈ R>0. Dla danej liczby k ∈ N przybliżamy (od dołu) liczbę α za pomocą największej całkowitej wielokrotności liczby m−k. To znaczy, wyznaczamy n a j w i ę k s z ą liczbę całkowitą Ak, dla której Akm −k ⩽ α. Wówczas Akm −k ⩽ α < (Ak + 1)m −k, skąd widzimy, że Ak jest częścią całkowitą liczby m kα. Połóżmy więc, dla dowolnego k ∈ N, Rk(α) = ⌊mkα⌋ mk = Akm−k. (12.8) Liczbę Rk(α) nazywamy k-tym reduktem liczby α przy podstawie m. Ćwiczenie 12.20 Wykorzystać nierówności 0 ⩽ α − Rk(α) < m −k do dowodu faktu, że ciąg (Rk(α))k reduktów liczby rzeczywistej α ⩾ 0 jest zbieżny do α. Zapiszmy teraz redukt Rk = Rk(α) w postaci s u m y t e l e s k o p o w e j: ⌊mkα⌋ mk = ⌊m kα⌋ − m⌊m k−1α⌋ mk + ⌊m k−1α⌋ − m⌊mk−2α⌋ mk−1 + . . . + ⌊mα⌋ − m⌊α⌋ m + ⌊α⌋. Dla skrótu połóżmy a−l = a−l(α) = ⌊mlα⌋ − m⌊m l−1α⌋ (12.9) dla l = 1, 2, 3, . . . . Wówczas powyższe przedstawienie k-tego reduktu zapisuje się następująco: Rk(α) = ⌊α⌋ + a−1 m + a−2 m2 + . . . + a−k mk . (12.10) Liczbę a−l(α) nazywamy l-tą cyfrą po przecinku (w zapisie liczby α przy podstawie m). Ćwiczenie 12.21 Udowodnić, że a−l(α) są cyframi m-kowymi. Zapiszmy teraz część całkowitą ⌊α⌋ liczby α w systemie pozycyjnym przy podstawie m: ⌊α⌋ = a0 + a1m + . . . + anm n. 420 12. Kilka wiadomości dodatkowych Ćwiczenie 12.22 Udowodnić, że w takim przypadku zachodzą równości aj = ⌊ α mj ⌋ − m ⌊ α mj−1 ⌋ = aj(⌊α⌋). Ćwiczenia C12.20, C12.21 i C12.22 pozwalają więc dla dowolnej nieujemnej liczby rzeczy- wistej α napisać równość α = ∑ k⩾−n a−k(α)m −k, (12.11) gdzie a−k(α) = ⌊m kα⌋ − m⌊m k−1α⌋, dla k ∈ Z, są cyframi m-kowymi. Zapis (12.11) nazywamy zapisem pozycyjnym liczby rzeczywistej α ⩾ 0 (w systemie) przy podstawie m. ”Numerycznie” zapisujemy tę równość następująco: α = ⌊α⌋ + (0, a−1a−2a−3 . . . )m. (12.12) Dla danej liczby α > 0 i danej liczby n ∈ N połóżmy αn = m n (α − Rn(α)) = mnα − ⌊m nα⌋. (12.13) Ćwiczenie 12.23 Sprawdzić, że dla k ∈ N zachodzi równość a−k(α) = ⌊mαk⌋. Ćwiczenie 12.24 Udowodnić, że ciąg cyfr (a−n(α))n∈N jest okresowy (od pewnego miej- sca) wtedy i tylko wtedy, gdy istnieją takie liczby naturalne k < l, że αk = αl. Najważniejszym twierdzeniem dotyczącym zapisu pozycyjnego liczb rzeczywistych doda- tnich jest poniższe: TWIERDZENIE 12.3 Liczba rzeczywista dodatnia ma okresowy (od pewnego miejsca) zapis pozycyjny przy podstawie m wtedy i tylko wtedy, gdy jest liczbą wymierną. D O W Ó D. (⇐=) Niech α = u w będzie dodatnią liczbą wymierną. Nie zmniejszając ogólno- ści rozważań możemy założyć, że 0 < u < w. Wówczas αk = mku/w − ⌊m ku/w⌋. Wykonajmy dzielenie m ku przez w z resztą: m ku = qkw + rk, 0 ⩽ rk < w. (12.14) Możemy więc zapisać αk = m ku w − ⌊ mku w ⌋ = qk + rk w − ⌊qk + rk w ⌋ = rk w . (12.15) Ponieważ reszty rk, dla k = 1, 2, . . . , przyjmują tylko wartości ze zbioru {0, 1, . . . , w − 1}, więc w ciągu r1, r2, . . . , rw+1 znajdą się dwa r ó w n e wyrazy. Zatem αk = αl dla pewnych 1 ⩽ k < l ⩽ w + 1. Na mocy C12.24 widzimy więc, że ciąg (a−n(u/w)) cyfr m-kowych liczby u w jest okresowy o okresie długości n i e w i ę k s z e j niż w. 12.3. Ułamki egipskie 421 (=⇒) Dowód w tę stronę jest prostym wykorzystaniem wzoru na sumę wyrazów ciągu geometrycznego. Załóżmy, że α = ⌊α⌋ + (0, a−1a−2 . . . a−nc1c2 . . . ck)m. (12.16) Patrz (12.12). Oznaczmy A = c1 m + c2 m2 + . . . + ck mk . Przy tym oznaczeniu, równość (12.11) pisze się następująco: α = ⌊α⌋ + a−1 m + . . . + a−n mn + 1 mn (A + A mk + A m2k + A m3k + . . .) . Ponieważ wyrażenie w nawiasie równe jest A (1 − 1 mk )−1, więc widzimy, że α ∈ Q. □ Korzystając z (12.14) i (12.15) łatwo rozwiążemy dwa ćwiczenia. Ćwiczenie 12.25 Udowodnić, że przedstawienie liczby α ∈ Q>0 ∖ N w systemie pozycyj- nym przy podstawie m jest s k o ń c z o n e (to znaczy, że cyfry a−n są równe zero od pewnego miejsca) wtedy i tylko wtedy, gdy zachodzi równość α = a b , gdzie mianownik b dzieli się przez takie i tylko takie liczby pierwsze p, dla których vp(m) > 0. Ćwiczenie 12.26 Udowodnić, że zapis m-kowy liczby wymiernej 1 p , gdzie p jest liczbą pierwszą, jest czysto-okresowy o okresie długości p − 1 wtedy i tylko wtedy, gdy m (mod p) jest pierwiastkiem pierwotnym modulo p. Zobacz też C5.52. 12.3 Ułamki egipskie Starożytni egipcjanie używali w zasadzie tylko najprostszych ułamków. Ułamków postaci 1/n, gdzie n ∈ N. Będziemy je wobec tego nazywać ułamkami egipskimi. 1 12.3.1 Skończone sumy ułamków egipskich Sumy ułamków egipskich są, oczywiście, liczbami wymiernymi dodatnimi. Zajmiemy się pyta- niem odwrotnym: czy każda liczba wymierna dodatnia jest sumą ułamków egipskich? Odpo- wiedź na tak postawione pytanie jest trywialna: t a k. Bowiem m/n = 1/n + 1/n + . . . + 1/n. Utrudnimy więc pytanie: czy każda liczba wymierna dodatnia α = m/n da się zapisać w postaci α = 1 k1 + 1 k2 + . . . + 1 ks , gdzie k1 < k2 < . . . < ks? (12.17) 1Nazywa sie je również ułamkami prostymi. Zobacz [17] gdzie znaleźć można dużo więcej informacji na temat sum ułamków egipskich. 422 12. Kilka wiadomości dodatkowych Sumy dwóch ułamków egipskich Zaczniemy od rozkładów liczb wymiernych (dodatnich) na sumy d w ó c h ułamków egipskich. Ćwiczenie 12.27 Udowodnić twierdzenie A. Schinzla: Liczba wymierna m/n > 0 (dana w postaci nieskracalnej) jest sumą dwóch ułamków egipskich wtedy i tylko wtedy, gdy mianow- nik n ma takie względnie pierwsze dzielniki a, b, że m|a + b. Ćwiczenie 12.28 Udowodnić, że na to żeby liczba wymierna m/n > 0 (dana w postaci nieskracalnej) była sumą dwóch ułamków egipskich o względnie pierwszych mianownikach, potrzeba i wystarcza, aby liczba m2 − 4n była kwadratem (liczby całkowitej). Ćwiczenie 12.29 Udowodnić, że istnieje nieskończenie wiele liczb naturalnych n, dla któ- rych liczba wymierna 3/n n i e jest sumą dwóch ułamków egipskich. Hipoteza Erd˝osa-Strausa W związku z rozkładami liczb wymiernych dodatnich na sumy ułamków egipskich mamy wiele nierozstrzygniętych pytań. Odsyłając zainteresowanego Czytelnika do literatury, wspomnimy tu tylko o hipotezie Erd˝osa-Strausa: Dla dowolnej liczby naturalnej n liczba 4/n da się zapisać w postaci sumy trzech ułamków egipskich, innymi słowy, równanie 4 n = 1 x + 1 y + 1 z ma rozwiązania w liczbach n a t u r a l n y c h x, y, z dla każdego n ∈ N. Hipoteza ta została sprawdzona dla wszystkich n ∈ [ 2; 10 14 ] ∩ N. Ćwiczenie 12.30 Sprawdzić hipotezę Erd˝osa-Strausa dla n = 2, . . . , 20. Rozkłady jedynki Przedstawienie liczby 1 w postaci sumy r ó ż n y c h ułamków egipskich nazwiemy rozkładem jedynki. Każdy zna najprostszy rozkład jedynki (jedyny na trzy składniki, zobacz Z11.1): 1 = 1 2 + 1 3 + 1 6. (12.18) Łatwo podać rozkłady jedynki na sumy parzystych (to znaczy o parzystych mianownikach) ułamków egipskich. Serię prostych przykładów widzimy poniżej: 1 = 1 2 + 1 4 + . . . + 1 2n + 1 2n+1 + 1 3·2n + 1 6·2n . (12.19) [Suma pierwszych n wyrazów jest równa 1 − 1 2n , pozostałe trzy składniki powstają przez pomnożenie obu stron równości (12.18) przez 1 2n .] Jeżeli znajdziemy liczbę naturalną N i takie jej r ó ż n e dzielniki 1 ⩽ d1 < d2 < . . . < ds, że N = d1 + d2 + . . . + ds, to dzieląc tę równość przez N znajdujemy rozkład jedynki: 1 = 1 k1 + 1 k2 + . . . + 1 ks , gdzie N = ds−jkj+1 dla j = 0, . . . , s − 1. W ten sposób z sumy 6 = 1 + 2 + 3 powstaje rozkład (12.18). Wszystkie inne liczby doskonałe dostarczają podobnych przykładów. 12.3. Ułamki egipskie 423 Ćwiczenie 12.31 Uzasadnić, że n i e istnieje rozkład jedynki na sumę dwóch, ani trzech, ani czterech, ani pięciu, ani sześciu różnych nieparzystych (o nieparzystych mianownikach) ułamków egipskich. Istnieją takie liczby n i e p a r z y s t e, które są sumami swoich różnych dzielników. Każda taka liczba dostarcza więc przykładu rozkładu jedynki na sumę nieparzystych ułamków egip- skich. P r z y k ł a d 1. Niech N = 3465 = 3 2 · 5 · 7 · 11. Mamy 3465 = 1155 + 693 + 495 + 385 + 315 + 231 + 99 + 77 + 15, skąd dostajemy dziewięciowyrazowy nieparzysty rozkład jedynki: 1 = 1 3 + 1 5 + 1 7 + 1 9 + 1 11 + 1 15 + 1 35 + 1 45 + 1 231. ♦ P r z y k ł a d 2. Interesującą własność ma liczba 945 = 3 3 · 5 · 7. Oto zbiór jej dodatnich dzielników: D+(945) = {1, 3, 5, 7, 9, 15, 21, 27, 35, 45, 63, 105, 135, 189, 315, 945}. Można udowodnić, że nie tylko sama liczba 945, ale wszystkie liczby naturalne z przedziału [ 1; σ(945) ], z wyjątkiem 2 i 1918, są sumami różnych elementów zbioru D+(945). W szcze- gólności 945 = 315 + 189 + 135 + 105 + 63 + 45 + 35 + 27 + 21 + 9 + 1. Stąd dostajemy jedenastowyrazowy nieparzysty rozkład jedynki: 1 = 1 3 + 1 5 + 1 7 + 1 9 + 1 15 + 1 21 + 1 27 + 1 35 + 1 45 + 1 105 + 1 945 ♦ Ćwiczenie 12.32 Udowodnić, że każda liczba naturalna m ∈ [ 1920 ]∖{2, 1918} jest sumą r ó ż n y c h elementów zbioru D+(945). Ćwiczenie 12.33 Udowodnić, że istnieją rozkłady jedynki na sumę nieparzystych (i róż- nych) ułamków egipskich mające dowolną nieparzystą i większą niż 7 liczbę składników. Wska- zówka. Można wykorzystać rozkład 1/3 = 1/5 + 1/9 + 1/45. Ćwiczenie 12.34 Udowodnić, że żadna liczba naturalna ⩾ 2 nie da się zapisać w postaci sumy różnych kwadratowych ułamków egipskich (tzn. ułamków postaci 1/k2). Ćwiczenie 12.35 Udowodnić, że żadna liczba naturalna nie jest sumą różnych ułamków egipskich o mianownikach będących liczbami pierwszymi. Algorytm Fibonacci’ego Fibonacci pokazał prosty algorytm pozwalający uzyskiwać przedstawienia postaci (12.17) dla dodatnich liczb wymiernych m/n niewiększych od 1 (tzw. ułamków właściwych). Niech mianowicie m/n będzie ułamkiem właściwym nieegipskim danym w postaci nieskracalnej, to znaczy, że 2 ⩽ m ⩽ n i NWD (m, n) = 1. Niech k1 będzie jedyną taką liczbą naturalną, że 1 k1 < m n < 1 k1 − 1. (12.20) Łatwo widzieć, że jeżeli m ⩾ 2, to takie k1 istnieje (oczywiście k1 = ⌈ n m ⌉, gdzie ⌈x⌉ oznacza najmniejszą liczbę całkowitą większą bądź równą x, jest to tak zwany suﬁt liczby x ∈ R). 424 12. Kilka wiadomości dodatkowych Wówczas m n − 1 k1 = k1m−n k1n =: m′ n′ = m1 n1 , gdzie m1 n1 jest postacią nieskracalną ułamka m′ n′ . W ten sposób otrzymujemy przedstawienie m n = 1 k1 + m1 n1 , Ćwiczenie 12.36 Udowodnić, że wówczas m1 ⩽ m ′ < m oraz że, jeżeli m1 ⩾ 2, to k2 := ⌈ n1 m1 ⌉ > k1. Stąd wynika, że sztuczkę polegającą na odejmowaniu największego ułamka egipskiego mniej- szego niż dana liczba wymierna z przedziału ( 0; 1 ) możemy powtarzać aż do momentu, gdy dostaniemy licznik ms = 1. Opisaną tym sposobem procedurę nazwiemy algorytmem Fibo- nacci’ ego lub algorytmem zachłannym (ang. greedy). Jego ”zachłanność” przejawia się w tym, że prowadzi on zazwyczaj do dużych mianowników ki. P r z y k ł a d 3. Stosując algorytm Fibonacci’ego do liczby 59 120 dostajemy rozkład 59 120 = 1 3 + 1 7 + 1 65 + 1 10920. Tymczasem 59 120 = 1 5 + 1 6 + 1 8. ♦ Dzięki algorytmowi Fibonacci’ego możemy udowodnić twierdzenie: TWIERDZENIE 12.4 Każda liczba wymierna dodatnia może być zapisana w postaci sumy r ó ż n y c h ułamków egipskich (i to na nieskończenie wiele sposobów). D O W Ó D. Niech α ∈ Q>0. Pokażemy najpierw i s t n i e n i e rozkładu postaci (12.17). Jeżeli α ⩽ 1, to już wiemy. Załóżmy więc, że α > 1. Korzystając z twierdzenia T12.5 znajdziemy taką liczbę naturalną n, że hn−1 ⩽ α < hn. Jeżeli α = hn−1, to koniec. Załóżmy więc, że hn−1 < α < hn i rozważmy dodatnią liczbę wymierną β = α − hn−1. Ponieważ β < hn − hn−1 = 1 n < 1, więc stosując do β algorytm Fibonacci’ego znajdujemy rozkład β = 1 k1 + · · · + 1 ks , gdzie 1 k1 < β < 1 n. Ostatecznie α = hn−1 + β = 1 1 + . . . + 1 n−1 + 1 k1 + . . . + 1 ks i 1 < 2 < . . . < n − 1 < k1 < . . . < ks. Mamy więc szukany rozkład. Chcemy jeszcze udowodnić, że różnych takich rozkładów danej liczby α ∈ Q>0 jest dowolnie wiele. W tym celu pokażemy metodę, która dla danego rozkładu (12.17) pozwala wskazać roz- kład liczby α o istotnie większych mianownikach. Weźmy mianowicie dowolną liczbę naturalną N > ks i dowolny rozkład N α = 1 l1 + 1 l2 + . . . + 1 lt spełniający warunek l1 < l2 < . . . < lt. Dzieląc tę równość obustronnie przez N znajdujemy rozkład liczby α α = 1 N l1 + 1 N l2 + . . . + 1 N lt , dla którego ks < N ⩽ N l1 < N l2 < . . . < N lt. To kończy dowód. □ Zachęcamy Czytelnika do przeczytania książki Wacława Sierpińskiego [17], gdzie między innymi znaleźć można dowód twierdzenia, że każda dodatnia liczba wymierna o nieparzystym mianowniku jest sumą r ó ż n y c h nieparzystych ułamków egipskich. 12.3. Ułamki egipskie 425 12.3.2 Szeregi harmoniczne Pokażemy teraz, że ”sumą” w s z y s t k i c h ułamków egipskich jest ”n i e s k o ń c z o n o ś ć”. To znaczy, że ciąg (hn), którego n-ty wyraz równy jest sumie ∑n k=1 1/k, jest ciągiem rosnącym do nieskończoności (ma d o w o l n i e duże wyrazy). Z tego faktu korzystaliśmy już w dowodzie T12.4. Pokażemy jeszcze parę jego zastosowań w teorii liczb. Ustęp zakończymy pięknym rozwiązaniem tak zwanego problemu bazylejskiego. Wygodnie jest badać ogólniejsze sumy postaci hn(s) := 1 + 1 2s + 1 3s + . . . + 1 ns , (12.21) gdzie s ∈ R. Zamiast hn(1) piszemy po prostu hn. Jasne, że ciąg (hn(s))n⩾1 jest ciągiem ściśle rosnącym. Może być o g r a n i c z o n y (na przykład hn(2) ⩽ 2 dla każdego n ∈ N, zobacz C1.4), albo n i e o g r a n i c z o n y (na przykład hn(0) ⩾ n dla każdego n ∈ N). TWIERDZENIE 12.5 Jeżeli s > 1, to ciąg (hn(s))n⩾1 jest ciągiem ograniczonym, jeżeli zaś s ⩽ 1, to ciąg (hn(s)n⩾1 jest ciągiem nieograniczonym (rosnącym do nieskończoności). D O W Ó D. Zaczniemy od przypadku s = 1. Niech n = 2k. Zapiszmy liczbę hn = hn(1) następująco: hn = 1 + 1 2 + ( 1 3 + 1 4 ) + . . . + ( 1 2k−1 + 1 + 1 2k−1 + 2 + . . . + 1 2k ) . Ponieważ, jak łatwo widzieć, suma liczb w każdym ze wskazanych nawiasów jest > 1 2, więc mamy oszacowanie h2k ⩾ 1 + k 2 dla każdego k ∈ N. Jeżeli dla danej liczby M wybierzemy dowolną liczbę naturalną k spełniającą warunek k ⩾ 2(M − 1), to, jak widać z tego oszaco- wania, h2k ⩾ M . To znaczy, że liczby hn są d o w o l n i e d u ż e (dla dostatecznie dużych n). [Inaczej mówiąc: jeżeli startujemy z punktu 0 na osi liczbowej i kroczymy ”w prawo” przy czym tak, że nasz k-ty krok ma długość równą 1 k , to możemy zajść d o w o l n i e d a l e k o.] Jeżeli teraz s ⩽ 1, to dla każdego k ∈ N mamy nierówność ks ⩽ k, więc hn(s) = n∑ k=1 1 ks ⩾ n∑ k=1 1 k = hn. Ponieważ ciąg (hn) jest ciągiem rosnącym do +∞, więc, mający większe wyrazy, ciąg (hn(s)) tym bardziej rośnie do +∞. Załóżmy teraz, że s > 1. Połóżmy s = 1 + t, gdzie t > 0. Wówczas, dla n = 2 k − 1 hn(s) = (1) + ( 1 2s + 1 3s ) + ( 1 4s + 1 5s + 1 6s + 1 7s ) + . . . + ( 1 (2k−1)s + . . . + 1 (2k − 1)s ) . Widzimy, że liczba hn(s) jest (przy n = 2 k − 1) sumą k składników (w nawiasach), z których l-ty jest sumą 2 l−1 składników mniejszych bądź równych 2 ls. Wobec tego hn(s) ⩽ 1 + 2 2s + 4 4s + . . . + 2 k−1 (2k−1)s = 1 + 1 2t + 1 4t + . . . + 1 (2k−1)t . 426 12. Kilka wiadomości dodatkowych Z prawej strony widzimy tu sumę skończonej liczby wyrazów ciągu geometrycznego o ilorazie 2 −t. Więc suma ta jest < niż suma w s z y s t k i c h wyrazów takiego ciągu: hn(s) < 1 1 − 2−t = 2 t 2t − 1 = 2 s−1 2s−1 − 1. (12.22) [Zauważmy, że przy s = 2 otrzymaliśmy to samo szacowanie co w C1.4.] Stąd natychmiast dostajemy ograniczoność ciągu (hn(s))n⩾1. □ Ćwiczenie 12.37 Czy możecie uzasadnić nieograniczoność ciągu (hn) za pomocą poniż- szych napisów ∞∑ k=1 1 k = ∞∑ l=0 ( 1 2l + 1 + 1 2l + 2 ) > ∞∑ l=0 ( 1 2l + 2 + 1 2l + 2 ) = ∞∑ l=0 1 l + 1 = ∞∑ k=1 1 k ? Należy przy tym zwrócić uwagę na dwie okoliczności: (1) zarówno wszystkie trzy występujące tu znaki równości jak i znak nierówności w y m a g a j ą zrozumienia i uzasadnienia, (2) powstały w ten sposób dowód rozbieżności ciągu (hn) do nieskończoności, w przeciwieństwie do pokazanego w dowodzie twierdzenia, n i e daje wyobrażenia o s z y b k o ś c i tej rozbieżności. Dla s > 1 oznaczamy przez ζ(s) n a j m n i e j s z e ograniczenie (górne) ciągu (hn(s)). To znaczy, że hn(s) < ζ(s) dla każdego n, ale nierówność hn(s) < ζ(s) − ε może (przy ε > 0) zachodzić dla skończonej tylko liczby indeksów n. Zapisujemy to tak: ζ(s) = ∞∑ n=1 1 ns = lim n→∞ hn(s). Pokażemy teraz (mało teorioliczbowe, dlaczego?) zastosowanie rozbieżności ciągu (hn): ZADANIE 12.6 Dana jest (ustalona) liczba naturalna a. Udowodnić, że w zapisie dzie- siętnym pewnej jej wielokrotności występują wszystkie cyfry 0, 1, . . . , 9. R o z w i ą z a n i e. Dla danej cyfry l ∈ {0, 1, . . . , 9} oznaczmy przez Cl zbiór tych wszyst- kich liczb naturalnych, w zapisie dziesiętnym których n i e występuje cyfra l. Gdy l ̸= 0, to liczb s-cyfrowych w zbiorze Cl jest 8 · 9 s−1 i każda z nich jest ⩾ 10 s−1. Zatem suma odwrot- ności wszystkich, mających mniej niż N cyfr, liczb należących do Cl spełnia nierówność ∑ k∈Cl, 1⩽k<10N 1 k ⩽ 8 + 8 · 9 10 + 8 · 9 2 102 + . . . + 8 · 9 N 10N = 80(1 − (0, 9)N +1) < 80. Wobec tego ∑ k∈Cl 1 k < 80 dla każdego l = 1, . . . , 9. Przy l = 0 dostajemy analogicznie ∑ k∈C0 1 k < 90. Załóżmy teraz nie wprost, że w s z y s t k i e wielokrotności ka liczby a należą do sumy C = C0 ∪ C1 ∪ . . . ∪ C9 (to znaczy, że żadna wielokrotność ka nie jest dobra). Wtedy ∑ k⩾1 1 ka = ∑ k∈C 1 ka < ∑ r∈C0 1 r + 9∑ l=1 ∑ r∈Cl 1 r < 90 + 9 · 80. Dostaliśmy sprzeczność z r o z b i e ż n o ś c i ą ciągu (hn/a). Czytelnik z pewnością potraﬁ do- strzec i naprawić pozostawione tu rozmyślnie luki matematyczne. ♦ 12.3. Ułamki egipskie 427 Ćwiczenie 12.38 Ciąg (an) ma wyrazy całkowite i jest ściśle rosnący. Załóżmy ponadto, że |an| ⩽ 2016 2017n dla wszystkich n większych niż 2018 2019. Wykazać, że istnieje co najmniej 2020 2021 takich indeksów n ∈ N, że an jest liczbą naturalną, w zapisie dziesiętnym której występuje 2022 2023 cyfr równych 7 pod rząd. Pokażemy teraz zapowiadany nowy dowód twierdzenia Schura T5.3. Ten dowód ma się tak do pokazanego w ustępie 5.1.3, jak nasz czwarty dowód te ma się do naszego pierwszego dowodu te, zobacz ustęp 2.3.2. D O W Ó D. Niech f (X) ∈ Z[X], deg f (X) = n ≥ 1. Chcemy wykazać, że kongruencja f (x) ≡ 0 (mod p) (12.23) ma rozwiązania w liczbach naturalnych dla n i e s k o ń c z e n i e wielu liczb pierwszych p. Jasne, że jeżeli wielomian f (X) ma pierwiastek całkowity, na przykład f (u) = 0, to dla d o w o l n e j liczby pierwszej p i dostatecznie dużych t ∈ N, liczba u+tp jest naturalnym (należącym do N) pierwiastkiem kongruencji (12.23). Załóżmy więc, że f (X) nie ma pierwiastków całkowitych. W szczególności f (k) ̸= 0 dla wszystkich k ∈ N. Załóżmy też, nie wprost, że kongruencje f (x) ≡ 0 (mod p) mają rozwiązania w y ł ą c z n i e dla p ∈ {p1, p2, . . . , pr}. To, oczywiście, znaczy, że dla dowolnego k ∈ N liczba naturalna(!) |f (k)| dzieli się tylko przez liczby pierwsze ze zbioru {p1, . . . , pr}. Czyli zachodzi równość |f (k)| = pe1 1 pe2 2 · . . . · per r (12.24) dla pewnych (zależnych od k) wykładników e1, . . . , er. Stąd ∑ k⩾1 1 |f (k)|s ⩽ 2n ∑ e1,...,er⩾0 1 pe1s 1 · . . . · pers r = 2n r∏ j=1 ( 1 + 1 ps j + 1 p2s j + 1 p3s j + . . . ) . Nierówność jest jasna, ponieważ dana liczba stojąca z prawej strony (12.24) może być warto- ścią |f (k)| dla co najwyżej 2n wartości k. Korzystając ze wzoru na sumę wyrazów ciągu geometrycznego, mamy więc dla dowolnego s > 0: ∑ k⩾1 1 |f (k)|s ⩽ 2n r∏ j=1 ps j ps j − 1. (12.25) Z drugiej strony, ponieważ |f (x)| ⩽ xn+1 dla wszystkich x ⩾ M (gdzie M ⩾ 1), więc ∑ k⩾M 1 k ⩽ ∑ k⩾M 1 |f (k)|s ⩽ ∑ k⩾1 1 |f (k)|s , dla dowolnego 0 < s < 1/(n + 1). To jest sprzeczne z nierównością (12.25). □ Dla ułatwienia wysłowień przyjmijmy deﬁnicję: Deﬁnicja 12.2 Mówimy, że podzbiór D ⊆ N jest szczupły, gdy istnieje taka stała M , że ∑ k∈D 1 k ⩽ M . W przypadku przeciwnym mówimy, że D jest zbiorem obszernym. ZADANIE 12.7 Dowieść, że zbiór liczb bezkwadratowych jest zbiorem o b s z e r n y m. 428 12. Kilka wiadomości dodatkowych R o z w i ą z a n i e. Załóżmy nie wprost, że zbiór B liczb naturalnych bezkwadratowych jest szczupły, czyli że ∑ k∈B 1 k ⩽ M dla pewnej stałej M . Wówczas, zobacz C2.36, ∑ k∈N 1 k = ∑ a∈N ∑ k∈B 1 a2k = ∑ a∈N ( 1 a2 ∑ k∈B 1 k ) ⩽ ∑ a∈N M a2 = M ζ(2) < ∞. Uzyskana sprzeczność kończy rozwiązanie. ♦ TWIERDZENIE 12.6 (Euler ) Zbiór P liczb pierwszych jest zbiorem o b s z e r n y m. D O W Ó D. (I. Niven) Oznaczmy przez Bx zbiór wszystkich takich liczb naturalnych bez- kwadratowych, które dzielą się tylko przez liczby pierwsze ⩽ x. Wówczas, zakładając nie wprost, że ∑ p∈P 1 p ⩽ M , dostajemy ∑ k∈Bx 1 k = ∏ p⩽x ( 1 + 1 p ) < ∏ p⩽x e1/p = exp ∑ p⩽x 1 p ⩽ eM . Korzystamy tu z nierówności 1 + x < e x =: exp x prawdziwej dla x > 0. Ponieważ, zgodnie z Z12.7, limx→∞ ∑ k∈Bx 1 k = ∞, więc mamy sprzeczność. □ U w a g a 1. Zbiór obszerny jest zbiorem nieskończonym. To jest oczywiste. Dzięki T12.6 widzimy więc (po raz kolejny!), że card(P) = ∞. U w a g a 2. Nie wiemy czy zbiór Ptwin liczb pierwszych bliźniaczych (zobacz 2.3.3 P1) jest nieskończony. Wiemy, że jest on zbiorem szczupłym. Udowodnił to Viggo Brun (1919). Zatem ∑ p∈Ptwin 1 p < M (12.26) dla pewnej stałej M . Udowodniono później, że można przyjąć M = 1, 71, zobacz [ 6 ]. U w a g a 3. Zbiór kwadratów jest szczupły. Można zapytać o w a r t o ś ć ζ(2) (pytanie znane jako problem bazylejski ). Ustęp zakończymy pięknym rozwiązaniem tego problemu: TWIERDZENIE 12.7 (Euler – 1735) Zachodzi równość ζ(2) = π2/6. D O W Ó D. (1) Pokażemy najpierw ”trygonometryczne” przybliżenie liczb hn(2). Wy- startujemy od znanej nierówności sin x < x < tg x prawdziwej dla wszystkich x ∈ ( 0; π 2 ). Prosty dowód znaleźć można w każdym podręczniku analizy matematycznej, również w RIN . Nierówność tę zapiszemy w r ó w n o w a ż n e j postaci ctg2 x < 1 x2 < 1 + ctg2 x. Kładąc tu kolejno x = xk = kπ 2n+1 (dla k = 1, 2, . . . , n) i dodając stronami, dostajemy n∑ k=1 (ctg kπ 2n + 1 )2 < (2n + 1)2 π2 n∑ k=1 1 k2 < n + n∑ k=1 ( ctg kπ 2n + 1 )2 . (12.27) 12.3. Ułamki egipskie 429 (2) Obliczymy występującą po obu stronach powyższych nierówności sumę ∑n k=1 ctg2 xk. W tym celu pokażemy wielomian, którego pierwiastkami są liczby ctg2 xk i zastosujemy wzór Vi`ete’a (na sumę pierwiastków wielomianu). Tym wielomianem jest wielomian Qn(X) = ( 2n + 1 1 ) X n − (2n + 1 3 )X n−1 + ( 2n + 1 5 ) X n−2 − . . . . Aby to zobaczyć przekształcimy wzór de Moivre’a: (sin ϕ)m(ctg ϕ + i)m = cos mϕ + i sin mϕ. Następnie, kładąc m = 2n+1, zastosujemy wzór dwumienny (1.7) i porównamy części urojone: sin(2n + 1)ϕ (sin ϕ)2n+1 = (2n + 1 1 )(ctg2 ϕ) n − (2n + 1 3 ) (ctg2 ϕ) n−1 + ( 2n + 1 5 ) (ctg2 ϕ)n−2 − . . . . Stąd widzimy, że każda z n (różnych!) liczb ctg2 xk, dla k = 1, 2, . . . , n, jest pierwiastkiem wielomianu n-tego stopnia Qn(X). Wobec tego i wzoru Vi`ete’a: n∑ k=1 ctg2 xk = ( 2n+1 3 ) ( 2n+1 1 ) = n(2n − 1) 3 . (12.28) (3) Udowodniona równość (12.28) pozwala przekształcić nierówności (12.27): n(2n − 1) 3(2n + 1)2 · π2 < hn(2) < 3n + n(2n − 1) 3(2n + 1)2 · π2. Twierdzenie o trzech ciągach kończy rozumowanie. □ U w a g a 4. Euler udowodnił więcej: ζ(2m) = (−1) m−1B2m 2 · (2m)! (2π)2m dla każdego m ∈ N. B2m oznacza tu liczbę Bernoulli’ego. N i e znamy podobnych wyrażeń dla ζ(2m + 1). Ćwiczenie. Udowodnić, że ∑ k∈N (2k − 1)−2 = π2/8. 12.3.3 Liczby harmoniczne. Twierdzenie Wolstenholme’a Sumę hn = hn(1) nazwiemy n-tą liczbą harmoniczną. Mamy więc hn = 1 + 1 2 + 1 3 + . . . + 1 n = A(n) B(n). (12.29) Umawiamy się w takiej sytuacji, że ułamek A(n) B(n) jest nieskracalny, tzn. że A(n) ⊥ B(n). ZADANIE 12.8 Udowodnić, że hn ̸∈ N dla n > 1. R o z w i ą z a n i e. Niech k oznacza taki wykładnik, że 2 k ⩽ n < 2 k+1. Niech m będzie najmniejszą wspólną wielokrotnością wszystkich liczb 1, 2, . . . , n z w y j ą t k i e m 2 k. Wtedy m hn = m+ m 2 + . . . + m n . Jasne, że wszystkie, z w y j ą t k i e m m/2 k, składniki po prawej stronie tej równości są liczbami całkowitymi. Gdyby więc hn było liczbą całkowitą, to mielibyśmy sprzeczność. ♦ 430 12. Kilka wiadomości dodatkowych Ćwiczenie 12.39 Udowodnić, że B(n) > n 2 dla każdego n ∈ N. Wskazówka. Jeżeli k jest takie jak w rozwiązaniu zadania Z12.8, to 2 k jest dzielnikiem B(n), więc n/2 < 2 k ⩽ B(n). Ćwiczenie 12.40 Czy różnica hn − hm może być liczbą całkowitą? Ćwiczenie 12.41 Niech a1, a2, . . . , an, przy n ⩾ 2, będą niezerowymi liczbami całkowi- tymi. Załóżmy, że istnieje taka liczba pierwsza p, że vp(ai) > max j̸=i {vp(aj)} dla pewnego i ∈ [ n ]. Udowodnić, że liczba 1/a1 + 1/a2 + . . . + 1/an nie jest liczbą całkowitą. Interesują nas arytmetyczne własności liczników liczb harmonicznych (i podobnych do nich). Dla wygodniejszego zapisywania takich własności u m a w i a m y się, że jeżeli w jest liczbą wymierną, to napis w ≡ 0 (mod m) oznacza, że m|a, gdzie a b jest ułamkiem nieskracalnym równym w. [Poprawność tej umowy wynika z C2.18.] Czytelnik s p r a w d z i, że jeżeli dla liczb wymiernych w, u zachodzi w ≡ 0 (mod m) i u ≡ 0 (mod m), to w + u ≡ 0 (mod m). LEMAT 12.1 Ustalmy m ∈ N. Dane są liczby aj, bj ∈ Z̸=0, przy czym bj ⊥ m dla każdego j = 1, 2, . . . , s. Wówczas a1 b1 + a2 b2 + . . . + as bs ≡ 0 (mod m) (12.30) wtedy i tylko wtedy, gdy a1b−1 1 + a2b−1 2 + . . . + anb−1 n ≡ 0 (mod m), gdzie b−1 j oznacza odwrotność bj modulo m. D O W Ó D. Zapiszmy sumę z lewej strony (12.30) w postaci ułamka nieskracalnego a1 b1 + a2 b2 + . . . + as bs = A B . Równość ta może być zapisana w postaci Ab1b2 · . . . · bs = B(a1b2b3 · . . . · bs + b1a2b3 · . . . · bs + . . . + b1b2 · . . . · as). Stąd, wobec względnej pierwszości A ⊥ B, bj ⊥ m i ZTA, widzimy, że A ≡ 0 (mod m) ⇐⇒ a1b2b3 · . . . · bs + b1a2b3 · . . . · bs + . . . + b1b2 · . . . · as ≡ 0 (mod m). Wystarczy teraz pomnożyć obie strony drugiej z tych kongruencji przez odwracalny (mod m) iloczyn b−1 1 b−1 2 · . . . · b−1 s . □ Ćwiczenie 12.42 Niech {r1, r2, . . . , rp−1}, gdzie p ∈ P⩾3, będzie dowolnym zredukowa- nym układem reszt modulo p. Udowodnić, że 1 r1 + 1 r2 + . . . + 1 rp−1 ≡ 0 (mod p). 12.4. Współczynniki dwumienne 431 Z ćwiczenia C12.42 widzimy, że hp−1 ≡ 0 (mod p) dla dowolnej liczby pierwszej p ⩾ 3. Okazuje się, że dla p ⩾ 5 można udowodnić więcej: TWIERDZENIE 12.8 (Twierdzenie Wolstenholme’ a – 1862) Jeżeli p ⩾ 5 jest liczbą pierwszą, to zachodzi kongruencja: 1 + 1 2 + 1 3 + . . . + 1 p − 1 ≡ 0 (mod p2). D O W Ó D. Grupując składniki sumy hp−1 w pary, otrzymamy: hp−1 = s∑ k=1 ( 1 k + 1 p − k ) = p ( 1 1 · (p − 1) + 1 2 · (p − 2) + . . . + 1 s · (s + 1) ) , gdzie s = p−1 2 . Wszystkie mianowniki k(p − k) występujących tu ułamków są niezerowymi minus kwadratami modulo p: k(p − k) ≡ −k2 (mod p). Ich odwrotnościami modulo p są więc również minus kwadraty modulo p. Ponieważ jest ich s, czyli tyle ile występuje niezerowych minus kwadratów modulo p, więc te odwrotności (k(p − k)) ∼, k = 1, 2, . . . , s, stanowią per- mutację ciągu (−1 2) (mod p), (−2 2) (mod p), . . . , (−s2) (mod p) niezerowych minus kwadratów modulo p. Z drugiej strony p(p − 1)(2p − 1) 6 = p−1∑ j=1 j2 = s∑ j=1 j2 + s∑ j=1 (p − j) 2 ≡ 2 s∑ j=1 j2 (mod p). Zatem (pamiętamy, że p > 3) s∑ k=1(k(p − k)) ∼ ≡ s∑ k=1(−k2) ∼ ≡ − s∑ j=1 j2 ≡ −2 −1 · p(p − 1)(2p − 1) 6 ≡ 0 (mod p). To, na mocy L12.1, kończy rozwiązanie. □ U w a g a. W trakcie dowodu T12.8 pokazaliśmy, że dla każdej liczby pierwszej p ⩾ 5 1 + 1 22 + 1 32 + . . . + 1 (p − 1)2 ≡ 0 (mod p). (12.31) Na tę kongruencję również zwrócił uwagę Wolstenholme. 12.4 Współczynniki dwumienne Ustęp ten poświęcamy kilku teorioliczbowym aspektom współczynników dwumiennych. 432 12. Kilka wiadomości dodatkowych 12.4.1 Wielomiany Newtona Określone niżej wielomiany nazwaliśmy (tu) nazwiskiem Newtona. Wielomiany Newtona przyj- mują tylko wartości całkowite dla całkowitych wartości argumentu. Deﬁnicja 12.3 Niech m będzie liczbą naturalną. Wielomian m-tego stopnia Nm(X) = 1 m! X(X − 1) · . . . · (X − m + 1) nazwiemy m-tym wielomianem Newtona. Kładziemy też N0(X) = 1. Wielomiany Newtona mają współczynniki wymierne, na przykład N1(X) = X, N2(X) = 1 2X 2 − 1 2X, N3(X) = 1 6X 3 − 1 2X 2 + 1 3X. Mają jednak pewną sympatyczną własność, mianowicie, przyjmują wartości c a ł k o w i t e dla wszystkich całkowitych wartości argumentu: Ćwiczenie 12.43 Udowodnić, że jeżeli a ∈ Z, to Nm(a) ∈ Z. W istocie wielomiany Newtona są w pewnym sensie jedynymi wielomianami przyjmującymi tylko wartości całkowite dla całkowitych wartości argumentu. Dokładniej: Ćwiczenie 12.44 Udowodnić, że jeżeli wielomian f (X) ∈ R[X] stopnia n przyjmuje wartości całkowite dla każdej całkowitej wartości argumentu, to istnieją takie liczby całkowite a0, a1, . . . , an, że f (X) = a0N0(X) + a1N1(X) + a2N2(X) + . . . + anNn(X). Ponadto, liczby a0, a1, . . . , an są wyznaczone jednoznacznie. 12.4.2 Twierdzenie Lucas’a Wartość Nk(n) dla 0 ⩽ k ⩽ n, oznaczana (n k) , nazywa się współczynnikiem (symbolem) dwumiennym (Newtona). Jasne, że (n k) = n! k!(n−k)! , zobacz KOM . Głównym wynikiem tego ustępu jest twierdzenie Lucas’a dające resztę z dzielenia współczynnika dwumiennego przez daną liczbę pierwszą p w terminach cyfr p-kowych jego licznika i mianownika. TWIERDZENIE 12.9 (Twierdzenie Lucas’ a) Niech p będzie liczbą pierwszą. Niech { n = a0 + a1p + a2p2 + . . . + arpr, k = b0 + b1p + b2p2 + . . . + brpr będą przedstawieniami liczb całkowitych nieujemnych k, n w systemie pozycyjnym przy pod- stawie p. Wówczas zachodzi kongruencja: ( n k ) ≡ ( ar br ) · ( ar−1 br−1 ) · . . . · (a0 b0 ) (mod p). (12.32) 12.4. Współczynniki dwumienne 433 D O W Ó D. Zauważmy najpierw, że na mocy wzoru dwumiennego (1.7) i C2.50, (1 + X)ps ≡ 1 + X ps (mod p). Oznaczenie F (X) ≡ G(X) (mod p) wprowadziliśmy w ustępie 5.4.4. Stąd (1 + X)n ≡ (1 + X)a0(1 + X p)a1 · . . . · (1 + X pr)ar (mod p). Zatem, znowu dzięki dwumianowi Newtona, (1 + X) n ≡ ( a0∑ j0=0 ( a0 j0 )X j0) ( a1∑ j1=0 (a1 j1 ) X pj1) · . . . · ( ar∑ jr=0 (ar jr )X prjr) (mod p). Ponieważ k ma jednoznaczne przedstawienie w systemie pozycyjnym przy podstawie p, więc współczynnik przy X k w ostatnim iloczynie równy jest (ar br) · (ar−1 br−1) · . . . · (a0 b0) . Porównując współczynniki po obu stronach ostatniej kongruencji otrzymujemy (12.32). □ Ćwiczenie 12.45 Udowodnić, że wszystkie wyrazy n-tego wiersza trójkąta Pascala są licz- bami nieparzystymi wtedy i tylko wtedy, gdy n jest postaci 2 k − 1. ZADANIE 12.9 Niech p będzie liczbą pierwszą, s ∈ N. Udowodnić, że (ps p ) ≡ ps−1 (mod ps). R o z w i ą z a n i e. Z oczywistej równości p( ps p ) = ps( ps−1 p−1 ) mamy ( ps p ) = ps−1( ps − 1 p − 1 ) . (12.33) W zapisie liczby k = p − 1 przy podstawie p mamy b0 = p − 1 oraz bi = 0 dla i > 0. W zapisie liczby n = ps − 1 cyfry a0 = a1 = . . . = as−1 = p − 1 i ai = 0 dla i ⩾ s. Stąd, na podstawie formuły Lucas’a, ( ps − 1 p − 1 ) ≡ (( p − 1 0 ))s−1 · ( p − 1 p − 1 ) ≡ 1 (mod p). To, dzięki (12.33), pozwala skończyć rozwiązanie (zróbcie to!). ♦ Ćwiczenie 12.46 Udowodnić, że jeżeli p jest liczbą pierwszą, to dla 0 ⩽ r ⩽ p − 1 zachodzi kongruencja: ( p − 1 r ) ≡ (−1)r (mod p). (12.34) Wyprowadzić stąd uproszczony wzór dwumienny modulo p: (x − y)p−1 ≡ p−1∑ r=0 xryp−1−r (mod p), dla dowolnych liczb całkowitych x, y. 434 12. Kilka wiadomości dodatkowych 12.4.3 Twierdzenie Wolstenholme’a-Glaishera Jeżeli p jest liczbą pierwszą, to natychmiastowym wnioskiem z twierdzenia Lucas’a jest kon- gruencja ( np mp) ≡ ( n m ) (mod p) dla dowolnych liczb naturalnych m ⩽ n. W tym ustępie udo- wodnimy, że taka kongruencja zachodzi modulo p3. Teza poniższego zadania jest przypadkiem szczególnym i jednocześnie ważnym krokiem w dowodzie twierdzenia ogólnego. ZADANIE 12.10 Udowodnić, że dla każdej liczby pierwszej p ⩾ 5, (2p p ) ≡ 2 (mod p3). (12.35) R o z w i ą z a n i e. Zauważmy najpierw, że kongruencja ( 2p p ) ≡ 2 (mod p) wynika natych- miast z twierdzenia Lucas’a. Mocniejszą kongruencję (2p p ) ≡ 2 (mod p2) łatwo udowodnić korzystając z równości ( 2p p ) = ( p 0 )2 + ( p 1 )2 + . . . + ( p p )2, (12.36) (patrz tożsamość Cauchy’ego-Vandermonde’a w 3.1 P1 dla m = n = r = p) i ćwiczenia C2.50. My chcemy dostać więcej. Robimy to tak: Równość (12.36) można przepisać do postaci ( 2p p ) − 2 = p−1∑ k=1 ( p k (p − 1 k − 1 ))2 = p2 p−1∑ k=1 ( 1 k (p − 1 k − 1 ))2 . Korzystaliśmy tu z oczywistej tożsamości pochłaniania a b ( a−1 b−1) = ( a b), zobacz też KOM . Dla zakończenia rozwiązania musimy więc wykazać, że p−1∑ k=1 1 k2 (p − 1 k − 1 )2 ≡ 0 (mod p). Lub, korzystając z (12.34) i lematu L12.1, że p−1∑ k=1 (k2)−1(−1)2(k−1) ≡ 0 (mod p), a to jest znaną nam kongruencją Wolstenholme’a (12.31). Rozwiązanie jest skończone. ♦ Ćwiczenie 12.47 Uzasadnić, że (2p−1 p−1 ) ≡ 1 (mod p3) dla każdej liczby pierwszej p ⩾ 5. Udowodnimy teraz piękne uogólnienie kongruencji (12.35). Dowód będzie polegał na spryt- nej kombinatorycznej redukcji do przypadku szczególnego. Jednym z elementów tej redukcji jest kombinatoryczna interpretacja liczby (2n n ) − 2: Ćwiczenie 12.48 Dany jest zbiór A = A1 ⊔ A2 przedstawiony w postaci sumy rozłącznej dwóch podzbiorów n-elementowych. Udowodnić, że liczba takich n-elementowych podzbiorów zbioru A, które zawierają co najmniej jeden element z podzbioru A1 i co najmniej jeden element z podzbioru A2, wynosi (2n n ) − 2. Wskazówka. Zobacz kombinatoryczny dowód tożsamości Cauchy’ego-Vandermonde’a w KOM . 12.4. Współczynniki dwumienne 435 TWIERDZENIE 12.10 (Twierdzenie Glaishera) Dla dowolnych liczb całkowitych 0 ⩽ m ⩽ n i dowolnej liczby pierwszej p ⩾ 5 zachodzi kongruencja ( np mp ) ≡ ( n m ) (mod p3). (12.37) D O W Ó D. Niech A = A1 ⊔ A2 ⊔ . . . ⊔ An będzie zbiorem np-elementowym przed- stawionym w postaci sumy n rozłącznych podzbiorów Aj = {a (j) 0 , a(j) 1 , . . . , a (j) p−1}. Jeżeli B = {a(j) i1 , a(j) i2 , . . . , a (j) is } jest dowolnym niepustym podzbiorem zbioru Aj, to dla dowolnego k ∈ Z/p kładziemy k + B := {a(j) k+i1, a(j) k+i2, . . . , a (j) k+is}. To oznacza, że, po utożsamieniu (za pomocą dolnych indeksów) elementów zbioru Aj z elemen- tami grupy Z/p, dodajemy k do wszystkich elementów zbioru B. Każdy podzbiór X ⊆ A wyznacza i jest (jednoznacznie) wyznaczony przez ciąg X1 := X ∩ A1, X2 := X ∩ A2, . . . , Xn := X ∩ An przekrojów z kolejnymi zbiorami Aj. Dwa podzbiory X, Y ⊆ A nazwiemy równoważnymi, X ∼ Y , gdy istnieje taki ciąg κ = (k1, k2, . . . , kn) ∈ (Z/p) n, że κ + X = Y , przy czym κ + X = (k1 + X1) ⊔ (k2 + X2) ⊔ . . . ⊔ (kn + Xn). Umawiamy się oczywiście, że jeżeli B ⊆ Aj jest pustym podzbiorem zbioru Aj, to k + B jest również pustym podzbiorem zbioru Aj. Liczba ( np mp) oznacza moc rodziny wszystkich podzbiorów mp-elementowych zbioru A. Wszystkie zbiory X ∈ Pmp(A) podzielimy na typy: Taki zbiór X jest typu r, gdy wśród zbiorów X1, X2, . . . , Xn jest dokładnie r właściwych (podzbiór B ⊆ Ai nazywamy tu właściwym, gdy jest niepusty i nie równy Ai). Po tych ustaleniach Czytelnik udowodni poniższe fakty: F a k t 1: Jeżeli X ∈ Pmp(A) jest podzbiorem typu r, to w klasie abstrakcji [X]∼ jest dokładnie pr elementów. F a k t 2: Podzbiorów X ∈ Pmp(A) typu 0 jest dokładnie ( n m) . F a k t 3: Żaden podzbiór X ∈ Pmp(A) n i e jest typu 1. F a k t 4: Podzbiorów X ∈ Pmp(A) typu 2 jest ( n 2 )( n − 2 m − 1 ) · [( 2p p ) − 2 ] . [W dowodzie F a k t u 4 korzystamy z C12.48.] Z tych czterech faktów dostajemy równość: ( np mp ) = ( n m ) + (n 2 )( n − 2 m − 1 ) · [( 2p p ) − 2 ] + p3 · coś, (12.38) z której, dzięki (12.35), natychmiast dostajemy kongruencję (12.37). □ ∗ ∗ ∗ ∞ ∞ ∞ ∗ ∗ ∗ Na zakończenie proponujemy ćwiczenie-problem: 436 12. Kilka wiadomości dodatkowych Ćwiczenie 12.49 Załóżmy, że dany jest NWD -ciąg a = (an) o wyrazach należących do N (por. C2.76, T9.1 czy C9.25). Deﬁniujemy ciąg (An)n⩾0: A0 = 1 i An = a1a2 · . . . · an dla n ∈ N. Deﬁniujemy wreszcie ( n k ) a := An Ak An−k . (12.39) Udowodnić, że liczby ( n k) a są liczbami całkowitymi. Udowodnić jak najwięcej własności tak określonych a-współczynników dwumiennych. U w a g a. Gdy a = (fn) jest ciągiem liczb Fibonacci’ego, liczby (12.39) nazywamy współczynnikami dwumiennymi Fibonacci’ego i oznaczamy ( n k) Fib. Gdy zaś a = (qn − 1)n⩾1, przy q ∈ N⩾2, liczby (12.39) nazywamy q-współczynnikami dwumiennymi (oznaczenie ( n k) q). 12.5 Rozmieszczenie liczb pierwszych Wiemy, że liczb pierwszych jest nieskończenie wiele. Przytoczymy teraz cztery twierdzenia mówiące trochę więcej o rozmieszczeniu liczb pierwszych na osi liczbowej. Dla danej liczby rzeczywistej x > 0 przez π(x) oznaczamy liczbę liczb pierwszych mniejszych lub równych x. Tak określona funkcja π jest jedną z trudniej ”badalnych” funkcji w całej matematyce. Twier- dzenie Euklidesa z ustępu 2.3.2 jest równoważne z faktem, że π(x) rośnie do nieskończoności, gdy x −→ ∞. Nierówność (2.20) pokazuje, że π(x) rośnie co najmniej tak szybko jak loga- rytm (pomnożony przez stałą 1 2 log 2). W tym paragraﬁe udowodnimy twierdzenie Czebyszewa, z którego między innymi wynika, że w rzeczywistości funkcja π(x) rośnie do nieskończoności zdecydowanie szybciej. 12.5.1 Dwa twierdzenia Czebyszewa Ten ustęp poświęcamy na dowód dwóch twierdzeń Czebyszewa. W ich dowodzie wykorzystamy kilka prostych własności arytmetyczno-wielkościowych liczb (n k) . Będziemy oznaczać przez vp(n, k) wykładnik p-adyczny liczby ( n k). Jasne, że vp(n, k) = vp(n!) − vp(k!) − vp((n − k)!), więc, na mocy formuły Legendre’a z T2.17, vp(n, k) = ∞∑ e=1 (⌊ n pe ⌋ − ⌊ k pe ⌋ − ⌊ n − k pe ⌋) . (12.40) ZADANIE 12.11 Dowieść, że jeżeli p jest liczbą pierwszą, a 1 ⩽ k ⩽ ps − 1, to p| ( ps k ) . R o z w i ą z a n i e. Połóżmy n = ps w (12.40). Wiemy, że dla dowolnych x, y ∈ R liczba ⌊x + y⌋ − ⌊x⌋ − ⌊y⌋ jest równa 0 lub 1, zobacz C12.1.5. Więc wszystkie składniki sumy (12.40) są ⩾ 0, a składnik s-ty jest równy 1 − 0 − 0 = 1. Stąd vp(ps, k) ⩾ 1. ♦ ZADANIE 12.12 Dowieść, że jeżeli ( n k) = pe1 1 pe2 2 · . . . · pes s jest kanonicznym rozkładem na czynniki pierwsze, to dla każdego i = 1, . . . , s zachodzi nierówność pei i ⩽ n. R o z w i ą z a n i e. Niech, dla danego i, liczba całkowita r będzie (jednoznacznie) wyzna- czona z nierówności pr i ⩽ n < pr+1 i . Kładąc w (12.40) p = pi widzimy, tak jak wyżej, że ei = vpi(n, k) jest sumą r liczb równych 1 lub 0. Stąd ei ⩽ r, więc pei i ⩽ pr i ⩽ n. ♦ 12.5. Rozmieszczenie liczb pierwszych 437 ZADANIE 12.13 Dowieść, że dla dowolnych 0 ⩽ k ⩽ n zachodzi nierówność ( n k) ⩽ 2 n. R o z w i ą z a n i e. Wynika z równości ∑n k=0 (n k) = 2 n, zobacz KOM . ♦ ZADANIE 12.14 Dowieść, że dla dowolnego n ∈ N zachodzi nierówność ( 2n+1 n ) < 4 n. R o z w i ą z a n i e. Wynika z faktu, że r ó w n e liczby ( 2n+1 n ) i ( 2n+1 n+1 ) są składnikami, równej 2 2n+1, sumy ∑2n+1 k=0 (2n+1 k ) . ♦ ZADANIE 12.15 Dowieść, że dla dowolnego n ∈ N zachodzi nierówność ( 2n n ) ⩾ 4 n/2n. R o z w i ą z a n i e. Wiadomo, zobacz na przykład KOM C1.26, że ( 2n n ) jest największym ze wszystkich współczynników dwumiennych występujących w 2n-tym wierszu trójkąta Pascala. Po odjęciu dwóch skrajnych jedynek ((2n 0 ) = ( 2n 2n ) = 1), mamy więc 2 2n − 2 2n − 1 ⩽ ( 2n n ) , bo średnia arytmetyczna jest niewiększa niż maksimum. Wystarczy więc udowodnić, że lewa strona powyższej nierówności jest ⩾ 4 n/2n, co jest natychmiastowe. ♦ Udowodnimy metodą Erd˝osa następujący lemat: LEMAT 12.2 Iloczyn wszystkich liczb pierwszych niewiększych niż dana liczba x ⩾ 2 jest mniejszy niż 4 x. To znaczy, ∏ p⩽x p < 4 x. D O W Ó D. Oznaczmy przez P (n) iloczyn wszystkich liczb pierwszych niewiększych niż n ⩾ 2. Dowodzimy przez indukcję względem n ⩾ 2 mocniejszej tezy, że P (n) ⩽ 4 n−1. Baza indukcji jest oczywista. Załóżmy więc, że P (k) ⩽ 4 k−1 dla wszystkich 2 ⩽ k ⩽ n − 1 i rozważmy iloczyn P (n). Zachodzi jedna z możliwości: albo n = 2k, i wtedy P (n) = P (n − 1) ⩽ 4 n−2 ⩽ 4 n−1, albo n = 2k + 1. W tym przypadku zapiszmy: P (n) = P (2k + 1) = P (k + 1) · p1p2 · . . . · ps, (12.41) gdzie przez p1, . . . , ps oznaczyliśmy wszystkie liczby pierwsze z przedziału (k + 1; 2k + 1]. Zauważmy, że wszystkie te liczby dzielą licznik ułamka (2k+1)! k!(k+1)! ale nie(!) dzielą mianownika tego ułamka. Wobec tego p1p2 · . . . · ps| ( 2k+1 k ) , skąd p1p2 · . . . · ps ⩽ ( 2k+1 k ) . Równość (12.41) i założenie indukcyjne P (k + 1) ⩽ 4 k dają więc P (n) ⩽ 4 k · (2k + 1 k ) ⩽ 4 k · 4 k = 4 2k = 4 n−1. [Druga nierówność wynika z Z12.14.] To kończy dowód. □ Fizyk francuski Joseph Bertrand, przeglądając tablice liczb pierwszych, wysunął przypusz- czenie, że w każdym przedziale ( n; 2n ], n ∈ N, znajdzie się co najmniej jedna liczba pierwsza. Matematyk rosyjski Pafnucy Czebyszew udowodnił, że przypuszczenie Bertrand’a jest prawdą. Udowodnimy teraz to twierdzenie Czebyszewa. 438 12. Kilka wiadomości dodatkowych TWIERDZENIE 12.11 (Postulat Bertrand’ a) Dla każdej liczby naturalnej n > 1 ist- nieje (co najmniej jedna) taka liczba pierwsza p, że n < p ⩽ 2n. D O W Ó D. Załóżmy, nie wprost, że n jest taką liczbą naturalną, że w przedziale ( n; 2n ] nie(!) ma ani jednej liczby pierwszej. Niech (2n n ) = (pe1 1 · . . . · pes s )(pes+1 s+1 · . . . · pes+t s+t ) (12.42) będzie kanonicznym rozkładem współczynnika ( 2n n ) na czynniki pierwsze. Liczby pierwsze pi występujące w tym rozkładzie podzieliliśmy na dwie grupy. Do pierwszej grupy należą wszystkie(!) liczby pierwsze z przedziału ( 1; √2n ], do drugiej wszystkie(!) liczby pierwsze z przedziału ( √2n; 2 3n ]. Łatwo widzieć, że innych liczb pierwszych w rozkładzie współczynnika( 2n n ) na czynniki pierwsze nie ma. Rzeczywiście: każda liczba pierwsza dzieląca ( 2n n ) dzieli licznik (2n)!, więc jest dzielnikiem któregoś z czynników tej silni, więc jest ⩽ 2n, czyli, zgodnie z założeniem nie wprost, ⩽ n. Ponadto, jeżeli p ∈ ( 2 3n; n] jest dzielnikiem pierwszym licznika (2n)! ułamka (2n n ) = (2n)! n! n! , to dzieli go w potędze drugiej (w silni (2n)! występują tylko wielokrotności p i 2p liczby p, bo 3p > 2n), a w mianowniku n! · n! mamy dwa czynniki p. Z zadania Z12.12 wiemy, że pei i ⩽ 2n dla każdego i = 1, 2, . . . , s + t. Jednocześnie ( √ 2n) ei < p ei i ⩽ 2n dla i = s + 1, . . . , s + t, bowiem √2n < pi dla tych i. Stąd wynika, że ei ⩽ 1 dla każdego i = s + 1, . . . , s + t. Biorąc to pod uwagę widzimy, że równość (12.42) ma postać (2n n ) = (pe1 1 · . . . · pes s )(ps+1 · . . . · ps+t) i każdy z początkowych s czynników pei i jest ⩽ 2n. Mamy więc (2n n ) ⩽ (2n) s · (ps+1ps+2 · . . . · ps+t) ⩽ (2n) √2n · ∏ p⩽ 2 3 n p ⩽ (2n)√ 2n · 4 2 3 n. Druga z tych nierówności wynika z faktu, że s = π( √2n) ⩽ √ 2n (jasne, że π(x) ⩽ x dla każdego x > 0) i z faktu, że wszystkie liczby pierwsze ps+j są ⩽ 2 3n. Trzecia zaś z lematu L12.2. Korzystając teraz z Z12.15 otrzymujemy nierówność 4 n ⩽ (2n) 1+ √2n · 4 2 3 n, równoważnie 4 1 3 n ⩽ (2n) 1+ √2n. W ćwiczeniu C12.50 proponujemy Czytelnikowi sprawdzenie, że nierówność ta nie zachodzi dla n ⩾ 4000. Wobec tego: jeżeli w przedziale ( n; 2n ] nie ma liczb pierwszych, to n < 4000. Ale to jest sprzeczne z obserwacją, że ciąg 2, 3, 5, 7, 13, 23, 43, 83, 163, 317, 631, 1259, 2003, 4001 składa się z liczb pierwszych i że każdy przedział ( n; 2n ], dla n < 4000, zawiera co najmniej jeden wyraz tego ciągu. Uzyskana sprzeczność kończy dowód. □ Ćwiczenie 12.50 Udowodnić, że jeżeli 4 1 3 n ⩽ (2n) 1+ √2n, to n < 4000. Ćwiczenie 12.51 Udowodnić, że jeżeli n! = mk dla k, m, n ∈ N, to n = 1 lub k = 1. 12.5. Rozmieszczenie liczb pierwszych 439 Ćwiczenie 12.52 Liczbę naturalną n ⩾ 2 nazwiemy miłą, gdy jest równa sumie wszyst- kich liczb pierwszych p < n. Udowodnić, że jedyną liczbą miłą jest 5. Ćwiczenie 12.53 Udowodnić, że dla każdego n ∈ N istnieje takie rozbicie {1, 2, . . . , 2n} = {x1, y1} ⊔ {x2, y2} ⊔ . . . ⊔ {xn, yn}, że każda liczba xi + yi jest liczbą pierwszą. Przyglądając się wnikliwie tablicom liczb pierwszych (oczywiście znacznie obszerniejszym niż zamieszczona w naszym skrypcie) można zauważyć, że gęstość zbioru liczb pierwszych w zbiorze liczb naturalnych w otoczeniu liczby naturalnej n wynosi około 1 log n . To oznacza, że jeżeli k jest dużo mniejszą liczbą naturalną niż n (zapisujemy to: k ≪ n), to prawdopodo- bieństwo znalezienia liczby pierwszej w przedziale [ n − k; n + k ] wynosi w przybliżeniu 1 log n (log oznacza tu i dalej logarytm naturalny). Obserwacja ta sugeruje, że funkcja π powinna w ”otoczeniu nieskończoności” zachowywać się podobnie do funkcji x log x . Poniższe twierdzenie Czebyszewa zdaje się do pewnego stopnia potwierdzać takie przypuszczenie: TWIERDZENIE 12.12 (Czebyszew ) Istnieją takie stałe 0 < C < 1 < D, że C n log n < π(n) < D n log n (12.43) dla wszystkich n ∈ N⩾2. D O W Ó D. W rozwiązaniu Z4.C1 udowodniliśmy, że stała D = 6 log 2 jest dobra. Wska- żemy więc teraz stałą C. Ustalmy n ∈ N⩾2 i weźmy dowolne k ⩽ n. Niech (n k) = pe1 1 pe2 2 ·. . .·pes s będzie kanonicznym rozkładem na czynniki pierwsze. Wówczas, jak wiemy z Z12.12, pei i ⩽ n dla każdego i. Zatem (n k ) = pe1 1 pe2 2 · . . . · pes s ⩽ ns ⩽ nπ(n), (12.44) bo wszystkie liczby pierwsze p1, p2, . . . , ps, jako dzielniki licznika n! ułamka n! k!(n−k)! , są nie- większe niż n, więc ich ilość s jest niewiększa niż π(n). Dodając stronami nierówności (12.44) dla wszystkich k = 0, 1, . . . , n, dostajemy 2 n = n∑ k=0 ( n k ) ⩽ (n + 1)n π(n). Stąd, po zlogarytmowaniu, dostajemy nierówność n log 2−log(n+1) log n ⩽ π(n) dla każdego n ∈ N⩾2. Czytelnik zechce uzasadnić, że licznik wyrażenia z lewej strony jest większy niż n log 2√3 i, w ten sposób, uzasadnić, że stała C = log 2√3 jest dobra. □ Ćwiczenie 12.54 Uzasadnić, że ciąg (an)n⩾2 dany wzorem an = log(n+1) n jest ciągiem malejącym zbieżnym do zera. Wywnioskować stąd, że dla dostatecznie dużych n stałą C z nierówności (12.43) można wybrać równą 2/3. 440 12. Kilka wiadomości dodatkowych U w a g a. Wykazując więcej skrupulatności w takich jak wyżej (i podobnych) szacowaniach, Czebyszew udowodnił, że dla dostatecznie dużych n zachodzi nierówność podwójna: 0, 92129 n log n < π(n) < 1, 10555 n log n. Ćwiczenie 12.55 W kryptograﬁi używa się d u ż y c h (to znaczy wielocyfrowych) liczb pierwszych. Czy da się każdemu człowiekowi na Ziemi (dla uproszczenia przyjmijmy, że jest nas 10 miliardów) ”przydzielić” milion liczb pierwszych 200-cyfrowych tak, by każdy człowiek dostał inne liczby? 12.5.2 Twierdzenie o liczbach pierwszych Okazuje się, że zachodzi mocniejsze, tak zwane Twierdzenie o Liczbach Pierwszych: TWIERDZENIE 12.13 (PNT) Zachodzi następująca równość asymptotyczna π(x) ∼ x log x . To oznacza, że i s t n i e j e (i jest równa 1) granica ilorazu π(x)/ x log x przy x → ∞, tzn., limx→∞ π(x) log x x = 1. □ (12.45) To piękne twierdzenie udowodnili niezależnie od siebie w roku 1896 Jacques Hadamard i Charles de la Vall´ee Poussin. Ćwiczenie 12.56 Udowodnić, że istnieje taka liczba B, że jeżeli x ⩾ B, to w przedziale [x; 3 2x] znajdzie się co najmniej 2013 liczb pierwszych. Charles de la Vall´ee Poussin udowodnił również poniższe wzmocnienie twierdzenia T5.19: TWIERDZENIE 12.14 Dla danych liczb naturalnych względnie pierwszych a, r, oznaczmy przez πa, r(x) liczbę liczb pierwszych niewiększych niż x ∈ R>0 będących wyrazami ciągu aryt- metycznego a, a + r, a + 2r, a + 3r, . . . . Wówczas limx→∞ πa, r(x) log x x = 1 ϕ(r). □ (12.46) To oznacza, że jeżeli {a1, a2, . . . , aϕ(r)} jest zredukowanym układem reszt modulo r, to w każdym z ciągów arytmetycznych (a1 + rn)n∈Z, (a2 + rn)n∈Z, . . . , (aϕ(r) + rn)n∈Z leży nieskoń- czenie wiele i ”mniej więcej” tyle samo liczb pierwszych. We wszystkich pozostałych ciągach arytmetycznych o różnicy r leży łącznie skończenie wiele liczb pierwszych. Literatura [0] Aigner M., Ziegler G. M. Dowody z Księgi, PWN, Warszawa 2004. [1] Courant R., Robbins H. Co to jest matematyka, PWN, Warszawa 1967. [2] Ireland K., Rosen M. A Classical Introduction to Modern Number Theory, Springer. [3] Koblitz N. Wykład z teorii liczb i kryptograﬁi, WN-T, Warszawa 1995. [4] Kurlyandchik L. Złote rybki w oceanie matematyki, ”Tutor”, Toruń 2005. [5] Mostowski A., Stark M. Elementy algebry wyższej, PWN, Warszawa 1968. [6] Narkiewicz W. Elementy algebraicznej teorii liczb, PZWS, Warszawa 1972. [7] Narkiewicz W. Teoria liczb, PWN, Warszawa 2003. [8] Rademacher H., Toeplitz O. O liczbach i ﬁgurach, PWN, Warszawa 1956. [9] Ribenboim P. Wielkie twierdzenie Fermata dla laików, WN-T, Warszawa 2001. [10] Sierpiński W. Arytmetyka teoretyczna, PWN, Warszawa 1968. [11] Sierpiński W. Wstęp do teorii liczb, WSiP, Warszawa 1987. [12] Sierpiński W. 250 zadań z elementarnej teorii liczb, WSiP, Warszawa 1987. [13] Sierpiński W. Elementary Theory of Numbers, PWN, Warszawa 1964. [14] Sierpiński W. Trójkąty pitagorejskie, PWN, Warszawa 1954. [15] Sierpiński W. O rozwiązywaniu równań w liczbach całkowitych, Warszawa 1956. [16] Sierpiński W. Liczby trójkątne, PZWS, Warszawa 1962. [17] Sierpiński W. O rozkładach liczb wymiernych na ułamki proste, PWN 1957. [18] Song Y. Yan Teoria liczb w informatyce, PWN, Warszawa 2006. [19] Winogradow I. Elementy teorii liczb, PWN, Warszawa 1954. [20] Wowk C., Szkibiel G. Zadania z arytmetyki szkolnej i teorii liczb, Szczecin 1999. Indeks Algebra, 6 algebra parzystości, 175 algebraiczna teoria liczb, 287 algorytm, 26 — dzielenia z resztą wielomianów, 69 — Euklidesa, 26, 84, 330 — — w pierścieniu normowo-euklidesowym, 341 — Fibonacci’ego (zachłanny), 424 analityczna teoria liczb, 162 analiza matematyczna, 75 argument liczby zespolonej, 13 arytmetyczna przestrzeń wektorowa nad ciałem, 240 a-współczynnik dwumienny, 436 Baza indukcji, 3 — deﬁnicji indukcyjnej, 5 — przestrzeni liniowej, 123 — — Rek(P, Q), 310 bikwadrat, 50, 373 binarna forma kwadratowa, 288 biwymierność przekształcenia, 399 Cechy podzielności, 159 ciało, 11 — algebraicznie domknięte, 92 — charakterystyki dwa, 77 — Fp(= Z/p), 178 — Fp2, 319 — kwadratowe Q( √D), 325 — kwaternionów (Hamiltona), 296 — liczb algebraicznych A, 235 — — rzeczywistych R, 10 — — wymiernych Q, 10 — — zespolonych C, 13 ciąg czysto-okresowy, 198, 265 — Farey’a, 251 — Fermat’a, 311 — Fibonacci’ego klasyczny, 301 — Lucas’a, 310 — — klasyczny, 311 — — stowarzyszony, 310 — —, formuły konwersji, 312 — —, tożsamość kwadratowa, 312 — —, uogólnione tożsamości Ces`aro, 312 — —, wzór Cassini’ego, 312 — Mersenne’a, 311 Combinatorial Nullstellensatz, CN, 241 cyfra m-kowa, 417 — po przecinku l-ta, 419 część całkowita liczby rzeczywistej, 412 — rzeczywista liczby zespolonej, 12 — ułamkowa liczby rzeczywistej, 412 — urojona liczby zespolonej, 12 czwórka Catalan’a, 58 czynnik kwadratowy wielomianu, 96 — liniowy wielomianu, 96 Desant nieskończony, 80, 125, 160, 274, 366 diagonalizacja macierzy, 314 dodawanie, 8 — liczb całkowitych, 7 — liczb zespolonych, 11 — modulo m, 176 — punktów krzywej eliptycznej, 409 — — płaszczyzny, 277 — w ciele Fp(ι), 317 — — grupie addytywnej, 8 — — pierścieniu, 9 — wielomianów jednej zmiennej, 64 dyskretna własność Darboux, 243 działanie dwuargumentowe, 6 — — łączne, przemienne, 7 — rozdzielne względem działania, 7 — składania, 7 dziedzina całkowitości, 11, 354 — ideałów głównych, dig, 21, 83, 341, 366 — z jednoznacznością rozkładu, 347, 358 dzielenie liczb zespolonych, 12 — z resztą liczb całkowitych, 20 — — — — — Gaussa, 327 — — — wielomianów, 68 dzielnik, 18, 82, 328, 340, 355 — pierwotny (wyrazu ciągu), 192 INDEKS 443 — właściwy, 31 — zera w pierścieniu, 11 dziewiątkowy test poprawności mnożenia, 159 Element neutralny działania, 8 — nierozkładalny, 357 — — pierścienia kwadratowego, 343 — nieskończonego rzędu (w grupie), 184 — odwrotny w grupie, 8 — odwracalny w pierścieniu, 11 — pierwszy, 358 — — pierścienia kwadratowego, 343 — przeciwny w grupie addytywnej, 8 — (punkt) przeciwny w płaszczyźnie, 277 — rzędu nieskończonego w grupie, 184 — zerowy pierścienia, 9 elementy komutujące w grupie, 185 — stowarzyszone w pierścieniu, 341 — względnie pierwsze, 341, 357 elipsa, 392 Figura centralnie symetryczna, 280 — wypukła, 280 ”ﬁlozoﬁa” Vi`ete’a, 78 forma kwadratowa binarna, 288 — — dodatnio-określona, 291 — — — — zredukowana, 292 — — kanoniczna, 344 — — nieokreślona, 291 — — określona, 291 formalny szereg potęgowy, 308 formuła Legendre’a, 37 — Waringa, 230 formuły duplikacji, 411 — konwersji dla ciągów Lucas’a, 312 formy kwadratowe równoważne, 288 funkcja arytmetyczna, 143 — — multyplikatywna, 143 — — µ-M¨obiusa, 148 — — σ, 145 — — silnie multyplikatywna, 154 — — τ , 144 — — ϕ-Eulera, 146 — charakterystyczna, 246 — ciągła, 76 — kwadratowa, 75 — różniczkowalna, 225 — symetryczna, 78 — tworząca (ciągu), 231, 309 — wielomianowa, 72 — wymierna jednej zmiennej, 106 — — prosta, 107 Generator grupy cyklicznej, 196, 320 — ideału, 20 geometria algebraiczna, 241 granica, 225 grupa, 8 — abelowa (= komutatywna, = przemienna), 8 — bijekcji, 9 — cykliczna, 195, 320 — jedności pierścienia, 11 — — pierścienia wielomianów, 81 — multyplikatywna ciała, 320 — pierwiastków z jedynki stopnia n, 15 — symetryczna, 9 — typu addytywnego, 8 — warstw odwracalnych modulo m, 177 grupy izomorﬁczne, 320 Hiperbola, 392 — z mnożeniem, 387 hipoteza Erd˝osa-Strausa, 422 — Goldbacha, 33 Ideał, 20, 83, 329, 341, 356 — generowany przez dwa elementy, 21, 83, 341 — główny, 20, 82, 328, 340, 355 — zerowy, 20 iloczyn prosty (pod)grup, 199 — teoriomnogościowy, 7 — punktu płaszczyzny przez liczbę, 277 iloraz (niepełny), 20, 69, 327 indeks przy podstawie g, 201 indukcja wsteczna, 52 interpretacja piechura liczb Fibonacci’ego, 304 inwolucja, 298 Jednokładność, 14 jednomian, 109 jednorodny składnik wielomianu, 110 jedność pierścienia, 11 — trywialna, 361 — fundamentalna, 362 jedynka pierścienia, 9 Kanoniczne rozwinięcie liczby rzeczywistej na uła- mek łańcuchowy, 253 kanoniczny rozkład na czynniki pierwsze, 36 klasa reszt modulo m, 176 kombinacja liniowa liczb, 21 — — punktów (wektorów), 277 444 INDEKS komutujące elementy grupy, 185 kongruencja indyjska, 391 — modulo (według modułu) m, 157 — — µ, 351 — stopnia pierwszego (liniowa), 162 kontynuanta, 256 K-punkty krzywej, 411 krata (podgrupa punktów płaszczyzny), 277 — Eisensteina, 277 — — uogólnione, 91 — Gaussa, 326 krok indukcyjny, 4 — — deﬁnicji indukcyjnej, 5 kryterium Eisensteina, 90 — — uogólnione, 91 — Eulera, 204 — Gaussa, 206 — Korselta, 202 krzywa eliptyczna, 403 — stożkowa, 392 — — zdegenerowana, 392 — sześcienna, 398 — — osobliwa, 402 kwadrat w grupie, 203 kwadratura koła, 238 kwaterniony, 294 Lemat Gaussa (kryterium Gaussa), 206 — — o wielomianach pierwotnych, 87 — Hensela, 220 — Lagrange’a, 290 — o zwiększaniu wykładnika, LZW, 39 liczba algebraiczna (całkowita), 232 — całkowita, 1 — — bezkwadratowa, 34 — — Eisensteina, 351 — — Gaussa, 326 — — p-adyczna, 222 — Carmichaela, 202 — Catalan’a, 45 — czysto urojona, 12 — doskonała, 145 — Fermat’a, 23 — f -wyróżniona, 161 — Frobeniusa, 30 — harmoniczna (n-ta), 428 — kongruentna, 402 — naturalna, 1 — nierozkładalna Gaussa, 331 — Mersenne’a, 35 — Nov´aka, 46 — odwracalna modulo m, 163 — pierwsza, 31 — — Fermat’a, 36 — — Gaussa, 331 — — — leżąca nad p, 336 — — Mersenne’a, 35 — — Sophie Germain, 215 — — wymierna, 335 — przedstawialna przez formę kwadratową, 288 — — właściwie przez formę kwadratową, 288 — przestępna, 232 — rozwiązań kongruencji, 161 — rzeczywista, 419 — —, interpretacja arytmetyczna, 419 — —, — geometryczna, 419 — —, zapis pozycyjny, 420 — sprzężona liczby zespolonej, 12 — — niewymierności kwadratowej, 264, 325 — zespolona, 11 — złota, 259 — złożona, 31 liczby Bernoulli’ego, 249 — pierwsze bliźniacze, 35 — rzeczywiste równoważne, 262 — stowarzyszone w Z[ i ], 328 — trójkątne, 46, 297 — względnie pierwsze, 23, 329 — złote, 259 lokalizacja w liczbie pierwszej, 181 logarytm dyskretny, 201 Macierz odwzorowania liniowego płaszczyzny, 313 — jednostkowa, odwrotna, 261 małe twierdzenie Fermat’a, 166 — — — w ciele Fp2, 320 medianta dwóch ułamków, 252 metoda desantu (nieskończonego), 80, 125 — Eulera dowodu WTF(3), 375 — siecznych, 404 — siecznych-stycznych, 403 — stycznych, 405 — zstępowania, 366 metryka w Zp, 223 mianowniki ułamka łańcuchowego, 253 miejsce zerowe wielomianu, 66 mnożenie liczb całkowitych, 7 — — zespolonych, 11 INDEKS 445 — macierzy, 314 — modulo m, 176 — w ciele Fp(ι), 317 — — pierścieniu, 9 — wielomianów jednej zmiennej, 64 moduł, 157 — liczby zespolonej, 12 MTF, 166 multiwykładnik, 230 multyplikatywność normy w ciałach kwadratowych, 325 Nadpierścień, 325 najmniejsza wspólna wielokrotność, 25 największy wspólny dzielnik, 22, 83, 329, 341, 357 niereszta kwadratowa modulo m, 203 nierówność Bonse 47 — Schwarza, 76 — trójkąta w C, 12 — — — płaszczyźnie, 277 — — — Zp (ultrametryczna), 223 niewymierność kwadratowa, 233, 263 — — zredukowana, 265 — liczby √2, 2, 366 nitka p-adyczna, 222 norma niewymierności kwadratowej, 325 nośnik liczby całkowitej, 54 Nullstellensatz, 240 NWD-ciąg, 53 Obrót płaszczyzny, 14 odwrotność elementu w grupie, 8 — — pierścienia, 11 — (liczby) modulo m, 163 — liczby zespolonej, 12 odwzorowanie liniowe płaszczyzny, 313 ogon ciągu, 263 ogólne równanie indyjskie, 389 — — —, postać normowa, 389 opis parametryczny, 392, 394 oś liczbowa, 11 — rzeczywista, urojona 12 Parabola, 392 pełny wielomian symetryczny jednorodny danego stopnia, 231 permutacja, 9 pierścień Dedekinda, 352 — Eisensteina Z[τ−3], 351 — Eulera Z[τ−2], 349 — formalnych szeregów potęgowych, 308 — ilorazowy, 325 — klas reszt (liczb całkowitych) modulo m, 177 — kwadratowy (rzeczywisty lub urojony), 336 — — (normowo-) euklidesowy, 338 — — — typu (±1), 364 — liczb algebraicznych całkowitych I, 234 — — całkowitych, 10 — — — Gaussa Z[ i ], 326 — — rzeczywistych, 10 — — wymiernych, 10 — noetherowski, 359 — przemienny z jedynką, 9 — wielomianów jednej zmiennej, 64 — — wielu zmiennych, 109 pierwiastek arytmetyczny, 325 — kongruencji wielomianowej, 179 — kwadratowy, 73 — pierwotny modulo m, 195 — podwójny trójmianu kwadratowego, 73 — redukcji wielomianu modulo m, 179 — wielokrotny (k-krotny) wielomianu, 227 — wielomianu, 66 pierwiastki charakterystyczne, 301 — n-tego stopnia z liczby zespolonej, 15 pierwotna trójka pitagorejska, 43 pochodna, 225 — druga, k-ta, 225 — wielomianu, 225 podłoga liczby rzeczywistej, 412 podgrupa, 183 — dyskretna płaszczyzny, 278 — generowana przez (dany) element, 183 podkrata, 326 podniesienie rozwiązania, 218 podstawa systemu pozycyjnego, 417 podzbiór induktywny zbioru N, 3 — multyplikatywny (multyplikatywnie zamknięty) w Z, 111 — zamknięty względem działania, 183 postać kanoniczna trójmianu kwadratowego, 73 — normalna równania sześciennego, 399 — normowa ogólnego równania indyjskiego, 389 — trygonometryczna liczby zespolonej, 13 — zredukowana równania sześciennego, 99 postulat Bertrand’a, 438 potęga elementu grupy, 183 — malejąca 51 — właściwa liczby całkowitej, 47 446 INDEKS prawo najlepszego przybliżenia, 258 — skracania, 159, 326, 355 — wzajemności reszt kwadratowych, 208 — — — — , II uzupełnienie, 207 — — — — , I uzupełnienie, 205 problem bazylejski, 428 — Catalan’a, 58 — Frobeniusa, 30 przedłużenie ciągu na Z, 316 przedstawienie liczby przez formę, 288 — właściwe liczby przez formę, 288 przekrój zbiorów, 7 pseudomianowniki, 253 punkt idealny, 409 — osobliwy krzywej, 405 — wymierny płaszczyzny, 44, 278 — — (całkowity, rzeczywisty, zespolony) krzywej, 399 punkty stałe odwzorowania, 299 PWRK (prawo wzajemności reszt kwadratowych), 208 pytanie Eulera, 400 — Fermat’a, 400 q-współczynnik dwumienny, 436 Redukcja ciągu modulo m, 321 — wielomianu modulo m, 179 redukt liczby ∈ R przy danej podstawie, 419 — ułamka łańcuchowego, 256 reguła Eulera, 256 relacja kongruencji modulo m, 157 — podzielności w pierścieniu Z, 19 — —- — — wielomianów, 82 — — — dziedzinach całkowitości, 355 — stowarzyszenia, 356 — — w K[X], 82 — zgodna z dodawaniem, 158, 351 — — — — wielomianów, 179 — — — mnożeniem, 158 reszta kwadratowa modulo m, 203 — z dzielenia, 20, 69, 327 — — — w pierścieniu wielomianów, 69 rozdzielność działań, 7 rozkład jedynki, 422 rozwiązania kongruencji wielomianowej, 161 — — — równoważne modulo m, 161 rozwiązanie fundamentalne równania indyjskiego, 385 równanie anty-indyjskie, 388 — Bachet’a, 370 — diofantyczne, 160 — indyjskie (Pella), 383 — — ogólne, 389 — Pitagorasa, 43, 333, 394 — Ramanujana, 378 — rekurencyjne liniowe, 301 — rozwiązujące równania szaściennego, 99 — trzykwadratowe, 99 równoległobok podstawowy kraty, 278 równość B´ezout’a, 66 równość Bhaskary, 383 — pochłaniania, 122 — Ramanujana, 378 równoważność form kwadratowych, 288 — liczb (rzeczywistych), 262 — nitek p-adycznych, 222 rząd elementu grupy, 184 Sito Eratostenesa, 32 składanie (bijekcji), 7 składnik jednorodny stopnia k, 110 skoki Vi`ete’a, 79 spektrum liczby rzeczywistej, 414 splot Dirichlet’a, 147 sprzęganie w ciele Fp(ι), 318 sprzężona liczba zespolona, 12 — niewymierność kwadratowa, 264 stała Minkowskiego, 287 standardowy zredukowany układ reszt, 164 — zupełny układ reszt, 20, 164 stopień dolny szeregu potęgowego, 308 — jednomianu, 109 — liczby algebraicznej, 232 — wielomianu jednej zmiennej, 65 — — wielu zmiennych, 109 stowarzyszenia relacja w dziedzinach całkowitości, 356 struktura algebraiczna, 6 suﬁt liczby rzeczywistej, 423 suma teoriomnogościowa, 7 superpozycja wielomianów, 66 symbol dwumienny (Newtona), 432 — Legendre’a, 204 system pozycyjny, 417 szereg harmoniczny, 425 — Neumanna, 308 — potęgowy (formalny), 308 sześcian, 50 INDEKS 447 Technika skoków Vi`ete’a, 79 teoria form modularnych, 287 TFE, dowód pierwszy, 273 — — drugi, 274 — — trzeci, 282 — — czwarty, 292 — — piąty, 299 — — szósty, 332 theorema fundamentale (aureum), 208 tożsamość algebraiczna, 110 — Brahmagupty, Fibonacci’ego, 271 — Cauchy’ego-Vandermonde’a, 65 — Ces`aro, 303 — — uogólniona, 312 — Eulera, 294 — Hermite’a, 413 — kwadratowa dla ciągów Lucas’a, 312 — ”nieśmiertelna”, 10 — —, ”nieskończone” uogólnienie, 308 — pochłaniania, 434 — Sophie Germain, 110 translacja, 13 trik w N, 42 — w Z[ i ], 333 — w dziedzinie z jednoznacznością rozkładu, 369 trójka pitagorejska, 43 — —, pierwotna, 43 trójkąt pitagorejski, 43 — Tartaglia’i, 100 trójmian kwadratowy, 73 — minimalny (niewymierności kwadratowej), 264 twierdzenie Brahmagupty-Bachet’a, 28 — Beatty’ego-Banga, 414 — B´ezout’a, 67 — Catalan’a, 45 — Cauchy’ego-Davenporta, 245 — Cauchy’ego-Farey’a, 252 — Chevalley’a-Warninga, 246, 247 — chińskie o resztach, CTR, 169 — — — — uogólnione, 173 — Czebyszewa, 438, 439 — Dirichlet’a o aproksymacji, 251 — — o liczbach pierwszych w ciągach arytmetycz- nych, 189 — Erd˝osa-Ginzburga-Ziva, 244 — Euklidesa, TE, 33 — — o liczbach doskonałych, 145 — Eulera, 165 — — o czterech liczbach, 370 — — — funkcji π(n), 150 — — — liczbach doskonałych, 145 — — — wartości ζ(2), 428 — Fermat’a-Eulera, TFE, 273 — Fermat’a, małe, MTF, 166 — —, wielkie, WTF, 372 — Galois’a, 267 — Gaussa o ϕ-funkcji, 146 — — — istnieniu NWD wielomianów, 84 — Gaussa-B´ezout’a, 24 — Gaussa-Legendre’a, 296 — Glaishera, 435 — Goldbacha, 23 — Hurwitza, 259 — kombinatoryczne o zerach, CN, 241 — Lagrange’a o czterech kwadratach, 294 — — — liczbach pierwszych postaci x2 + 2y2, 283 — — — pierwiastkach wielomianu, 70 — — — równaniu indyjskim, 383 — — — rzędzie podgrupy, 184 — — — ułamku łańcuchowym niewymierności kwa- dratowej, 268 — — — — — liczby √D, 268 — — — wartości średniej, 226 — — — wielomianie interpolacyjnym, 105 — Legendre’a, 37, 396 — Lindemanna, 238 — Liouville’a, 238 — Lucas’a, 432 — Minkowskiego o ﬁgurze wypukłej, 280 — M¨obiusa o odwracaniu (I i II), 149 i 150 — Newtona o wielomianach symetrycznych, 229 — o aproksymacji diofantycznej, 252 — — ekwipartycji, 417 — — istnieniu pierwiastków pierwotnych (mod m), 198 — — jednoznaczności dla funkcji wymiernych, 108 — — — (zapisu wielomianu), 71 — — — rozkładu w dig’ach, 359 — — — — — K[X], 86 — — — — — N, 32 — — — — — Z[ i ], 332 — — — — — Z[X], 88 — — kongruencji liniowej, 162 — — liczbach pierwszych, PNT, 441 — — partyzantach, 282 — — strażakach, 96 — Picka, 252 448 INDEKS — Poincar´e’go, 411 — Rolle’a, 225 — Schinzla, 422 — Schura, 162 — Sophie Germain, 374 — Sylvestera, 29 — Thue’go, 281 — de la Vall´ee Poussin’a, 441 — Wilsona, 167 — Wolstenholme’a, 431 — zasadnicze algebry, 92 — — arytmetyki, ZTA, 24 — Zsigmondy’ego, 192 Układ Eisensteina, Gaussa, 206 — kongruencji liniowych, 174 — zredukowany reszt modulo m, 164 — zupełny reszt modulo m, 164 ułamek egipski, 421 — łańcuchowy, kanoniczne rozwinięcie na, 253 — nieskracalny, 25 — prosty, 107 uogólnienie tożsamości nieśmiertelnej, 308 uogólnione twierdzenie chińskie o resztach, 173 uproszczony wzór dwumienny (mod p), 433 uzupełnienie I prawa wzajemności, 205 — II prawa wzajemności, 207 Warstwa liczby a modulo m, 176 wartość funkcji wymiernej, 108 — średnia funkcji r(n), 276 — ułamka łańcuchowego, 257 — wielomianu, 66 — — f (X) ∈ Z[X] dla argumentu α ∈ Zp, 222 warunek bazowy indukcji, 3 — jednorodności danego stopnia, 110 warunki początkowe, 301 wektor, 240 Wielkie Twierdzenie Fermat’a, WTF, 372 — — —, przypadek I, 374 — — —, przypadek II, 374 wielokrotność, 18, 328, 340, 355 — w pierścieniu wielomianów, 82 — elementu grupy addytywnej, 183 wielomian Bernoulli’ego, 248 — ”broszkowy”, 243 — charakterystyczny, 301 — cyklotomiczny, 98 — — jednorodny, 191 — Czebyszewa, 306 — dwóch zmiennych, 108 — interpolacyjny Lagrange’a, 105 — jednej zmiennej, 64 — minimalny liczby algebraicznej, 232 — n zmiennych, 109 — Newtona, 432 — nierozkładalny, 85 — palindromiczny, 104 — Petersena grafu prostego, 243 — pierwotny, 87 — Polya’i, 115 — stały, 64 — symetryczny (elemetarny), 228 — — pełny jednorodny stopnia k, 110 — — elementarny, 228 — unormowany, 69 — zerowy, 64 wielomiany stowarzyszone, 82 — względnie pierwsze, 84 własność Darboux (funkcji ciągłych), 75 — — dyskretna, 243 — nieparzystej podzielności (ciągu), 53 — podzielności (ciągu), 53 wspólne dzielniki (zbiór owych), 19 współczynnik dwumienny, 432 — — Fibonacci’ego, 436 — wielomianu, 64 — — wiodący, 65 współrzędne biegunowe, 13 wstępujący łańcuch ideałów, 359 wykładnik p-adyczny, 36 wynik działania, 6 wyraz wolny wielomianu, 64 wyróżnik, 230 — binarnej formy kwadratowej, 288 — kraty, 278 — niewymierności kwadratowej, 264 — równania sześciennego, 99 — trójmianu kwadratowego, 73 — — sześciennego, 403 wyznacznik macierzy (odwzorowania liniowego) 315 — Vandermonde’a 51 wzory Eulera-Binet’a, 306 — — — na wielomiany Czebyszewa, 307 — Vi`ete’a, 77, 101 wzór Binet’a, 302 — dwumienny, 10 — —, uproszczony modulo p, 433 — Cassini’ego 304 INDEKS 449 — — uogólniony, 316 — de Moivre’a, 14 — Legendre’a, 37 — Maclaurina, Taylora, 226 Zadanie Fermat’a, 373 — Halmosa, 5 — o broszkach, 242 — — długiej igle, 171 — — trójkątach Napoleona, 17 — — woźnym matematyku, 144 — — zakopanym skarbie, 16 — — znudzonych uczniach, 144 zagadka Erd¨osa, 23 zapis pozycyjny liczb naturalnych, 417 — — — rzeczywistych, 420 zasada indukcji (matematycznej), 3 — maksimum, 2 — minimum, 1 — odejmowania proporcji stronami, 2 — podstawowa, 19 — równoległoboku dodawania wektorów, 13 — skwantowania (liczb całkowitych), 2 — szuﬂadkowa, 250 zasadnicze twierdzenie algebry, 92 — — arytmetyki, ZTA, 24 — — — w pierścieniu Gaussa, 329 — — — — — wielomianów, 84 zawartość wielomianu z Q[X], 87 zbiór liczb algebraicznych A, 232 — — — całkowitych I, 232 — — całkowitych Z, 1 — — naturalnych N, 1 — — zespolonych C, 11 — multyplikatywnie zamknięty, 271 — obszerny/szczupły (liczb naturalnych), 427 — wspólnych dzielników, 19 zero grupy addytywnej, 8 — pierścienia, 9 — wielomianu, 66 zespolona płaszczyzna rzutowa, 409 złożenie wielomianów, 66 zredukowana niewymierność kwadratowa, 265 zredukowany układ reszt modulo m, 164 — standardowy układ reszt modulo m, 164 ZTA (Zasadnicze Twierzenie Arytmetyki), 24 zupełność pierścienia Zp, 223 zupełny układ reszt modulo m, 164 — standardowy układ reszt modulo m, 20, 164 zwartość pierścienia Zp, 223 Kilka oznaczeń Fn liczba Fermat’a, 23 Mn liczba Mersenne’a, 35 P zbiór liczb pierwszych, 31 (α) ideał główny generowany przez α, 20, 355 vp(c) wykładnik p-adyczny liczby c ∈ Z, 36 Supp(a) nośnik liczby całkowitej a, 54 R[X] pierścień wielomianów jednej zmiennej X o współczynnikach w pierścieniu R, 64 Φn(X) n-ty wielomian cyklotomiczny, 98 σk(X1, . . . , Xn) k-ty elementarny wielomian sy- metryczny zmiennych X1, . . . , Xn, 228 τ (n) liczba dzielników liczby n ∈ N, 144 σ(n) suma dzielników liczby n ∈ N, 145 ϕ(n) wartość funkcji Eulera, 146 µ(n) wartość funkcji M¨obiusa, 148 f ∗ g splot Dirichlet’a, 148 a ≡ b (mod m) kongruencja modulo m, 157 Z/m pierścień klas reszt modulo m, 176 (Z/m)∗ grupa jedności pierścienia Z/m, 177 Fp = Z/p ciało klas reszt modulo p, 178 N (h; m) zbiór rozwiązań (parami nierównoważ- nych) kongruencji h(x) ≡ 0 (mod m), 161 N (h; m) moc zbioru N (h; m), 161 (α) podgrupa cykliczna generowana przez element α danej grupy, 183 rz(α) rząd elementu α danej grupy, 184 rzp(a) rząd a (mod p) w grupie (Z/p)∗, 187 indg(a) indeks a (mod m) przy podstawie g, 202 aRm, aNm a jest resztą, nieresztą kwadratową modulo m, 203 ( a p ) = (a|p) symbol Legendre’a (a po p), 204 Q( √D) ciało kwadratowe, 325 α′ sprzężenie elementu α danego ciała kwadra- towego, 325 N(α) norma w ciele kwadratowym, 325 Z[τD] pierścień kwadratowy, 336","libVersion":"0.2.2","langs":""}